<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">В этой статье опубликованы различные вспомогательные функции на VBA, которые порой помогают в работе.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Функция формирования инициалов из имени и отчества</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> CropFIO(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> FIO </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' получает в качестве параметра текстовую строку с виде &quot;Фамилия имя отчество&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' обрезает имя и отчество, оставляя лишь инициалы - в виде &quot;Фамилия И. О.&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    CropFIO = Application.Trim(FIO): arr = Split(CropFIO, </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(arr) &lt;&gt; 2 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Если в ячейке не 3 слова - выход из процедуры</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    CropFIO = Replace(CropFIO, </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';"> &amp; arr(1), </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';"> &amp; UCase(Left(arr(1), 1)) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    CropFIO = Replace(CropFIO, </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';"> &amp; arr(2), </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';"> &amp; UCase(Left(arr(2), 1)) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">2. Шифрование строк на VBA</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> s(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 255) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, kep(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 255) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> EnDeCrypt(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> plaintxt </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> Password </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> temp </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, a </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, b </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, cipherby </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Byte</span><span style=" font-family:'monospace';">, cipher </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    b = 0: </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> a = 0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 255: b = b + 1: </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> b &gt; Len(Password) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> b = 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        kep(a) = Asc(Mid$(Password, b, 1)): </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> a</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> a = 0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 255: s(a) = a: </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> a: b = 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> a = 0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 255: b = (b + s(a) + kep(a)) </span><span style=" font-family:'monospace'; color:#000080;">Mod</span><span style=" font-family:'monospace';"> 256: temp = s(a): s(a) = s(b): s(b) = temp: </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> a</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> a = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> Len(plaintxt): cipherby = EnDeCryptSingle(Asc(Mid$(plaintxt, a, 1)))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        cipher = cipher &amp; Chr(cipherby): </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';">: EnDeCrypt = cipher</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> EnDeCryptSingle(plainbyte </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Byte</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Byte</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> i </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, j </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, temp </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, k </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, cipherby </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Byte</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    i = (i + 1) </span><span style=" font-family:'monospace'; color:#000080;">Mod</span><span style=" font-family:'monospace';"> 256: j = (j + s(i)) </span><span style=" font-family:'monospace'; color:#000080;">Mod</span><span style=" font-family:'monospace';"> 256: temp = s(i): s(i) = s(j): s(j) = temp</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    k = s((s(i) + s(j)) </span><span style=" font-family:'monospace'; color:#000080;">Mod</span><span style=" font-family:'monospace';"> 256): cipherby = plainbyte </span><span style=" font-family:'monospace'; color:#000080;">Xor</span><span style=" font-family:'monospace';"> k: EnDeCryptSingle = cipherby</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#008000;">' примеры использования</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> Шифрование_с_расшифровкой()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    MsgBox EnDeCrypt(EnDeCrypt(</span><span style=" font-family:'monospace'; color:#800000;">&quot;123456&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;passw&quot;</span><span style=" font-family:'monospace';">), </span><span style=" font-family:'monospace'; color:#800000;">&quot;passw&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> Тест_шифра()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    MsgBox EnDeCrypt(</span><span style=" font-family:'monospace'; color:#800000;">&quot;123456&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;пароль&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">3. Сортировка двумерного массива по нулевому столбцу</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> CoolSort(SourceArr </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Variant</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> Check </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Boolean</span><span style=" font-family:'monospace';">, iCount </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, jCount </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span><span style=" font-family:'monospace';">, nCount </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> tmpArr(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(SourceArr, 2)) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Do</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Until</span><span style=" font-family:'monospace';"> Check</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        Check = </span><span style=" font-family:'monospace'; color:#000080;">True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> iCount = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(SourceArr, 1) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(SourceArr, 1) - 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Val(SourceArr(iCount, 0)) &gt; Val(SourceArr(iCount + 1, 0)) </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> jCount = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(SourceArr, 2) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(SourceArr, 2)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    tmpArr(jCount) = SourceArr(iCount, jCount)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    SourceArr(iCount, jCount) = SourceArr(iCount + 1, jCount)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    SourceArr(iCount + 1, jCount) = tmpArr(jCount)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    Check = </span><span style=" font-family:'monospace'; color:#000080;">False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Loop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    CoolSort = SourceArr</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">4. Преобразование строки в набор ASC кодов</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> String2CharCodes(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> txt$) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    sep = </span><span style=" font-family:'monospace'; color:#800000;">&quot; &amp; &quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> Len(txt)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        charcode = </span><span style=" font-family:'monospace'; color:#800000;">&quot;Chr(&quot;</span><span style=" font-family:'monospace';"> &amp; Asc(Mid(txt, i, 1)) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;)&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        String2CharCodes = String2CharCodes &amp; sep &amp; charcode</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    String2CharCodes = Mid(String2CharCodes, Len(sep) + 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">5. Функции для определения нажатой клавиши</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#008000;">'============= Функции для определения нажатой клавиши =================================</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Declare</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> GetKeyState </span><span style=" font-family:'monospace'; color:#000080;">Lib</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#800000;">&quot;user32&quot;</span><span style=" font-family:'monospace';"> (</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> nVirtKey </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> VirtualKeys) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Enum</span><span style=" font-family:'monospace';"> VirtualKeys    </span><span style=" font-family:'monospace'; color:#008000;">' Virtual Keys, Standard Set</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_LBUTTON = &amp;H1: VK_RBUTTON = &amp;H2: VK_CANCEL = &amp;H3: VK_MBUTTON = &amp;H4    </span><span style=" font-family:'monospace'; color:#008000;">'VK_MBUTTON = &amp;H4 -  NOT contiguous with L RBUTTON</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_BACK = &amp;H8: VK_TAB = &amp;H9: VK_CLEAR = &amp;HC: VK_RETURN = &amp;HD</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_SHIFT = &amp;H10: VK_CONTROL = &amp;H11: VK_MENU = &amp;H12: VK_PAUSE = &amp;H13: VK_CAPITAL = &amp;H14: VK_ESCAPE = &amp;H1B</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_SPACE = &amp;H20: VK_PRIOR = &amp;H21: VK_NEXT = &amp;H22: VK_END = &amp;H23: VK_HOME = &amp;H24</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_LEFT = &amp;H25: VK_UP = &amp;H26: VK_RIGHT = &amp;H27: VK_DOWN = &amp;H28: VK_SELECT = &amp;H29: VK_PRINT = &amp;H2A</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_EXECUTE = &amp;H2B: VK_SNAPSHOT = &amp;H2C: VK_INSERT = &amp;H2D: VK_DELETE = &amp;H2E: VK_HELP = &amp;H2F</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' VK_A thru VK_Z are the same as their ASCII equivalents: 'A' thru 'Z'</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' VK_0 thru VK_9 are the same as their ASCII equivalents: '0' thru '9'</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#008000;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_NUMPAD0 = &amp;H60: VK_NUMPAD1 = &amp;H61: VK_NUMPAD2 = &amp;H62: VK_NUMPAD3 = &amp;H63: VK_NUMPAD4 = &amp;H64</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_NUMPAD5 = &amp;H65: VK_NUMPAD6 = &amp;H66: VK_NUMPAD7 = &amp;H67: VK_NUMPAD8 = &amp;H68: VK_NUMPAD9 = &amp;H69</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_MULTIPLY = &amp;H6A: VK_ADD = &amp;H6B: VK_SEPARATOR = &amp;H6C: VK_SUBTRACT = &amp;H6D: VK_DECIMAL = &amp;H6E: VK_DIVIDE = &amp;H6F</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_F1 = &amp;H70: VK_F2 = &amp;H71: VK_F3 = &amp;H72: VK_F4 = &amp;H73: VK_F5 = &amp;H74: VK_F6 = &amp;H75: VK_F7 = &amp;H76</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_F8 = &amp;H77: VK_F9 = &amp;H78: VK_F10 = &amp;H79: VK_F11 = &amp;H7A: VK_F12 = &amp;H7B</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_F13 = &amp;H7C: VK_F14 = &amp;H7D: VK_F15 = &amp;H7E: VK_F16 = &amp;H7F: VK_F17 = &amp;H80: VK_F18 = &amp;H81</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_F19 = &amp;H82: VK_F20 = &amp;H83: VK_F21 = &amp;H84: VK_F22 = &amp;H85: VK_F23 = &amp;H86: VK_F24 = &amp;H87</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_NUMLOCK = &amp;H90: VK_SCROLL = &amp;H91</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">'   VK_L VK_R - left and right Alt, Ctrl and Shift virtual keys.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">'   Used only as parameters to GetAsyncKeyState() and GetKeyState().</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">'   No other API or message will distinguish left and right keys in this way.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_LSHIFT = &amp;HA0: VK_RSHIFT = &amp;HA1: VK_LCONTROL = &amp;HA2: VK_RCONTROL = &amp;HA3: VK_LMENU = &amp;HA4: VK_RMENU = &amp;HA5</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_ATTN = &amp;HF6: VK_CRSEL = &amp;HF7: VK_EXSEL = &amp;HF8: VK_EREOF = &amp;HF9: VK_PLAY = &amp;HFA</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    VK_ZOOM = &amp;HFB: VK_NONAME = &amp;HFC: VK_PA1 = &amp;HFD: VK_OEM_CLEAR = &amp;HFE</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Enum</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#008000;">'==========================================================================================</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#008000;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Public</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> KeyPressed(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> VKey </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> VirtualKeys) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Boolean</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    KeyPressed = IIf(GetKeyState(VKey) &lt; 0, </span><span style=" font-family:'monospace'; color:#000080;">True</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#000080;">False</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">6. Макрос для создания копии файла программы</span><br />(подразумевается наличие в программе глобальной константы или функции <span style=" font-weight:600;">PROJECT_NAME</span>)<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> CreateBackup()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';">: ThisWorkbook.Save</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    BackupsPath = Replace(ThisWorkbook.FullName, ThisWorkbook.Name, PROJECT_NAME &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot; Backups\&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    MkDir BackupsPath</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    filename = PROJECT_NAME &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;_BACKUP_&quot;</span><span style=" font-family:'monospace';"> &amp; Format(Now, </span><span style=" font-family:'monospace'; color:#800000;">&quot;DD-MM-YYYY__HH-NN-SS&quot;</span><span style=" font-family:'monospace';">) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;.xls&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ThisWorkbook.SaveCopyAs BackupsPath &amp; filename</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">'Debug.Print BackupsPath &amp; filename</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">7. Изменяем форматирование цифр в ячейке (выделяем все цифры полужирным шрифтом)</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> BoldingDigits(</span><span style=" font-family:'monospace'; color:#000080;">ByRef</span><span style=" font-family:'monospace';"> celll </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> Range)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> celll.Characters.count</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        letter = celll.Characters(start:=i, Length:=1).Text</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        celll.Characters(start:=i, Length:=1).Font.Bold = IsNumeric(letter)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">8. Поиск артикула (последовательности цифр заданной длины) в текстовой строке</span><br />Ссылка на примеры использования Regexp: script-coding.com/WSH/RegExp.html<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> FindDigits(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> txt$, </span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> DigitsCount%) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' ищет в строке txt$ подстроку цифр длиной DigitsCount%</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> expres = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;VBScript.RegExp&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    expres.Pattern = Replace(</span><span style=" font-family:'monospace'; color:#000080;">String</span><span style=" font-family:'monospace';">(DigitsCount%, </span><span style=" font-family:'monospace'; color:#800000;">&quot;%&quot;</span><span style=" font-family:'monospace';">), </span><span style=" font-family:'monospace'; color:#800000;">&quot;%&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;[0-9]&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> expres.test(txt$) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> FindDigits = expres.Execute(txt$)(0).Value</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> FindDigits(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> txt$, </span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> DigitsCount%) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' ищет в строке txt$ подстроку цифр длиной DigitsCount%</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> RegExp = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;VBScript.RegExp&quot;</span><span style=" font-family:'monospace';">): RegExp.Global = </span><span style=" font-family:'monospace'; color:#000080;">True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    RegExp.Pattern = </span><span style=" font-family:'monospace'; color:#800000;">&quot;[\D]&quot;</span><span style=" font-family:'monospace';">: txt$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';"> &amp; RegExp.Replace(txt$, </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';">) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    RegExp.Pattern = </span><span style=" font-family:'monospace'; color:#800000;">&quot; [\d]{&quot;</span><span style=" font-family:'monospace';"> &amp; DigitsCount% &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;} &quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> RegExp.test(txt$) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> FindDigits = RegExp.Execute(txt$)(0).Value</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">9. Добавление значений сразу во весь столбец двумерного массива</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> AddValueIntoColumn(</span><span style=" font-family:'monospace'; color:#000080;">ByRef</span><span style=" font-family:'monospace';"> arr, </span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> ColumnIndex%, </span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> NewValue)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' добавляет значение NewValue в столбец ColumnIndex% всех строк</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' переданного по ссылке двумерного массива arr</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(arr) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(arr)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        arr(i, ColumnIndex%) = NewValue</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">10. Использование Application.OnTime с задержкой меньше секунды</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> ЗапускМакросаСНебольшойЗадержкой() </span><span style=" font-family:'monospace'; color:#008000;">' по мотивам макроса ZVI_Timer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ЗадержкаВСекундах = 0.3    </span><span style=" font-family:'monospace'; color:#008000;">' в секундах</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    НазваниеМакроса$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;test&quot;</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' этот макрос будет запущен через 0.3 сек.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ЗадержкаВЧасах$ = Replace(Format(</span><span style=" font-family:'monospace'; color:#000080;">CDbl</span><span style=" font-family:'monospace';">(TimeSerial(0, 0, 1)) * ЗадержкаВСекундах, </span><span style=" font-family:'monospace'; color:#800000;">&quot;0.000000000&quot;</span><span style=" font-family:'monospace';">), </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    macro = </span><span style=" font-family:'monospace'; color:#800000;">&quot;ON.TIME(NOW()+&quot;</span><span style=" font-family:'monospace';"> &amp; ЗадержкаВЧасах$ &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;, &quot;&quot;&quot;</span><span style=" font-family:'monospace';"> &amp; НазваниеМакроса$ &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;&quot;)&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#008000;">' формируем команду запуска</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ExecuteExcel4Macro macro </span><span style=" font-family:'monospace'; color:#008000;">' macro = ON.TIME(NOW()+0.000003472, &quot;test&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">11. Преобразование коллекции в массив</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> Collection2Array(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> coll </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Collection</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> arr(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> coll.Count - 1): </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> i </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Long</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> coll.Count: arr(i - 1) = coll(i): </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Collection2Array = arr</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">12. Разрешаем Excel доступ в Интернет путем отключения брандмауэра:</span><br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#008000;">' включаем файрвол Windows (доступ в интернет ограничен)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;HNetCfg.FwMgr&quot;</span><span style=" font-family:'monospace';">).LocalPolicy.CurrentProfile.FirewallEnabled = </span><span style=" font-family:'monospace'; color:#000080;">True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#008000;">' отключаем файрвол Windows (доступ в интернет открыт)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;HNetCfg.FwMgr&quot;</span><span style=" font-family:'monospace';">).LocalPolicy.CurrentProfile.FirewallEnabled = </span><span style=" font-family:'monospace'; color:#000080;">False</span></pre>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">17057 просмотров </li></ul></td>
<td></td></tr></table></body></html>