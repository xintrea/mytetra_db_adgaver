<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Элементы ActiveX перестали работать или ведут себя непредсказуемо</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">В Microsoft Office после определенных обновлений может появиться проблема: </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Перестают работать все элементы ActiveX</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (кнопки CommandButton, списки(Lists и ComboBox) и пр.) во всех файлах, а так же невозможно вставить любой элемент ActiveX на лист(при попытке вставки появляется сообщение </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Вставка объекта неосуществима</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">), а при работе с таким файлом может появится ошибка </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Can't exit design mode because control cannot be created</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">). Подробнее про вставку таких элементов на лист можно прочитать в статье: </span><a href="https://www.excel-vba.ru/chto-umeet-excel/kak-sozdat-knopku-dlya-vyzova-makrosa-na-liste/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">КАК СОЗДАТЬ КНОПКУ ДЛЯ ВЫЗОВА МАКРОСА НА ЛИСТЕ?</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Там я описывал пример вставки кнопки через ActiveX, но сути это не меняет - остальные элементы вставляются точно так же. Яркий пример - </span><a href="http://support2.microsoft.com/default.aspx?scid=kb;en-us;2553154"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">декабрьское обновление безопасности для пакета Microsoft Office (от 09.12.2014)</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, которое призвано устранить различные уязвимости безопасности (кстати сам пакет обновлений делает исправления не только в офисе, но и в Internet Explorer(IE), Exchange и самой ОС Windows). Тогда многие пользователи оказались практически без элементов ActiveX.<br />При этом очевидных решений проблем как правило нет, удаление установленных обновлений не всегда решает проблему.<br />Если столкнулись с подобной проблемой, то можно попробовать некоторые приведенные ниже способы. Не все они выдуманы мной, некоторые взяты из форумов. Я собрал проверенные методы в одну статью. Особая благодарность за решение сей проблемы MVP Excel Владимиру Захарову, известному на форумах как ZVI.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Предупреждение:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> все описанные ниже действия вы выполняете на свой страх и риск и автор статьи не несет никакой ответственности за потерю каких-либо данных(в том числе форматов) вследствие неосторожного использования инструкции, а так же за какой-либо ущерб, включая все без исключения случаи упущенной выгоды или потери данных, либо других денежных потерь, ставших результатом использования или невозможности использования инструкции, даже если автор был заранее поставлен в известность о возможности подобного рода ущерба.</span></p>
<hr />
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Закрыть Excel (желательно вообще все окна и приложения)</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажать одновременно клавишу Windows и R (или нажать на панели задач кнопку ПУСК и выбрать команду Выполнить. В Windows 7 и выше она может отсутствовать и её необходимо будет отобразить через настройку меню Пуск)</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ввести в поле команду: <span style=" font-weight:600;">%APPDATA%\Microsoft\Forms</span> и нажать Enter<br />В XP обычно это папка:<br /><span style=" font-weight:600;">C:\Documents and Settings\%USERNAME%\Application Data\Microsoft\Forms\</span><br />В Win7:<br /><span style=" font-weight:600;">C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Forms\</span></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В открывшейся папке удалить все файлы с расширением EXD</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же не помешает удалить файлы с расширением EXD из временных папок Excel и VBE: %Temp%\Excel8.0\, %Temp%\VBE\, %USERPROFILE%\Local Settings\Temp\, %USERPROFILE%\Local Settings\Temp\Excel8.0\, %SystemRoot%\Temp\VBE\, %SystemRoot%\Temp\Excel8.0\<br />Если каких-то папок нет или в них нет файлов EXD - значит все хорошо и там ничего критичного нет.</li></ol>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="1.png" style="vertical-align: middle;" /><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  </span><a href="https://www.excel-vba.ru/download/99/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">fixMS_Hay.zip</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (423 bytes, 3 959 скачиваний)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Само содержание BAT-ника выглядит так:		</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6ab1f027e3494342998"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">										</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">@echo off del &quot;%APPDATA%\Microsoft\Forms\*.exd&quot; del &quot;%APPDATA%\Microsoft\Excel\*.xlb&quot; del &quot;%APPDATA%\Roaming\Microsoft\Forms\*.exd&quot; del &quot;%Temp%\VBE\*.exd&quot; del &quot;%Temp%\Excel8.0\*.exd&quot; del &quot;%APPDATA%\Microsoft\Local\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\VBE\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\Excel8.0\*.exd&quot; del &quot;%SystemRoot%\Temp\VBE\*.exd&quot; del &quot;%SystemRoot%\Temp\Excel8.0\*.exd&quot;			</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">@echo off </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%APPDATA%\Microsoft\Forms\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%APPDATA%\Microsoft\Excel\*.xlb&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%APPDATA%\Roaming\Microsoft\Forms\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%Temp%\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%Temp%\Excel8.0\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%APPDATA%\Microsoft\Local\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%USERPROFILE%\Local Settings\Temp\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%USERPROFILE%\Local Settings\Temp\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%USERPROFILE%\Local Settings\Temp\Excel8.0\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%SystemRoot%\Temp\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:12px; color:#0000ff;">del &quot;%SystemRoot%\Temp\Excel8.0\*.exd&quot;									</span></p></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">					</span></p>
<hr />
<hr />
<hr />
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">И напоследок - элементы ActiveX сами по себе считаются устаревшими и я бы не рекомендовал их использовать без крайней необходимости, во избежание ситуаций, описанных в этой статье. Для запуска макроса кнопкой есть и </span><a href="https://www.excel-vba.ru/chto-umeet-excel/kak-sozdat-knopku-dlya-vyzova-makrosa-na-liste/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">другие методы</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, более стабильные.</span></p></body></html>