<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как сортировать листы в Excel? Программная сортировка листов макросом VBA<span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">			</span></p>
<p style=" margin-top:8px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">									Подробности							</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">																		Категория: </span><a href="http://macros-vba.ru/makrosy/excel"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Макросы Excel</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p>
<p style=" margin-top:0px; margin-bottom:8px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">					Опубликовано: 08 апреля 2012				</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">В Microsoft Excel 2007, а также в более ранних версиях, нельзя сортировать листы рабочей книги стандартными средствами. Для того, чтобы упорядочить расположение листов в книге, можно прибегнуть к помощи Visual Basic for Applications (VBA).</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Макрос для сортировки листов в Excel</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#333333;">На одной из страниц сайта </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">http://support.microsoft.com/kb/812386</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#333333;">размещен программный код макроса, который сортирует листы в рабочих книгах Excel по возрастанию и убыванию. Ниже приведен этот код в несколько измененном виде.</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Сортировка по возрастанию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Sub Sortirovka_Listov_Po_Vozrastaniyu()</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    Dim i As Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    Dim j As Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        For i = 1 To Sheets.Count</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">            For j = 1 To Sheets.Count - 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                If UCase$(Sheets(j).Name) &gt; UCase$(Sheets(j + 1).Name) Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                    Sheets(j).Move After:=Sheets(j + 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">            Next j</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        Next i</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">End Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Для того, чтобы перенести этот программный код на свой компьютер, наведите курсор мыши на поле с программным кодом, нажмите на одну из двух кнопкок  в правом верхнем углу этого поля, скопируйте программный код и вставьте его в модуль проекта на своем компьютере (подробнее о том, </span><a href="http://macros-vba.ru/knigi/vba/62-kak-sohranit-kod-macrosa"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; text-decoration: underline; color:#0000ff;">как сохранить программный код макроса</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">).</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Сортировка по убыванию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Sub Sortirovka_Listov_Po_Ubyvaniyu()</span></p>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    Dim i As Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    Dim j As Integer</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        For i = 1 To Sheets.Count</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">            For j = 1 To Sheets.Count - 1</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                If UCase$(Sheets(j).Name) &lt; UCase$(Sheets(j + 1).Name) Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                    Sheets(j).Move After:=Sheets(j + 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                End If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">            Next j</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">        Next i</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">End Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Приведенный выше макрос сортирует листы по имени и вполне справляется со своей задачей. В большинстве случаев он помогает автоматизировать упорядочивание листов в рабочей книге, но и свои недостатки тоже имеет. Например, если имена листов состоят из двух частей, текстовой и числовой, то в результате такой сортировки за именем &quot;Лист1&quot; будет следовать &quot;Лист11&quot;, а не &quot;Лист2&quot;, как иногда хотелось бы. Этот недостаток можно устранить, если сортировать листы по двум параметрам, как по текстовой, так и по числовой части. </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Надстройка для сортировки листов Excel</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#333333;">Механизм сортировки листов по двум параметрам реализован в </span><a href="http://macros-vba.ru/nadstrojki/excel/77-kak-sortirovat-listy-v-excel-sortirovka-listov"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; text-decoration: underline; color:#0000ff;">надстройке</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#333333;">, действие которой можно оценить на </span><a href="http://macros-vba.ru/video/excel/127-video-po-sortirovke-listov-rabochey-knigi-excel"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; text-decoration: underline; color:#0000ff;">видео</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#333333;">. Надстройка разработана на основе макроса, но более удобна при использовании, так как позволяет быстро запускать макросы прямо из панели инструментов и не тратить время на выбор нужного макроса из списка.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/nadstrojki/excel/137-sortirovka-listov-excel-po-imeni-po-tsvetu-yarlychka-i-po-spisku"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; text-decoration: underline; color:#0000ff;">В другой надстройке</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> реализовано сразу несколько способов сортировки листов от алфавитной, до сортировки по настраиваемым спискам.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Другие материалы по теме:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/office/55-sostav-ms-office"><span style=" text-decoration: underline; color:#0000ff;">				Состав MS Office</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/53-chto-takoe-makrosy"><span style=" text-decoration: underline; color:#0000ff;">				Что такое VBA? Что такое макросы VBA? Что такое надстройки?</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/61-sposobyi-ustanovki-macrosov"><span style=" text-decoration: underline; color:#0000ff;">				Создание и написание макросов. Как установить макрос на свой компьютер?</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/60-macros-recorderom"><span style=" text-decoration: underline; color:#0000ff;">				Как записать макрос макрорекордером? Как запустить макрос в Word и Excel?</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://macros-vba.ru/knigi/vba/62-kak-sohranit-kod-macrosa"><span style=" text-decoration: underline; color:#0000ff;">				Как сохранить программный код макроса? Что такое модули?</span></a></li></ul></body></html>