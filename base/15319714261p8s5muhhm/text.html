<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'AngsanaUPC'; font-size:5pt; font-weight:600;">Автоматическое подключение внешних таблиц, полученных при разбиении исходной базы данных на таблицы и объекты</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Автор: Дмитрий Сонных </span><a href="mailto:sonni-dim@mail.ru"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">sonni-dim@mail.ru</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">    После того, как я несколько раз получил письма приблизительно следующего содержания: &quot; ... я разделил, как мне рекомендовали, базу на две части - одну с кодом, другую с таблицами и теперь не могу перенести её на другой компьютер (диск, раздел). Что делать?...&quot; я решил сесть и написать пример, который бы позволил начинающим программистам на Accesse решить эту проблему.<br /> Для чего разделяют базы? Для того, чтобы при модификации кода, разработке новых форм и отчетов можно было легко заменить файл с кодом и оставить базу с таблицами нетронутой. (Разбиение производится так же при построении сетевых систем, но это мы оставим в стороне)<br /> Следующие действия приводят к разделению базы данных на два файла, в одном из которых содержатся таблицы, а в другом запросы, формы, отчеты, макросы и модули.<br />                                        <br />1 Выберите в меню Сервис команду Надстройки и подкоманду Разделить базу данных.<br />2 Выполните действия, заданные в окнах диалога мастера по разделению баз данных.<br /><br /> После разделения получаются два файла, один из них будет иметь старое имя и в нем будет содержаться програмный код, запросы, формы, отчеты, а другой будет иметь имя &quot;ИмяБазы_be.mdb&quot;, и в нем будут содержаться таблицы с данными.<br /> Если теперь в базе с кодами открыть закладку &quot;Таблицы&quot;, то возле всех таблиц с данными будут стоять маленькие жирные стрелочки, которые показывают, что данные таблицы подключены из внешней базы. После этого попытки перенести базу с данными на любой другой компьютер (если не сохранять структуру каталогов), в другой раздел, на другой диск - терпят неудачу. Дело в том, что при создании линка, жестко прописывается путь к файлу базы, и при изменении расположения этого файла связи рвутся. Их можно восстановить программно или вручную, используя Файл -&gt; Внешние данные -&gt; Связь с таблицами (только с начала надо отключить старые связи удалив ссылки на таблицы).<br /> Предлагаемый пример позволяет автоматизировать подключение базы с таблицами к базе с кодом. Необходимо соблюдать только одно условие: файл с кодом и файл с таблицами должны находится в одном разделе. Теперь достаточно в секции Form_Load загружаемой формы установить вызов подпрограммы SetReferencesA и программа сама найдет базу с таблицами и подключит все таблицы, находящиеся в базе.<br /> Ограничения: такой способ не годится для сетевых версий программ, т.к. в этом случае база с таблицами располагается на сервере и требуется явно указать путь к ней. Хотя саму подпрограмму подключения всех таблиц из указанной базы можно использовать.<br /> Как подключать таблицы в сетевых разработках можно посмотреть на примере базы </span><span style=" font-family:'DejaVu Sans'; font-weight:600;">Uchet.zip</span><span style=" font-family:'DejaVu Sans';"> расположенной на </span><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=320"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">http://am.rusimport.ru/MSAccess/topic.aspx?ID=320</span></a><span style=" font-family:'DejaVu Sans';"><br /><br /> Используемые источники: кусочки кодов из программ Александра Юраги (Alex) и  Derevyankin Alexander.<br /><br /><br />Всего хорошего, Дмитрий С. (aka Joss) banderlogi@bk.ru</span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="1.png" /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"><br /><br /><br /></span><a href="http://msa.polarcom.ru/st/s0000215_AutoConnect_v01.zip"><img src="2.png" width="119" height="28" /></a><span style=" font-family:'DejaVu Sans';">        </span></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">MSA-2003 ( 83 kB)</span></p></body></html>