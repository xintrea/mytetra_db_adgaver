<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div class="post hentry uncustomized-post-template" itemscope="itemscope" itemtype="http://schema.org/BlogPosting"><h3 class="post-title entry-title" itemprop="name">
Урок 11. Создание второй надстройки, дополняющей первую.
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-2455848646371840243" itemprop="articleBody">
<div dir="ltr" style="text-align: left;" trbidi="on">
<div dir="ltr" style="text-align: left;" trbidi="on">
<div dir="ltr" style="text-align: left;" trbidi="on">
<div style="text-align: justify;">
На этом уроке мы попробуем написать вторую надстройку, которая могла бы 
использоваться как независимо от первой, так и располагаться вместе с 
ней на той-же вкладке. Пусть это будет надстройка работы со строками. </div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Создадим в Word новый документ и сохраним его как документ с макросами 
(.doсm). Убедимся, что в новом документе работает надстройка, сделанная 
нами на прошлом уроке. Закроем документ, и откроем его через Ribbon XML 
Editor.</div>
<div style="text-align: justify;">
<br></div>
<div style="margin-left: 35.4pt; text-align: justify;">
Кстати, документы можно открывать в Ribbon XML Editor как 
непосредственно из этого редактора, так и из контекстного меню самого 
документа, что очень удобно. Но для этого нужно вначале добавить в эти 
контекстные меню соответствующий пункт. Это легко делается со страницы 
настроек Ribbon XML Editor. <br>
<br>
Откройте вкладку настроек, и обратите внимание на раздел в правой части 
«Добавление «Открыть в Ribbon XML Editor» в контекстное меню 
проводника». Отметьте галочками те документы, для которых в контекстное 
меню проводника должен быть добавлен соответствующий пункт. В нашем 
случае достаточно одной галочки в столбце «Для файлов Word» напротив 
«Документ с макросами», но можно отметить и все галочки. Затем нажмите 
кнопку «Установить». <br>
<br>
Обязательно прочтите всплывающую подсказку на кнопке, там есть много 
полезной информации. В частности, то, что документ будет открываться в 
той копии Ribbon XML Editor, из которой была осуществлена установка. 
Перед удалением программы, для того, чтобы убрать ненужные уже пункты 
контекстных меню, не забудьте снять все установленные галочки и снова 
нажать кнопку «Установить» для установки отменённого состояния пунктов 
контекстного меню.</div>
<br>
Напишем интерфейс, аналогичный прежней надстройке:<br>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;?xml version="1.0" standalone="yes"?&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    &lt;ribbon startFromScratch="false"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        &lt;tabs&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            &lt;tab id="Вкладка1" label="Полезные надстройки" insertBeforeMso="TabHome" keytip="Н"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                &lt;group id="РаботаСоСтроками" label="Работа со строками"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        id="ДублироватьТекущуюСтроку" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        onAction="ДублироватьТекущуюСтроку" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        label="Дублировать" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        keytip="Д" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        imageMso="QuickStylesSets" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        size="large" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        screentip="Дублировать текущую строку" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        supertip="Сопировать текущую строку в строку ниже"/&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        id="УдалитьСдвоенныеПустыеСтроки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        onAction="УдалитьСдвоенныеПустыеСтроки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        label="Удалить повторные пустые строки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        keytip="С" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        imageMso="RecordsCollapseAllSubdatasheets" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        size="large" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        screentip="Удалить повторные пустые строки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        supertip="Найти и заменить все повторяющиеся пустые строки одной"/&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        id="УдалитьПустыеСтроки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        onAction="УдалитьПустыеСтроки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        label="Удалить пустые строки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        keytip="В" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        imageMso="GroupQuerySetup" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        size="large" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        screentip="Удалить все пустые строки" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        supertip="Найти и удалить все пустые строки"/&gt;                            </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                &lt;/group&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            &lt;/tab&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        &lt;/tabs&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    &lt;/ribbon&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;/customUI&gt;</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
<div style="text-align: justify;">
Сгенерируем процедуры обратного вызова и сохраним их в файле. Запустим 
документ на выполнение. Ожидаем, что на уже существующую вкладку 
«Вкладка1» добавится новая группа. Попробуем запустить документ (<b>F9</b>). Запустили? Вот те на…</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Вместо того, чтобы группа добавилась на вкладку с указанным 
идентификатором, мы увидели, что создалась ещё одна вкладка с тем же 
именем, куда и была помещена новая группа! Что же произошло не так?</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
По всей видимости, приложения офиса всё же различают внутри себя 
одинаковые идентификаторы. Очевидно, им автоматически присваиваются 
разные пространства имён (о которых мы говорили на первых наших уроках).
 Какой же из этого выход? Принудительно присвоить нашим идентификаторам 
одинаковое пространство имён. Для этого нам придётся произвести 
небольшую модификацию кода в обеих надстройках и вспомнить, что такое <b>idQ</b>.</div>
<br>
Закроем Word, и удалим нашу прежнюю надстройку из папки:<br>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
<div style="text-align: justify;">
В текущей надстройке, открытой в Ribbon XML Editor, добавим в тег customUI второй атрибут <b>xmlns</b>
 с указанием идентификатора нашего собственного пространства имён, 
например, МПИ (Моё Пространство Имён), и присвоим значение этому 
идентификатору, например, http://customui.blogspot.ru (интернет-адрес 
этого блога), как показано в строке ниже:</div>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xmlns:МПИ="http://customui.blogspot.ru"</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
<div style="text-align: justify;">
Этим самым мы объявим новое пространство имён, в дополнение к пространству по умолчанию, которое выражалось строкой</div>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    xmlns="http://schemas.microsoft.com/office/2006/01/customui"</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
<div style="text-align: justify;">
Теперь в теге tab заменим атрибут <b>id </b>на атрибут <b>idQ</b>, чтобы
 иметь возможность включить в идентификатор вкладки префикс пространства
 имён, и перед идентификатором «Вкладка1» вставим этот префикс нашего 
нового пространства. Замечу, что как только мы добавляем новое 
пространство имён в тег интерфейса (customUI), оно сразу появляется в 
автодополнении, поэтому вставку префикса мы можем осуществить прямо из 
него. Итак, мы получили строку:</div>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;tab idq="МПИ:Вкладка1" insertbeforemso="TabHome" keytip="Н" label="Полезные надстройки"&gt;</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
</div>
</div>
<br>
<div style="text-align: justify;">
Запускаем документ на выполнение (<b>F9</b>) и видим нашу вкладку в 
интерфейсе. Она будет единственной, потому что старую нашу надстройку, 
которую мы ещё не модифицировали аналогичным образом, мы удалили. 
Переходим в редактор Бейсика (<b>Alt+F11</b>) и открываем в нём ранее 
сохранённые нами шаблоны процедур обратного вызова для этой надстройки. 
Затем заполняем их следующим образом:</div>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'НайтиИЗаменить (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub НайтиИЗаменить(findString As String, replaceString As String)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    With Selection.Find</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .ClearFormatting</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Replacement.ClearFormatting</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Text = findString</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Replacement.Text = replaceString</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Forward = True</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Wrap = wdFindContinue</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Format = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MatchCase = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MatchWholeWord = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MatchWildcards = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MatchSoundsLike = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MatchAllWordForms = False</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Execute Replace:=wdReplaceAll</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End With</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'ДублироватьТекущуюСтроку (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub ДублироватьТекущуюСтроку(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    With Selection</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .HomeKey Unit:=wdLine</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .Copy</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .HomeKey Unit:=wdLine</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        .PasteAndFormat (wdFormatOriginalFormatting)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    End With</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'УдалитьСдвоенныеПустыеСтроки (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub УдалитьСдвоенныеПустыеСтроки(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim NumCharsBefore As Long, NumCharsAfter As Long</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Do</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        NumCharsBefore = ActiveDocument.Characters.Count</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Call НайтиИЗаменить("^p^p^p", "^p^p")</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        NumCharsAfter = ActiveDocument.Characters.Count</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Loop Until NumCharsBefore = NumCharsAfter</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'УдалитьПустыеСтроки (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub УдалитьПустыеСтроки(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim NumCharsBefore As Long, NumCharsAfter As Long</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Do</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        NumCharsBefore = ActiveDocument.Characters.Count</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Call НайтиИЗаменить("^p^p", "^p")</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        NumCharsAfter = ActiveDocument.Characters.Count</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Loop Until NumCharsBefore = NumCharsAfter</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
<div style="text-align: justify;">
В этих функциях мы реализовываем функционал кнопок. Мы можем увидеть 
здесь уже знакомую нам по первой надстройке функцию «НайтиИЗаменить», а 
также функции обратного вызова для кнопок. Функция дублирования строки 
создана методом записи макроса с последующей небольшой корректировкой, а
 две оставшиеся функции в цикле меняют одно количество символов абзаца (<b>^p</b>) на другое, в зависимости от задачи.</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Замечу, что предложенная реализация функций не является эталонной. 
Напротив, это первое и самое простое, что пришло в голову. Напомню, что 
задачей этих уроков является построение интерфейса, а не 
программирование на VBA.</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Сохраним код, перейдём в окно документа и проверим работу кнопок. Если 
всё работает так, как надо, то сохраняем документ как шаблон с 
поддержкой макросов (.dotm) в папку:</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Эта надстройка готова. В Word пока не включаем её, чтобы не мешалась. 
Теперь открываем в Ribbon XML Editor документ со старой надстройкой, и 
правим её аналогично новой. Добавляем то же самое пространство имён, у 
вкладки меняем атрибут <b>id </b>на <b>idQ </b>и добавляем наш префикс перед идентификатором. Запускаем документ (<b>F9</b>), проверяем функционал и сохраняем его как шаблон рядом со второй надстройкой в папке </div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    C:\Users\[ИмяПользователя]\AppData\Roaming\Microsoft\Word\STARTUP</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
</div>
<div style="text-align: justify;">
<br></div>
<div style="text-align: justify;">
Закрываем сохранённый шаблон в Word и открытый документ в Ribbon XML 
Editor. Обе надстройки готовы к работе. Запускаем Word, лезем в 
настройки, и включаем обе надстройки, установив напротив них галочки. 
После сохранения изменений в настройках у нас появляется одна вкладка, 
содержащая две группы, сформированные разными надстройками! То, что нам и
 было нужно.</div>
</div>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">

<a href="https://www.blogger.com/profile/15132597310126998409" rel="author" title="author profile">
<span itemprop="name">dolbodub</span>
</a>
</span>
</span>
<span class="post-timestamp">
на

<a class="timestamp-link" href="http://fluentui.blogspot.ru/2015/03/11.html?m=1" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2015-03-12T03:16:00+03:00">03:16</abbr></a>
</span>
<span class="post-comment-link">
</span>
</div>
<div class="post-footer-line post-footer-line-2">
<div class="mobile-link-button goog-inline-block" id="mobile-share-button">
<a href="javascript:void(0);">Поделиться</a>
</div>
<div class="goog-inline-block dummy-container"><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none;  font-size: 1px; vertical-align: baseline; display: inline-block; width: 32px; height: 20px;" id="___plusone_0"><iframe ng-non-bindable="" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" id="I0_1526205967418" name="I0_1526205967418" src="1.png" data-gapiattached="true" title="G+" width="100%" frameborder="0"></iframe></div></div>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>7 комментариев:</h4>
<div class="comments-content">


<div id="comment-holder">

<div id="bc_0_8C" kind="c"><div id="bc_0_8CT"><div id="bc_0_7T" class="comment-thread" kind="r" t="0" u="0"><ol id="bc_0_7TB"><li id="bc_0_4B" class="comment" kind="b"><div class="avatar-image-container"><img src="2.png"></div><div id="c5913433485966324639" class="comment-block"><div id="bc_0_4M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13357728351184639665">Алексей Мальков</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1444225640565&amp;m=1#c5913433485966324639">07 октября, 2015 16:47</a></span></div><p id="bc_0_4MC" class="comment-content">А
 можно ли как-то регулировать порядок групп на вкладке? Чтобы группа из 
второй надстройки располагалась после, а не до группы из первой 
надстройки.</p><span id="bc_0_4MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Ответить</a></span></div><div id="bc_0_4BR" class="comment-replies"><span id="bc_0_4b+seedCEuqD" kind="d"><div id="bc_0_0T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_0TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_0TA" class="thread-arrow"></span><span id="bc_0_0TN" class="thread-count"><a href="javascript:;" target="_self">Ответы</a><div id="bc_0_0TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_0TC" class="thread-chrome thread-expanded"><div><li id="bc_0_0B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c7362153228505715955" class="comment-block"><div id="bc_0_0M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1444256194987&amp;m=1#c7362153228505715955">08 октября, 2015 01:16</a></span></div><p id="bc_0_0MC" class="comment-content">Ну вообще, у групп тоже есть атрибуты insertBeforeMso и insertAfterMso.</p><span id="bc_0_0MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_0BR" class="comment-replies"></div><div id="bc_0_0B_box" class="comment-replybox-single"></div></li><li id="bc_0_1B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c7276456335629856348" class="comment-block"><div id="bc_0_1M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1444256370778&amp;m=1#c7276456335629856348">08 октября, 2015 01:19</a></span></div><p id="bc_0_1MC" class="comment-content">А также insertBeforeQ и insertAfterQ.</p><span id="bc_0_1MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_1BR" class="comment-replies"></div><div id="bc_0_1B_box" class="comment-replybox-single"></div></li><li id="bc_0_2B" class="comment" kind="b"><div class="avatar-image-container"><img src="2.png"></div><div id="c3349389219707480835" class="comment-block"><div id="bc_0_2M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13357728351184639665">Алексей Мальков</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1444797902528&amp;m=1#c3349389219707480835">14 октября, 2015 07:45</a></span></div><p id="bc_0_2MC" class="comment-content">Спасибо</p><span id="bc_0_2MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_2BR" class="comment-replies"></div><div id="bc_0_2B_box" class="comment-replybox-single"></div></li><li id="bc_0_3B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c796741748442871766" class="comment-block"><div id="bc_0_3M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1444864590223&amp;m=1#c796741748442871766">15 октября, 2015 02:16</a></span></div><p id="bc_0_3MC" class="comment-content">Пожалуйста! :-)</p><span id="bc_0_3MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_3BR" class="comment-replies"></div><div id="bc_0_3B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_0I" class="continue" kind="ci"><a href="javascript:;" target="_self">Ответить</a></div></ol><div id="bc_0_0T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_4B_box" class="comment-replybox-single"></div></li><li id="bc_0_6B" class="comment" kind="b"><div class="avatar-image-container"><img src="7.png"></div><div id="c788125494392485056" class="comment-block"><div id="bc_0_6M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17737661652250037328">Игорь Горбачев</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1492672383755&amp;m=1#c788125494392485056">20 апреля, 2017 10:13</a></span></div><p id="bc_0_6MC" class="comment-content">Что-то не получается. А какие значения необходимо задать этим атрибутам?</p><span id="bc_0_6MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Ответить</a></span></div><div id="bc_0_6BR" class="comment-replies"><span id="bc_0_6b+seedCEuvD" kind="d"><div id="bc_0_5T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_5TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_5TA" class="thread-arrow"></span><span id="bc_0_5TN" class="thread-count"><a href="javascript:;" target="_self">Ответы</a><div id="bc_0_5TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_5TC" class="thread-chrome thread-expanded"><div><li id="bc_0_5B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c373576558496171494" class="comment-block"><div id="bc_0_5M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/11.html?showComment=1492688238054&amp;m=1#c373576558496171494">20 апреля, 2017 14:37</a></span></div><p id="bc_0_5MC" class="comment-content">Каким
 именно атрибутам? В статье приведён полный код. А в xml-разметке в 
качестве значения атрибута просто прописывается имя функции.</p></div></li></div></ol></div></span></div></li></ol></div></div></div></div></div></div>
</body>
</html></p></body></html>