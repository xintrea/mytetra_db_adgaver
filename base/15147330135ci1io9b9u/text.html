<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/NamesList"><span style=" text-decoration: underline; color:#0000ff;">Вывод списка имён (Names) книги Excel на новый лист</span></a> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/sheets_and_ranges"><span style=" text-decoration: underline; color:#0000ff;">Работа с диапазонами ячеек и листами</span></a> </li></ul></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если вы хотите посмотреть, присутствуют ли в книге Excel назначенные имена,<br />сделать это просто - достаточно </span><span style=" font-size:8.25pt; font-weight:600;">вызвать диспетчер имён</span><span style=" font-size:8.25pt;"> нажатием комбинации клавиш </span><span style=" font-size:8.25pt; font-weight:600;">Ctrl + F3: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image16018.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В диспетчере имён можно </span><span style=" font-size:8.25pt; font-weight:600;">создать новые имена, просмотреть ранее созданные, и, при желании, изменить их</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Одно но: в диспетчере имён отображаются только видимые имена,</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">а в книге Excel могут присутствовать и скрытые.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Чтобы </span><span style=" font-size:8.25pt; font-weight:600;">узнать количество имён в книге</span><span style=" font-size:8.25pt;">, а также посмотреть их значения,<br />мы воспользуемся макросом:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ПолучениеСпискаИмёнВКниге()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> n </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Name, VisibleNames%, HiddenNames%, WB </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Workbook, i </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> WB = ActiveWorkbook</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:8.25pt;"> n </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:8.25pt;"> WB.Names</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        VisibleNames = VisibleNames - n.Visible</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        HiddenNames = HiddenNames - </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Not</span><span style=" font-family:'monospace'; font-size:8.25pt;"> n.Visible</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:8.25pt;"> n</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> VisibleNames + HiddenNames = 0 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        MsgBox </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Имена в книге отсутствуют (не назначены)&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, vbInformation</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        msg = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Количество имён в книге: &quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; VisibleNames + HiddenNames &amp; vbNewLine &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">              </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Из них видимых: &quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; VisibleNames &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;, скрытых: &quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; HiddenNames &amp; vbNewLine &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">              vbNewLine &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Вывести на лист список всех имён?&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> MsgBox(msg, vbInformation + vbYesNo, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Имена в открытом файле&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">) = vbYes </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sh </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Worksheet: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sh = Workbooks.Add(xlWBATWorksheet).Worksheets(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            sh.Cells(1, 1).Resize(, 4).Value = _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            Array(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;№&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Имя&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Видимость&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Ссылка (значение)&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            sh.Cells(1, 1).Resize(, 4).Interior.ColorIndex = 15</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i = 1 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:8.25pt;"> WB.Names.Count</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> n = WB.Names(i)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                sh.Cells(i + 1, 1).Resize(, 4).Value = _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                Array(i, n.Name, IIf(n.Visible, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Видимое&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Скрытое&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">), </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;'&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; n.RefersTo)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            sh.UsedRange.EntireColumn.AutoFit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для этого в прикреплённом файле нажмём зеленую кнопку,<br />и увидим вообщение с информацией о количестве имен в книге:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image23199.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если в диаоговом окне мы нажмём «Да», то </span><span style=" font-size:8.25pt; font-weight:600;">макрос создаст новую книгу, и сформирует в ней таблицу со списком всех имен книги</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image21824.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Ознакомьтесь также со </span><a href="http://excelvba.ru/code/HiddenNames"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">способом сохранения значений в скрытых именах книги Excel</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если же вам требуется </span><span style=" font-size:8.25pt; font-weight:600;">вывести список видимых имён на лист Excel</span><span style=" font-size:8.25pt;">, то можно воспользоваться макросом из одной строки:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> СписокВидимыхИмён()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    ActiveCell.ListNames</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Того же эффекта можно добиться, нажав кнопку «</span><span style=" font-size:8.25pt; font-weight:600;">Все имена</span><span style=" font-size:8.25pt;">» в диалоговом окне, вызываемом из меню </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">Вставка - Имя - Вставить...</span><span style=" font-size:8.25pt;"> (в Excel 2003):</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image32499.png" /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td></td>
<td></td>
<td></td>
<td></td></tr></thead></table>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Вложение</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Размер</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Загрузки</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Последняя загрузка</span></p></td></tr></thead>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ExcelVBA.ru/sites/default/files/NamesList.xls"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">NamesList.xls</span></a></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">41.5 КБ</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">72</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4 недели 8 часов назад</span></p></td></tr></table>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">19962 просмотра </li></ul></td>
<td></td></tr></table></body></html>