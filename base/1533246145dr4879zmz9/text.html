<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table id="tblPlaceArt" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td colspan="2" align="center"><span id="lbArtHeader" class="ArtHeader">Количество вхождений подстроки в строку (VBA)</span></td>
									</tr>
									<tr>
										<td colspan="2" align="center">
											<p>
												<span id="lbArtObr" class="ArtObr">(обращений: <b>1430</b> с 28.03.2016)</span><br>
												<br>
												<span id="lbIssueListH">Разделы:</span> 
												<span id="lbIssueList"><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=6">Строки</a>, <a href="http://am.rusimport.ru/MsAccess/content.aspx?id=20">Полезные функции</a></span></p>
											<p> </p>
										</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbBody"><p><span class="ArtPartHead">Описание: </span>Всё ясно из названия</p><p><span class="ArtPartHead">Автор: </span><a href="mailto:banderlogi@bk.ru">Дмитрий Сонных  (AKA Joss)</a>   </p><p><span class="ArtPartHead">Добавил на сайт: </span> <a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="1.png" width="16" border="0"></a><a href="mailto:banderlogi@bk.ru">Joss</a>  28.03.2016</p>В
 VBA нет стандартной функции определяющей количество вхождений подстроки
 в строку. По этому каждый извращается как может. Вот одно из решений 
когда-то найденное на просторах интернета <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">k = len(stroka) - len(replace(stroka, simvol, <font color="blue">""</font>))</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> с таким же успехом можно подсчитать количество вхождений подстроки:<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">k = (len(stroka) - len(replace(stroka, podstroka, <font color="blue">""</font>)))/len(podstroka)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Ну и оформим всё это в функцию <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Public</font> <font color="darkblue">Function</font> fnOccurrenceSubstring(Stroka <font color="darkblue">As</font> <font color="darkblue">String</font>, Podstroka <font color="darkblue">As</font> <font color="darkblue">String</font>)  <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">If</font> Len(Stroka) = 0 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    fnOccurrenceSubstring = -1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Exit</font> <font color="darkblue">Function</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">If</font> Len(bPodstroka) = 0 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    fnOccurrenceSubstring = -1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Exit</font> <font color="darkblue">Function</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">If</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">fnOccurrenceSubstring = (Len(Stroka) - Len(Replace(Stroka, Podstroka, <font color="blue">""</font>))) / Len(Podstroka)</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p><a href="javascript:history.back(1)">[Back]</a></p><br></span>
											</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											
<table class="Rating" id="tblPlace" width="100%" cellspacing="0" cellpadding="0" border="0">
	<tbody><tr>
		<td style="WIDTH: 30%" valign="top"><span id="Rating1_lbBar">Текущий рейтинг:<br>0 из 5 (проголосовало:0).<br><img src="2.png"></span></td>
		<td valign="top">
			<table id="Rating1_pnlLogin" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<span id="Rating1_lbNoUser">Здравствуйте!<br>Для участия в рейтинге необходимо залогиниться на сайт.<br>Это
 сделано для того, чтобы более точно производить оценку статей (чтобы 
одному и тому же человеку было труднее голосовать несколько раз, портя 
тем самым статистику.<br>
Эта процедура очень быстрая и, надеюсь, Вас не затруднит :).<br>
Все мысли по поводу работы сайта всегда можно высказать на <a href="http://am.rusimport.ru/MsAccess/f.aspx?type=2">форуме</a>!<br>
</span>
				<a id="Rating1_lnkLogin" href="http://am.rusimport.ru/MsAccess/login.aspx?ReturnURL=topic.aspx?id=795">Вход на сайт</a>
			
	</td></tr></tbody></table>
			</td>
	</tr>
</tbody></table>
</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbComment"><br><table class="ArtCommentHead" width="100%"><tbody><tr><td><a name="comments" class="ArtCommentHead">Обсуждение статьи:</a>  <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=0&amp;topic=795" target="blank"><img src="3.png" title="Добавить комментарий" width="16" border="0"></a> <a href="javascript:Subscribe(-2,795)"><img src="4.png" title="Подписаться на комментарии к этой теме" <="" a="" width="16" border="0"></a></td></tr></tbody></table></span></td>
									</tr>
									<tr>
										<td colspan="2" align="left"></td>
									</tr>
								</tbody></table>
							

<table id="Table1" width="100%" cellspacing="0" cellpadding="0" bordercolor="#CACACA" border="1">
	<tbody><tr>
		<td>
			<table id="_ctl0_pnlHead" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<table id="tblHead" width="100%" cellspacing="0" cellpadding="0" bordercolor="#000000" border="0">
					<tbody><tr bgcolor="#CACACA">
						<td style="WIDTH: 70%"><a name="67762"></a><a class="ml" href="http://am.rusimport.ru/MsAccess/topic.aspx?id=795"><img src="5.png" width="16" height="16" border="0">Число вхождений подстроки (символа) в текст</a></td>
						<td align="right"><a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="6.png" width="16" border="0"></a><a class="" href="mailto:banderlogi@bk.ru">Joss</a></td>
						<td style="WIDTH: 15%" align="right"><a href="javascript:MarkAsUnread(67762)"><img src="7.png" title="Пометить сообщение как непрочитанное" width="16" border="0"></a> <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=67762&amp;topic=795" target="blank"><img src="8.png" title="Ответить" width="16" border="0"></a> </td>
					</tr>
				</tbody></table>
			
	</td></tr></tbody></table>
		</td>
	</tr>
	<tr bgcolor="#eeeeee">
		<td>Вот ещё один пример из интернета<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> КолСимв(строка <font color="darkblue">As</font> <font color="darkblue">String</font>, символ <font color="darkblue">As</font> <font color="darkblue">String</font>) <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> TestPos <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">КолСимв = 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">TestPos = 1</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Do</font> <font color="darkblue">While</font> <font color="darkblue">InStr</font>(TestPos, строка, символ) &gt; 0</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   КолСимв = КолСимв + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   TestPos = <font color="darkblue">InStr</font>(TestPos, строка, символ) + Len(символ)</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Loop</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></td>
	</tr>
	
	<tr bgcolor="#eeeeee">
		<td><font size="1">26.03.2016 21:30</font></td>
	</tr>
</tbody></table>
<br>


<table id="Table1" width="100%" cellspacing="0" cellpadding="0" bordercolor="#CACACA" border="1">
	<tbody><tr>
		<td>
			<table id="_ctl1_pnlHead" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<table id="tblHead" width="100%" cellspacing="0" cellpadding="0" bordercolor="#000000" border="0">
					<tbody><tr bgcolor="#CACACA">
						<td style="WIDTH: 70%"><a name="67763"></a><a class="ml" href="http://am.rusimport.ru/MsAccess/topic.aspx?id=795"><img src="5.png" width="16" height="16" border="0">Взято с сайта http://www.programmersforum.ru</a></td>
						<td align="right"><a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="6.png" width="16" border="0"></a><a class="" href="mailto:banderlogi@bk.ru">Joss</a></td>
						<td style="WIDTH: 15%" align="right"><a href="javascript:MarkAsUnread(67763)"><img src="7.png" title="Пометить сообщение как непрочитанное" width="16" border="0"></a> <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=67763&amp;topic=795" target="blank"><img src="8.png" title="Ответить" width="16" border="0"></a> </td>
					</tr>
				</tbody></table>
			
	</td></tr></tbody></table>
		</td>
	</tr>
	<tr bgcolor="#eeeeee">
		<td>Решить данную задачу можно кучей способов... Вот так<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> s1 <font color="darkblue">As</font> <font color="darkblue">String</font>, s2 <font color="darkblue">As</font> <font color="darkblue">String</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> Cnt <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">s1 = <font color="blue">"es"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">s2 = <font color="blue">"vest is best forest"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Cnt = 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">While</font> <font color="darkblue">InStr</font>(1, s2, s1) &gt; 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Cnt = Cnt + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> s2 = <font color="darkblue">Mid</font>(s2, <font color="darkblue">InStr</font>(1, s2, s1) + Len(s1))</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Wend</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">MsgBox <font color="blue">"Count = "</font> &amp; Str(Cnt)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> или так <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> s1 <font color="darkblue">As</font> <font color="darkblue">String</font>, s2 <font color="darkblue">As</font> <font color="darkblue">String</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> PrevPos <font color="darkblue">As</font> <font color="darkblue">Integer</font>, Cnt <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">s1 = <font color="blue">"es"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">s2 = <font color="blue">"vest is best forest"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">PrevPos = 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Cnt = 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">While</font> <font color="darkblue">InStr</font>(PrevPos, s2, s1) &gt; 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Cnt = Cnt + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> PrevPos = <font color="darkblue">InStr</font>(PrevPos, s2, s1) + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Wend</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">MsgBox <font color="blue">"Count = "</font> &amp; Str(Cnt)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> и вот так <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> s1 <font color="darkblue">As</font> <font color="darkblue">String</font>, s2 <font color="darkblue">As</font> <font color="darkblue">String</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> i <font color="darkblue">As</font> <font color="darkblue">Integer</font>, Cnt <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> s1 = <font color="blue">"es"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> s2 = <font color="blue">"vest is best forest"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> i = 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Cnt = 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <font color="darkblue">For</font> i = 1 <font color="darkblue">To</font> Len(s2) - Len(s1) + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   <font color="darkblue">If</font> <font color="darkblue">Mid</font>(s2, i, Len(s1)) = s1 <font color="darkblue">Then</font> Cnt = Cnt + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <font color="darkblue">Next</font> i</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> MsgBox <font color="blue">"Count = "</font> &amp; Str(Cnt)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>Ещё один вариант - правда, красиво!<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Dim</font> s1 <font color="darkblue">As</font> <font color="darkblue">String</font>, s2 <font color="darkblue">As</font> <font color="darkblue">String</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> s1 = <font color="blue">"es"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> s2 = <font color="blue">"vest is best forest"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> MsgBox <font color="blue">"Count = "</font> &amp; UBound(Split(s2, s1))</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><br></td>
	</tr>
	
	<tr bgcolor="#eeeeee">
		<td><font size="1">26.03.2016 21:55</font></td></tr></tbody></table>
</body>
</html></p></body></html>