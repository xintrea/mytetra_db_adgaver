<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В статье &quot;<a href="http://www.programm-school.ru/data_type_v_vba.html"><span style=" text-decoration: underline; color:#0000ff;">Типы данных в Visual Basic (VBA)</span></a>&quot; мы познакомились с основными простейшими типами в VBA. Но средства VBA нам позволяют создавать свои составные (пользовательские) типы данных, основанные на простейших типах. Для чего это нужно? Например, нам необходимо описать некоторые объекты по следующим параметрам: Длина, Ширина, Глубина, Цвет, Материал и т.д. Это можно сделать двумя способами:<br />1 - На каждый параметр создать переменную определенного типа<br />2 - Создать свой пользовательский (составной) тип, содержащий все эти параметры и описать переменную этого типа.<br />Пока не совсем понятно, что я имел ввиду. Сейчас на примере разберем.</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Что нам дает описание собственного типа?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Удобство! В одной переменной вы можете передать множество параметров разного типа. Такой подход значительно упростит код и сделает его легко-читаемым, да и с объектами легче работать.</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Как описать свой тип данных в VBA?</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В VBA для описания своего типа предусмотрена конструкция:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">[<span style=" font-weight:600;">Private</span> | <span style=" font-weight:600;">Public</span>] <span style=" font-weight:600;">Type</span> <span style=" font-style:italic;">НазваниеТипа</span><br /><span style=" font-style:italic;">Элемент1</span> <span style=" font-weight:600;">As</span> <span style=" font-style:italic;">Тип</span><br /><span style=" font-style:italic;">Элемент2</span> <span style=" font-weight:600;">As</span> <span style=" font-style:italic;">Тип<br />....</span><br /><span style=" font-weight:600;">End Type</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">где<span style=" font-weight:600;">:<br />Prvate/Public - </span>определяет область видимости нашего типа (private - виден только в текущем модуле, public - виден во всех модулях)<br /><span style=" font-weight:600;">Type</span> - ключевое слово, указывающее на описание нового типа &quot;<span style=" font-style:italic;">НазваниеТипа</span>&quot;<br /><span style=" font-style:italic;">Элемент1,2...n - </span>собственно поля простых типов<br /><span style=" font-weight:600;">End Type - </span>конец описания типа.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На примере рассмотрим описание вышеупомянутого составного типа, который содержит несколько элементов описывающих объект.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Описать тип можно в любом модуле, но если таких составных типов в проекте будет не один 10-ок, то для простоты рекомендую выносить их описание в отдельный модуль. Итак, создадим наш тип MyObject с элементами:<br />Длина, Ширина, Глубина - типа Single<br />Цвет, Материал - типа String.</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0" bgcolor="#e4f9fd">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Option Explicit</span><br /><span style=" font-weight:600;">Public Type </span>MyObject<br />  dl as single<br />   sh as single<br />   gl as single<br />   cvet as string<br />   mat as string<br /><span style=" font-weight:600;">End Type</span><br /><br /><span style=" font-weight:600;">Sub</span> TestMyType ()<br /><span style=" font-weight:600;">dim</span> obj <span style=" font-weight:600;">as</span> MyObject<br />obj.dl = 35.5<br />obj.sh = 15<br />obj.gl=3<br />obj.cvet = &quot;Черный&quot;<br />obj.mat = &quot;Резина&quot;<br /><br />' для более удобного обращения к полям объекта obj<br />'воспользуемся конструкцией with ... end with<br /><span style=" font-weight:600;">with</span> obj<br />  <span style=" font-weight:600;">msgbox</span> &quot;Параметры объекта:&quot; &amp; chr(13) &amp; &quot;Длина - &quot;&amp; .dl &amp; chr(13) _<br />           &amp; &quot;Ширина - &quot;&amp; .sh &amp; chr(13) &amp; &quot;Глубина - &quot; &amp; .gl &amp; chr(13) _<br />           &amp; &quot;Цвет - &quot; &amp; .cvet &amp; chr(13) &amp; &quot;Материал - &quot; &amp; .mat<br /><span style=" font-weight:600;">end with</span><br /><br /><span style=" font-weight:600;">end sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Обратите внимание что когда Вы ставите точку после названия переменной obj у вас выпадает список всех доступных полей.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вы можете так же составлять новые типы из созданных уже ранее типов т.е.</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0" bgcolor="#e4f9fd">
<tr>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Type</span> MyObject<br />  dl <span style=" font-weight:600;">as</span> single<br />   sh <span style=" font-weight:600;">as</span> single<br />   gl <span style=" font-weight:600;">as</span> single<br />   cvet <span style=" font-weight:600;">as</span> string<br />   mat <span style=" font-weight:600;">as</span> string<br /><span style=" font-weight:600;">End Type</span><br /><br /><span style=" font-weight:600;">Public Type</span> MyType<br />  ID <span style=" font-weight:600;">as</span> long<br />  Myobj <span style=" font-weight:600;">as</span> MyObject<br />' .... <br /><span style=" font-weight:600;">End Type</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обращаться к полю<span style=" font-weight:600;"> MyType.MyObject.pole1</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На этом все! До скорого...</p></body></html>