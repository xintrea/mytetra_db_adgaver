<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#3774a4;">Подключение к базе данных через ADODB (статья) - VB</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<p style=" margin-top:10px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">09.02.2013, 11:22. </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Просмотров</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 6926. </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Ответов</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://www.cyberforum.ru/threadposts943586.html"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">0</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<p style=" margin-top:5px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Метки</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; background-color:#fffacd;">Укажите метки</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  (</span><a href="http://www.cyberforum.ru/tags/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Все метки</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">)			</span></p>
<hr />
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><a name="post_message_4111728"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">					</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#0000ff;">Подключение к базе данных через ADODB.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Sub OpenDB()</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Set conn = Nothing</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Set conn = New ADODB.Connection</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    conn.ConnectionString = &quot;Driver={Microsoft Access Driver (*.mdb, *.accdb)};&quot; &amp; _</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    &quot;Dbq=D:\Public\Documents\Temp\data_ref_User.accdb;Uid=Admin;Pwd=;&quot;</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    conn.Open</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    </span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Set rs = Nothing</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Set rs = New ADODB.Recordset</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Sql = &quot;SELECT * From ListRefBlock&quot;&quot;&quot;</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    rs.Open Sql, conn, 3, 3</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    aTemp = rs.GetRows</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    If conn.State = 1 Then</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">        MsgBox &quot;Соединение установлено&quot;</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    Else</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">        MsgBox &quot;Соединение не установлено&quot;</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">    End If</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">End Sub</span></p>
<p style=" margin-top:2px; margin-bottom:2px; margin-left:5px; margin-right:2px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Предположим, что у нас есть база данных которую мы создали в Microsoft Access версии 2010 или 2003 или более ранних, значения не имеет. В базе данных имеется 1 (одна) таблица с именем </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Клиенты&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Структура таблицы в базе данных следующая:<br /><br /></span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:5px; margin-right:2px;" cellspacing="1" cellpadding="5">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Код</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Фамилия</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Имя</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Отчество</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Дата рождения</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Где:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">1.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Код - имеет тип данных: Счетчик </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">(размер поля длинное целое)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">2.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Фамилия - имеет тип данных: Текстовый </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">(размер поля 50 символов)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">3.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Имя - имеет тип данных: Текстовый </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">(размер поля 50 символов)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">4.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Отчество - имеет тип данных: Текстовый </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">(размер поля 50 символов)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">5.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Дата рождения - имеет тип данных: Дата/время </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#ff0000;">(формат поля краткий формат даты)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br />Созданную базу данных для удобства поместим в каталог с нашей программой. Назовем ее к примеру </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;DataBase&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Теперь создадим новый проект на </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Visual Basic 6.0</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, сохраним его в каталог с программой. В проекте создадим 1 (одну) форму и 1 (один) модуль. Имя формы оставим по умолчанию </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Form1&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, имя модуля тоже оставим по умолчанию </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Module1&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Следующим шагом, подключим библиотеку под названием </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Microsoft ActiveX Data Objects 2.8 Library&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Подключение выполняем нажав на меню </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Project&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ---&gt; </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;References&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> в открывшемся окне находим </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Microsoft ActiveX Data Objects 2.8 Library&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ставим галочку рядом с названием нажимаем на кнопку &quot;OK&quot;.<br /><br />Следующим шагом будет объявление переменных для </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">ADODB.Connection</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">ADODB.Recordset</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Откроем наш созданный модуль </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Module1&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и в самый верх модуля, вставим следующие строки кода:<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Visual Basic</span><a href="http://www.cyberforum.ru/#"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1" style=" padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="613951568"></a><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">2</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Public conn As New ADODB.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Public rs As New ADODB.Recordset</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#696969;">Получается следующие, что переменная </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#696969;">conn</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#696969;"> - </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#696969;">ADODB.Connection</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#696969;"> будет отвечать за соединение с базой данных и выполнения команд поступающих от программы к базе данных в виде SQL запроса. Переменная </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#696969;">rs</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#696969;"> - </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#696969;">ADODB.Recordset</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#696969;"> является набором записей, она будет содержать в себе набор записей которая вернет база данных при выполнении того или иного запроса во время работы программы.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">После объявления переменных спустимся ниже на пару строк и вставим следующие строки кода:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Visual Basic</span><a href="http://www.cyberforum.ru/#"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1" style=" padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="847937971"></a><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">4</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Sub Main()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    OpenDB</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    Form1.Show</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Наша программа будет начинать работу с процедуры </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Sub Main&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. То есть нам надо вернуться в настройки программы, а именно сюда: на панели меню проекта выберите </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Project&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ---&gt; </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Project1 Properties&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> в открывшемся окне на вкладке </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;General&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> выберем из списка </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Startup Object&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ---&gt; </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Sub Main&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, нажмем кнопку &quot;ОК&quot;. В созданном коде получается следующие:<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">1.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> При запуске программы, происходит обращение к процедуре под именем </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;OpenDB&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. <br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">2.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Открывается Form1, созданная нами ранее.<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Теперь спустимся еще на пару строк ниже и вставим код процедуры &quot;OpenDB&quot;.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Visual Basic</span><a href="http://www.cyberforum.ru/#"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1" style=" padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="671049354"></a><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">11</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Sub OpenDB()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Set conn = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Set conn = New ADODB.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    conn = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\Documents and Settings\User\Рабочий стол\DataBase\Database.accdb;Uid=Admin;Pwd=;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    conn.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Open</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">If conn.State = 1 Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;Соединение установлено&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;Соединение не установлено&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Тут переменная </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;conn&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> получает строку соединения: <br /><br /></span></p>
<p style=" margin-top:5px; margin-bottom:20px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Код	</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px;"><a name="749709233"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\Documents and Settings\User\Рабочий стол\DataBase\Database.accdb;Uid=Admin;Pwd=;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">далее выполняется соединение. Если соединение установлено, тогда параметр conn.State получает свойство = 1, по созданному условию мы предупреждаем пользователя о выполненном с базой данных:<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Visual Basic</span><a href="http://www.cyberforum.ru/#"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1" style=" padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="88863838"></a><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">5</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">If conn.State = 1 Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;Соединение установлено&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;Соединение не установлено&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">После чего по коду выше открывается Form1. В форме, вставляем следующий код:<br /><br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:5px; margin-bottom:5px; margin-left:35px; margin-right:12px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:35px; margin-right:12px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Visual Basic</span><a href="http://www.cyberforum.ru/#"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#606060;">Выделить код</span></a></p></td></tr></thead>
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1" style=" padding-left:5; padding-right:10; padding-top:0; padding-bottom:0;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><a name="656111504"></a><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">11</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Private Sub Form_Load()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Call UpdateConnect</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Sub UpdateConnect()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Set rs = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Set rs = New ADODB.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    SQL = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">&quot;SELECT * From Клиенты&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    rs.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Open SQL, conn, 3, 3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">Set DataGrid1.DataSource = rs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></td>
<td></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">При открытии формы происходит обращение в процедуру: </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Call UpdateConnect&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> в которой создается SQL запрос к базе данных, после чего созданная переменная rs - ADODB.Recordset получает набор записей который возвращает база данных после выполнения SQL запроса. DataGrid1.DataSource = rs отображаем набор записей в DataGrid на форме. Для отображения записей на форме записей в DataGrid необходимо данный компонент добавить на форму, для этого сделаем следующие: нам надо вернуться в настройки программы, а именно сюда: на панели меню проекта выберите </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Project&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ---&gt; </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Components&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, в списке найдите </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">&quot;Microsoft DataGrid Control 6.0 (SP6) (OLEDB)&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ставим галочку рядом с названием нажимаем на кнопку &quot;OK&quot;. На панели инструментов появится объект в форме сетки, выберите его и нарисуйте его на форме по нужным вам размерам. Теперь попробуйте запустите проект, если все сделали правильно вы увидите отображенные записи в </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">DataGrid</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> на форме. На всякий случай выкладываю исходник проекта. <br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Всем удачи!</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Я конечно не мастер написания статей, сильно не ругайте!</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">					</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">																					Вложения					</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="3" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="1.png" width="16" height="16" /><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.cyberforum.ru/attachments/233294d1360394507"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">DataBase.rar</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (18.4 Кб, 827 просмотров)</span></p></td></tr></table></body></html>