<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перебрать записи в таблице можно так:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Sub SOZD()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim RS As Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim R</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Set RS = CurrentDb.TableDefs(&quot;Titles&quot;).OpenRecordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveLast</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveFirst</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">For R = 1 To RS.RecordCount</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Debug.Print RS(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveNext</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic; color:#808080;">Добавлено через 23 секунды</span><br />Отбирай по условию<br /><br /><span style=" font-style:italic; color:#808080;">Добавлено через 8 минут</span><br />А вот создать таблицу...</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Программное создание таблицы и ее полей в MS Access 2003 <br /><br />Задача: создать в базе данных MS Acces 2003 таблицу, в таблице ключевое поле типа счетчик, поля с разными типами данных<br /><br />Способ решения:<br /><br /><br /><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Sub СоздатьТаблицу()<br />Dim db As Database ' бд, в которой будет создаваться таблица<br />Dim Tbl As TableDef ' создаваемая таблица<br /><br />Dim Fld1 As Field ' добавляемое поле<br />Dim Fld2 As Field<br />Dim Fld3 As Field<br />Dim Fld4 As Field<br />Dim Fld5 As Field<br />Dim Fld6 As Field<br />Dim Fld7 As Field<br />Dim Fld8 As Field<br />Dim Fld9 As Field<br />Dim Fld10 As Field<br />Dim Fld11 As Field<br />Dim Fld12 As Field<br />Dim Fld15 As Field<br />Dim Fld16 As Field<br /><br /><br />Dim Indx As Index ' индекс таблицы<br />Dim IndxFld As Field ' поле индекса таблицы<br /><br />' определяю бд, в которой создаю таблицу<br />Set db = CurrentDb<br />' создаю таблицу<br />Set Tbl = db.CreateTableDef(&quot;Таблица&quot;)<br />' ========================================<br />' создаю ключевое поле<br />Set Fld1 = Tbl.CreateField(&quot;КлючевоеПоле&quot;, dbLong)<br />' делаю поле счетчиком<br />Fld1.Attributes = Fld1.Attributes + dbAutoIncrField<br />' добавляю поле в таблицу<br />Tbl.Fields.Append Fld1<br />' создаю индекс по полю &quot;КлючевоеПоле&quot;<br />Set Indx = Tbl.CreateIndex(&quot;Ключевое поле&quot;)<br />Set IndxFld = Indx.CreateField(&quot;КлючевоеПоле&quot;, dbLong)<br />' добавляю индекс<br />Indx.Fields.Append IndxFld<br />' делаю первичным ключем<br />Indx.Primary = True<br />' добавляю индекс<br />Tbl.Indexes.Append Indx<br /><br />' ========================================<br />' создаю поле. тип данных -- логический<br />Set Fld2 = Tbl.CreateField(&quot;Поле1&quot;, 1)<br />Tbl.Fields.Append Fld2<br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (байт)<br />Set Fld2 = Tbl.CreateField(&quot;Поле2&quot;, 2)<br />Tbl.Fields.Append Fld2<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (целое)<br />Set Fld3 = Tbl.CreateField(&quot;Поле3&quot;, 3)<br />Tbl.Fields.Append Fld3<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой(длинное целое)<br />Set Fld4 = Tbl.CreateField(&quot;Поле4&quot;, 4)<br />Tbl.Fields.Append Fld4<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- денежный<br />Set Fld5 = Tbl.CreateField(&quot;Поле5&quot;, 5)<br />Tbl.Fields.Append Fld5<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (Одинарное с плавающей точкой)<br />Set Fld6 = Tbl.CreateField(&quot;Поле6&quot;, 6)<br />Tbl.Fields.Append Fld6<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (Двойное с плавающей точкой)<br />Set Fld7 = Tbl.CreateField(&quot;Поле7&quot;, 7)<br />Tbl.Fields.Append Fld7<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- дата/время<br />Set Fld8 = Tbl.CreateField(&quot;Поле8&quot;, 8)<br />Tbl.Fields.Append Fld8<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- двоичный<br />Set Fld9 = Tbl.CreateField(&quot;Поле9&quot;, 9)<br />Tbl.Fields.Append Fld9<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- текстовый (150 символов)<br />Set Fld10 = Tbl.CreateField(&quot;Поле10&quot;, 10, 150)<br />Tbl.Fields.Append Fld10<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- поле объекта<br />Set Fld11 = Tbl.CreateField(&quot;Поле11&quot;, 11)<br />Tbl.Fields.Append Fld11<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- поле МЕМО<br />Set Fld12 = Tbl.CreateField(&quot;Поле12&quot;, 12)<br />Tbl.Fields.Append Fld12<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (код репликации)<br />Set Fld15 = Tbl.CreateField(&quot;Поле15&quot;, 15)<br />Tbl.Fields.Append Fld15<br /><br /><br />' ========================================<br />' создаю поле. тип данных -- числовой (действительное)<br />Set Fld16 = Tbl.CreateField(&quot;Поле16&quot;, 16)<br />Tbl.Fields.Append Fld16<br /><br /><br /><br />' добавляю таблицу<br />db.TableDefs.Append Tbl<br />' обновляю данные о таблицах<br />db.TableDefs.Refresh<br /><br /><br />Set db = Nothing<br />End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; font-size:9pt; color:#6a1009;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; font-size:9pt; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Sub SOZD()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim TB As TableDef</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim TB0 As TableDef</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim myF As Field</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim RS As Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim RSn As Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim R, c</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim N, A</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Dim Q As Field</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Set TB = CurrentDb.CreateTableDef(&quot;NEV_t&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">For R = 0 To CurrentDb.TableDefs(&quot;Titles&quot;).Fields.Count - 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">N = CurrentDb.TableDefs(&quot;Titles&quot;).Fields(R).Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">A = CurrentDb.TableDefs(&quot;Titles&quot;).Fields(R).Attributes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Set Q = CurrentDb.TableDefs(&quot;Titles&quot;).Fields(R)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Select Case R</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Case 1 ' числовой (целое)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set myF = TB.CreateField(N, 3): TB.Fields.Append myF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Case 3 'числовой(длинное целое)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set myF = TB.CreateField(N, 4): TB.Fields.Append myF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Case 7 ' поле МЕМО</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set myF = TB.CreateField(N, 12): TB.Fields.Append myF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Case Else ' текстовый (150 символов)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set myF = TB.CreateField(N, 10, 150): TB.Fields.Append myF</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">End Select</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">CurrentDb.TableDefs.Append TB</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">CurrentDb.TableDefs.Refresh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Set RS = CurrentDb.TableDefs(&quot;Titles&quot;).OpenRecordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveLast</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveFirst</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">For R = 1 To RS.RecordCount</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">If RS(1) = 1994 Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set RSn = CurrentDb.OpenRecordset(&quot;NEV_t&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    RSn.AddNew</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        For c = 0 To CurrentDb.TableDefs(&quot;Titles&quot;).Fields.Count - 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">            RSn(c) = RS(c)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    RSn.Update</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">RS.MoveNext</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; font-size:9pt; color:#6a1009;"><br /></p></body></html>