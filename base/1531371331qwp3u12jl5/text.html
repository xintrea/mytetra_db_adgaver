<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<p style="font:large;margin-bottom :20px;font-family:Arial;">
                05. В этом примере, используя запросы SQL можно создать или удалить индекс
                </p>
                
                

<table id="table01" width="100%" cellspacing="0" cellpadding="0" border="0">
  <tbody>
  <tr>
    <td valign="top" align="left">
		<table style="background-color: #99CC99" width="100%" cellspacing="1" cellpadding="5" border="0" bgcolor="#89bbcb">
						<tbody><tr bgcolor="#ffffff">
										<td>
										<span class="product_header">
										<a href="http://www.leadersoft.ru/Rus/Market/db/Default.aspx?go=product&amp;pid=60">
										Все примеры Microsoft Access</a></span></td>
						</tr>
						<tr bgcolor="#ffffff">
										<td>
										<font size="-1" face="Courier New"><font color="#0000aa">Private Sub </font>butExecute_Click()<br>
<font color="#0000aa">Dim </font>dbs <font color="#0000aa">As </font>Database<br>
    <font color="#0000aa">On Error GoTo </font>999<br>
    <font color="#0000aa">Set </font>dbs = CurrentDb<br>
    <font color="#007700">'Удаляем таблицу</font><br>
    dbs.Execute <font color="#660000">"DROP TABLE [Пример 05]"</font><br>
    <br>
    <font color="#007700">'Создаем таблицу с индексом</font><br>
    dbs.Execute <font color="#660000">"CREATE TABLE [Пример 05] "</font> _<br>
        &amp; <font color="#660000">"(Номер INTEGER CONSTRAINT Ключ1 PRIMARY KEY, "</font> _<br>
        &amp; <font color="#660000">"Книга CHAR(15), Описание CHAR, Сумма MONEY, Дата DATE);"</font><br>
    <br>
    <font color="#007700">'Сообщение</font><br>
    MsgBox <font color="#660000">"Таблица создана!"</font>, vbInformation, <font color="#660000">"Индексы"</font><br>
    <font color="#0000aa">Exit Sub</font><br>
999:<br>
    MsgBox Err.Description, vbCritical, <font color="#660000">"Создание поля"</font><br>
    Err.Clear<br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'   Удаление индекса</font><br>
<font color="#0000aa">Private Sub </font>butDelete_Click()<br>
<font color="#0000aa">Dim </font>dbs <font color="#0000aa">As </font>Database<br>
    <font color="#0000aa">On Error GoTo </font>999<br>
    <font color="#0000aa">Set </font>dbs = CurrentDb<br>
    <font color="#007700">'Удаляем индекс</font><br>
    dbs.Execute <font color="#660000">"DROP INDEX Ключ1 ON [Пример 05] "</font><br>
    <font color="#007700">'Сообщение</font><br>
    MsgBox <font color="#660000">"Индекс Ключ1 удален!"</font>, vbInformation, <font color="#660000">"Индексы"</font><br>
    <font color="#0000aa">Exit Sub</font><br>
999:<br>
    MsgBox Err.Description, vbCritical, <font color="#660000">"Создание индекса"</font><br>
    Err.Clear<br>
<font color="#0000aa">End Sub</font></font></td></tr></tbody></table></td></tr></tbody></table>
</body>
</html></p></body></html>