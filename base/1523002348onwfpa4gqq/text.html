<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://opennotes.ru/knowledge/vba-knowledge/avtomaticheskaya-otpravka-pisma-cherez-excel/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">Автоматическая отправка письма через Excel</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">								</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Если после выполнения макроса необходимо отправить в качестве вложения получившийся документ Excel, можно использовать следующий код. Он создаёт письмо с нужным перечнем адресатов в полях «Кому» и «Копия», с указанной темой, текстом и прикреплённым Excel файлом. Остаётся толкьо дописать письмо в случае необходимости и нажать кнопку «Отправить».</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#f660ab;">Object</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, SM </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#f660ab;">Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#e56717;">CreateObject</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Outlook.Application&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> SM = OutlookApp.CreateItem(olMailItem)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'SM.SentOnBehalfOfName = &quot;mail@example.ru&quot; 'Поле &quot;От&quot;, если нужен другой отправитель</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;mail@example.ru&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Поле &quot;Кому&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.CC = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;mail@example.ru&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Поле &quot;Копия&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Subject = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Тема письма&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Body = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Текст письма&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Attachments.Add (</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;C:\Test.xls&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Адрес вложения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Display</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> SM = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#00c2ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#00c2ff;">Nothing</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="more-217"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Е</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">сли же нужно отправить письмо в фоновом режиме, без отображения и необходимости самостоятельно нажимать кнопку «Отправить», то вместо </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">SM.Display</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> нужно вставить следующий код:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Send</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> OutlookApp.Quit</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Чтобы вместо простого текста в теле письма было отформатированное содержимое можно воспользоваться вместо </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">SM.Body</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> следующее:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.HTMLBody =  </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&amp;lt;div&amp;gt;&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Text &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;&amp;lt;/div&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Чтобы создать письмо с подписью, которая ставится по умолчанию, можно прибегнуть к следующему коду:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#e56717;">Sub</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cbSendMail_Click(FileName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> Application.DisplayAlerts = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#00c2ff;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> FullFilePath = ThisWorkbook.Path &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;\&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; FileName &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;.xlsx&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#f660ab;">Object</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, SM </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#f660ab;">Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#e56717;">CreateObject</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Outlook.Application&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> SM = OutlookApp.CreateItem(olMailItem)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;mail@example.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.CC = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;mail@example.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Subject = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Название темы&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; FileName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'в этом случае открывается письмо </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'с подписью той которая по умолчанию в Outlooke</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Body = Activedocument.Content</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.HTMLBody = Activedocument.Content.Text</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Dir(FullFilePath) &lt;&gt; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Attachments.Add (FullFilePath) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Адрес вложения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Файл для вложения не найден: &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Chr(13) &amp; FullFilePath</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.Display</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> SM.HTMLBody = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Добрый день!&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; SM.HTMLBody</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> SM = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#00c2ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> OutlookApp = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#00c2ff;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#e56717;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Ещё по теме</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Источник:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://programmersforum.ru/showthread.php?t=65272&amp;page=8"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Клуб ПРОграммистов</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> — </span><a href="http://programmersforum.ru/showpost.php?p=908658&amp;postcount=78"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Отправка почты макросом Excel</span></a></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.planetaexcel.ru/tip.php?aid=156"><span style=" text-decoration: underline; color:#0000ff;">Отправка книги или листа по email</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Форум программистов и сисадминов — <a href="http://www.cyberforum.ru/vba/thread14780.html"><span style=" text-decoration: underline; color:#0000ff;">Автоматическая отправка E-mail с Excel или с Access</span></a></li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.sql.ru/forum/actualthread.aspx?tid=82407"><span style=" text-decoration: underline; color:#0000ff;">Как из VBA открыть Outlook Item, лежащий отдельно в виде .msg файла</span></a></li></ul></body></html>