<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Элемент управления ToggleButton</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image20302.png" /><span style=" font-size:8.25pt;"> июля 31, 2015 </span><img src="image4844.png" /><span style=" font-size:8.25pt;"> admin </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600; font-style:italic;">ToggleButton</span><span style=" font-size:8.25pt;"> выглядит как кнопка,  которая при нажатии становится “нажатой”, а при повторном нажатии отключается.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image5168.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Рис 1.1 Элемент управления ToggleButton на панели ToolBox</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image5238.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Рис. 1.2 Элемент управления  ToggleButton на форме</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton похож на кнопку, но выполняет такие же функции, что и </span><a href="http://msexcel-vba.ru/%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82-%d1%83%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-checkbox/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">CheckBox</span></a><span style=" font-size:8.25pt;">: вы нажимаете на кнопку, и она фиксируется в нажатом положении</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">У компонента vba ToggleButton те же свойства, что и у CheckBox, рассмотрим основные:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Name</span><span style=" font-size:8.25pt;"> – как всегда, имя объекта заданного класса.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Caption</span><span style=" font-size:8.25pt;"> – надпись, которая будет прописана на поверхности ToggleButton</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">TripleState</span><span style=" font-size:8.25pt;"> – свойство может содержать значение false или true. При значении false – объект будет поддерживать два состоянии, при true – три состояния.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Value</span><span style=" font-size:8.25pt;"> – содержит состояние объекта: true – кнопка нажата, false – не нажата, null – кнопка серого цвета (третье состояние).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Рассмотрим пример:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Добавляем в проект новую форму (меню </span><span style=" font-size:8.25pt; font-weight:600;">Insert/UserForm</span><span style=" font-size:8.25pt;">) и новый модуль (меню </span><span style=" font-size:8.25pt; font-weight:600;">Insert/Module</span><span style=" font-size:8.25pt;">). В редакторе кода для модуля пишем:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> TBModule()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">TBForm.Show</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Тут </span><span style=" font-size:8.25pt; font-weight:600;">TBModule</span><span style=" font-size:8.25pt;"> – имя модуля, а </span><span style=" font-size:8.25pt; font-weight:600;">TBForm</span><span style=" font-size:8.25pt;"> – название формы.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image3616.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Теперь нужно добавить процедуры для формы. Просто в окне проекта выбираете форму и жмете на кнопку </span><span style=" font-size:8.25pt; font-weight:600;">View Code</span><span style=" font-size:8.25pt;"> и добавляете следующий код:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton1_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton1.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton1.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton1.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton2_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton2.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton2.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">oggleButton2.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton3_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton3.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton3.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton3.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton4_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton4.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton4.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton4.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton5_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton5.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton5.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton5.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> ToggleButton6_Change()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">If</span><span style=" font-size:8.25pt;"> ToggleButton6.Value = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Then</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ListBox1.AddItem ToggleButton6.Caption</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton6.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">False</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Private</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span><span style=" font-size:8.25pt;"> CommandButton1_Click()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">ToggleButton1.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ToggleButton2.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ToggleButton3.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ToggleButton4.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ToggleButton5.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ToggleButton6.Enabled = </span><span style=" font-size:8.25pt; font-weight:600;">True</span><span style=" font-size:8.25pt;">     ListBox1.Clear</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">End</span><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt; font-weight:600;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">На форме находятся 6 объектов ToggleButton. Также на форме присутствует объект </span><a href="http://msexcel-vba.ru/%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82-%d1%83%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-listbox/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ListBox</span></a><span style=" font-size:8.25pt;"> и </span><a href="http://msexcel-vba.ru/%d1%8d%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d1%82-%d1%83%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d1%8f-commandbutton/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">CommandButton</span></a><span style=" font-size:8.25pt;">, при нажатии на выключатель происходит событие Change. Как только мы нажимаем на выключатель происходит проверка, если значение Value ровно true, то в список ListBox добавляется содержимое свойства Caption объекта ToggleButton vba языка и сам объект выключатель блокируется. Кнопка на форме служит для очистки списка и разблокирования выключателей.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p></body></html>