<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Проверка существования таблицы </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://msdn.microsoft.com/en-us/library/ms190328(SQL.90).aspx"><span style=" text-decoration: underline; color:#0000ff;">OBJECT_ID (Transact-SQL)</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; text-decoration: underline; color:#0000ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; text-decoration: underline; color:#0000ff;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<table border="0" style=" margin-top:10px; margin-bottom:10px; margin-left:10px; margin-right:10px;" cellspacing="0" cellpadding="4" bgcolor="#dddddd">
<tr>
<td bgcolor="#efefff" style=" vertical-align:top; padding-left:7; padding-right:7; padding-top:7; padding-bottom:7;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,Arial'; background-color:#efefff;">Подскажите пожалуйста как проверить существует ли определённая таблица и если её нет, то создать её</span></p></td></tr></table>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#0000ff;">IF</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#ff00ff;">OBJECT_ID</span><span style=" font-family:'Courier New,courier';">(N</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'ИмяТаблицы'</span><span style=" font-family:'Courier New,courier';">,</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'U'</span><span style=" font-family:'Courier New,courier';">) </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">IS</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#777777;">NULL</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">PRINT</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'Таблицы [ИмяТаблицы] не существует!'</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#0000ff;">ELSE</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">PRINT</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'Есть таблица [ИмяТаблицы].'</span><span style=" font-family:'Courier New,courier';">;</span> </pre></td>
<td></td></tr>
<tr>
<td colspan="2">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Или так тоже можна</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#0000ff;">IF</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#777777;">NOT</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#777777;">EXISTS</span><span style=" font-family:'Courier New,courier';"> (</span><span style=" font-family:'Courier New,courier'; color:#0000ff;">SELECT</span><span style=" font-family:'Courier New,courier';"> * </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">FROM</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#00aa00;">SYSOBJECTS</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">WHERE</span><span style=" font-family:'Courier New,courier';"> NAME=</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'TableName'</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#777777;">AND</span><span style=" font-family:'Courier New,courier';"> xtype=</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'U'</span><span style=" font-family:'Courier New,courier';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; color:#008080;">/*сделать то-то*/</span></pre></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">сравните планы</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#0000ff;">SELECT</span><span style=" font-family:'Courier New,courier';"> * </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">FROM</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#00aa00;">SYSOBJECTS</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#0000ff;">WHERE</span><span style=" font-family:'Courier New,courier';"> NAME=</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'TableName'</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#777777;">AND</span><span style=" font-family:'Courier New,courier';"> xtype=</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'U'</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#0000ff;">select</span><span style=" font-family:'Courier New,courier';"> </span><span style=" font-family:'Courier New,courier'; color:#ff00ff;">object_id</span><span style=" font-family:'Courier New,courier';">(</span><span style=" font-family:'Courier New,courier'; color:#ff0000;">'TableName'</span><span style=" font-family:'Courier New,courier';">)</span></pre></body></html>