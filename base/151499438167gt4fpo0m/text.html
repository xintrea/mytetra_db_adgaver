<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не работают/пропали меню </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Встречался я пару раз с ситуацией, когда у человека отсутствовало меню по правому клику мыши. Или по правому клику мыши на ярлычке листа. Т.е. щелкнули по ячейке, чтобы допустим поменять формат или скопировать и ничего не произошло. Вообще ничего. Меню не появилось. Или лист захотели добавить, но опять же по щелчку мыши никакого меню не появилось. Это неудобно. Очень неудобно. Или может быть просто пропали какие-то важные пункты меню, которые были раньше, но чудесным образом испарились или стали вдруг неактивными...</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Почему это происходит? Скорее всего Вы открыли чью-то книгу, в которой был расположен код Visual Basic for Application(VBA). А код как раз отключал показ меню. Или Вы только начали изучать VBA и сами выполнили по незнанию подобный код. И как же теперь вернуть себе свои меню? Очень просто. Надо всего лишь выполнить приведенный ниже код: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce75a09a7e832734025"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub Reset_MenuBars() Dim cmdBar As Object On Error Resume Next For Each cmdBar In Application.CommandBars cmdBar.Enabled = True: cmdBar.Reset Next cmdBar End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce75a09a7e832734025-1"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub Reset_MenuBars()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim cmdBar As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   On Error Resume Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each cmdBar In Application.CommandBars</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       cmdBar.Enabled = True: cmdBar.Reset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next cmdBar</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce75a09a7e832734025-7"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как применить код: переходим в редактор VBA(Alt+F11) -</span><span style=" font-size:8.25pt; font-weight:600;">Insert</span><span style=" font-size:8.25pt;"> -</span><span style=" font-size:8.25pt; font-weight:600;">Module</span><span style=" font-size:8.25pt;">. В созданный </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#StandartModule"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">стандартный модуль</span></a><span style=" font-size:8.25pt;"> вставляем коды выше. Выполнить код, нажав прямо в там же F5. Или можете скачать приложенный файл и просто нажать кнопку. </span><a href="http://www.excel-vba.ru/chto-umeet-excel/pochemu-ne-rabotaet-makros/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Макросы должны быть разрешены</span></a><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Скачать пример</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image13576.png" /><span style=" font-size:8.25pt;">  </span><a href="http://www.excel-vba.ru/download/52/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Tips_Macro_ResetBars.xls</span></a><span style=" font-size:8.25pt;"> (48,0 KiB, 2 240 скачиваний)</span></p></body></html>