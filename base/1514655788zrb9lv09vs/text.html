<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetPrivateProfileString <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;GetPrivateProfileStringA&quot;</span> _<br />        <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> lpapplicationname <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpkeyname <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpdefault <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, _<br />        <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpreturnedstring <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSize <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpfilename <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> WritePrivateProfileString <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;WritePrivateProfileStringA&quot;</span> _<br />        <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> lpapplicationname <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpkeyname <span style=" font-weight:600; color:#0000ff;">As</span> Any, _<br />        <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpstring <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpfilename <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> writeINI<span style=" color:#000000;">(</span>sINIFile <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sSection <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sValue <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> n <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> sTemp  <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    sTemp <span style=" color:#000000;">=</span> sValue<br />    <span style=" font-weight:600; color:#0000ff;">For</span> n <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">1</span> <span style=" font-weight:600; color:#0000ff;">To</span> Len<span style=" color:#000000;">(</span>sValue<span style=" color:#000000;">)</span><br />        <span style=" font-weight:600; color:#0000ff;">If</span> <a href="http://www.google.com/search?q=MID%24+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Mid$</span></a><span style=" color:#000000;">(</span>sValue, n, <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> vbCr <span style=" font-weight:600; color:#0000ff;">Or</span> <a href="http://www.google.com/search?q=MID%24+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Mid$</span></a><span style=" color:#000000;">(</span>sValue, n, <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> vbLf <span style=" font-weight:600; color:#0000ff;">Then</span> <a href="http://www.google.com/search?q=MID%24+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Mid$</span></a><span style=" color:#000000;">(</span>sValue, n<span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot; &quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Next</span> n<br />    n <span style=" color:#000000;">=</span> WritePrivateProfileString<span style=" color:#000000;">(</span>sSection, sKey, sTemp, sINIFile<span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Function</span> sGetINI<span style=" color:#000000;">(</span>sINIFile <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sSection <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>, sdefault <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> sTemp  <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span> <span style=" color:#000000;">*</span> <span style=" color:#a52a2a;">256</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> nLength <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br />    sTemp <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=SPACE%24+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Space$</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">256</span><span style=" color:#000000;">)</span><br />    nLength <span style=" color:#000000;">=</span> GetPrivateProfileString<span style=" color:#000000;">(</span>sSection, sKey, sdefault, sTemp, <span style=" color:#a52a2a;">255</span>, sINIFile<span style=" color:#000000;">)</span><br />    sGetINI <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=LEFT%24+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Left$</span></a><span style=" color:#000000;">(</span>sTemp, nLength<span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Пример использования:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-style:italic; color:#008000;">'запись</span><br />writeINI App<span style=" color:#000000;">.Path</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;\test.ini&quot;</span>, <span style=" color:#a52a2a;">&quot;TestSection&quot;</span>, <span style=" color:#a52a2a;">&quot;TestKey&quot;</span>, txtValue<br /><br /><span style=" font-style:italic; color:#008000;">'чтение</span><br />txtValue <span style=" color:#000000;">=</span> sGetINI<span style=" color:#000000;">(</span>App<span style=" color:#000000;">.Path</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;\test.ini&quot;</span>, <span style=" color:#a52a2a;">&quot;TestSection&quot;</span>, <span style=" color:#a52a2a;">&quot;TestKey&quot;</span>, <span style=" color:#a52a2a;">&quot;None&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Синтаксис:</span><br /><br />writeINI [путь к файлу], [имя секции], [имя параметра (ключа)], [значение]<br /><br />переменная = sGetINI([путь к файлу], [имя секции], [имя параметра (ключа)], [значение]) </p></body></html>