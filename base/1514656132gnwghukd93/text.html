<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Преобразовать длинный Hex (8 байт) в Decimal и обратно</span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#0000ff;">Function</span> HexToDec<span style=" color:#000000;">(</span>strHex<span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> i<br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> size<br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ret<br />    size <span style=" color:#000000;">=</span> Len<span style=" color:#000000;">(</span>strHex<span style=" color:#000000;">)</span> <span style=" color:#000000;">-</span> <span style=" color:#a52a2a;">1</span><br />    ret <span style=" color:#000000;">=</span> <span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">For</span> i <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">To</span> size<br />        ret <span style=" color:#000000;">=</span> ret <span style=" color:#000000;">+</span> <span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;&amp;H&quot;</span> <span style=" color:#000000;">&amp;</span> Mid<span style=" color:#000000;">(</span>strHex, size <span style=" color:#000000;">-</span> i <span style=" color:#000000;">+</span> <span style=" color:#a52a2a;">1</span>, <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">))</span> <span style=" color:#000000;">*</span> <span style=" color:#000000;">(</span><span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">16</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">^</span> <span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span>i<span style=" color:#000000;">))</span><br />    <span style=" font-weight:600; color:#0000ff;">Next</span><br />    HexToDec <span style=" color:#000000;">=</span> ret<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#0000ff;">Function</span> DecToHex<span style=" color:#000000;">(</span>dblNumber<span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> Q<br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ret<br /><br />    ret <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;&quot;</span><br />    Q <span style=" color:#000000;">=</span> <span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span><a href="http://www.google.com/search?q=FIX+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Fix</span></a><span style=" color:#000000;">(</span>dblNumber<span style=" color:#000000;">))</span><br />    <span style=" font-weight:600; color:#0000ff;">While</span> Q <span style=" color:#000000;">&gt;</span> <span style=" color:#a52a2a;">0</span><br />        ret <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=HEX+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Hex</span></a><span style=" color:#000000;">(</span>Q <span style=" color:#000000;">-</span> <a href="http://www.google.com/search?q=FIX+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Fix</span></a><span style=" color:#000000;">(</span>Q <span style=" color:#000000;">/</span> <span style=" color:#a52a2a;">16</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">*</span> <span style=" color:#a52a2a;">16</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">&amp;</span> ret<br />        Q <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=FIX+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Fix</span></a><span style=" color:#000000;">(</span>Q <span style=" color:#000000;">/</span> <span style=" color:#cd6a5a;">CDbl</span><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">16</span><span style=" color:#000000;">))</span><br />    <span style=" font-weight:600; color:#0000ff;">Wend</span><br />    DecToHex <span style=" color:#000000;">=</span> ret<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p></body></html>