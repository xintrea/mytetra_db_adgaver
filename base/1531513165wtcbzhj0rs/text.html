<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #ff0000;"><strong>Microsoft Access DAO Object Model: Create an Index, Create Relationship between Fields, Create and Exceute a Query<br></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #993300;"><strong>Microsoft Access: Data Access Objects Library (DAO), Connect with Access Databases from Excel using VBA.</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #993300;"><strong>Part 2 of 3</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<hr>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333; font-size: 12pt;"><strong><span style="font-size: 12pt;">Microsoft Access: Data Access Objects Library (DAO), Connect with Access Databases from Excel using VBA</span>:</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=175:microsoft-access-data-access-objects-library-dao&amp;catid=79&amp;Itemid=475">1. Connecting to Microsoft Access Database from Excel VBA, using DAO Object Model.</a></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>2. Microsoft Access DAO Object Model: Create an Index, Create Relationship between Fields, Create and Execute a Query.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=177:import-export-data-from-access-to-excel-using-dao&amp;catid=79:excel-vba&amp;Itemid=475">3. Microsoft Access DAO Object Model: Import or Export Data from Access to Excel.</a></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">----------------</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong>Also Read:</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=171:microsoft-access-activex-data-objects-library-ado&amp;catid=79&amp;Itemid=475">Microsoft Access: ActiveX Data Objects (ADO), Connect with Access Databases from Excel using VBA.</a></p>
<hr>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">---------------------------------------------------------------------------------------------------------</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong><span style="font-size: 12pt;">Contents:</span></strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=176:microsoft-access-dao-object-model-create-an-index-create-relationship-between-fields-create-and-exceute-a-query&amp;catid=79&amp;Itemid=475#Create an Index using DAO" rel="alternate">Create an Index using DAO</a></strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=176:microsoft-access-dao-object-model-create-an-index-create-relationship-between-fields-create-and-exceute-a-query&amp;catid=79&amp;Itemid=475#Create Relationship between Fields of Database Tables, using DAO" rel="alternate">Create Relationship between Fields of Database Tables, using DAO</a></strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong><a href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=176:microsoft-access-dao-object-model-create-an-index-create-relationship-between-fields-create-and-exceute-a-query&amp;catid=79&amp;Itemid=475#Create and Exceute a Query, including Action &amp; Parameter Query, using DAO" rel="alternate">Create and Exceute a Query, including Action &amp; Parameter Query, using DAO</a></strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">---------------------------------------------------------------------------------------------------------</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">An <strong>Index</strong>
 specifies the order of accessing records and can disallow duplicate 
values in a field. Index enables quick search of records in a table, and
 it can be created on one or multiple table columns. <strong>Key</strong>
 is a means to identify records in a table, wherein data can be related 
by using one or more columns as key columns. You can relate multiple 
tables by <strong>creating a relationship</strong> between key fields of each. SQL statements are referred to as <strong>queries</strong>. You may create a Recordset based on a <strong>stored query</strong> or a <strong>parameter query</strong>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #0000ff;"><strong><a id="Create an Index using DAO"></a>Create an Index using DAO</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">An
 Index specifies the order of accessing records and can disallow 
duplicate values in a field. Index enables quick search of records in a 
table, and it can be created on one or multiple table columns. An index 
speedily points directly to the row containing a given value in the 
indexed column(s), instead of searching every row inserted in a random 
order in the table. Key is a means to identify records in a table, 
wherein data can be related by using one or more columns as key columns.
 Primary key can be specified as one or more columns having unique 
values, and cannot be Null. There can be only one Primary key in a 
Table.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Steps to create an Index in a database table:</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Step 1: Create an Index object, using the DAO TableDef.CreateIndex Method.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Step
 2: Set Index properties viz. set index name, set as primary key index, 
allow / disallow null value in index field, and so on.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Step
 3: Define Index Field(s) - Create Field object(s) for the Index object 
(using its CreateField method) and Append these to the fields collection
 of the Index object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Step 4: Append the Index object to the TableDef's Indexes collection (using the Indexes.Append Method).</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Create an Index object</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>TableDef.CreateIndex Method</strong> to Create an Index in a Database Table. <em><strong>Syntax: TableDefObject.CreateIndex(Name)</strong></em>. The <strong>Name</strong>
 argument (optional) is a string value specifying the name (maximum 
length of 64 characters) of the new Index. If you do not specify the 
Name in the CreateIndex method, you can set it later by assigning the 
name to the Index object before appending the new Index object to a 
collection.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Indexes Collection</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Indexes Collection refers to all Index objects of a Table.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="text-decoration: underline;"><strong>DAO Indexes Collection  Methods and Properties</strong></span>:</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Indexes.Append Method</strong>. Use the Append method to add a new index to the Indexes collection: TableDefObject.Indexes.Append(IndexObject).</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Indexes.Delete Method</strong>. To Delete an Index object, use the Delete method: TableDefObject.Indexes.Delete(IndexName).</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Indexes.Refresh Method</strong>:
 The Refresh method is particularly required to be used in a multi-user 
environment wherein different users might be making changes in the 
database, in which case only those objects are contained when you have 
referred to the collection initially without reflecting any subsequent 
changes made by other users, and the collection will get updated only on
 using the Refresh method. To refresh the indexes collection: 
TableDefObject.Indexes.Refresh.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Indexes.Count Property</strong>:
 The Count property of the Indexes collection determines the number of 
Index objects in the collection. When there are no objects in the 
collection, the Count property value will be 0.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index Object</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">An
 Index specifies the order of accessing records and can disallow 
duplicate values in a field. Index enables quick search of records in a 
table, and it can be created on one or multiple table columns.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="text-decoration: underline;"><strong>DAO Index Object  Methods and Properties</strong></span>:</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Some methods &amp; properties of an Index object are briefly discussed here.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.CreateField Method</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">To create a new field for an Index object, use the <strong>Index.CreateField Method</strong>. <em><strong>Syntax: IndexObject.CreateField(Name, Type, Size)</strong></em>. All arguments are optional to specify. The <strong>Name</strong> argument specifies a name for the new Field. The <strong>Type</strong> and <strong>Size</strong>
 arguments are not supported for an Index object, and are ignored in 
this case. If the Name argument is not specified in the method, you can 
set the Name property thereafter but before the Field is appended to the
 Fields collection of the Index object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">To delete a field from the Fields Collection, use the <strong>DAO Fields.Delete Method</strong>.
 Note that once an index referencing a field has been created, that 
Field cannot be deleted from a Fields collection of a TableDef object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.Name Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use
 the Name property to set or return the name (a string value with 
maximum length of 64 characters) of an Index object. The property is 
read/write before the Index object is appended to a collection and 
read-only after appending. <em><strong>Syntax: IndexObject.Name</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.Primary Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>Index.Primary Property</strong>
 to determine whether the Index object is as a primary key index for a 
database table. Use the Syntax IndexObject.Primary = True to set the 
Index object as a primary key index. Default value is False. The Unique 
and Required properties are automatically set to True for a primary key 
index. A primary key index will identify all records of a table uniquely
 in a predefined order. If an Index is not primary, it is a secondary 
index (ie. when the Primary property of the Index is set to False). The 
Primary property is read/write before the Index object is appended to 
the Indexes collection and read-only for an appended Index object. Note 
that the Primary property is read/write also in the case when the Index 
object is appended to the TableDef object which itself is not appended 
to the TableDefs collection.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.Unique Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>Index.Unique Property</strong>
 to determine whether values in an Index should be unique or not. 
Setting the property to True will identify all records uniquely in the 
table. For a single-field index this means that all values within the 
field should be unique, whereas for a multi-field index this means that 
though duplicate values are allowed within a particular field but each 
set of values combined from all indexed fields should be unique. <em><strong>Syntax: IndexObject .Unique</strong></em>. The property is read/write before the Index object is appended to a collection and read-only after appending.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.Required Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">The <strong>Index.Required Property</strong>
 determines whether an index field can accept null values. Setting the 
Required Property to False will allow null values in the indexed field. 
Between an Index object and a Field object, set the Required property 
for the Field object because its validation for the Field object 
precedes that of an Index object. Default setting is False. <em><strong>Syntax: IndexObject.Required</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Index.IgnoreNulls Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em><strong>Syntax: IndexObject.IgnoreNulls</strong></em>.
 This property is read/write before the Index object is appended to a 
collection and read-only after appending. Default setting is False. The <strong>IgnoreNulls Property</strong>
 determines whether a record having a null value in its index field will
 be included in the index (ie. will have an index entry or not). The 
IgnoreNulls property and Required property are used together to 
determine an index entry for records having null index values. When the 
Required property for an Index is False: (i) records are allowed to have
 a null value in the Index field and if IgnoreNulls property is True, an
 index entry WILL NOT be added for the record; and (ii) records are 
allowed to have a null value in the Index field and if IgnoreNulls 
property is False, an index entry WILL be added for the record. When the
 Required property for an Index is True, records are NOT allowed to have
 a null value in the Index field, and in this case the record with a 
non-null value in its Index field will have an index entry. If you want 
to allow null values in the Index field and expect a large number of 
null values therein, setting the IgnoreNulls property to True will 
reduce the storage space used by the Index. Refer Example 8b which 
explains this property.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Index property of a Recordset Object: DAO Recordset.Index Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Index
 is created for a database Table and appended to the Indexes collection 
of the underlying TableDef object. An Index does not change the order in
 which records are actually stored in a base table, but only affects the
 order in which they are returned or are accessed in a Recordset when it
 is opened or when a particular Index is selected. For a table-type 
Recordset object you can set the order of the records only with an index
 which is already defined for the underlying TableDef object. Use the <strong>Recordset.Index property</strong> in a table-type Recordset object to set or return the name of the current Index object - <em><strong>Syntax: RecordsetObject.Index</strong></em>.
 Note that you can use an SQL statement ORDER BY clause in a 
dynaset-type or snapshot-type or forward-only-type Recordset to sort 
records in an order other than in a defined Index of a table.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 8a: Create Index Keys (Primary Index, Single-Field Index &amp; Multi-Field Index) for Fields in a Database.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 8a, 8b, 8c &amp; 8d as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 515px;"><img class="caption" title="Image 8a" src="1.png" alt="" border="0"><p class="img_caption">Image 8a</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 515px;"><img class="caption" title="Image 8b" src="2.png" alt="" border="0"><p class="img_caption">Image 8b</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong> </strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 515px;"><img class="caption" title="Image 8c" src="3.png" alt="" border="0"><p class="img_caption">Image 8c</p></div></strong></span></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 517px;"><img class="caption" title="Image 8d" src="4.png" alt="" border="0"><p class="img_caption">Image 8d</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_CreateIndex_8a()</strong><br><span style="color: #008000;">'create Index Keys (Primary Index, Single-Field Index &amp; Multi-Field Index) for Fields in a database, using DAO</span><br><span style="color: #008000;">'refer Image 8a to view the existing SalesManager Table in MS Access file "SalesReport.accdb".</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String<br>Dim daoDB As DAO.Database<br>Dim daoTblDef As DAO.TableDef<br>Dim daoIndex As DAO.Index<br>Dim daoFld As DAO.Field<br><br><span style="color: #008000;">'---------------</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'open a database object: assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'refer to a TableDef object by its name: reference the table named SalesManager</span><br>Set daoTblDef = daoDB.TableDefs("SalesManager")<br><br><span style="color: #008000;">'----------------</span><br><span style="color: #008000;"><strong>'Steps to create an Index:</strong></span><br><span style="color: #008000;">'Step 1: Create an Index object, using the DAO TableDef.CreateIndex Method.</span><br><span style="color: #008000;">'Step
 2: Define Index properties viz. set index name, set as primary key 
index, allow / disallow null value in index field, and so on.</span><br><span style="color: #008000;">'Step
 3: Define Index Field(s) - Create Field object(s) for the Index object 
(using its CreateField method) and Append these to the fields collection
 of the Index object.</span><br><span style="color: #008000;">'Step 4: Append the Index object to the TableDef's Indexes collection.</span><br><br><span style="color: #008000;">'----------------</span><br><span style="color: #008000;">'CREATE A PRIMARY KEY INDEX:</span><br><span style="color: #008000;">'refer
 Image 8b showing the "SalesManager" Table where the Primary Index has 
been created on "EmployeeId" column whose values appear in ascending 
order and the column cannot have duplicate values. The Unique and 
Required properties are automatically set to True for a primary key 
index:</span><br><br>Set daoIndex = daoTblDef.CreateIndex("piEmpId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'define index properties:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'set index as a primary key index, that uniquely identifies all records in a table:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Primary = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'define the Index field:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("EmployeeId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'append index to collection:</span><br>daoTblDef.Indexes.Append daoIndex<br><br><span style="color: #008000;">'destroy the index object variable:</span><br>Set daoIndex = Nothing<br><br><span style="color: #008000;">'delete index by reference to its name:</span><br>daoTblDef.Indexes.Delete "piEmpId"<br><br><span style="color: #008000;">'----------------</span><br><span style="color: #008000;">'CREATE A SINGLE-FIELD INDEX WITH UNIQUE VALUES:</span><br><span style="color: #008000;">'refer
 Image 8c showing the "SalesManager" Table where the Index has been 
created on "Surname" column whose values appear in ascending order and 
the column cannot have duplicate values.</span><br><br>Set daoIndex = daoTblDef.CreateIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'define index properties:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Name = <span style="color: #333333;">"iSurNm"</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'null values not allowed in the indexed field:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Required = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'identify
 all records uniquely in the table. For a single-field index this means 
that all values within the field should be unique, whereas for a 
multi-field index this means that though duplicate values are allowed 
within a </span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">particular field but each set of values combined from all indexed fields should be unique.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Unique = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("Surname")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">daoTblDef.Indexes.Append daoIndex<br><br>Set daoIndex = Nothing<br><br><span style="color: #008000;">'delete index by reference to its name:</span><br>daoTblDef.Indexes.Delete ("iSurNm")<br><br><span style="color: #008000;">'----------------</span><br><span style="color: #008000;">'CREATE A MULTI-FIELD INDEX:</span><br><span style="color: #008000;">'refer
 Image 8d showing the "SalesManager" Table where the Index has been 
created on 2 columns, "FirstName" and "Surname", wherein values appear 
in ascending order based on both columns - note that "Jim Davis" which 
was below "Jim Mason" originally now precedes it.</span><br><br>Set daoIndex = daoTblDef.CreateIndex("iFullNm")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'define index properties:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Required = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("Surname")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">daoTblDef.Indexes.Append daoIndex<br><br>Set daoIndex = Nothing<br><br><span style="color: #008000;">'refresh display (order) of Indexes collection:</span><br>daoTblDef.Indexes.Refresh<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'enumerate all Indexes collection and Fields collection of each Index:</span><br>For Each daoIndex In daoTblDef.Indexes</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">For Each daoFld In daoIndex.Fields</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">MsgBox "Index Name: " &amp; daoIndex.Name &amp; "; " &amp; "Field Name: " &amp; daoFld.Name</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">Next daoFld</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Next daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'delete index by reference to its name:</span><br>daoTblDef.Indexes.Delete "iFullNm"<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set daoTblDef = Nothing<br>Set daoIndex = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set daoFld = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example
 8b: When the Required property setting is False for an Index object, 
records with Null value have an index entry depending on the 
Index.IgnoreNulls property setting.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 8a &amp; 8e as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 516px;"><img class="caption" title="Image 8e" src="5.png" alt="" border="0"><p class="img_caption">Image 8e</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_CreateIndex_8b()</strong><br><span style="color: #008000;">'When
 the Required property setting is False for an Index object: records 
with Null value have an index entry if IgnoreNulls = False; records with
 Null value do NOT have an index entry if IgnoreNulls = True;</span><br><span style="color: #008000;">'refer
 Image 8a to view the existing SalesManager Table in MS Access file 
"SalesReport.accdb"; refer Image 8e after running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String<br>Dim daoDB As DAO.Database<br>Dim daoTblDef As DAO.TableDef<br>Dim daoIndex As DAO.Index<br>Dim recSet As DAO.Recordset<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport4.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'open a database object: assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'refer to a TableDef object by its name: reference the table named SalesManager</span><br>Set daoTblDef = daoDB.TableDefs("SalesManager")<br><br><span style="color: #008000;">'----------------</span><br>Set daoIndex = daoTblDef.CreateIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'define index properties:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Name = <span style="color: #333333;">"iSurNm"</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'determine if a record with null value in the index field will be included in the index:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.IgnoreNulls = False</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Unique = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("Surname")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">daoTblDef.Indexes.Append daoIndex<br><br><span style="color: #008000;">'open table-type recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set recSet = daoDB.OpenRecordset("SalesManager", dbOpenTable)<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With recSet</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'add new record with a null value for the "Surname" index field:</span><br>.AddNew<br>.Fields("EmployeeId") = 55<br>.Fields("FirstName") = <span style="color: #333333;">"Albert"</span><br>.Update<br><span style="color: #008000;">'set index for the recordset using the Recordset.Index Property:</span><br>.Index = daoIndex.Name</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.MoveFirst</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"> <span style="color: #008000;">'refer
 Image 8e showing "SalesManager" table in which new record is added, 
which will be included in the index depending on the IgnoreNulls 
property setting when the Required property setting is False (default).</span><br><span style="color: #008000;">'If
 IgnoreNulls = False, record with Null value has an index entry and 
messages returned are: Albert Null, Jim Davis, Sam Green, David Kelly, 
Jim Mason, Tracy Murray.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'If
 IgnoreNulls = True, record with Null value does not have an index entry
 and messages returned are: Jim Davis, Sam Green, David Kelly, Jim 
Mason, Tracy Murray.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">Do While Not .EOF</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">If IsNull(.Fields("Surname")) Then</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 150px; margin: 0px;">MsgBox "First Name: " &amp; .Fields("FirstName") &amp; ", " &amp; "Surname: Null"</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">Else</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 150px; margin: 0px;">MsgBox "First Name: " &amp; .Fields("FirstName") &amp; ", " &amp; "Surname: " &amp; .Fields("Surname")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">End If</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">.MoveNext</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">Loop</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'delete index by reference to its name:</span><br><span style="color: #008000;">'daoTblDef.Indexes.Delete ("iSurNm")</span><br><br><span style="color: #008000;">'close the objects:</span><br>recSet.Close<br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set daoTblDef = Nothing<br>Set daoIndex = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set daoFld = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Recordset.Seek Method</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><br>Use the <strong>Seek method</strong>
 for a table-type recordset, to locate a record meeting the criteria 
specified for the current index. If the Seek method finds the record, 
the located record becomes the current record and the NoMatch property 
is set to False. However if a record is not found, the current record is
 undefined and method sets the NoMatch property to True. <em><strong>Syntax: RecordsetObject.Seek(ComparisonExpression, Key1, Key2, ... Key13)</strong></em>. Both the arguments of ComparisonExpression and Keys are required to be specified. The <strong>ComparisonExpression</strong> can be any of the 5 expressions: &gt;, =, &gt;=, &lt;, &lt;=. The <strong>Key</strong>
 argument is a value evaluated against the current Index field and you 
can specify a maximum of 13 keys, wherein Key1 must be of the same data 
type as that of the current index field.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Note
 that a current Index must be set (using the Index property) for the 
Recordset before using the Seek method, and in case the index field is 
not unique (ie. the field has duplicate values) then the first record 
which satisfies the criteria is located. For comparison expressions of 
greater than (&gt;), equal (=), or greater than or equal (&gt;=), the 
search is started at the beginning of the index and moves forward. For 
comparison expressions of less than (&lt;) or less than or equal 
(&lt;=), the search is started at the index end and moves backward and 
if the index end has duplicate entries then search starts randomly from 
any of these duplicate entries and moves backward. As mentioned earlier,
 to search through Dynaset-type or Snapshot-type recordsets, you will 
need to use the Find method (which is slower the Seek method) which is 
supported by these recordsets.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 9: Use the Seek method for a table-type recordset, to locate a record.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_SeekMethod_9()</strong><br><span style="color: #008000;">'Use the Seek method for a table-type recordset, to locate a record meeting the criteria specified for the current index.</span><br><span style="color: #008000;">'If
 the Seek method finds the record, the located record becomes the 
current record and the NoMatch property is set to False. However if a 
record is not found, the current record is undefined and method sets the
 NoMatch property to True.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim daoTblDef As DAO.TableDef<br>Dim daoIndex As DAO.Index<br>Dim recBookMark As String<br>Dim intSeek As Integer<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'open a database object: assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'refer to a TableDef object by its name: reference the table named SalesManager</span><br>Set daoTblDef = daoDB.TableDefs("SalesManager")<br><br><span style="color: #008000;">'----------------</span><br><span style="color: #008000;">'CREATE A PRIMARY KEY INDEX:</span><br>Set daoIndex = daoTblDef.CreateIndex("piEmpId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndex</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Primary = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Required = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("EmployeeId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">daoTblDef.Indexes.Append daoIndex<br><br><span style="color: #008000;">'----------------</span><br><br><span style="color: #008000;">'Open a table-type recordset to use the Seek method:</span><br>Set recSet = daoDB.OpenRecordset("SalesManager", dbOpenTable)<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With recSet</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'specify the index name wherein to search with the Seek method - set index for the recordset using the Recordset.Index Property:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Index = <span style="color: #333333;">"piEmpId"</span><br><span style="color: #008000;">'save position of current record to which you might want to return later:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">recBookMark = .Bookmark</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'specify search value:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">intSeek = InputBox("Enter EmployeeID to locate")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'run the Seek meth0d:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Seek <span style="color: #333333;">"</span>=<span style="color: #333333;">",</span> intSeek</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'check whether matching record found or not by the Seek method:</span><br>If .NoMatch Then</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;"><span style="color: #008000;">'return the record whose position was saved, if no match is found by the Seek method:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">.Bookmark = recBookMark</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">MsgBox "Not found EmployeeID: " &amp; intSeek &amp; ", reverted to initial record: " &amp; recSet.Fields("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">Else</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;"><span style="color: #008000;">'return the matching record found by the Seek method:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 120px; margin: 0px;">MsgBox "Found EmployeeID: " &amp; intSeek &amp; ", whose First Name is: " &amp; recSet.Fields("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">End If</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'close recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Close</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'delete index by reference to its name:</span><br>daoTblDef.Indexes.Delete "piEmpId"<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set recSet = Nothing<br>Set daoTblDef = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set daoIndex = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #0000ff;"><strong><a id="Create Relationship between Fields of Database Tables, using DAO"></a>Create Relationship between Fields of Database Tables, using DAO</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">An <strong>Index</strong>
 specifies the order of accessing records and can disallow duplicate 
values in a field. Index enables quick search of records in a table, and
 it can be created on one or multiple table columns. <strong>Key</strong>
 is a means to identify records in a table, wherein data can be related 
by using one or more columns as key columns. Primary key can be 
specified as one or more columns having unique values, and cannot be 
Null. There can be only one Primary key in a Table.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">A
 relational database has multiple tables, each table comprising of 
columns (fields) and rows wherein data can be grouped using common 
attributes, and from which data can be easily retrieved. The multiple 
tables relate to and work with each other through certain key fields 
(like unique "ID Nos") viz. a separate table is created for 
vendor-details and another table for purchase-orders wherein vendor 
details are not repeated each time a purchase order is made and they are
 related with each other through a unique "Vendor ID" column which is 
present in both tables.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">You
 can relate multiple tables (we consider 2 tables here) by creating a 
relationship between key fields (usually the 'primary key' fields) of 
each. We refer one table as the 'primary table', for which a unique 
index is required for the key field so that this key field contains 
unique values. The other table is referred as 'foreign table' and its 
key field as the 'foreign key'. The unique index field of the primary 
table is related to the 'foreign key'. Note that though it is not 
required that the foreign key field contain unique values, it is 
preferable to do so otherwise relating multiple options from the foreign
 key to a single/unique value in the key field of the primary table 
might become meaningless.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Relation Object</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">A
 Relation object shows the relationship between fields in tables of a 
database. Use a Relation object to relate tables by creating a 
relationship between fields or return existing relationships in a 
database. A new Relation object is created using the <strong>Database.CreateRelation Method</strong>.
 Within the Relations collection of a Database, you can refer a Relation
 object by its ordinal position or Name property - to reference a 
Relation named "RelationName", which is the first relation object in the
 database, you can use any of the following:- 
DatabaseObject.Relations("RelationName") or 
DatabaseObject![RelationName] or DatabaseObject.Relations(0).</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Steps to Create a Relation between Key Fields of Tables:</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;">Step 1: Reference the Primary table and Foreign table - assign to object variables (TableDef).</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;">Step 2: Create Index for the Primary table - the Indexed field will be part of the relationship.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;">Step
 3: Create a new Relation object (using the Database.CreateRelation 
Method), specifying names of the Primary &amp; Foreign tables to be 
related, and also specifying the Attributes for the relationship type.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;">Step
 4: Create  a new Field object (using the Relation.CreateField Method) 
for the Relation object; specify Field names of the Primary &amp; 
Foreign table which will be part of the relationship; and append the new
 Field object to the Fields collection of the Relation object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;">Step 5: Append the new Relation object to the Relations collection of the Database.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><br><strong>DAO Database.CreateRelation Method</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>Database.CreateRelation Method</strong> to create a new Relation object. <em><strong>Syntax: DatabaseObject.CreateRelation(Name, Table, ForeignTable, Attributes)</strong></em>. The <strong>Name</strong> argument  names the Relation object; the <strong>Table</strong> argument names the Primary table to be related; The <strong>ForeignTable</strong>
 argument names the Foreign table to be related. Note that both the 
Table and ForeignTable should be existing tables when using this method.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">The <strong>Attributes</strong>
 argument sets the constants (RelationAttributeEnum Enumeration) 
describing the relationship type viz. dbRelationUnique (value 1) - 
describes one-to-one relationship; dbRelationUpdateCascade (value 256) -
 Updates will cascade; dbRelationDeleteCascade (value 4096) - Deletions 
will cascade; dbRelationLeft (value 16777216) &amp; dbRelationRight 
(value 33554432) - to determine whether the relationship between fields 
in the table is left join or right join; and so on. While specifying the
 Attributes, use the sum of the RelationAttributeEnum Enumeration values
 when you want to include multiple values viz. dbRelationUpdateCascade +
 dbRelationDeleteCascade.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>Delete method</strong> on the Relations collection to delete the Relation object - Syntax: DatabaseObject.Relations.Delete "RelationName".</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Relation.CreateField Method</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">To add a field to a Relation object, use the DAO <strong>Relation.CreateField Method</strong>, <em><strong>Syntax: RelationObject.CreateField(Name, Type, Size)</strong></em>. All arguments are optional to specify. The <strong>Name</strong> argument specifies a name for the new Field. The <strong>type</strong> and <strong>size</strong>
 arguments are not supported for a Relation object, and are ignored in 
this case. If the Name argument is not specified in the method, you can 
set the Name property thereafter but before the Field is appended to the
 Fields collection of the Relation object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">To <strong>delete</strong> a field from the Fields Collection, use the <strong>DAO Fields.Delete Method</strong>.
 Note that once an index referencing a field has been created, that 
Field cannot be deleted from a Fields collection of a TableDef object.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Relation.Name Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">Use the <strong>Name property</strong>
 to set or return the name (a string value with maximum length of 64 
characters) of a Relation object. The property is read/write before the 
Relation object is appended to a collection and read-only after 
appending. <em><strong>Syntax: RelationObject.Name</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Relation.ForeignTable Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">A
 Relation object shows the relationship between fields of database 
tables, referred to as Primary Table &amp; Foreign Table. The <strong>Relation.ForeignTable Property</strong>
 is used to set (or return) the Foreign table's name in the 
relationship. The property is read/write before the Relation object is 
appended to a collection and read-only after it is appended. <em><strong>Syntax: RelationObject .ForeignTable</strong></em>. The Foreign table is referred to by the TableDef object's name property viz. TableDefObject.Name.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>DAO Field.ForeignName Property</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">A
 Relation object shows the relationship between fields of database 
tables, referred to as Primary Table &amp; Foreign Table. You create  a 
new Field object (using the Relation.CreateField Method) for the 
Relation object; specify Field names of the Primary &amp; Foreign table 
which will be part of the relationship; and append the new Field object 
to the Fields collection of the Relation object. The <strong>Field.ForeignName Property</strong>
 is used to set (or return) the Field name in the Foreign table and the 
Field.Name Property is used to set the corresponding Field name in the 
Primary table of the relationship. <strong>Syntax</strong> of ForeignName property: <em><strong>FieldObject.ForeignName</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 10: Create a Relation between Two Tables using the Database.CreateRelation Method.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 10a, 10b &amp; 10c as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 593px;"><img class="caption" title="Image 10a" src="6.png" alt="" border="0"><p class="img_caption">Image 10a</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 731px;"><img class="caption" title="Image 10b" src="7.png" alt="" border="0"><p class="img_caption">Image 10b</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong> </strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 673px;"><img class="caption" title="Image 10c" src="8.png" alt="" border="0"><p class="img_caption">Image 10c</p></div></strong></span></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_TablesCreateRelation_10()</strong><br><span style="color: #008000;">'Create
 a Relation between Two Tables, using DAO - relationship between fields 
in two TableDef (or QueryDef) objects using the Database.CreateRelation 
Method.</span><br><span style="color: #008000;">'refer Image 10a to view the existing SalesManager Table in MS Access file "SalesReport.accdb".</span><br><span style="color: #008000;">'refer Image 10b to view the existing Performance Table in MS Access file "SalesReport.accdb".</span><br><span style="color: #008000;">'refer Image 10c to view the SalesManager Table, after Creating Relation by running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String<br>Dim daoDB As DAO.Database<br>Dim tblDefSM As DAO.TableDef, tblDefP As DAO.TableDef<br>Dim daoIndx As DAO.Index<br>Dim daoRel As DAO.Relation<br>Dim daoFld As DAO.Field<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'open a database object: assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'----------------</span><br><strong><span style="color: #008000;">'Steps to Create a Relation between Key Fields of Tables:</span></strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'Step 1: Reference the Primary table and Foreign table - assign to object variables (TableDef).</span><br><span style="color: #008000;">'Step 2: Create Index for the Primary table - the Indexed field will be part of the relationship.</span><br><span style="color: #008000;">'Step
 3: Create a new Relation object (using the Database.CreateRelation 
Method), specifying names of the Primary &amp; Foreign tables to be 
related, and also specifying the Attributes for the relationship type.</span><br><span style="color: #008000;">'Step
 4: Create  a new Field object (using the Relation.CreateField Method) 
for the Relation object; specify Field names of the Primary &amp; 
Foreign table which will be part of the relationship; and append the new
 Field object to the Fields collection of the Relation object.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'Step 5: Append the new Relation object to the Relations collection of the Database.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'specify and reference "SalesManager" as the primary table:</span><br>Set tblDefSM = daoDB.TableDefs("SalesManager")<br><span style="color: #008000;">'specify and reference "Performance" as the foreign table:</span><br>Set tblDefP = daoDB.TableDefs("Performance")<br><br><span style="color: #008000;">'Create Index for the primary table "SalesManager". The indexed field will create relationship with the foreign table's field:</span><br>Set daoIndx = tblDefSM.CreateIndex("indxEmpId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoIndx</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Required = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Unique = True</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">.Fields.Append .CreateField("EmployeeId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">tblDefSM.Indexes.Append daoIndx<br><br><span style="color: #008000;">'Create
 Relation object named relSalesPerf, specifying names of the primary 
&amp; foreign tables to be related, and also specifying the attributes 
for the relationship type.</span><br>Set daoRel = daoDB.CreateRelation("relSalesPerf", tblDefSM.Name, tblDefP.Name, dbRelationUpdateCascade)<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'create field object for the Relation object daoRel and append to its fields collection.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">With daoRel</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'specify field name of the primary table which has been indexed and will be a part of the relationship:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">Set daoFld = .CreateField("EmployeeId")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'specify field name of the foreign table which will be a part of the relationship:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">daoFld.ForeignName = <span style="color: #333333;">"EmployeeId"</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;"><span style="color: #008000;">'Append the new field object to fields collection of the relation object:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">daoRel.Fields.Append daoFld</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">End With</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;"> </span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'append the new relation object daoRel to the Relations collection of the Database.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">daoDB.Relations.Append daoRel<br><br><span style="color: #008000;">'delete relation:</span><br><span style="color: #008000;">'daoDB.Relations.Delete "relSalesPerf"</span><br><span style="color: #008000;">'delete Index:</span><br><span style="color: #008000;">'tblDefSM.Indexes.Delete "indxEmpId"</span><br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set tblDefSM = Nothing<br>Set tblDefP = Nothing<br>Set daoFld = Nothing<br>Set daoRel = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set daoIndx = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #0000ff;"><strong><a id="Create and Exceute a Query, including Action &amp; Parameter Query, using DAO"></a>Create and Exceute a Query, including Action &amp; Parameter Query, using DAO</strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">SQL statements are referred to as queries. A <strong>QueryDef object</strong> is a predefined query which is defined, saved and stored in a Microsoft Access database for later use. The <strong>CreateQueryDef method</strong> is used to create a new QueryDef object - <strong>Syntax</strong> of DAO <strong>Database.CreateQueryDef Method</strong>: <em><strong>DatabaseObject.CreateQueryDef(QueryName, SQLText)</strong></em>.
 Both QueryName &amp; SQLText arguments are Optional. This method 
automatically appends the QueryDef object to the QueryDefs collection if
 a valid name is specified. A temporary QueryDef object which is not 
automatically appended to the collection, can be created by using a 
zero-length string ("") for the QueryName argument. The SQLText argument
 specifies the SQL statement.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">If
 the QueryName and SQLText are not specified while creating the QueryDef
 object, these can be set later using the object's Name &amp; SQL 
properties - DAO <strong>QueryDef.Name Property</strong> &amp; DAO <strong>QueryDef.SQL Property</strong>.
 The Name property sets or returns the name of the QueryDef object, 
which cannot exceed 64 characters. The SQL Property of the QueryDef 
object sets or returns the SQL statement by which a query is defined for
 the QueryDef object. To delete the QueryDef object from a QueryDefs 
collection, use the <strong>QueryDefs.Delete Method</strong>, <em><strong>Syntax: QueryDefs.Delete(Name)</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">To create a Recordset based on a stored query or a parameter query, use the<strong> DAO QueryDef.OpenRecordset Method</strong>, <em><strong>Syntax: QueryDefObject.OpenRecordset(Type, Options, LockEdit)</strong></em>.
 In this method you first get a reference to the QueryDef object and 
then use the Set operator to return the recordset. Refer Example 11b in 
which this method is used.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 11a: Create and Save a Query (QueryDef object).</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Image 11 as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 592px;"><img class="caption" title="Image 11" src="9.png" alt="" border="0"><p class="img_caption">Image 11</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_CreateSaveQuery_11a()</strong><br><span style="color: #008000;">'create and save a query (QueryDef object).</span><br><span style="color: #008000;">'refer
 Image 11 which shows the SalesManager Table in MS Access file 
"SalesReport.accdb", and the query "sqlQuery" that is created after 
running below code.</span><br><br><span style="color: #008000;">'To use 
DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'If
 you open a database object without specifying a workspace, it will 
exist within the default workspace. First assign the database reference 
to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'SQL statement assigned to the variable (strSQL).</span><br>strSQL = <span style="color: #333333;">"SELECT</span> * FROM SalesManager WHERE EmployeeId &gt; 18"<br><br><span style="color: #008000;">'Specify
 QueryName and SQLText while creating the QueryDef object. The QueryDef 
object is automatically appended to the QueryDefs collection.</span><br>Set qryD = daoDB.CreateQueryDef("sqlQuery", strSQL)<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set qryD = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 11b: Open Recordset based on a saved Query; Delete the QueryDef object.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Image 11 as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_OpenRecordSetSavedQuery_11b()</strong><br><span style="color: #008000;">'Open Recordset based on a saved Query; return the first two fields of each record; delete the QueryDef object.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String<br>Dim daoDB As DAO.Database<br>Dim recSet As DAO.Recordset<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'Assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.OpenDatabase(strDB)<br><br><span style="color: #008000;">'Open snapshot-type recordset based on a saved query:</span><br>Set recSet = daoDB.OpenRecordset("sqlQuery", dbOpenSnapshot)<br><span style="color: #008000;">'alternate code - creates recordset using QueryDef.OpenRecordset Method:</span><br><span style="color: #008000;">'Set qryD = daoDB.QueryDefs("sqlQuery")</span><br><span style="color: #008000;">'Set recSet = qryD.OpenRecordset(dbOpenDynaset)</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'return the first two fields of each record of the Recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'Three
 records are returned, with reference to Image 11: EmployeeId - 21, 
FirstName - Jim; EmployeeId - 35, FirstName - David; EmployeeId - 56, 
FirstName - Sam.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Do While Not recSet.EOF</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields(0).Name &amp; " - " &amp; recSet.Fields(0)</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields(1).Name &amp; " - " &amp; recSet.Fields(1)</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">recSet.MoveNext</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Loop</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'delete the QueryDef object:</span><br>daoDB.QueryDefs.Delete ("sqlQuery")<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>recSet.Close<br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set qryD = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set recSet = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 12a: Create and Save a QueryDef object, with a Parameter Query.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Image 12 as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 593px;"><img class="caption" title="Image 12" src="10.png" alt="" border="0"><p class="img_caption">Image 12</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_CreateParameterQuery_12a()</strong><br><span style="color: #008000;">'create and save a QueryDef object, with a parameter query.</span><br><span style="color: #008000;">'refer
 Image 12 which shows the SalesManager Table in MS Access file 
"SalesReport.accdb", and the parameter query "ParamQuery" that is 
created after running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.Workspaces(0).OpenDatabase(strDB)<br><br><span style="color: #008000;">'A
 parameter query is one in which the user is prompted to enter some 
information, such as selection criteria for records or a field value to 
be inserted.</span><br><span style="color: #008000;">'SQL Parameterized query, is constructed with parameters, and assigned to the variable (strSQL).</span><br>strSQL = <span style="color: #333333;">"PARAMETERS</span> startDate DateTime, endDate DateTime; SELECT * FROM SalesManager WHERE JoinDate between startDate and endDate"<br><br><span style="color: #008000;">'Create
 a QueryDef object, with the parameter query name "ParamQuery". The 
QueryDef object is automatically appended to the QueryDefs collection.</span><br>Set qryD = daoDB.CreateQueryDef("ParamQuery")<br><br><span style="color: #008000;">'Because the SQLText was not specified while creating the QueryDef object, it is being set later using the object's property:</span><br>qryD.Sql = strSQL<br><br><span style="color: #008000;">'alternatively, specify QueryName and SQLText while creating the QueryDef object:</span><br><span style="color: #008000;">'Set qryD = daoDB.CreateQueryDef("ParamQuery", strSQL)</span><br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set qryD = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 12b: Open Recordset based on a saved Parameter Query; Delete the QueryDef object.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Image 12 as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_OpenRecordSetParameterQuery_12b()</strong><br><span style="color: #008000;">'Open Recordset based on a saved parameter Query; return the first two fields of each record; delete the QueryDef object.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim recSet As DAO.Recordset<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.Workspaces(0).OpenDatabase(strDB)<br><br><span style="color: #008000;">'set the parameter query:</span><br>Set qryD = daoDB.QueryDefs("ParamQuery")<br><br><span style="color: #008000;">'set value for parameters:</span><br>qryD.Parameters("startDate") = <span style="color: #333333;">"04/01/2011"</span><br>qryD.Parameters("endDate") = Now<br><br><span style="color: #008000;">'Open Snapshot-type Recordset based on a parameter query:</span><br>Set recSet = qryD.OpenRecordset(dbOpenSnapshot)<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'return the first two fields of each record of the Recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'Two records are returned, with reference to Image 12: EmployeeId - 18, FirstName - Tracy; EmployeeId - 56, FirstName - Sam.</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Do While Not recSet.EOF</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields(0).Name &amp; " - " &amp; recSet.Fields(0)</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields(1).Name &amp; " - " &amp; recSet.Fields(1)</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">recSet.MoveNext</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Loop</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'delete the QueryDef object:</span><br>daoDB.QueryDefs.Delete ("ParamQuery")<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>recSet.Close<br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set qryD = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set recSet = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Run an Action Query or Execute SQL Statement</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><br>The <strong>Database.Execute Method</strong> is used to run an action query or execute an SQL statement. <em><strong>Syntax: DatabaseObject.Execute(Query, Options)</strong></em>. The <strong>Query</strong>
 argument is necessary to specify, it is a string value representing the
 name of the action query you want to run or an SQL statement you want 
to execute. The <strong>Options</strong> argument is optional, and can 
be any of the specified constants viz. dbInconsistent (Default - 
Executes inconsistent updates),  dbDenyWrite (write permission denied to
 other users),  dbFailOnError (updates are rolled back on accurence of 
an error), and so on. Note that you can run only action queries using 
the Execute method.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;">You can run the <strong>Execute method</strong> both from a QueryDef object (QueryDef.Execute Method) or a Database object (Database.Execute Method). <em><strong>Syntax for QueryDef.Execute Method: QueryDefObject.Execute(Options)</strong></em>.</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 13: Use the DAO Execute Method to run an action query, from a QueryDef object or a Database object.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 13a &amp; 13b, as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 593px;"><img class="caption" title="Image 13a" src="11.png" alt="" border="0"><p class="img_caption">Image 13a</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 594px;"><img class="caption" title="Image 13b" src="12.png" alt="" border="0"><p class="img_caption">Image 13b</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_ExecuteActionQuery_13()</strong><br><span style="color: #008000;">'Use the DAO Execute Method to run an action query, from a QueryDef object or a Database object.</span><br><span style="color: #008000;">'refer Image 13a to view the existing SalesManager Table in MS Access file "SalesReport.accdb".</span><br><span style="color: #008000;">'refer Image 13b to view the SalesManager Table, after running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim recSet As DAO.Recordset<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.Workspaces(0).OpenDatabase(strDB)<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'SQL
 statement assigned to the variable (strSQL). The sql will change the 
FirstName from John to Johnny in the SalesManager table.</span><br>strSQL = <span style="color: #333333;">"UPDATE</span> SalesManager SET FirstName = <span style="color: #333333;">'Johnny'</span> WHERE FirstName = <span style="color: #333333;">'John'"</span><br><br><span style="color: #008000;">'Specify
 QueryName and SQLText while creating the QueryDef object. The QueryDef 
object is automatically appended to the QueryDefs collection.</span><br>Set qryD = daoDB.CreateQueryDef("sqlQuery", strSQL)<br>MsgBox "query created"<br><br><span style="color: #008000;">'run an action query using the Database.Execute Method:</span><br>daoDB.Execute "sqlQuery"<br><span style="color: #008000;">'alternate code to run the action query:</span><br><span style="color: #008000;">'qryD.Execute</span><br>MsgBox "query executed"<br><br><span style="color: #008000;">'----</span><br><span style="color: #008000;">'set recordset:</span><br>Set recSet = daoDB.OpenRecordset("SalesManager")<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'return the FirstName field of each record in the Recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Do While Not recSet.EOF</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">recSet.MoveNext</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Loop</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'delete the QueryDef object:</span><br><span style="color: #008000;">'daoDB.QueryDefs.Delete ("sqlQuery")</span><br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>recSet.Close<br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing<br>Set qryD = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set recSet = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 14: Use the DAO Database.Execute Method to execute an SQL statement, from a Database object.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 13a &amp; 14, as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 593px;"><img class="caption" title="Image 14" src="13.png" alt="" border="0"><p class="img_caption">Image 14</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_ExecuteSqlStatement_14()</strong><br><span style="color: #008000;">'Use the DAO Database.Execute Method to execute an SQL statement, from a Database object.</span><br><span style="color: #008000;">'refer Image 13a to view the existing SalesManager Table in MS Access file "SalesReport.accdb".</span><br><span style="color: #008000;">'refer Image 14 to view the SalesManager Table, after running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim recSet As DAO.Recordset<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.Workspaces(0).OpenDatabase(strDB)<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'Execute an SQL Statement (action sql) using the Database.Execute Method:</span><br><span style="color: #008000;">'The sql statement will change the FirstName from John to Johnny in the SalesManager table.</span><br>daoDB.Execute "UPDATE SalesManager SET FirstName = <span style="color: #333333;">'Johnny'</span> WHERE FirstName = <span style="color: #333333;">'John'"</span><br>MsgBox "sql executed"<br><br><span style="color: #008000;">'----</span><br><span style="color: #008000;">'set recordset:</span><br>Set recSet = daoDB.OpenRecordset("SalesManager")<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><span style="color: #008000;">'return the FirstName field of each record in the Recordset:</span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Do While Not recSet.EOF</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">MsgBox recSet.Fields("FirstName")</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 90px; margin: 0px;">recSet.MoveNext</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Loop</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;"><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>recSet.Close<br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set recSet = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: medium; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><strong>Example 15: Use the DAO QueryDef.Execute Method to run a Parameter Action Query, from a QueryDef object.</strong></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><em>Refer Images 13a &amp; 15, as mentioned in the code.</em></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"><span style="color: #333333;"><strong><div class="img_caption none" style="float: none; width: 592px;"><img class="caption" title="Image 15" src="14.png" alt="" border="0"><p class="img_caption">Image 15</p></div></strong></span></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px; margin: 0px;"> </p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>Sub AccessDAO_ExecuteParameterQuery_15()</strong><br><span style="color: #008000;">'Use the DAO QueryDef.Execute Method to run a parameter action query, from a QueryDef object.</span><br><span style="color: #008000;">'refer Image 13a to view the existing SalesManager Table in MS Access file "SalesReport.accdb".</span><br><span style="color: #008000;">'refer Image 15 to view the SalesManager Table, after running below code.</span><br><br><span style="color: #008000;">'To
 use DAO in your Excel VBA project, you must add a reference to the DAO 
Object Library in Excel (your host application) by clicking 
Tools-References in VBE.</span><br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Dim strMyPath As String, strDBName As String, strDB As String, strSQL As String<br>Dim daoDB As DAO.Database<br>Dim recSet As DAO.Recordset<br>Dim qryD As DAO.QueryDef<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'your data source with which to establish connection - ENTER the MS Access Database Name:</span><br>strDBName = <span style="color: #333333;">"SalesReport.accdb"</span><br><span style="color: #008000;">'get path / location of the database, presumed to be in the same location as the host workbook:</span><br>strMyPath = ThisWorkbook.Path<br><span style="color: #008000;">'set the string variable to the Database:</span><br>strDB = strMyPath &amp; "\" &amp; strDBName<br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'assign the database reference to an object variable:</span><br>Set daoDB = DBEngine.Workspaces(0).OpenDatabase(strDB)<br><br><span style="color: #008000;">'A
 parameter query is one in which the user is prompted to enter some 
information, such as selection criteria for records or a field value to 
be inserted.</span><br><span style="color: #008000;">'SQL Parameterized query, is constructed with parameters, and assigned to the variable (strSQL).</span><br>strSQL = <span style="color: #333333;">"PARAMETERS</span> startDate DateTime, endDate DateTime; DELETE * FROM SalesManager WHERE JoinDate between startDate and endDate"<br><br><span style="color: #008000;">'Create
 a QueryDef object, with the parameter query name "ParamQuery". The 
QueryDef object is automatically appended to the QueryDefs collection.</span><br>Set qryD = daoDB.CreateQueryDef("ParamQuery", strSQL)<br>MsgBox "query created"<br><br><span style="color: #008000;">'enter parameters for the parameter query and run query using the Execute Method:</span><br>qryD.Parameters("[startDate]") = <span style="color: #333333;">"01/01/2009"</span><br>qryD.Parameters("[endDate]") = <span style="color: #333333;">"12/31/2010"</span><br>qryD.Execute<br>MsgBox "query executed"<br><br><span style="color: #008000;">'delete the QueryDef object:</span><br><span style="color: #008000;">'daoDB.QueryDefs.Delete ("ParamQuery")</span><br><br><span style="color: #008000;">'---------------</span><br><span style="color: #008000;">'close the objects:</span><br>daoDB.Close<br><br><span style="color: #008000;">'destroy the variables:</span><br>Set daoDB = Nothing</p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 60px; margin: 0px;">Set qryD = Nothing<br><br></p>
<p style="font-size: small; font-style: normal;  font-weight: normal; font-variant: normal; color: #000000; word-spacing: normal; letter-spacing: normal; text-align: left; white-space: normal; display: block; padding: 0px 0px 0px 30px; margin: 0px;"><strong>End Sub</strong></p>
</body>
</html></p></body></html>