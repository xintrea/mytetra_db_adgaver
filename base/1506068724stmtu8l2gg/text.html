<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'==================================================================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'==================================================================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'Диалог выбора файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'==================================================================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">Function Get_Open_File() As String 'Выбор файла для обработки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'    Call Create_Catalogs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Dim oFD As FileDialog</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Dim x, lf As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    'Открыть диалог выбора файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    Set oFD = Application.FileDialog(msoFileDialogFilePicker)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    With oFD 'используем короткое обращение к объекту</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .AllowMultiSelect = False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .Title = &quot;Выбрать файлы отчетов&quot; 'заголовок окна диалога</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .ButtonName = &quot;Выбрать файлы Excel&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .Filters.Clear 'очищаем установленные ранее типы файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .Filters.Add &quot;Excel files&quot;, &quot;*.xlsx*;*.xls*&quot;, 1 'устанавливаем возможность выбора только файлов Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .FilterIndex = 1 'устанавливаем тип файлов по умолчанию - Text files(Текстовые файлы)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .InitialFileName = Folder_Path '&amp; &quot;nonSSARDetail&quot; '&quot;C:\Temp\Книга1.xlsx&quot; 'назначаем папку отображения и имя файла по умолчанию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        .InitialView = msoFileDialogViewDetails 'вид диалогового окна(доступно 9 вариантов)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        If .Show = 0 Then Exit Function 'показывает диалог</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        Get_Open_File = .SelectedItems(1) 'считываем полный путь к файлу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        File_Open_Path = .InitialFileName     'считываем папку с файлом</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">        'Workbooks.Open x 'открытие книги</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; font-size:9pt; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">    End With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">End Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:18px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; font-size:9pt; color:#6a1009;">'==================================================================</span></p></body></html>