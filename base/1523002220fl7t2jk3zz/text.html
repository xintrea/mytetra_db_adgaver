<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://opennotes.ru/knowledge/vba-knowledge/kak-dobavit-liniyu-urovnya-na-grafik-s-pomoshhyu-vba/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">Как добавить линию уровня на график с помощью VBA?</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">								</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Задача:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> необходимость добавить к графику горизонтальную линию на уровне определенного значения одной из осей. Для решения этой задачи можно либо составить ряд одинаковых чисел и добавить соответствующий график на диаграмму, либо воспользоваться VBA:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td bgcolor="#eff0f1">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">Const Num = 0.8 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Значение уровня</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> objSeries </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Series</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> arrValues()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">ActiveWorkbook.Sheets(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Имя_листа&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">).ChartObjects(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#800000;">&quot;Имя_диаграммы&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">).Activate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">arrValues = ActiveChart.SeriesCollection(1).Values</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> i = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">LBound</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">(arrValues) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">To</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">UBound</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">(arrValues)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   arrValues(i) = Num</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#8d38c9;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; font-weight:600; color:#151b8d;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> objSeries = ActiveChart.SeriesCollection.NewSeries</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">objSeries.Values = arrValues</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">objSeries.ChartType = xlLine</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-weight:600;">Источник:</span> <a href="http://www.programmingforum.ru/vba/thread818592.html"><span style=" text-decoration: underline; color:#0000ff;">Форум программистов</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr></table></body></html>