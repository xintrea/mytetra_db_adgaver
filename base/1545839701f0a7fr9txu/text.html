<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<h3></h3><h3>SQL Server 2012 querying Access 2007 data using OPENROWSET error</h3><h3>Ask Question</h3><h3>4</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">I would like to query data in Management Studio from a Microsoft Access 2007 database located on the same machine as my SQL Server 2012 instance. I do NOT want to use a linked server to do this as different Access databases can be chosen by the user. I am following the directions found on technet and other sources I have read said to use OPENROWSET as the proper way to do what I want, but when I execute this in Management Studio...</p><h3></h3><h3>SELECT *</h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0',</p><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      'C:\Users\oliver.klosoff\Desktop\New folder\41000-13-0085 Consolidated Killers LLC.mdb';</p><h3>      'admin';'',tblTtlHrsFringes);</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">...I get the error below:</p><h3></h3><h3>Msg 7302, Level 16, State 1, Line 1</h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Cannot create an instance of OLE DB provider &quot;Microsoft.Jet.OLEDB.4.0&quot; for linked server &quot;(null)&quot;.</p><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The database does not have a password set for the admin user, and the admin user has permissions to read this table. Access 2007 32bit is installed on the machine, which is 64 bit, as well as the SQL Server instance. I believe that SQL Server can access the database file because when I get 1 when I execute this:</p><h3></h3><h3>DECLARE @out INT</h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">EXEC master.dbo.xp_fileexist 'C:\Users\oliver.klosoff\Desktop\New folder\41000-13-0085    Consolidated Killers LLC.mdb', @out OUTPUT</p><h3>SELECT @out`</h3><h3></h3><h3>Is there a way to do what I am trying to accomplish?</h3><h3>sql-server ms-access sql-server-2012 ms-access-2007</h3><h3>shareimprove this question</h3><h3>edited Nov 9 '14 at 14:43</h3><h3>Gord Thompson</h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">76.3k1389213</p><h3>asked Jan 28 '14 at 18:00</h3><h3>RoastBeast</h3><h3>58511230</h3><h3>add a comment</h3><h3>4 Answers</h3><h3>active</h3><h3>oldest</h3><h3>votes</h3><h3>1</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Finally, after several unsuccessful attempts to have SQL Server &quot;talk to&quot; an Access database – either as a &quot;Linked Server&quot; in SSMS or via OPENROWSET() in T-SQL – I found this blog post that offered the following three (3) suggestions.</p><h3>Tweak #1: OLE DB Provider settings</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">The OLE DB Provider for ACE (or Jet) must have the &quot;Dynamic parameter&quot; and &quot;Allow inprocess&quot; options enabled. In SSMS, open the</p><h3></h3><h3>Server Objects &gt; Linked Servers &gt;Providers</h3><h3></h3><p style="margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">branch, right-click &quot;Microsoft.ACE.OLEDB.12.0&quot; (or &quot;Microsoft.Jet.OLEDB.4.0&quot;), choose &quot;Properties&quot;, and ensure that those options are selected:</p></p></body></html>