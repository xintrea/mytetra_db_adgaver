<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Средствами VBA в программном режиме можно создавать не только объекты Access: <span style=" font-style:italic;">таблицы, формы, запросы</span>, но и такие элементы управления, как <span style=" font-style:italic;">Кнопки</span>, <span style=" font-style:italic;">Надпись</span> и др., что позволяет существенно повысить уровень <a href="http://click02.price.ru/click.jsp?url=*HFuhluBU6zqg7-6GTCSlYgJFa1t0yjlZg0hcN2DgJT3Q7Ok2NJBvl81lb*4XLkPPe6WbSC2TGbT7qcWmRdZKlL0Ix*UzMCqjBqPYhnflyMGZHmBhliZQLuKbKJ0bAcNz1siYdRo7wxYhwJKHajRCxzwrt02ksbdzfYNx4fV6Wf8Uvv0r2I3c3*SY64N-vsCkieGoK3xsflrvQa7PitxagSIXdNCmKUWrpNovgmnKebNdspdfVA0*87GtJr-EppIfkwPZ*uZ9w3zSq2D6P6lOy5D9Cw4Vm7Y9Rq2QyWdaQn5*YfhAEc66fMq9p6qhnDMyvIyAzDGIiNBu3fm-hmc683IYF7PhVD6eprZsAy-EudpZo3M*bRemfjpmAzNea6rWtKyVYbcqjP8d7VSVsX3pIPAF*WAwpgnYHOmwH7wVe-XarfR90SV-bUXEO0PvqvumMMF*JI8FHT6nEoKQFySXEndXLaBx-ypeT35hidSwh7SeLjBHpAehcOH06agCjVs1Y2zhhEXAZDr4mKYnAV31hmnmrRsMGxPWHDF7jnFe5dJ27Lq6-9iSt4AF6g7pfV3fmeCSwkWJfF1haBvSCEQKT9N5b*1fgw8rAnhP9rz7unbMWlMYl6KFZDrJO1llDgwlS5UNlIaw0YIK64kQTd*w4FT5g7Ubm3t2ZghctXtxlQItwDEZUqhBGvQLX2mufkXnyZYFZC-nEw-mOYuSTR2xx0Rs6pHiZxqCpGnA01cda9HZ7QpsI1qAvkuKO3lZ2knH1bHSIFXDotUGr6MxXj0VSmgJ7Z6TZJPyVmRhxXWy0ElAEVk6nrMFJ7hLgZewPYRYtweHXA*MrUcN2ESY*e9Zvyj*CCwaCzCbvUfDFhw3JG*DnUSa5x2RorSj5fA5rUJmJf5Fz1RDb9lk1TdFmvxbH7x8DQ4CVrcEmPJwRQwFmZJEVUllfC1OQyLGUnE75bjtmnw-t5vZTBIPt0Gj5FOsY5mEGS2fn9t*phmPfs9iTP4jAqDxT0ftEtyVg1cqahmSBn98M5hg74MSt4nNIP0E7VesrTZOnuMIr35j7xCUbZXXpm1C4ri9IUGGC4BS-o4Me**29vNCCloUWkb7-HlVtXM0bm-PMyrltB1WyY72ykLiKzwG-Qv9MmpbphC3TVmH2dgw36gMftIiGh1NDInQfptTOWph1f5NU51k88CDVurz2gmE3bGiOOP96GiWQLsAgAAALrcvAoAAAAA&amp;eurl%5B%5D=SntnSZTG71vEy*VDvPvzeftPtxZjZlOBW1Gx21hYS5BBAl9tyffc1XM8M2VY3rXu6Z6Oa7fnKbWqHMtoCRDcvQIAAAC63LwKAAAAAA&amp;click_time=&amp;mousedown_time=&amp;mouseover_count=4&amp;mouseover_time=1513758477203"><span style=" text-decoration: underline; color:#0000ff;">автоматизации</span></a> работы приложения. Ниже даны примеры создания некоторых объектов и элементов управления, приведены программы. По тексту программ даны необходимые пояснения. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Создание таблицы.</span>Пусть, требуется создать в текущей базе данных таблицу <span style=" font-style:italic;">Elise</span> со следующими полями: <span style=" font-style:italic;">Код, Фамилия вкладчика, Домашний адрес, Сумма вклада, Срок заключения договора, ме</span>с. Для решения данной задачи необходимо:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">- в процедуре создать объектные переменные <span style=" font-style:italic;">db</span>, <span style=" font-style:italic;">tb</span> типа Database, TableDef и <span style=" font-style:italic;">f1, f2, f3, f4</span> типа Field, предназначенные для хранения ссылок на соответствующие объекты базы данных;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">- для создания нового объекта TableDef – таблицы с именем <span style=" font-style:italic;">Elise</span> нужно применить метод CreateTableDef к объектной переменной <span style=" font-style:italic;">db. </span>Для создания новых объектов Field – полей таблицы, нужно применить метод CreateField к объектным переменным <span style=" font-style:italic;">f1, f2, f3, f4</span>;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">- для добавления этих полей в семейство Fields, входящих в объект TableDef нужно использовать метод Append;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">- для добавления таблицы – объекта TableDef в семейство TableDefs нужно использовать метод Append;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Процедура решения этой задачи с использованием библиотеки DAO приведена ниже</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Public Sub Создание_таблицы()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">‘ Описание переменных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim db As Database</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim tb As TableDef</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim f1, f2, f3, f4, f5 As field</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set db = CurrentDb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">‘Создание таблицы и ее полей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set tb = db.CreateTableDef(&quot;Elise&quot;)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set f1 = tb.CreateField(&quot;Код&quot;, dbInteger)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set f2 = tb.CreateField(&quot;Фамилия вкладчика&quot;, dbText)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set f3 = tb.CreateField(&quot;Домашний адрес&quot;, dbText)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set f4 = tb.CreateField(&quot;Сумма вклада&quot;, dbCurrency)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set f5 = tb.CreateField(&quot;Срок заключения договора, мес&quot;, dbInteger) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">‘Добавление полей в таблицу</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">tb.Fields.Append f1</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">tb.Fields.Append f2</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">tb.Fields.Append f3</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">tb.Fields.Append f4</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">tb.Fields.Append f5</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">‘Добавление таблицы в БД</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">db.TableDefs.Append tb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Создание формы.</span>При создании форм за единицу измерениявMicrosoft Accessберут<span style=" font-style:italic;"> Твип (twip).</span>Один твип равен 1/1440 дюйма. В одном сантиметре содержится 567 твипов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пусть требуется<span style=" font-weight:600;">с</span>редствами VBA создать форму на основе таблицы <span style=" font-style:italic;">КАФЕДРА</span> только без фото. Процедура решения этой задачи с использованием библиотеки DAO приведена ниже</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Public Sub Создание_формы()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim frm As Form 'Определение объектной переменной для формы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set frm = CreateForm 'Создание новой формы и ссылки на переменную</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">frm.RecordSource = &quot;КАФЕДРА&quot; 'Источник данных в форме</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">'Определение объектных переменных для элементов управления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim c1, c2, c3, c4, t1, t2, t3, t4, n1 As Control</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">frm.Caption = &quot;КАФЕДРАVBA&quot; ' Имя файла</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">'Создание элементов управления типа надпись</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set t1 = CreateControl(frm.Name, acLabel, , , , 100, 1000, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">t1.Caption = &quot;Код кафедры:&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set t2 = CreateControl(frm.Name, acLabel, , , , 100, 1300, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">t2.Caption = &quot;Название:&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set t3 = CreateControl(frm.Name, acLabel, , , , 100, 1600, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">t3.Caption = &quot;Телефон:&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set t4 = CreateControl(frm.Name, acLabel, , , , 100, 1900, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">t4.Caption = &quot;Зав кафедрой:&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">'Создание элементов управления типа поле</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set c1 = CreateControl(frm.Name, acTextBox, , , , 1500, 1000, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">c1.ControlSource = &quot;Код кафедры&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set c2 = CreateControl(frm.Name, acTextBox, , , , 1500, 1300, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">c2.ControlSource = &quot;Название&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set c3 = CreateControl(frm.Name, acTextBox, , , , 1500, 1600, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">c3.ControlSource = &quot;Телефон&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set c4 = CreateControl(frm.Name, acTextBox, , , , 1500, 1900, 1300, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">c4.ControlSource = &quot;Зав кафедрой&quot;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set n1 = CreateControl(frm.Name, acLabel, , , , 1400, 300, 700, 200)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">n1.Caption = &quot;КАФЕДРА&quot; 'Имя формы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">DoCmd.Restore</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Создание запроса.</span>Требуетсясредствами VBA создать запрос <span style=" font-style:italic;">МАКС</span> по таблице <span style=" font-style:italic;">ТОВАРЫ </span>для выборки записей в которых <span style=" font-style:italic;">Стоимость товара</span> больше определенной нижней границы. Граница вводится в окно диалога. Процедура решения этой задачи с использованием библиотеки DAO приведена ниже</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Public Sub Создание_запроса_VBA()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim db As Database</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Dim q As QueryDef</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set db = CurrentDb</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">' Создается запрос с именем Макс</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Set q = db.CreateQueryDef(&quot;Макс&quot;, &quot;Select *&quot; _</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">&amp; &quot;from Товары where [Стоимость товара] &gt;” &amp; _ </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">“ [Введите нижнюю границу стоимости товара];&quot;) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">End Sub</span></p></body></html>