<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Я тут нарисовал такой Sanek_81.dqy<br /></p>
<p style=" margin-top:5px; margin-bottom:2px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;">Код:</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">XLODBC</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">DSN=Excel Files;DBQ=C:\temp\Sanek_81\test.xls;DefaultDir=C:\temp\Sanek_81;DriverId=790;MaxBufferSize=2048;PageTimeout=5;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">SELECT `Лист3$`.`test ok`, `Лист3$`.F2, `Лист3$`.`test ok1`, `Лист3$`.`test ok2`, `Лист3$`.`test ok3`  FROM `C:\temp\Sanek_81\test`.`Лист3$` `Лист3$`  WHERE (`Лист3$`.F2=1)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">test ok	F2	test ok1	test ok2	test ok3</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подправить пути, сохранить текст как имя.dqy, запустить.<br />Работает, но вытягивает только данные-цифры. Т.е. выбрал такие две строки, если единичку к семёркам поставить:<br /></p>
<p style=" margin-top:5px; margin-bottom:2px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;">Код:</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">7	1	7	7	7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Может пригодится...<br /><br />P.S. А почему именно SQL?<br />Я как-то массивами обхожусь - и быстрее получается, и код как хочешь можно повернуть...</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'------------------------------------------------------------------------------------------------------------------------</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Послушайтесь совета<span style=" font-weight:600;"> Hugo121</span>.У вас данные должны быть сохранены как текст,иначе возьмет только числа</p>
<p style=" margin-top:5px; margin-bottom:2px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;">Код:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Public Const sCn1 = &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Public Const sCn2 = &quot;;Extended Properties=&quot;&quot;Excel 8.0;HDR=No&quot;&quot;;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Public Sub Go_Junior()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Dim cn As ADODB.Connection, rs As ADODB.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Dim sCon As String, n As Long, sCon_R As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Set cn = New ADODB.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Set rs = New ADODB.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">  sCon = sCn1 + ThisWorkbook.FullName + sCn2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    cn.Open sCon</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> If Not cn.State = 1 Then Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">   sSql = &quot;SELECT F1, F2, F3, F4, F5  &quot; + _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    &quot; FROM [Лист3$A1:E5] T &quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">    &quot;WHERE F2 Like '1' ;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     rs.Open sSql, cn, adOpenStatic, adLockReadOnly</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Лист1.Cells(1, 1).CopyFromRecordset rs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">rs.Close</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> cn.Close</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Set cn = Nothing</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Set rs = Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">End Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:20px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>