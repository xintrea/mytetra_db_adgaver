<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/FilenamesCollection"><span style=" text-decoration: underline; color:#0000ff;">Получение списка файлов в папке и подпапках средствами VBA</span></a><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/processing_files"><span style=" text-decoration: underline; color:#0000ff;">Обработка файлов</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/hyperlinks"><span style=" text-decoration: underline; color:#0000ff;">Гиперссылки</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/filenames"><span style=" text-decoration: underline; color:#0000ff;">Список файлов</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/Windows"><span style=" text-decoration: underline; color:#0000ff;">Средства Windows</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/files"><span style=" text-decoration: underline; color:#0000ff;">Работа с файлами</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/different"><span style=" text-decoration: underline; color:#0000ff;">Разное</span></a> </li></ul></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image4993.png" /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Функция VBA для получения списка файлов из папки,<br />с учётом выбранной глубины поиска в подпапках</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Пример в файле </span><a href="http://excelvba.ru/system/files/FilenamesCollection.xls"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">FilenamesCollection.xls</span></a><span style=" font-size:8.25pt;"> выводит список файлов на чистый лист новой книги (формируя заголовки) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Пример в файле </span><a href="http://excelvba.ru/system/files/FilenamesCollectionEx.xls"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">FilenamesCollectionEx.xls</span></a><span style=" font-size:8.25pt;"> более функционален - он, помимо списка файлов из папки, </span><span style=" font-size:8.25pt; font-weight:600;">отображает размер файла, и дату его создания, а также формирует в ячейках гиперссылки на найденные файлы</span><span style=" font-size:8.25pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Вывод списка производится на лист запуска, параметры поиска файлов задаются в ячейках листа (см. скриншот)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">ПРИМЕЧАНИЕ: Если вы выводите на лист список имен файлов картинок (изображений), то при помощи </span><a href="http://excelvba.ru/code/InsertPicturesEx"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">этой надстройки</span></a><span style=" font-size:8.25pt; font-weight:600;"> вы сможете вставить сами картинки в ячейки соседнего столбца (или в примечания к этим ячейкам)</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Ознакомьтесь также с </span><a href="http://excelvba.ru/code/FilenamesList"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">надстройкой для загрузки списка файлов из заданной папки</span></a><span style=" font-size:8.25pt; font-weight:600;">,</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">выполненной на основе функции FilenamesCollection,<br />а также со </span><a href="http://excelvba.ru/programmes/FilenamesWithValues"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">способом добавления в таблицу значений ячеек из найденных файлов</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Внимание:</span><span style=" font-size:8.25pt;"> если требуется, чтобы поиск не зависел от регистра символов в маске файла<br />(к примеру, обнаруживались не только файлы </span><span style=" font-size:8.25pt; font-weight:600;">.txt</span><span style=" font-size:8.25pt;">, но и </span><span style=" font-size:8.25pt; font-weight:600;">.TXT</span><span style=" font-size:8.25pt;"> и </span><span style=" font-size:8.25pt; font-weight:600;">.Txt</span><span style=" font-size:8.25pt;">),<br />поставьте первой строкой в модуле директиву </span><span style=" font-size:8.25pt; font-weight:600;">Option Compare Text</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FilenamesCollection(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FolderPath </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Optional</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Mask </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span><span style=" font-family:'monospace'; font-size:8.25pt;"> = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                             </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Optional</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> SearchDeep </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Long</span><span style=" font-family:'monospace'; font-size:8.25pt;"> = 999) </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Получает в качестве параметра путь к папке FolderPath,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' маску имени искомых файлов Mask (будут отобраны только файлы с такой маской/расширением)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' и глубину поиска SearchDeep в подпапках (если SearchDeep=1, то подпапки не просматриваются).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Возвращает коллекцию, содержащую полные пути найденных файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' (применяется рекурсивный вызов процедуры GetAllFileNamesUsingFSO)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FilenamesCollection = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">New</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' создаём пустую коллекцию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FSO = CreateObject(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' создаём экземпляр FileSystemObject</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    GetAllFileNamesUsingFSO FolderPath, Mask, FSO, FilenamesCollection, SearchDeep </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' поиск</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FSO = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Nothing</span><span style=" font-family:'monospace'; font-size:8.25pt;">: Application.StatusBar = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">False</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' очистка строки состояния Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:8.25pt;"> GetAllFileNamesUsingFSO(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FolderPath </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Mask </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByRef</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FSO, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                                 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByRef</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FileNamesColl </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> SearchDeep </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Long</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебирает все файлы и подпапки в папке FolderPath, используя объект FSO</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебор папок осуществляется в том случае, если SearchDeep &gt; 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' добавляет пути найденных файлов в коллекцию FileNamesColl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:8.25pt;">: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> curfold = FSO.GetFolder(FolderPath)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Not</span><span style=" font-family:'monospace'; font-size:8.25pt;"> curfold </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Is</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Nothing</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' если удалось получить доступ к папке</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' раскомментируйте эту строку для вывода пути к просматриваемой</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' в текущий момент папке в строку состояния Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Application.StatusBar = &quot;Поиск в папке: &quot; &amp; FolderPath</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:8.25pt;"> fil </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:8.25pt;"> curfold.Files    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебираем все файлы в папке FolderPath</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> fil.Name </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Like</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;*&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; Mask </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FileNamesColl.Add fil.Path</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        SearchDeep = SearchDeep - 1    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' уменьшаем глубину поиска в подпапках</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> SearchDeep </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' если надо искать глубже</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sfol </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:8.25pt;"> curfold.SubFolders    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебираем все подпапки в папке FolderPath</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                GetAllFileNamesUsingFSO sfol.Path, Mask, FSO, FileNamesColl, SearchDeep</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> fil = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Nothing</span><span style=" font-family:'monospace'; font-size:8.25pt;">: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> curfold = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Nothing</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' очищаем переменные</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">' Пример использования функции в макросе:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ОбработкаФайловИзПапки()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> folder$, coll </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    folder$ = ThisWorkbook.Path &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;\Платежи\&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Dir(folder$, vbDirectory) = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        MsgBox </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Не найдена папка «&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; folder$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;»&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, vbCritical, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Нет папки ПЛАТЕЖИ&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Exit</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выход, если папка не найдена</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll = FilenamesCollection(folder$, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;*.xls&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' получаем список файлов XLS из папки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll.Count = 0 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        MsgBox </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;В папке «&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; Split(folder$, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;\&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">UBound</span><span style=" font-family:'monospace'; font-size:8.25pt;">(Split(folder$, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;\&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)) - 1) &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;» нет ни одного подходящего файла!&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">               vbCritical, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Файлы для обработки не найдены&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Exit</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выход, если нет файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебираем все найденные файлы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:8.25pt;"> file </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        Debug.</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Print</span><span style=" font-family:'monospace'; font-size:8.25pt;"> file        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим имя файла в окно Immediate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Этот код позволяет осуществить поиск нужных файлов в выбранной папке (включая подпапки), и выводит полученный список файлов на лист книги Excel:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ПримерИспользованияФункции_FilenamesCollection()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Ищем на рабочем столе все файлы TXT, и выводим на лист список их имён.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Просматриваются папки с глубиной вложения не более трёх.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span><span style=" font-family:'monospace'; font-size:8.25pt;">, ПутьКПапке </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' получаем путь к папке РАБОЧИЙ СТОЛ</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    ПутьКПапке = CreateObject(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;WScript.Shell&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">).SpecialFolders(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Desktop&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' считываем в колекцию coll нужные имена файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll = FilenamesCollection(ПутьКПапке, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;.txt&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, 3)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    Application.ScreenUpdating = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">False</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' отключаем обновление экрана</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' создаём новую книгу</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sh </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Worksheet: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sh = Workbooks.Add.Worksheets(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' формируем заголовки таблицы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">With</span><span style=" font-family:'monospace'; font-size:8.25pt;"> sh.Range(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;a1&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">).Resize(, 3)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        .Value = Array(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;№&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Имя файла&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Полный путь&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        .Font.Bold = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">True</span><span style=" font-family:'monospace'; font-size:8.25pt;">: .Interior.ColorIndex = 17</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим результаты на лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i = 1 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll.Count </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебираем все элементы коллекции, содержащей пути к файлам</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        sh.Range(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;a&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; sh.Rows.Count).</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;">(xlUp).Offset(1).Resize(, 3).Value = _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        Array(i, Dir(coll(i)), coll(i))    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим на лист очередную строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        DoEvents    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' временно передаём управление ОС</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    sh.Range(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;a:c&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">).EntireColumn.AutoFit    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' автоподбор ширины столбцов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    [a2].Activate: ActiveWindow.FreezePanes = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">True</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' закрепляем первую строку листа</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br /></span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Ещё один пример использования:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ЗагрузкаСпискаФайлов()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Ищем файлы в заданной папке по заданной маске,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' и выводим на лист список их параметров.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Просматриваются папки с заданной глубиной вложения.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span><span style=" font-family:'monospace'; font-size:8.25pt;">, ПутьКПапке$, МаскаПоиска$, ГлубинаПоиска%</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    ПутьКПапке$ = [c1]    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' берём из ячейки c1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    МаскаПоиска$ = [c2]    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' берём из ячейки c2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    ГлубинаПоиска% = Val([c3])    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' берём из ячейки c3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ГлубинаПоиска% = 0 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ГлубинаПоиска% = 999    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' без ограничения по глубине</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' считываем в колекцию coll нужные имена файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll = FilenamesCollection(ПутьКПапке$, МаскаПоиска$, ГлубинаПоиска%)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    Application.ScreenUpdating = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">False</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' отключаем обновление экрана</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим результаты (список файлов, и их характеристик) на лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i = 1 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll.Count    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' перебираем все элементы коллекции, содержащей пути к файлам</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        НомерФайла = i</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        ПутьКФайлу = coll(i)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        ИмяФайла = Dir(ПутьКФайлу)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        ДатаСоздания = FileDateTime(ПутьКФайлу)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        РазмерФайла = FileLen(ПутьКФайлу)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим на лист очередную строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        Range(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;a&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; Rows.Count).</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;">(xlUp).Offset(1).Resize(, 5).Value = _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        Array(НомерФайла, ИмяФайла, ПутьКФайлу, ДатаСоздания, РазмерФайла)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' если нужна гиперссылка на файл во втором столбце</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        ActiveSheet.Hyperlinks.Add Range(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;b&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; Rows.Count).</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;">(xlUp), ПутьКФайлу, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                                   </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Открыть файл&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine &amp; ИмяФайла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        DoEvents    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' временно передаём управление ОС</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">PS: Найти подходящие имена файлов в коллекции можно при помощи следующей функции:<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:8.25pt;"> CollectionAutofilter(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByRef</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> filter$) </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Функция перебирает все элементы коллекции coll,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' оставляя лишь те, которые соответствуют маске filter$ (например, filter$=&quot;*некий текст*&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Возвращает коллекцию, содержащую только подходящие элементы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' Если элементы не найдены - возвращается пустая коллекция (содержащая 0 элементов)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:8.25pt;">: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:8.25pt;"> CollectionAutofilter = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">New</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Item </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:8.25pt;"> coll</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Item </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Like</span><span style=" font-family:'monospace'; font-size:8.25pt;"> filter$ </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;"> CollectionAutofilter.Add Item</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td></td>
<td></td>
<td></td>
<td></td></tr></thead></table>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Вложение</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Размер</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Загрузки</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Последняя загрузка</span></p></td></tr></thead>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ExcelVBA.ru/sites/default/files/FilenamesCollection.xls"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">FilenamesCollection.xls</span></a></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">35 КБ</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10367</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4 часа 33 минуты назад</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://ExcelVBA.ru/sites/default/files/FilenamesCollectionEx.xls"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">FilenamesCollectionEx.xls</span></a></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">56 КБ</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9927</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5 часов 9 минут назад</span></p></td></tr></table></body></html>