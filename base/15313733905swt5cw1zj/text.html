<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div id="ctl10_ctl03_PanelHeader" style="width:100%;"><table id="table01" style="line-height: normal" width="100%" cellspacing="5" cellpadding="0" border="0"><tbody><tr><td class="page_header" valign="middle" align="left"><font color="#C91F49">Диспетчер связанных таблиц
                                                        </font>
        </td>
        <td rowspan="3" style="padding: 10px" valign="top" align="left">
            <a id="ctl10_ctl03_ImageLogo" class="HyperlinkCssLogo" title="Диспетчер связанных таблиц" href="http://www.leadersoft.ru/Rus/help/code/Products/11949/images/logo.gif"></a>  
                  </td>
    </tr>
    <tr>
        <td valign="top" align="left">
        <div id="modernbricksmenu2">
            <font color="#C91F49">
            <a id="ctl10_ctl03_img_left" class="img_left" href="http://www.leadersoft.ru/Rus/help/code/Default.aspx"><img src="1.png" style="border-width:0px;"></a>
            </font>
            <ul id="ctl10_ctl03_ProductMenu">
			<li id="current"><a href="http://www.leadersoft.ru/Rus/help/code/Default.aspx?go=product&amp;ProductID=11949">Описание</a></li><li><a href="http://www.leadersoft.ru/Rus/help/code/Default.aspx?go=product&amp;ProductID=11949&amp;t2=galary">Галерея</a></li>
		</ul>
        </div>
             </td>
    </tr>
    <tr>
        <td style="padding:15px;" valign="top" align="left">
            <span id="ctl10_ctl03_ProductDescription">18. Если у Вас 
интерфейс хранится в одной базе, а данные в другой, то необходимо 
научится привязывать базу к таблицам на сервере. Иначе пользователю, 
используя стандартный интерфейс будет очень трудно это сделать. В этом 
примере показано как это делается автоматически через программный код.</span>
        </td>
    </tr>
    </tbody></table>
            <div id="line_green2" class="line_green2">
            </div>

	</div>
<div>
<div id="ctl10_ctl03_ctl00_PanelLine" style="width:100%;">
		
            <table id="Table2" class="bg_line" width="100%" cellspacing="0" cellpadding="0" border="0">
                <tbody><tr>
                    <td style="width: 6px; height: 27px;" valign="top" nowrap="nowrap">
                        <img id="ctl10_ctl03_ctl00_Image2" src="2.png" style="border-width:0px;"></td>
                    <td class="text12" style="font-weight: bold; height: 27px;" width="100%">
                        <span id="ctl10_ctl03_ctl00_Label4" style="font-family:arial;font-size:Small;font-weight:bold;">Свойства продукта</span></td>
                    <td style="height: 27px" valign="middle" nowrap="nowrap">
                    </td>
                </tr>
            </tbody></table>

	</div>
<br>
<table id="ctl10_ctl03_ctl00_DataListProperty" style="font-weight:normal;width:100%;border-collapse:collapse;" cellspacing="0" border="0">
		<tbody><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl00_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl00_Label2">Microsoft Office: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl00_HyperLink1" style="color:Green;">2000,2002,2003,2007,2010</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl01_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl01_Label2">Архив с файлами: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl01_HyperLink1" href="http://www.leadersoft.ru/Rus/Market/Db/Default.aspx?go=product&amp;pid=60" style="color:#C00000;">Перейти</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl02_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl02_Label2">Операционная система: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl02_HyperLink1" style="color:Green;">Windows XP,Vista</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl03_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl03_Label2">Применение: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl03_HyperLink1" style="color:Green;">Базы данных Access</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl04_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl04_Label2">Продажа: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl04_HyperLink1" href="http://www.leadersoft.ru/Rus/Market/Db/Default.aspx?go=order&amp;pid=60" style="color:#C00000;">Купить</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl05_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl05_Label2">Файл исходника: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl05_HyperLink1" style="color:Green;">..\Access\15 Формы\la_form1.mdb</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl06_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl06_Label2">Язык интерфейса: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl06_HyperLink1" style="color:Green;">Русский</a>
    </td><td></td>
		</tr>
	</tbody></table>

<br>
            <table id="Table3" class="bg_line" width="100%" cellspacing="0" cellpadding="0" border="0">
                <tbody><tr>
                    <td style="width: 6px; height: 27px;" valign="top" nowrap="nowrap">
                         </td>
                    <td class="text12" style="font-weight: bold; height: 27px;" width="100%">
                         </td>
                    <td style="height: 27px" valign="middle" nowrap="nowrap">
                    </td>
                </tr>
            </tbody></table>
<br>

<font size="-1" face="Courier New"><font color="#0000aa">Private Sub </font>Form_Open(Cancel <font color="#0000aa">As Integer</font>)<br>
<font color="#0000aa">Dim </font>s <font color="#0000aa">As String</font>, tdf <font color="#0000aa">As </font>TableDef, dbs <font color="#0000aa">As </font>Database<br>
<font color="#0000aa">Dim </font>tdfName <font color="#0000aa">As String</font>, dbsName <font color="#0000aa">As String</font>, i <font color="#0000aa">As Integer</font><br>
    <font color="#0000aa">On Error GoTo </font>999<br>
    <font color="#0000aa">Set </font>dbs = CurrentDb <font color="#007700">'Выбор базы данных</font><br>
    dbs.Execute <font color="#660000">"DELETE * FROM [Пример 18]"</font> <font color="#007700">'Удаляем все записи</font><br>
    <font color="#007700">'Инициализация таймера загрузки</font><br>
    Application.SetOption <font color="#660000">"Строка состояния"</font>, <font color="#0000aa">True </font><font color="#007700">'Показываем строку</font><br>
    i = 1: SysCmd acSysCmdInitMeter, <font color="#660000">"Загрузка таблиц ..."</font>, dbs.TableDefs.Count<br>
    <font color="#0000aa">For Each </font>tdf <font color="#0000aa">In </font>dbs.TableDefs   <font color="#007700">'Просматриваем все таблицы</font><br>
        SysCmd acSysCmdUpdateMeter, i: i = i + 1 <font color="#007700">'Перерисовываем таймер</font><br>
        dbsName = funGetSubString(tdf.Connect, <font color="#660000">";DATABASE="</font>, <font color="#660000">";"</font>) <font color="#007700">'Находим связанную таблицу</font><br>
        <font color="#0000aa">If </font>(dbsName &lt;&gt; <font color="#660000">""</font>) <font color="#0000aa">Then</font><br>
            tdfName = tdf.Name <font color="#007700">'Имя таблицы</font><br>
            <font color="#007700">'Составляем запрос на добавление</font><br>
            s = <font color="#660000">"INSERT INTO [Пример 18] ( Вкл, Таблица, Файл ) SELECT "</font> &amp; _<br>
                <font color="#660000">"False AS Вкл, "</font><font color="#660000">""</font> &amp; _<br>
                tdfName &amp; <font color="#660000">""</font><font color="#660000">" AS Таблица,"</font><font color="#660000">""</font> &amp; _<br>
                dbsName &amp; <font color="#660000">""</font><font color="#660000">" AS Файл;"</font><br>
            dbs.Execute s <font color="#007700">'Добавляем в таблицу меню</font><br>
        <font color="#0000aa">End If</font><br>
    <font color="#0000aa">Next</font><br>
    SysCmd acSysCmdRemoveMeter <font color="#007700">'Удаляем таймер</font><br>
    Me.Requery <font color="#007700">'Изменяем запрос в форме</font><br>
    <font color="#0000aa">Exit Sub</font><br>
999:<br>
    SysCmd acSysCmdRemoveMeter <font color="#007700">'Удаляем таймер</font><br>
    MsgBox Err.Description <font color="#007700">'Сообщаем об ошибке</font><br>
    Err.Clear<br>
<font color="#0000aa">End Sub</font></font></div>
</body>
</html></p></body></html>