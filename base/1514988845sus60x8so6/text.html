<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сборник формул для условного форматирования </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В данной статье собран список формул, которые можно использовать в условном форматировании ячеек, заданным при помощи формулы:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#336600;">Excel 2003</span>: <span style=" font-weight:600;">Формат</span><span style=" font-weight:600; color:#888888;">(Format)</span>-<span style=" font-weight:600;">Условное форматирование</span><span style=" font-weight:600; color:#888888;">(Conditional formatting)</span>- <span style=" font-weight:600;">формула</span>;</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#336600;">Excel 2007-2010</span>: вкладка <span style=" font-weight:600;">Главная</span><span style=" font-weight:600; color:#888888;">(Home)</span>-<span style=" font-weight:600;">Условное форматирование</span><span style=" font-weight:600; color:#888888;">(Conditional formatting)</span>-<span style=" font-weight:600;">Создать правило</span><span style=" font-weight:600; color:#888888;">(New rule)</span>-<span style=" font-weight:600;">Использовать формулу для определения форматируемых ячеек</span><span style=" font-weight:600; color:#888888;">(Use a formula to determine which cells to format)</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подробнее об условном форматировании можно прочитать в статье: <a href="http://www.excel-vba.ru/chto-umeet-excel/osnovnye-ponyatiya-uslovnogo-formatirovaniya-i-kak-ego-sozdat/"><span style=" text-decoration: underline; color:#0000ff;">Основные понятия условного форматирования и как его создать</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все условия приведены для диапазона A1:A20. Это означает, что для корректного выполнения условия необходимо выделить диапазон A1:A20(столбцов может быть больше), начиная с ячейки A1, после чего назначить условие.<br />Если выделять необходимо не с первой строки, а скажем, с 4-ой, то и выделить надо будет диапазон A4:A20 и в формуле для условия указывать в качестве критерия первую ячейку выделенного диапазона - A4.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если необходимо выделять форматированием не только конкретную ячейку, удовлетворяющую условию, а всю строку таблицы на основе ячейки одного столбца, то перед установкой правила необходимо выделить всю таблицу, строки которой необходимо форматировать, а ссылку на столбец с критерием закрепить:<br />=$A1=МАКС($A$1:$A$20)<br />при выделенном диапазоне A1:F20(диапазон применения условного форматирования), будет выделена строка A7:F7, если в ячейке A7 будет максимальное число.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же можно применять не к конкретно одному столбцу, а к полностью диапазону. Но в этом случае надо знать принцип смещения ссылок в формулах, чтобы условия применялись именно к нужным ячейкам. Например, если задать условие для диапазона B1:D10 в виде формулы: =<span style=" color:#0000ff;">B1</span>&lt;<span style=" color:#008000;">A1</span>, то цветом будут выделены ячейки столбца B, если значение ячейки столбца А в той же строке меньше(B1&lt;A1, B3&lt;A3). При этом если ячейки столбца D меньше ячеек столбца C в той же строке - они тоже будут выделены(D1&lt;C1, D5&lt;C5). </p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" text-decoration: underline; color:#800000;">ЧИСЛОВЫЕ ЗНАЧЕНИЯ</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с числами:<br />=ЕЧИСЛО(A1)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с числами, но не учитывая нули:<br />=И(ЕЧИСЛО(A1);A1&lt;&gt;0)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение строк со значением больше 0:<br />=A1&gt;0</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение строк со значением в диапазоне от 3 до 10:<br />=И(A1&gt;=3;A1&lt;=10)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение в диапазоне $A$1:$A$20 ячейки с максимальным значением:<br />=A1=МАКС($A$1:$A$20)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение в диапазоне $A$1:$A$20 ячейки с минимальным значением:<br />=И(ЕЧИСЛО(A1);A1=МИН($A$1:$A$20))</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение в диапазоне $A$1:$A$20 ячейки со вторым по величине числом. Т.е. из чисел 1,2,3,4,5,6,7 будет выделено число 6:<br />=A1=НАИБОЛЬШИЙ($A$1:$A$20;2)</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"> <br /><span style=" text-decoration: underline; color:#800000;">ТЕКСТОВЫЕ ЗНАЧЕНИЯ</span></p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с любым текстом:<br />=ЕТЕКСТ(A1)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с текстом <span style=" font-weight:600;">Итог</span>:<br />=A1=&quot;Итог&quot;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, содержащих текст <span style=" font-weight:600;">Итог</span>:<br />=СЧЁТЕСЛИ(<span style=" color:#0000ff;">A1</span>;&quot;*итог*&quot;)<br />=НЕ(ЕОШ(ПОИСК(&quot;итог&quot;;<span style=" color:#0000ff;">A1</span>)))</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, не содержащих текст <span style=" font-weight:600;">Итог</span>:<br />=СЧЁТЕСЛИ(<span style=" color:#0000ff;">A1</span>;&quot;*итог*&quot;)=0<br />=ЕОШ(ПОИСК(&quot;итог&quot;;<span style=" color:#0000ff;">A1</span>))</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, текст которых начинается со слова <span style=" font-weight:600;">Итог</span>:<br />=ЛЕВСИМВ(<span style=" color:#0000ff;">A1</span>;4)=&quot;Итог&quot;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, текст которых заканчивается на слово <span style=" font-weight:600;">Итог</span>:<br />=ПРАВСИМВ(<span style=" color:#0000ff;">A1</span>;4)=&quot;Итог&quot;</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"> <br /><span style=" text-decoration: underline; color:#800000;">ДАТА / ВРЕМЯ</span></p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение текущей даты:<br />=<span style=" color:#0000ff;">A1</span>=СЕГОДНЯ()</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячейки с датой, больше текущей:<br />=<span style=" color:#0000ff;">A1</span>&gt;СЕГОДНЯ()</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячейки с датой, которая наступит через неделю:<br />=<span style=" color:#0000ff;">A1</span>=СЕГОДНЯ()+7</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с датами текущего месяца(любого года):<br />=МЕСЯЦ(<span style=" color:#0000ff;">A1</span>)=МЕСЯЦ(СЕГОДНЯ())</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с датами текущего месяца текущего года:<br />=И(МЕСЯЦ(<span style=" color:#0000ff;">A1</span>)=МЕСЯЦ(СЕГОДНЯ());ГОД(A1)=ГОД(СЕГОДНЯ()))<br /><span style=" font-weight:600;">или</span><br />=ТЕКСТ(A1;&quot;ГГГГММ&quot;)=ТЕКСТ(СЕГОДНЯ();&quot;ГГГГММ&quot;)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с выходными днями:<br />=ДЕНЬНЕД(<span style=" color:#0000ff;">A1</span>;2)&gt;5</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек с будними днями:<br />=ДЕНЬНЕД(<span style=" color:#0000ff;">A1</span>;2)&lt;6</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, входящих в указанный период(промежуток) дат:<br />=И($A1&gt;ДАТА(2015;9;1);$A1&lt;ДАТА(2015;10;1))</li>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"> <br /><span style=" text-decoration: underline; color:#800000;">ДРУГИЕ</span></p>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение различий в ячейках по условию:<br />=<span style=" color:#0000ff;">A1</span>&lt;&gt;<span style=" color:#008000;">$B1</span></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячейки, если ячейка следующего столбца(B) этой же строки меньше:<br />=<span style=" color:#0000ff;">A1</span>&gt;<span style=" color:#008000;">B1</span></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение строк цветом через одну:<br />=ОСТАТ(СТРОКА();2)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение строк цветом, если значение ячейки столбца <span style=" color:#0000ff;">A</span> присутствует в диапазоне <span style=" color:#008000;">$F$1:$H$5000</span>:<br />=СЧЁТЕСЛИ(<span style=" color:#008000;">$F$1:$H$5000</span>;<span style=" color:#0000ff;">A1</span>)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение строк цветом, если значение ячейки столбца <span style=" color:#0000ff;">A</span> отсутствует в диапазоне <span style=" color:#008000;">$F$1:$H$5000</span>:<br />=СЧЁТЕСЛИ(<span style=" color:#008000;">$F$1:$H$5000</span>;<span style=" color:#0000ff;">A1</span>)=0</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение цветом ячейки, если её значение в диапазоне <span style=" color:#0000ff;">A1:A20</span> второе по счету:<br />=СЧЁТЕСЛИ(<span style=" color:#0000ff;">$A$1:$A1</span>;<span style=" color:#0000ff;">A1</span> )=2</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение ячеек, содержащих ошибки (<span style=" font-weight:600;">#ЗНАЧ!</span>; <span style=" font-weight:600;">#Н/Д</span>; <span style=" font-weight:600;">#ССЫЛКА!</span> и т.п.). Помимо просто выявления ячеек с ошибками можно применять, когда необходимо скрыть ошибочные значения в ячейках(назначив цвет шрифта таким же, как и цвет заливки):<br />=ЕОШИБКА(<span style=" color:#0000ff;">A</span>)</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделение непустых ячеек в столбце <span style=" color:#0000ff;">A</span>:<br />=<span style=" color:#0000ff;">$A1</span>&lt;&gt;&quot;&quot;</li></ol></body></html>