<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">из справки <br />------------------------- <br />Функция WNetAddConnection модуль Windows <br />Группа ссылок: Net <br /><br />Описание: <br />function WNetAddConnection(lpRemoteName, lpPassword, lpLocalName: PChar): DWORD; <br /><br />Функция позволяет вызывающему приложению подключить локальное устройство к сетевому ресурсу. Система автоматически будет восстанавливать связь при передачи и логине(LogIn). <br />Эта функция введена для совместимости с Win16-приложениями. Вы должны вызывать WNetAddConnection2 или WNetAddConnection3. <br /><br />Параметры: <br />lpRemoteName: Строка, определяющая удаленный сетевой ресурс для соединения. <br /><br />lpPassword: Строка, которая определяет пароль, для аутентификации. Если этот параметр nil, то используется пароль по умолчанию, если строка пустая, то пароль не используется. <br />Win 95/98/Me: Этот параметр должен быть nil или пустой строкой. <br /><br />lpLocalName: Строка которая определяет имя локального устройства, которое нужно переназначить. Например &quot;F:&quot; ли &quot;LPT1&quot;. Если строка равна nil, то локальный ресурс не переназначается. <br /><br />Возвращаемые значения <br />Если успешно то NO_ERROR. Если функция терпит неудачу, то возвращается одно из следующих значений: <br />ERROR_ACCESS_DENIED - Нет доступа к сетевому ресурсу. <br />ERROR_ALREADY_ASSIGNED - Устройство указанное в параметре lpLocalName уже переопределено. <br />ERROR_BAD_DEV_TYPE - Тип устройства и тип ресурса не сочетается. <br />ERROR_BAD_DEVICE - Значение определенное в параметре lpLocalName неверно. <br />ERROR_BAD_NET_NAME - Значение определенное в параметре lpRemoteName неверно. <br /><br />ERROR_BAD_PROFILE - Профиль пользователя неправильного формата. <br />ERROR_CANNOT_OPEN_PROFILE - Система не может открыть профиль пользователя. <br />ERROR_DEVICE_ALREADY_REMEMBERED - Прявязка для устройства указнного в параметре lpLocalName - уже в профиле пользователя. <br />ERROR_EXTENDED_ERROR - Произошла сетевая спецефическая ошибка. Для того чтобы получить информацию об ошибке, вызовите функцию WNetGetLastError. <br />ERROR_INVALID_PASSWORD - Пароль недействителен. <br /><br />ERROR_NO_NET_OR_BAD_PATH - Операция не выполнена потому что сетевой компонент не запущен или имя сетевого ресурса не может быть использовано. <br />ERROR_NO_NETWORK - Сеть отсутствует. <br /><br />Замечания <br />Win XP: функции WNet создают и удаляют буквы сетевых устройств в пределах пространства имен устройств МС-DOS, которые связываются с текущим сеансом и имеют AuthenticationID (AuthenticationID - Локальный уникальный идентификатор{LUID}, связанный с сеансом передачи). Это может повлиять на те приложения которые вызываю функции WNet для одного пользователя, после логона, а затем пытаютсч использовать в сеансе других пользователей. <br /><br />См. также: WNetCancelConnection, WNetGetConnection <br /><br />Функция находится в файле mpr.dll <br />-------------------- </p></body></html>