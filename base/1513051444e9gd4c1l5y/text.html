<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Циклы For</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оператор For предназначен для организации циклов с заранее известным числом повторений. Есть два варианта его использования. Первый - использование конструкции For - Next: <span style=" font-family:'Courier New,courier';"><br /><br />For i = 1 to 10 <br />  if Cells(1,i) &lt;&gt; &quot;&quot; then Exit For <br />  Cells(1,i).Value = i <br />Next i <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменная i принимает значения от 1 до 10. В случае необходимости выполнение цикла можно прервать командой Exit For. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Второй вариант цикла For позволяет перебирать все элементы, входящие в массив или коллекцию. Он полезен, когда нужно произвести однотипные операции над всем массивом. Описание его такое: <br /><br /><span style=" font-family:'Courier New,courier';">For Each переменная In массив<br />  Действия<br />Next переменная<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Переменная должна иметь тип Variant или Object, в котором можно хранить практически всё. Пример: <br /><br /><span style=" font-family:'Courier New,courier';">Sub Test()<br />  Dim arr(1) As String<br />  arr(0) = &quot;First element&quot;<br />  arr(1) = &quot;Second element&quot;<br />  Dim v As Variant<br />  For Each v In arr<br />   MsgBox (v)<br />  Next v<br />End Sub<br /><br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">For Each очень удобен для <a href="http://www.samcomp.info"><span style=" text-decoration: underline; color:#0000ff;">работы</span></a> с коллекциями. Вот так можно пробежаться по открытым книгам. <span style=" font-family:'Courier New,courier';"><br /><br />Sub Test()<br />  Dim v As Variant<br />  For Each v In Workbooks<br />   MsgBox (v.Name)<br />  Next v<br />End Sub<br /></span><br />Или по листам книги: <span style=" font-family:'Courier New,courier';"><br /><br />Sub Test() <br />  Dim v As Variant<br />  For Each v In Workbooks.Item(&quot;book.xls&quot;).Sheets<br />   MsgBox (v.Name)<br />  Next v<br />End Sub</span></p></body></html>