<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lbArtHeader"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">AQ: Работа с файлами средствами VB</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lbArtObr"></a><span style=" font-size:8.25pt;">(</span><span style=" font-size:8.25pt;">обращений: </span><span style=" font-size:8.25pt; font-weight:600;">37903</span><span style=" font-size:8.25pt;"> с 08.08.2003)<br /><br /></span><a name="lbIssueListH"></a><span style=" font-size:8.25pt;">Р</span><span style=" font-size:8.25pt;">азделы:  </span><a name="lbIssueList"></a><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=8"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">О</span></a><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">перационка</span><span style=" font-size:8.25pt;">, </span><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=20"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Полезные функции</span></a><span style=" font-size:8.25pt;">, </span><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=23"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">ЧаВо (FAQ)</span></a><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lbBody"></a><span style=" font-size:8.25pt;">О</span><span style=" font-size:8.25pt;">писание: Примеры по работе с файлами из среды VB (VBA)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Добавил на сайт: am 08.08.2003</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'Чтение бинарного файла в массив байт</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">Open sFileName </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Binary Access Read </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> #1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Get #1, , TheBytes()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">Close #1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'запись массива байт в файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">Open sFileName </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Binary Access Write </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> #1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Put #1, , TheBytes()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">Close #1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'Построчное чтение текстового файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">iFile = FreeFile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Open App.Path &amp; </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;\&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> &amp; sININame </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Input </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> iFile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Do</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">While</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Not</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> EOF(iFile) </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">' Loop until end of file.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">            Line Input #iFile, txt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">            </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'sINI = sINI + txt + vbCrLf</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Loop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Close iFile</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'построчная запись в текстовый файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    fnum = FreeFile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    file_name = App.Path</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">If</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Right</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">$(file_name, 1) &lt;&gt; </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;\&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Then</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> file_name = file_name &amp; </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;\&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    file_name = file_name &amp; LOG_FILE_NAME</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Open file_name </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Append </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> #fnum</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">' Remember that the file is open.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    file_open = </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">True</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">' Write the date and time, and the error message.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Print #fnum, Now</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Print #fnum, </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;Computer: &quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> &amp; ComputerName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Print #fnum, txt1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Print #fnum, </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;**********&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">' Close the file.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Close #fnum</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'Далее приведены 2 готовые функции, читающие текстовый файл в строковую переменную.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'первая читает построчно, вторая файл целиком. По быстродействию вторая функция значительно быстрее.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Public</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> File2Str(sPath </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">) </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> txt </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> sLine </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fn </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">fn = FreeFile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Open sPath </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Input </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Do</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">While</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Not</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> EOF(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        Line Input #fn, sLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        txt = IIf(Len(txt) &gt; 0, txt &amp; vbCrLf, </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">) &amp; sLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Loop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">Close fn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">File2Str = txt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">End</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#008000;">'am 030505</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Public</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> File2StrB(sPath </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">) </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> txt </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> sLine </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fn </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">fn = FreeFile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> TheBytes() </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Byte</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">ReDim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> TheBytes(FileLen(sPath) - 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Open sPath </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">For</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> Binary Access Read </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">As</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">        Get #fn, , TheBytes()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">    Close fn</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">File2StrB = StrConv(TheBytes(), vbUnicode)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">End</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Пример как изменить (удалить) строчку в текстовом файле (пример от Сергея Гаврилова): <br />(</span><a href="http://am.rusimport.ru/msaccess/f2.aspx?id=3354"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">http://am.rusimport.ru/msaccess/f2.aspx?id=3354</span></a><span style=" font-size:8.25pt;"> ) <br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Sub</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> test()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fso, a, f, retstring, retstream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Const</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> ForReading = 1, ForWriting = 2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> fso = CreateObject(</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;Scripting.FileSystemObject&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> f = fso.GetFile(</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;d:\config.sys&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> a = f.OpenAsTextStream(ForReading, </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">False</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Do</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">While</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> a.AtEndOfStream &lt;&gt; </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">retstring = a.ReadLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">If</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> retstring Like </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;files*&quot;</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">retstring = </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#0000ff;">&quot;fileshigh=200&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">End</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">retstream = retstream &amp; retstring &amp; vbCrLf</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Loop</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">a.Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> a = f.OpenAsTextStream(ForWriting, </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">False</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">a.Write retstream</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt;">a.Close</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">End</span><span style=" font-family:'Courier New,courier'; font-size:8.25pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:8.25pt; color:#00008b;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />(пример использует объектную модель библиотеки Windows Scripting Host, но и без неё идея такая же - прочитать построчно файл, изменить нужные строки и переписать его заново). <br /><br />Наверняка я здесь привел не все методы работы с файлами средствами VB, так что буду рад добавлениям и исправлениям! Добро пожаловать в комментарии ;-)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:history.back(1)"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">[Back]</span></a></p></td></tr></table></body></html>