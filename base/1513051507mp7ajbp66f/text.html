<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Информация о типе переменной</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Есть такой термин RTTI - run-time type information. Информация о типе переменной, доступная во время выполнения программы. Иногда эта информация оказывается просто необходимой. В VBA есть тип данных Variant, который может принимать значения любого типа за исключением пользовательского. Вот например так: <span style=" font-family:'Courier New,courier';"><br /><br />Sub Test() <br />  Dim v_string As String <br />  Dim v_int As Integer <br />  Dim v_variant As Variant <br />  v_string = &quot;Hello Variant&quot; <br />  v_int = 123 <br />  v_variant = v_string <br />  v_variant = v_int <br />End Sub </span><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Variant можно использовать в качестве аргумента процедуры. В этом случае может потребоваться информация о том, что же находится в переменной в данный момент. Для этого есть функция TypeName(), которая вернет строку с именем типа переменной. Вот пример её использования: <span style=" font-family:'Courier New,courier';"><br /><br />Sub TestVariant() <br />  Dim v_string As String <br />  Dim v_int As Integer <br />  Dim v_variant As Variant <br />  v_string = &quot;Hello Variant&quot; <br />  v_int = 123 <br />  v_variant = v_string <br />  MsgBox (TypeName(v_variant)) <br />  v_variant = v_int <br />  MsgBox (TypeName(v_variant)) <br />End Sub <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме этого есть еще ряд функций для проверки типа переменных. IsArray позволяет проверить, является ли переменная массивом. <span style=" font-family:'Courier New,courier';"><br /><br />Sub TestArray() <br />  Dim v_arr(10) As String <br />  If IsArray(v_arr) Then MsgBox (&quot;Массив&quot;) <br />End Sub <br /></span><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IsEmpty проверяет, была ли переменная инициализирована. Попробуйте запустить код, приведенный ниже, а потом раскомментируйте строку. <span style=" font-family:'Courier New,courier';"><br /><br />Sub TestEmpty() <br />  ' Dim v_arr As String <br />  If IsEmpty(v_arr) Then MsgBox (&quot;NO&quot;) <br />End Sub <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IsDate проверяет можно ли преобразовать переменную к типу даты. При выполнении нижеприведенного кода сообщение появится только один раз. <span style=" font-family:'Courier New,courier';"><br /><br />Sub TestDate() <br />  Dim v_arr As String <br />  v_arr = &quot;01.01.2001&quot; <br />  If IsDate(v_arr) Then MsgBox (&quot;YES&quot;) <br />  v_arr = &quot;41.01.2001&quot; <br />  If IsDate(v_arr) Then MsgBox (&quot;YES&quot;) <br />End Sub <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция IsNumeric проверяет, можно ли перевести строку в число: <span style=" font-family:'Courier New,courier';"><br /><br />Sub TestNumeric() <br />  Dim v_arr As String <br />  v_arr = &quot;not numeric&quot; <br />  If IsNumeric(v_arr) Then MsgBox (&quot;YES&quot;) <br />  v_arr = &quot;1998&quot; <br />  If IsNumeric(v_arr) Then MsgBox (&quot;YES&quot;) <br />End Sub <br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Есть еще несколько подобных функций: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IsObject - проверяет, является ли переменная обьектом </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IsNull(выражение) - проверка на пустое значение </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IsError(выражение) - проверка выражения, представляет ли оно ошибку </li></ul></body></html>