<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h1 class="entry-title">Подключение к Excel как к БД</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Опубликовано</span> <a href="http://pamirych.ru/%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba-excel-%d0%ba%d0%b0%d0%ba-%d0%ba-%d0%b1%d0%b4/" title="12:59 дп" rel="bookmark"><span class="entry-date">Декабрь 8, 2015</span></a> <span class="meta-sep">автором</span> <span class="author vcard"><a class="url fn n" href="http://pamirych.ru/author/Pamir/" title="Посмотреть все записи автора Памирыч">Памирыч</a></span>					</div>

					<div class="entry-content">
						<p></p>

		<div id="crayon-5aa3cc89da9fa347806863" class="crayon-syntax crayon-theme-vs2012 crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important;  height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; "><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; "><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Visual Basic .NET</span></div></div>
			
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="max-height: 500px; position: relative; z-index: 1; overflow: auto;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; "><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-2">2</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-4">4</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-6">6</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-8">8</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-10">10</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-12">12</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-14">14</div><div class="crayon-num" data-line="crayon-5aa3cc89da9fa347806863-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa3cc89da9fa347806863-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important;  -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-1"><span class="crayon-h">    </span><span class="crayon-r">Dim</span><span class="crayon-h"> </span><span class="crayon-e">tbl </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-e">DataTable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-2"><span class="crayon-e">    </span><span class="crayon-r">Dim</span><span class="crayon-h"> </span><span class="crayon-e">da </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-h"> </span><span class="crayon-v">OleDb</span><span class="crayon-sy">.</span><span class="crayon-e">OleDbDataAdapter</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-4"><span class="crayon-e">    </span><span class="crayon-m">Private</span><span class="crayon-h"> </span><span class="crayon-t">Sub</span><span class="crayon-h"> </span><span class="crayon-e">Button1_Click</span><span class="crayon-sy">(</span><span class="crayon-m">ByVal</span><span class="crayon-h"> </span><span class="crayon-e">sender </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-m">ByVal</span><span class="crayon-h"> </span>e<span class="crayon-h"> </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">EventArgs</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-r">Handles</span><span class="crayon-h"> </span><span class="crayon-v">Button1</span><span class="crayon-sy">.</span><span class="crayon-e">Click</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-5"><span class="crayon-e">        </span><span class="crayon-r">Dim</span><span class="crayon-h"> </span><span class="crayon-e">fname </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-v">String</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"C:\1.xls"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-6"><span class="crayon-h">        </span><span class="crayon-r">Dim</span><span class="crayon-h"> </span><span class="crayon-e">cn </span><span class="crayon-r">As</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-h"> </span><span class="crayon-v">OleDb</span><span class="crayon-sy">.</span><span class="crayon-e">OleDbConnection</span><span class="crayon-sy">(</span><span class="crayon-s">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source="</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">fName</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-s">";Extended Properties="</span><span class="crayon-s">"Excel 8.0;HDR=NO;IMEX=1"</span><span class="crayon-s">""</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-7"><span class="crayon-h">        </span><span class="crayon-v">cn</span><span class="crayon-sy">.</span><span class="crayon-e">Open</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-8"><span class="crayon-h">        </span><span class="crayon-v">da</span><span class="crayon-sy">.</span><span class="crayon-v">SelectCommand</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-h"> </span><span class="crayon-v">OleDb</span><span class="crayon-sy">.</span><span class="crayon-e">OleDbCommand</span><span class="crayon-sy">(</span><span class="crayon-s">"Select [F1] from [Лист3$]"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cn</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-9"><span class="crayon-h">        </span><span class="crayon-v">tbl</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-h"> </span><span class="crayon-e">DataTable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-10"><span class="crayon-e">        </span><span class="crayon-v">da</span><span class="crayon-sy">.</span><span class="crayon-e">Fill</span><span class="crayon-sy">(</span><span class="crayon-v">tbl</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-12"><span class="crayon-h">        </span><span class="crayon-c">'DataGridView1.DataSource = tbl</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-13"><span class="crayon-h">        </span><span class="crayon-v">ListBox1</span><span class="crayon-sy">.</span><span class="crayon-v">DisplayMember</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"F1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-14"><span class="crayon-h">        </span><span class="crayon-v">ListBox1</span><span class="crayon-sy">.</span><span class="crayon-v">DataSource</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">tbl</span></div><div class="crayon-line" id="crayon-5aa3cc89da9fa347806863-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5aa3cc89da9fa347806863-16"><span class="crayon-e">    </span><span class="crayon-st">End</span><span class="crayon-h"> </span><span class="crayon-t">Sub</span></div></div></td></tr></tbody></table></div></div></div>
</body>
</html></p></body></html>