<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/SplitTextFile"><span style=" font-size:5pt; font-weight:600; text-decoration: underline; color:#0000ff;">Разбиение текстового файла (в т.ч. CSV) на несколько файлов с заданным количеством строк</span></a><span style=" font-size:5pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/processing_files"><span style=" text-decoration: underline; color:#0000ff;">Обработка файлов</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/strings"><span style=" text-decoration: underline; color:#0000ff;">Текстовые строки</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/text_files"><span style=" text-decoration: underline; color:#0000ff;">Текстовые файлы</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/Excel/create"><span style=" text-decoration: underline; color:#0000ff;">Создание файлов</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/filenames"><span style=" text-decoration: underline; color:#0000ff;">Список файлов</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/text"><span style=" text-decoration: underline; color:#0000ff;">Текстовые файлы</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/CSV"><span style=" text-decoration: underline; color:#0000ff;">файлы CSV</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/Excel"><span style=" text-decoration: underline; color:#0000ff;">Книги Excel</span></a></li>
<li style=" font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/files"><span style=" text-decoration: underline; color:#0000ff;">Работа с файлами</span></a> </li></ul></td></tr></table>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt; font-weight:600;">Функция предназначена для разбивки текстового файла на несколько файлов меньшего размера - в каждом из которых будет не более заданнного количества строк</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Разделитель строк (обычно это перевод строки - константа </span><span style=" font-size:9pt; font-weight:600; font-style:italic;">vbNewLine</span><span style=" font-size:9pt;">) задаётся в качестве параметра функции </span><span style=" font-size:9pt; font-weight:600;">Delimiter</span><span style=" font-size:9pt;">$</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Создаваемые файлы получают имена вида </span><span style=" font-size:9pt; font-weight:600;">filename(1).txt</span><span style=" font-size:9pt;">, </span><span style=" font-size:9pt; font-weight:600;">filename(2).txt</span><span style=" font-size:9pt;"> и т.д.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Если задан параметр функции </span><span style=" font-size:9pt; font-weight:600;">DeleteSourceFile </span><span style=" font-size:9pt;">равным </span><span style=" font-size:9pt; font-weight:600; font-style:italic;">TRUE</span><span style=" font-size:9pt;">, - то исходный файл удаляется после разделения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Функция возвращает коллекцию, содержащую пути к сформированным файлам</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">В начало каждого создаваемого файла дописывается строка заголовка - первая строка из исходного файла</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;"> </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt; font-weight:600;">Пример использования функции SplitTextFile:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:9pt;"> ПримерИспользованияФункции_SplitTextFile()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    ИмяРазбиваемогоФайла$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;C:\test\2011 04 17  12-32-30.csv&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    МаксимальноеКоличествоСтрокВфайле&amp; = 3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:9pt;"> СписокИмёнФайлов </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> СписокИмёнФайлов = SplitTextFile(ИмяРазбиваемогоФайла$, МаксимальноеКоличествоСтрокВфайле&amp;, vbNewLine, </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">False</span><span style=" font-family:'monospace'; font-size:9pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Each</span><span style=" font-family:'monospace'; font-size:9pt;"> Файл </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">In</span><span style=" font-family:'monospace'; font-size:9pt;"> СписокИмёнФайлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        Debug.</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Print</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;Создан файл: &quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; Файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Результат работы примера (из окна </span><span style=" font-size:9pt; font-style:italic;">Immediate </span><span style=" font-size:9pt;">редактора VBA)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt;">Создан файл: C:\test\2011 04 17 12-32-30(1).csv<br />Создан файл: C:\test\2011 04 17 12-32-30(2).csv<br />Создан файл: C:\test\2011 04 17 12-32-30(3).csv</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:9pt; font-weight:600;">Код функции SplitTextFile:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:9pt;"> SplitTextFile(</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:9pt;"> filename$, </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:9pt;"> MaxRowsCount&amp;, </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:9pt;"> Delimiter$, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">                       </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Optional</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:9pt;"> DeleteSourceFile </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Boolean</span><span style=" font-family:'monospace'; font-size:9pt;"> = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">True</span><span style=" font-family:'monospace'; font-size:9pt;">) </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' функция предназначена для разбивки текстового файла filename$ на несколько файлов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' меньшего размера - в каждом из которых будет не более MaxRowsCount&amp; строк</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' Разделение строк выполняется с использованием разделителя Delimiter$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' Создаваемые файлы получают имена вида filename(1).txt, filename(2).txt и т.д.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' Если DeleteSourceFile = TRUE, - то исходный файл удаляется после разбивки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' Возвращает коллекцию имён созданных файлов</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:9pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    ext$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; Split(filename$, </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">)(</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">UBound</span><span style=" font-family:'monospace'; font-size:9pt;">(Split(filename$, </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">)))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> fso = CreateObject(</span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;scripting.filesystemobject&quot;</span><span style=" font-family:'monospace'; font-size:9pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> ts = fso.OpenTextFile(filename, 1, </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">True</span><span style=" font-family:'monospace'; font-size:9pt;">): txt = ts.ReadAll: ts.</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    HeaderRow$ = Split(txt, Delimiter$, 2)(0) &amp; Delimiter$    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' берем первую строку из файла как заголовок</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    txt = Split(txt, Delimiter$, 2)(1)    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' остаток текста - без строки заголовка</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:9pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' удаляем разделители строк в конце текстовой строки (если таковые присутствуют)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">While</span><span style=" font-family:'monospace'; font-size:9pt;"> txt </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Like</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;*&quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; Delimiter$: txt = Left(txt, Len(txt) - Len(Delimiter$)): Wend</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' RowsCount = UBound(Split(txt, Delimiter$)) + 1    ' количество текстовых строк в файле</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    FileIndex&amp; = 1    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' индекс очередного создаваемого файла</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:9pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    arr = Split(txt, Delimiter$): rc = 0: </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> SplitTextFile = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">New</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Collection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:9pt;"> i = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">LBound</span><span style=" font-family:'monospace'; font-size:9pt;">(arr) </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">UBound</span><span style=" font-family:'monospace'; font-size:9pt;">(arr)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        rc = rc + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        NewTXT$ = NewTXT$ &amp; arr(i) &amp; Delimiter$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:9pt;"> rc &gt;= MaxRowsCount&amp; </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Or</span><span style=" font-family:'monospace'; font-size:9pt;"> i = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">UBound</span><span style=" font-family:'monospace'; font-size:9pt;">(arr) </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' набрали достаточно строк для записи в файл</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            NewFilename$ = Mid(filename$, 1, Len(filename$) - Len(ext$)) &amp; </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;(&quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; FileIndex &amp; </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;)&quot;</span><span style=" font-family:'monospace'; font-size:9pt;"> &amp; ext$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> ts = fso.CreateTextFile(NewFilename$, </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">True</span><span style=" font-family:'monospace'; font-size:9pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            ts.Write HeaderRow$ &amp; NewTXT$: ts.</span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            SplitTextFile.Add NewFilename$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            FileIndex&amp; = FileIndex&amp; + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">            rc = 0: NewTXT$ = </span><span style=" font-family:'monospace'; font-size:9pt; color:#800000;">&quot;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">        </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:9pt;"> i</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> ts = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Nothing</span><span style=" font-family:'monospace'; font-size:9pt;">: </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Set</span><span style=" font-family:'monospace'; font-size:9pt;"> fso = </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">    </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:9pt;"> DeleteSourceFile </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:9pt;"> Kill filename$    </span><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">' удаляем исходный файл, если DeleteSourceFile = TRUE</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:9pt;"> </span><span style=" font-family:'monospace'; font-size:9pt; color:#000080;">Function</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">21868 просмотров </li></ul></td>
<td></td></tr></table></body></html>