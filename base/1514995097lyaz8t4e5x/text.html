<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы ActiveX перестали работать или ведут себя непредсказуемо </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В Microsoft Office после определенных обновлений может появиться проблема: </span><span style=" font-size:8.25pt; font-weight:600;">Перестают работать все элементы ActiveX</span><span style=" font-size:8.25pt;"> (кнопки CommandButton, списки(Lists и ComboBox) и пр.) во всех файлах, а так же невозможно вставить любой элемент ActiveX на лист(при попытке вставки появляется сообщение </span><span style=" font-size:8.25pt; font-weight:600;">Вставка объекта неосуществима</span><span style=" font-size:8.25pt;">), а при работе с таким файлом может появится ошибка </span><span style=" font-size:8.25pt; font-weight:600;">Can't exit design mode because control cannot be created</span><span style=" font-size:8.25pt;">). Подробнее про вставку таких элементов на лист можно прочитать в статье: </span><a href="http://www.excel-vba.ru/chto-umeet-excel/kak-sozdat-knopku-dlya-vyzova-makrosa-na-liste/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">КАК СОЗДАТЬ КНОПКУ ДЛЯ ВЫЗОВА МАКРОСА НА ЛИСТЕ?</span></a><span style=" font-size:8.25pt;"> Там я описывал пример вставки кнопки через ActiveX, но сути это не меняет - остальные элементы вставляются точно так же. Яркий пример - </span><a href="http://support2.microsoft.com/default.aspx?scid=kb;en-us;2553154"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">декабрьское обновление безопасности для пакета Microsoft Office (от 09.12.2014)</span></a><span style=" font-size:8.25pt;">, которое призвано устранить различные уязвимости безопасности (кстати сам пакет обновлений делает исправления не только в офисе, но и в Internet Explorer(IE), Exchange и самой ОС Windows). Тогда многие пользователи оказались практически без элементов ActiveX.<br />При этом очевидных решений проблем как правило нет, удаление установленных обновлений не всегда решает проблему.<br />Если столкнулись с подобной проблемой, то можно попробовать некоторые приведенные ниже способы. Не все они выдуманы мной, некоторые взяты из форумов. Я собрал проверенные методы в одну статью. Особая благодарность за решение сей проблемы MVP Excel Владимиру Захарову, известному на форумах как ZVI.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Предупреждение:</span><span style=" font-size:8.25pt;"> все описанные ниже действия вы выполняете на свой страх и риск и автор статьи не несет никакой ответственности за потерю каких-либо данных(в том числе форматов) вследствие неосторожного использования инструкции, а так же за какой-либо ущерб, включая все без исключения случаи упущенной выгоды или потери данных, либо других денежных потерь, ставших результатом использования или невозможности использования инструкции, даже если автор был заранее поставлен в известность о возможности подобного рода ущерба.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">СПОСОБ 1<br />Попробуем исправить ошибку вручную.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Закрыть Excel (желательно вообще все окна и приложения)</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажать одновременно клавишу Windows и R (или нажать на панели задач кнопку ПУСК и выбрать команду Выполнить. В Windows 7 и выше она может отсутствовать и её необходимо будет отобразить через настройку меню Пуск)</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ввести в поле команду: <span style=" font-weight:600;">%APPDATA%\Microsoft\Forms</span> и нажать Enter<br />В XP обычно это папка:<br /><span style=" font-weight:600;">C:\Documents and Settings\%USERNAME%\Application Data\Microsoft\Forms\</span><br />В Win7:<br /><span style=" font-weight:600;">C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Forms\</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В открывшейся папке удалить все файлы с расширением EXD</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же не помешает удалить файлы с расширением EXD из временных папок Excel и VBE: %Temp%\Excel8.0\, %Temp%\VBE\, %USERPROFILE%\Local Settings\Temp\, %USERPROFILE%\Local Settings\Temp\Excel8.0\, %SystemRoot%\Temp\VBE\, %SystemRoot%\Temp\Excel8.0\<br />Если каких-то папок нет или в них нет файлов EXD - значит все хорошо и там ничего критичного нет.</li></ol>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">СПОСОБ 2<br />Для тех, кто руками такое проделывать не хочет или все написанное выше китайская грамота - прикладываю BAT-файл со всеми необходимыми командами. Все, что останется - это только его запустить двойным кликом мыши (закрыв предварительно Excel и другие приложения и папки).<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image328.png" /><span style=" font-size:8.25pt;">  </span><a href="http://www.excel-vba.ru/download/99/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">fixMS_Hay.zip</span></a><span style=" font-size:8.25pt;"> (423 bytes, 3 793 скачиваний)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Само содержание BAT-ника выглядит так: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78db7d1c488350516"></a><span style=" font-size:8.25pt;">@</span><span style=" font-size:8.25pt;">echo off del &quot;%APPDATA%\Microsoft\Forms\*.exd&quot; del &quot;%APPDATA%\Microsoft\Excel\*.xlb&quot; del &quot;%APPDATA%\Roaming\Microsoft\Forms\*.exd&quot; del &quot;%Temp%\VBE\*.exd&quot; del &quot;%Temp%\Excel8.0\*.exd&quot; del &quot;%APPDATA%\Microsoft\Local\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\VBE\*.exd&quot; del &quot;%USERPROFILE%\Local Settings\Temp\Excel8.0\*.exd&quot; del &quot;%SystemRoot%\Temp\VBE\*.exd&quot; del &quot;%SystemRoot%\Temp\Excel8.0\*.exd&quot; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78db7d1c488350516-1"></a><span style=" font-size:8.25pt;">@</span><span style=" font-size:8.25pt;">echo off </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-2"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%APPDATA%\Microsoft\Forms\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-3"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%APPDATA%\Microsoft\Excel\*.xlb&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-4"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%APPDATA%\Roaming\Microsoft\Forms\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-5"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%Temp%\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-6"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%Temp%\Excel8.0\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-7"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%APPDATA%\Microsoft\Local\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-8"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%USERPROFILE%\Local Settings\Temp\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-9"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%USERPROFILE%\Local Settings\Temp\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-10"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%USERPROFILE%\Local Settings\Temp\Excel8.0\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-11"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%SystemRoot%\Temp\VBE\*.exd&quot; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78db7d1c488350516-12"></a><span style=" font-size:8.25pt;">d</span><span style=" font-size:8.25pt;">el &quot;%SystemRoot%\Temp\Excel8.0\*.exd&quot;</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если использовали Способ1 или Способ2, то для верности необходимо запустить файл с проектом VBA, открыть код(Alt+F11) и внести в код любые изменения (можно просто добавить или изменить любой комментарий), после чего скомпилировать проект в ручном режиме из меню: </span><span style=" font-size:8.25pt; font-weight:600;">Debug</span><span style=" font-size:8.25pt;">=&gt;</span><span style=" font-size:8.25pt; font-weight:600;">Compile VBAProject</span><span style=" font-size:8.25pt;">. Сохранить файл. Попробовать работу ActiveX, в том числе на других ПК.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">СПОСОБ 3<br />Самый верный способ для тех, кому нечего терять :-) Переустановка Windows. Можно еще попробовать сделать откат обновлений, но как показала практика откат не далеко не всегда решает проблему. Переустановка офиса помогает еще реже, судя по отзывам тех, кто столкнулся с проблемой. Т.е. переустановка может помочь, а может и нет. Как поступить в этом случае решайте сами.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">СПОСОБ 4<br />Вспомнить в какой момент это все началось и проверить обновления офиса и безопасности за этот период от Microsoft. Если таковые были - перейти на страницу обновлений, изучить что в них вошло. И терпеливо ждать исправления проблемы от Microsoft.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">И напоследок - элементы ActiveX сами по себе считаются устаревшими и я бы не рекомендовал их использовать без крайней необходимости, во избежание ситуаций, описанных в этой статье. Для запуска макроса кнопкой есть и </span><a href="http://www.excel-vba.ru/chto-umeet-excel/kak-sozdat-knopku-dlya-vyzova-makrosa-na-liste/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">другие методы</span></a><span style=" font-size:8.25pt;">, более стабильные.</span></p></body></html>