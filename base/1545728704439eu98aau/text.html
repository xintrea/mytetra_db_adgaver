<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">HERE IS THE SOLUTION FOR ALL OF YOU WITH THE SAME PROBLEM:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.sql.ru/forum/842257/access-2007-accdb-i-mssql-2005-linked-server"><span style=" font-family:'DejaVu Sans,serif'; text-decoration: underline; color:#0000ff;">Тема на sql.ru</span></a></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';">-On your Server Objects -&gt;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';"> Linked Servers -&gt;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif';"> Providers, Righ Click on Microsoft.ACE.OLEDB.12.0 and select Options. Check the option -&gt;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans,serif'; font-weight:600; color:#ff0000;">Allow inprocess</span> </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Arial'; font-size:small;">HERE IS THE SOLUTION FOR ALL OF YOU WITH THE SAME PROBLEM:</span><span style=" font-family:'Verdana'; font-size:small;"><br /><br />- Install the </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600;">2007 Office System Driver: Data Connectivity Components</span><span style=" font-family:'Verdana'; font-size:small;"> on your server.<br />here is the link:<br /></span><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=7554F536-8C28-4598-9B72-EF94E038C891&amp;displaylang=en"><span style=" font-family:'Verdana'; font-size:small; text-decoration: underline; color:#0000ff;">http://www.microsoft.com/downloads/details.aspx?FamilyID=7554F536-8C28-4598-9B72-EF94E038C891&amp;displaylang=en</span></a><span style=" font-family:'Verdana'; font-size:small;"><br /><br />- Make shure you have </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600;">SQL SERVER 2005 Standard</span><span style=" font-family:'Verdana'; font-size:small;"> installed. </span><span style=" font-family:'Verdana'; font-size:small; color:#ff0000;">IT DOESN'T WORK'S ON SQL EXPRESS</span><span style=" font-family:'Verdana'; font-size:small;">. No mather what you do. It only works on the standard versions...<br /><br />- Install </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600;">SQL SERVER SP2</span><span style=" font-family:'Verdana'; font-size:small;"><br /><br />- On your </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600; font-style:italic;">Server Objects &gt; Linked Servers &gt; Providers</span><span style=" font-family:'Verdana'; font-size:small;">, Righ Click on </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600;">Microsoft.ACE.OLEDB.12.0</span><span style=" font-family:'Verdana'; font-size:small;"> and select </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600;">Options</span><span style=" font-family:'Verdana'; font-size:small;">. Check the option </span><span style=" font-family:'Verdana'; font-size:small; font-weight:600; font-style:italic;">Allow inprocess<br /><br />-</span><span style=" font-family:'Verdana'; font-size:small;"> Use this T-SQL template (replacing by your own values) to create a connecto to the Linked Server:</span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Code Snippet</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- ==============================================</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- Add Linked Server Access 2007 ACCDB template</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- BY JOSÉ ALVES @ CCG - UMINHO - PORTUGAL</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- ==============================================</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">EXEC</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#800000; background-color:#ffffff;">sp_addlinkedserver</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">    </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">@server </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Your Linked Server Name'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @provider </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Microsoft.ACE.OLEDB.12.0'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @srvproduct </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Access2007'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @datasrc </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'C:\path\to\your\db.accdb'</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">GO</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- Set up login mapping using current user's security context</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">EXEC</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#800000; background-color:#ffffff;">sp_addlinkedsrvlogin</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">    </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">@rmtsrvname </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Your Linked Server Name'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @useself </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'TRUE'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @locallogin </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">NULL,</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @rmtuser </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Your Linked Server Name'</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">,</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">    @rmtpassword </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">=</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">GO</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- List the tables on the linked server</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">EXEC</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#800000; background-color:#ffffff;">sp_tables_ex</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#ff0000; background-color:#ffffff;">N'Your Linked Server Name'</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">GO</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#008000; background-color:#ffffff;">-- Select all the rows from table1</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">SELECT</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">*</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#0000ff; background-color:#ffffff;">FROM</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;"> [Your Linked Server Name]</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#808080; background-color:#ffffff;">...</span><span style=" font-family:'Consolas'; font-size:9.5pt; color:#000000; background-color:#ffffff;">table1</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">I hope this helps you. To me it was a big headache but i figured out after many tries...</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Greetings from Portugal</p></body></html>