<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table id="tblPlaceArt" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td colspan="2" align="center"><span id="lbArtHeader" class="ArtHeader">Динамическое форматирование форм.</span></td>
									</tr>
									<tr>
										<td colspan="2" align="center">
											<p>
												<span id="lbArtObr" class="ArtObr">(обращений: <b>91</b> с 25.11.2018)</span><br>
												<br>
												<span id="lbIssueListH">Разделы:</span> 
												<span id="lbIssueList"><a href="http://am.rusimport.ru/MSAccess/content.aspx?id=2">Формы</a>, <a href="http://am.rusimport.ru/MSAccess/content.aspx?id=7">Интерфейс</a></span></p>
											<p> </p>
										</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbBody"><p><span class="ArtPartHead">Описание: </span>Преимущества<br>
 1. Уменьшение количества форм 2. Уменьшение времени на форматирование 
новой формы 3. Упрощение поддержки единообразия формата нескольких форм,
 выполняющих смежные функции. 4. Уменьшение объема файла.<br> однако есть и сложности <br>1.
 Более высокие требования к организации кода. 2. Сложнее 
модернизировать, работать с кодом через некоторое время, когда рабочие 
состояния форм удалены (можно восстановить как в первом, так и во втором
 случае) <br>В той же мере касается и отчетов.<br><br>Здесь представлено 2 способа (в 2-х разных базах).<br>1. состояния элементов хранятся непосредственно в коде модуля.<br>2. состояния элементов хранятся в таблице и разделяются по инстансам.<br>В качестве примера приведено 3 состояния одной формы в качестве Всплывающей формы, Формы для ввода пароля, Прогрессбара.<br><br>Примеры функций - есть в базах</p><p><span class="ArtPartHead">Автор: </span><a href="mailto:garlex@rambler.ru">Галицков А.С.  (AKA alecko)</a>   </p><p><span class="ArtPartHead">Добавил на сайт: </span> <a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=3957"></a><a href="mailto:garlex@rambler.ru">alecko</a>  25.11.2018</p><table><tbody><tr><td><p><span class="ArtPartHead">Скачать: </span></p></td><td><a href="http://am.rusimport.ru/MSAccess/download.aspx?id=828">FormsFormats.zip</a> (171814 байт) <font size="2">(скачиваний: <b>17</b> с 25.11.2018)</font></td></tr></tbody></table>Формы frmPopUp2, frmPopUp3 - показывают как происходит работа.<br>Делаем
 копию основной формы, форматируем её- располагаем элементы где 
необходимо, форматируем их (размеры, шрифты, данные цвет и пр.).<br>Эти 
формы можно после форматирования можно удалить (лучше скопировать в 
другую техническую базу-и по мере надобности форматировать там) - они 
нужны только для создания инстанса основной формы (очевидно после 
отладки)-назовем их технические формы.<br><br>После этого на событии Form_Load<br><br>В 1-м случае запускаем процедуру<br>----------------------------------------------------------------------------------------------------------------<br>Call Allsq(frm, frmName,Colr, Srift)<br>здесь<br>frm - имя формы, которая будет анализироваться<br>frmName -имя переменной которой эта форма присвоена (если код будет в самой форме , то запишем "Me")<br>Colr- если нужны свойства цвета: фона, текста, границы (+толщина и стиль границы)<br>Srift-если нужны свойства шрифта: размер, жирный, имя.<br><br>функция
 открывает текстовый файл в котором определены свойства элементов 
управления, нужные копируем в код модуля (файл сохраняется в той же 
папке что и база).<br>----------------------------------------------------------------------------------------------------------------------------<br>Во 2-м случае (во 2-й базе) запускается функция <br> call LocateCTRLtable (Obj1, FormDonor, Level, [CtrlTochange], [strcontrol], [SectionIndex])<br>здесь<br>Obj1 - форма, которую анализируем-её и запускаем (как правило Me)<br>FormDonor-имя формы, состояние которой создаем (т.е. для всех форм "frmPopUp")<br>Level - номер состояния (Instance)<br>[CtrlTochange] - необязательный параметр имеет три параметра<br>	allcontrols - все элементы управления (по умолчанию)<br>	singlecontrol - отдельные элементы управления<br>	SectionForm - отдельные секции<br>[strcontrol]
 - необязательный элемент, в котором указываются отдельные элементы 
(когда выбрано CtrlTochange=singlecontrol ) через знак "|", пример 
("fld17|fld18|Надпись84|gr2|tbtn11|tbtn12|Надпись170")<br>[SectionIndex]
 -  необязательный элемент, в котором указывается индекс секции в 
которой работаем в случае когда CtrlTochange=SectionForm - при этом 
работаем только с выбранной секцией, данные об элементах в других 
секциях этого инстанса не меняются.<br><br>Данные сохраняются в таблице (при необходимости создаются новые записи) и этот инстанс уже готов к работе.<br>------------------------------------------------------------------------------------------------------------------------------------------------<br>во
 2-й базе есть также функция создания нужного инстанса (в случае если 
это нужно сделать (например нужно что-то поправить, а технические 
инстансы удалены)) из основной формы<br>call FromTableINForm(FormDonor, Level)<br>здесь<br>FormDonor-имя формы, состояние которой создаем<br>Level - номер состояния (Instance)<br><br>во 2-й базе также есть процедура, которая может переименовать нужные элементы управления<br>--------------------------------------------------------------------------------------------------------------------------------------<br>call PrisvTOC0ntrolsNames(frmName, typeControl, [OldNamectrls], [NewName], [SectionIndex], [Number] )<br>здесь<br>frmName- имя формы в которой будет проводится переименование<br>typeControl-тип элемента управления<br>соответствие типов элементов(108, 106, 111, 104, 119, 103, 100, 102, 110, 114, 105, 107, 124, 118, 101, 112, 123, 109, 122)<br>их
 названиям ("Присоединенная рамка объекта", "Флажок", "Поля со списком",
 "Кнопки", "acCustomControl", "Рисунок", "Надпись", "Линия", "Список", 
"Свободная рамка объекта", "Переключатели", "Группы", "Страница", 
"Разрыв страницы", "Прямоугольники", "Подчиненная форма/отчет", "Группы 
вкладок", "Поля для ввода данных", "Переключатели")<br>[OldNamectrls]-необязательный элемент управления - текст в имени элемента управления которые будем переименовывать<br>[NewName]-необязательный элемент управления -новое имя элемента управления<br>[SectionIndex]-необязательный элемент управления -в какой секции производится переименование (по умолчанию в области данных)<br>[Number] - с какого номера начнем присваивать номера (по умолчанию с 1)<br>также есть функция создающая лог ошибок, в случае появления таковых в подпапке Locatefrmt\Log.Err<p><a href="javascript:history.back(1)">[Back]</a></p></span></td></tr></tbody></table>
</body>
</html></p></body></html>