<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/UNZIP"><span style=" font-size:xx-large; font-weight:600; text-decoration: underline; color:#0000ff;">Получение файлов из архива ZIP на VBA</span></a> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/processing_files"><span style=" text-decoration: underline; color:#0000ff;">Обработка файлов</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/archive"><span style=" text-decoration: underline; color:#0000ff;">Архивы</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/filenames"><span style=" text-decoration: underline; color:#0000ff;">Список файлов</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/Windows"><span style=" text-decoration: underline; color:#0000ff;">Средства Windows</span></a></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/files"><span style=" text-decoration: underline; color:#0000ff;">Работа с файлами</span></a> </li></ul></td></tr></table>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">Функция предназначена для получения файлов, извлечённых из архива ZIP.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разархивирование выполняется средствами Windows, файлы извлекаются в специально созданную папку в каталоге для временных файлов (C:\WINDOWS\Temp\)</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">При запуске макроса папка UNZIPPED FILES сначала удаляется, а потом создаётся заново.</span><br />(таким образом, выполняется удаление файлов, которые могли оказаться в папке при предыдущем запуске макроса)</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Функция возвращает коллекцию, содержащую полные пути к извлечённым файлам.</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">См. также </span><a href="http://excelvba.ru/code/CreateBackup"><span style=" font-size:large; font-weight:600; text-decoration: underline; color:#0000ff;">функцию UnZip_File</span></a><span style=" font-size:large; font-weight:600;">, предназначенную для разархивирования файлов<br />в заданную папку, с возможностью удаления исходного файла-архива.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример использования функции <span style=" font-weight:600; font-style:italic;">FilesFromZip</span>:</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> ПримерИспользования()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    file$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;D:\Проекты\Прайсы\Архив.zip&quot;</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' путь к архиву, из которого будем извлекать файлы</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> coll </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Collection</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> coll = FilesFromZip(file)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#800000;">&quot;Извлечено файлов: &quot;</span><span style=" font-family:'monospace';"> &amp; coll.Count </span><span style=" font-family:'monospace'; color:#008000;">' выводи количество файлов</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Each</span><span style=" font-family:'monospace';"> filename </span><span style=" font-family:'monospace'; color:#000080;">In</span><span style=" font-family:'monospace';"> coll </span><span style=" font-family:'monospace'; color:#008000;">' выводим пути к извлечённым из архива ZIP файлам</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> filename</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Результат:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Извлечено файлов: 7<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс лист BMW.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс лист LAMBO.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс лист Porche.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс лист ROVER.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс лист VAG.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс-лист Ford.xls<br />C:\WINDOWS\Temp\UNZIPPED FILES\Прайс-лист Мерседес.xls </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код функции <span style=" font-weight:600; font-style:italic;">FilesFromZip</span>:</p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Для работы функции, необходимо дополнительно скопировать<br />в стандартный модуль код </span><a href="http://excelvba.ru/code/FilenamesCollection"><span style=" font-size:large; font-weight:600; text-decoration: underline; color:#0000ff;">функции FilenamesCollection</span></a></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> FilesFromZip(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> FileNameZip) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Collection</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Функция осуществляет распаковку архива с именем FileNameZip во временную папку</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' (предварительно удаляя папку с таким именем, если она существует)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Возвращает коллекцию, содержащую пути ко всем извлечённым из архива файлам)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';">: Err.Clear: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FilesFromZip = </span><span style=" font-family:'monospace'; color:#000080;">New</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Collection</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    folder = Environ(</span><span style=" font-family:'monospace'; color:#800000;">&quot;tmp&quot;</span><span style=" font-family:'monospace';">) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;\UNZIPPED FILES\&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Shell </span><span style=" font-family:'monospace'; color:#800000;">&quot;cmd /c rd /S/Q &quot;&quot;&quot;</span><span style=" font-family:'monospace';"> &amp; folder &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;&quot;&quot;</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' удаляем папку</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    DoEvents: DoEvents: DoEvents: DoEvents:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    MkDir folder    </span><span style=" font-family:'monospace'; color:#008000;">' и создаём эту папку заново</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    DoEvents: DoEvents: DoEvents: DoEvents: Err.Clear</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Len(Dir(folder, vbDirectory)) = 0 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' не удалось создать папку</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Len(Dir(FileNameZip)) = 0 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> MsgBox </span><span style=" font-family:'monospace'; color:#800000;">&quot;Файл &quot;&quot;&quot;</span><span style=" font-family:'monospace';"> &amp; FileNameZip &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;&quot; не найден!&quot;</span><span style=" font-family:'monospace';">, _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">       vbCritical, </span><span style=" font-family:'monospace'; color:#800000;">&quot;Ошибка в функции FilesFromZip&quot;</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> oApp = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;Shell.Application&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Each</span><span style=" font-family:'monospace';"> it </span><span style=" font-family:'monospace'; color:#000080;">In</span><span style=" font-family:'monospace';"> oApp.Namespace(FileNameZip).Items: DoEvents: DoEvents:  </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    oApp.Namespace(folder).CopyHere oApp.Namespace(FileNameZip).Items    </span><span style=" font-family:'monospace'; color:#008000;">'распаковываем файлы</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FilesFromZip = FilenamesCollection(folder, </span><span style=" font-family:'monospace'; color:#800000;">&quot;*&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другая версия функции, - работает более стабильно,<br />возвращает путь к файлу XLS из архива:<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> FileFromZip(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> FileNameZip) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Функция осуществляет распаковку архива с именем FileNameZip во временную папку</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' возвращает путь к разархивированному файлу Excel</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">     </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';">: Err.Clear</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    folder = Environ(</span><span style=" font-family:'monospace'; color:#800000;">&quot;tmp&quot;</span><span style=" font-family:'monospace';">) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;\UNZIP_&quot;</span><span style=" font-family:'monospace';"> &amp; Timer &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;\&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    MkDir folder        </span><span style=" font-family:'monospace'; color:#008000;">' и создаём эту папку заново</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#008000;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Len(Dir(folder, vbDirectory)) = 0 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#008000;">' не удалось создать папку</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Len(Dir(FileNameZip)) = 0 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> MsgBox </span><span style=" font-family:'monospace'; color:#800000;">&quot;Файл &quot;&quot;&quot;</span><span style=" font-family:'monospace';"> &amp; FileNameZip &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;&quot; не найден!&quot;</span><span style=" font-family:'monospace';">, _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">       vbCritical, </span><span style=" font-family:'monospace'; color:#800000;">&quot;Ошибка в функции FilesFromZip&quot;</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Exit</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> oApp = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;Shell.Application&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Each</span><span style=" font-family:'monospace';"> it </span><span style=" font-family:'monospace'; color:#000080;">In</span><span style=" font-family:'monospace';"> oApp.Namespace(FileNameZip).Items: DoEvents: DoEvents: </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    oApp.Namespace(folder).CopyHere oApp.Namespace(FileNameZip).Items        </span><span style=" font-family:'monospace'; color:#008000;">'распаковываем файлы</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    filename$ = folder &amp; Dir(folder &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;*.xls*&quot;</span><span style=" font-family:'monospace';">, vbNormal)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Dir(filename$, vbNormal) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> FileFromZip = filename$</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">15060 просмотров </li></ul></td>
<td></td></tr></table></body></html>