<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как получить слово после последнего пробела<span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Получить слово до первого пробела достаточно просто:<br />=ПСТР(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;1;НАЙТИ(&quot; &quot;;</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">)-1)<br />Но куда чаще сложности возникают с получением слова(символа), находящегося на определенной позиции между пробелом. Я беру в качестве примера пробел, но на самом деле это может быть абсолютно любой символ. Например, для получения второго слова(т.е. слова между первым пробелом и третьим), можно составить такую формулу:<br />=ПСТР(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;НАЙТИ(&quot; &quot;;</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">)+1;НАЙТИ(&quot; &quot;;</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;НАЙТИ(&quot; &quot;;</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">)+1)-НАЙТИ(&quot; &quot;;</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">)-1)<br />На мой взгляд, выглядит несколько закручено, хотя все предельно просто:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">НАЙТИ(&quot; &quot;;<span style=" color:#0000ff;">A1</span>)+1 - ищем позицию первого пробела;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">НАЙТИ(&quot; &quot;;A1;НАЙТИ(&quot; &quot;;<span style=" color:#0000ff;">A1</span>)+1) - ищем позицию второго пробела и затем из этой позиции вычитаем позицию первого пробела(-НАЙТИ(&quot; &quot;;<span style=" color:#0000ff;">A1</span>)).</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Но есть проблема - если второго пробела нет, то формула выдаст ошибку </span><span style=" font-size:8.25pt; font-weight:600;">#ЗНАЧ!</span><span style=" font-size:8.25pt;">. Тогда придется еще и проверку на ошибку делать, что явно не добавит формуле элегантности. Поэтому я предпочитаю использовать такую формулу:<br />=ПОДСТАВИТЬ(ПРАВСИМВ(ПСТР(&quot; &quot;&amp;ПОДСТАВИТЬ(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;&quot; &quot;;ПОВТОР(&quot; &quot;;999));1;999*2);999);&quot; &quot;;&quot;&quot;)<br />На первый взгляд куда кошмарнее, чем первая. Но у неё есть ряд преимуществ:<br />она не нуждается в проверке на отсутствие пробелов;<br />изменением одного числа можно получить не второе, а 3-е, 4-е и т.д. слово.<br />Разберем самое главное: чтобы получить первое слово от начала строки, нужно в блоке </span><span style=" font-size:8.25pt; font-weight:600;">999*2</span><span style=" font-size:8.25pt;"> заменить 2 на 1:<br />=ПОДСТАВИТЬ(ПРАВСИМВ(ПСТР(&quot; &quot;&amp;ПОДСТАВИТЬ(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;&quot; &quot;;ПОВТОР(&quot; &quot;;999));1;999*1);999);&quot; &quot;;&quot;&quot;)<br />Чтобы получить 5-е - на 5:<br />=ПОДСТАВИТЬ(ПРАВСИМВ(ПСТР(&quot; &quot;&amp;ПОДСТАВИТЬ(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;&quot; &quot;;ПОВТОР(&quot; &quot;;999));1;999*5);999);&quot; &quot;;&quot;&quot;)<br />Если вдруг пробелов будет меньше, чем указанное число - то мы получим слово после последнего пробела </span><span style=" font-size:8.25pt; font-style:italic;">(т.е. первое слово с конца строки)</span><span style=" font-size:8.25pt;">. Это значит, что если указать </span><span style=" font-size:8.25pt; font-weight:600;">*999</span><span style=" font-size:8.25pt;"> - в большинстве случаев получим как раз последнее слово.<br /></span><span style=" font-size:8.25pt; font-weight:600;">Как это работает:</span><span style=" font-size:8.25pt;"> при помощи функции ПОДСТАВИТЬ мы заменяем все пробелы в тексте на 999 пробелов(число может быть меньше 999, но не должно быть меньше длины исходной строки). Далее при помощи функции ПСТР мы выдергиваем первые 999 символов, помноженные на число, обозначающее необходимое нам слово(999*1 - первое). По сути только то количество слов, которое указано(в данном случае одно - 999*1). Затем функция ПРАВСИМВ возвращает нам только последнее слово - т.е. нужное нам. А далее та же ПОДСТАВИТЬ убирает лишние теперь пробелы, заменяя их все на пустую строку - &quot;&quot;.<br />Вроде бы достигли того, что нам нужно было. Но вдруг необходимо получить второе слово с конца строки? Как тогда быть? Считать пробелы? А если у нас их штук 50 хотя бы? Можно использовать некую модификацию приведенной выше формулы, но которая как раз возвращает слово с конца строки:<br />=ПОДСТАВИТЬ(ПСТР(ПРАВСИМВ(&quot; &quot;&amp;ПОДСТАВИТЬ(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;&quot; &quot;;ПОВТОР(&quot; &quot;;999));999*1);1;999);&quot; &quot;;&quot;&quot;)<br />Принцип тот же: если в блоке 999*1 заменить 1 на 5, то получим 5-е слово с конца строки.<br />Если необходимо выдергивать слова по пробелам, то лучше дополнить еще одной функцией - СЖПРОБЕЛЫ:<br />=ПОДСТАВИТЬ(ПРАВСИМВ(ПСТР(&quot; &quot;&amp;ПОДСТАВИТЬ(СЖПРОБЕЛЫ(A1);&quot; &quot;;ПОВТОР(&quot; &quot;;999));1;999*1);999);&quot; &quot;;&quot;&quot;)<br />=ПОДСТАВИТЬ(ПСТР(ПРАВСИМВ(&quot; &quot;&amp;ПОДСТАВИТЬ(СЖПРОБЕЛЫ(A1);&quot; &quot;;ПОВТОР(&quot; &quot;;999));999*1);1;999);&quot; &quot;;&quot;&quot;)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Так же можно &quot;вытянуть&quot; определенное количество слов:<br />=СЖПРОБЕЛЫ(ПСТР(ПРАВСИМВ(&quot; &quot;&amp;ПОДСТАВИТЬ(A1;&quot; &quot;;ПОВТОР(&quot; &quot;;999));999*3);1;999*2))<br /></span><span style=" font-size:8.25pt; font-weight:600;">3</span><span style=" font-size:8.25pt;"> — третье слово с конца строки.<br /></span><span style=" font-size:8.25pt; font-weight:600;">2</span><span style=" font-size:8.25pt;"> — количество слов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Остается еще добавить, что вместо пробелов могут быть и другие символы. Например, очень часто встречается ситуация, когда надо из текста получить не одно слово в конкретной позиции, а конкретную строку из текста, разнесенного в одной ячейке на строки:<br /></span><img src="image14211.png" /><span style=" font-size:8.25pt;"><br />Тогда для получения второй строки(ТЦ Таганка и ТЦ Опус) можно применить такую формулу:<br />=ПОДСТАВИТЬ(ПРАВСИМВ(ПСТР(СИМВОЛ(10)&amp;ПОДСТАВИТЬ(C2;СИМВОЛ(10);ПОВТОР(СИМВОЛ(10);999));1;999*2);999);СИМВОЛ(10);&quot;&quot;)<br />СИМВОЛ(10) здесь означает перенос строки. Обычно эти переносы делаются с клавиатуры. Входим в режим редактирования ячейки, ставим курсор в нужное место строки и нажимаем </span><span style=" font-size:8.25pt; font-weight:600;">Alt</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">Enter</span><span style=" font-size:8.25pt;">.<br />я для получения месяцев(Август 2015 г. и Сентябрь 2015 г.) - такую:<br />=ПОДСТАВИТЬ(ПСТР(ПРАВСИМВ(&quot;/&quot;&amp;ПОДСТАВИТЬ(C2;&quot;/&quot;;ПОВТОР(&quot;/&quot;;999));999*1);1;999);&quot;/&quot;;&quot;&quot;)<br />Если лень прописывать внутри формулы один символ несколько раз, его можно записать в ячейку(скажем, G1) и в формуле указать ссылку на эту ячейку:<br />=ПОДСТАВИТЬ(ПСТР(ПРАВСИМВ(G1&amp;ПОДСТАВИТЬ(C2;G1;ПОВТОР(G1;999));999*1);1;999);G1;&quot;&quot;)<br />Теперь для изменения символа надо будет изменить его один раз в ячейке и формула &quot;вытащит&quot; нужное слово/строку, опираясь именно на этот символ.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Скачать пример: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image28848.png" /><span style=" font-size:8.25pt;">  </span><a href="http://www.excel-vba.ru/download/83/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Tips_All_WordFromEndString.xls</span></a><span style=" font-size:8.25pt;"> (29,5 KiB, 1 618 скачиваний)</span></p></body></html>