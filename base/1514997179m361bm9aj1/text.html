<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как уменьшить размер файла<span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Данный вопрос возникает периодически на различных форумах. Решил написать некоторые рекомендации по уменьшению веса файла. Применив их Вы сможете понять - действительно ли Ваши данные настолько раздувают файл или же в файле имеется много лишнего.<br />Почему я это пишу. Бывают ситуации, когда в файле всего один лист, данных на нем на 1000 строк и 20 столбцов. Никаких формул, только значения. Но размер файла непомерно велик - скажем 10 Мб. Этого недопустимо. Или есть различные формулы, но Вы все равно считаете, что размер файла не соответствует тому, что должно бы быть.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Автоматически убрать все лишнее из файла так же поможет команда надстройки MulTEx </span><a href="http://www.excel-vba.ru/multex/optimizirovat-knigu/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Оптимизировать книгу</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">При этом описанные ниже причины, которые влияют на размер файла, так же могут влиять и на его &quot;быстродействие&quot;.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Следующие действия необходимо проделать на каждом листе книги:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Первое, что необходимо вспомнить - а не в общем ли доступе файл? Если в Общем, то есть вероятность, что размер файла растет именно из-за этого. Дело в том, что при установке общего доступа к файлу, по умолчанию ведется журнал изменений, в который записываются все действия, произведенные в книге каждым пользователем за период, указанный в параметрах. Чем больше пользователей - тем сильнее раздувается файл. Как избавиться или изменить период:<br /><span style=" font-weight:600; color:#336600;">Excel 2007 и выше</span>: вкладка <span style=" font-weight:600;">Рецензирование(Review)</span> - <span style=" font-weight:600;">Доступ к книге(Shared workbook)</span>;<br /><span style=" font-weight:600; color:#336600;">Excel 2003</span>: <span style=" font-weight:600;">Сервис</span> - <span style=" font-weight:600;">Доступ к книге</span>.<br />Переходим на вкладку <span style=" font-weight:600;">Подробнее(Advanced)</span> и выбираем <span style=" font-weight:600;">Не хранить журнал изменений(don't keep change history)</span>.<br />Еще лучше - снять общий доступ с книги, сохранить. Если общий доступ все еще нужен, то открываем книгу и опять даем общий доступ, но теперь устанавливаем кол-во дней, в течении которых надо хранить журнал. По умолчанию - 30, но можно сделать меньше, если файл сильно разбухает за озвученный период. Далее неплохо бы отключить оба пункта в разделе <span style=" font-weight:600;">Включить в личное представление(Include in personal view)</span>: <span style=" font-weight:600;">параметры печати(Print settings)</span> и <span style=" font-weight:600;">фильтры(Filter settings)</span>. Личные представления позволяют сохранять для каждого пользователя файла свои параметры печати и настройки фильтров. Чем больше разных пользователей – тем больше настроек сохраняется и тем выше вероятность замедления работы файла и увеличения его размеров. А практическая ценность этих пунктов в ущерб удобству и быстроте работы с файлом сомнительная.<br />После этого сохранить файл.<br />Подробнее про общий доступ можно прочитать в статье: <a href="http://www.excel-vba.ru/chto-umeet-excel/vedenie-zhurnala-sdelannyx-v-knige-izmenenij/"><span style=" text-decoration: underline; color:#0000ff;">Ведение журнала сделанных в книге изменений</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Убедитесь, что лист не содержит ячеек без данных, но занимающих пространство. Перейдя на лист, нажмите <span style=" font-weight:600;">Ctrl</span>+<span style=" font-weight:600;">End</span>. Активируется последняя ячейка листа. Если она расположена ниже или правее последних нужных рабочих данных - то удалите все строки и столбцы после последних данных таблицы. Удалите полностью строки. Сделать это быстро можно так. Нажимаем <span style=" font-weight:600;">Ctrl</span>+<span style=" font-weight:600;">End</span> и попадаем на последнюю ячейку. Выделяем эту строку и нажимаем <span style=" font-weight:600;">Ctrl</span>+<span style=" font-weight:600;">Shift</span>+стрелка <span style=" font-weight:600;">Вверх</span>. Выделились все строки вместе с последней строкой данных. Удерживая <span style=" font-weight:600;">Shift</span> жмем на клавиатуре стрелку <span style=" font-weight:600;">Вниз</span>. Тоже самое и со столбцами.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Посмотрите лист на предмет форматирования. Необходимо избегать форматирования ЦЕЛИКОМ столбцов либо строк. Это приводит к раздуванию файла. Все форматирование, выходящее за границы таблицы необходимо убрать. А еще лучше - вообще избегать излишнего форматирования, особенно если книгой никто, кроме Вас не пользуется. Вместо Заливки ячеек - Белым цветом ставьте &quot;Нет заливки&quot;.Чтобы убрать все форматирование из ячеек: выделяете необходимый диапазон и:<br />для <span style=" font-weight:600; color:#336600;">Excel 2003</span>: <span style=" font-weight:600;">Правка</span> - <span style=" font-weight:600;">Очистить</span> - <span style=" font-weight:600;">Формат</span>.<br />В <span style=" font-weight:600; color:#336600;">Excel 2007-2010</span>: вкладка <span style=" font-weight:600;">Главная(Home)</span> - <span style=" font-weight:600;">Очистить(Clear)</span> -<span style=" font-weight:600;">Очистить форматы(Clear formats)</span><br /><img src="image30465.png" /></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверить наличие в книге лишних объектов. Удаляем объекты:<br />В <span style=" font-weight:600; color:#336600;">Excel 2003:</span> меню <span style=" font-weight:600;">Правка</span>- <span style=" font-weight:600;">Перейти</span> – <span style=" font-weight:600;">Выделить</span> – <span style=" font-weight:600;">Объекты</span>.<br />в <span style=" font-weight:600; color:#336600;">Excel 2007-2010:</span> вкладка <span style=" font-weight:600;">Главная(Home)</span> -<span style=" font-weight:600;">Найти и выделить(Find &amp; Select)</span> -<span style=" font-weight:600;">Выделение группы ячеек(Go To Special...)</span> -<span style=" font-weight:600;">Объекты(Objects)</span>.<br />Нажмите <span style=" font-weight:600;">Delete</span>. Все объекты на листе будут удалены. Правда есть небольшой шанс, что на листе так же есть и скрытые объекты. Тогда надо идти в редактор VBA (<span style=" font-weight:600;">Alt</span>+<span style=" font-weight:600;">F11</span>) -<span style=" font-weight:600;">Ctrl</span>+<span style=" font-weight:600;">R</span>. Отображаете окно свойств (<span style=" font-weight:600;">F4</span>). Находите объект <a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#ThisWorkbook"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">ЭтаКнига(ThisWorkbook)</span></a>, в окне свойств этого объекта находите свойство <span style=" font-weight:600;">DisplayDrawingObjects</span> и ставите там значение - <span style=" font-weight:600;">-4104</span>-<span style=" font-weight:600;">xlDisplayShapes</span>. После этого переходите опять на лист и повторяете операции по выделению и удалению объектов, описанные выше. Зачем все так сложно? То, что мы не видим все объекты на листе не означает, что их там нет. Плюс могут быть объекты нулевых размеров. Как правило &quot;невидимые&quot; и &quot;нулевые&quot; объекты попадают на лист в результате копирования из других файлов и работы различных макросов. И в некоторых случаях объекты переносятся с нулевой длиной и шириной или вообще невидимые. Как следствие - объект не видно, но файл увеличивается в размерах. И при каждом копировании он начинает увеличиваться в размерах в геометрической прогрессии, т.к. по умолчанию объекты копируются вместе с ячейками. После нескольких таких копирований-вставок файл начинает дико тормозить даже при выделении ячеек. Выделили ячейку, хотите выделить другую - файл задумался на пару секунд.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если привыкли помечать ячейки примечаниями (вкладка <span style=" font-weight:600;">Рецензирование</span> -<span style=" font-weight:600;">Создать примечание</span>), то самое время задуматься так ли это необходимо. Т.к. примечание это тоже объект, то их избыточное количество на листах так же может привести к замедлению работы файла. Удалить все примечания из выделенных ячеек очень просто: выделяем ячейки - вкладка <span style=" font-weight:600;">Рецензирование</span> -<span style=" font-weight:600;">Удалить</span>. Небольшой совет: если нет прямой необходимости в хранении примечаний именно таким образом, то самый правильный способ выделить отдельный столбец в таблице, в который заносить примечания для строки данных. Данный способ оптимально подходит для таблиц в правильной структуре. Тогда можно будет осуществлять поиск, сортировку и фильтрацию по примечаниям. Если примечаний уже много и информацию из них необходимо перенести в ячейки, то можно воспользоваться этим решением: <a href="http://www.excel-vba.ru/chto-umeet-excel/kak-poluchit-tekst-primechaniya-v-yachejku/"><span style=" text-decoration: underline; color:#0000ff;">Как получить текст примечания в ячейку?</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Еще очень хорошо помогает удаление всех формул и связей. Удаление не в прямом смысле: заменить все формулы значениями, которые они вернули. Это можно сделать без макросов: выделяем все ячейки с данными на листе-Копируем-правая кнопка мыши-Специальная вставка-Значения. <span style=" font-family:'Times New Roman';">Но это не очень удобно, если листов много, поэтому я заготовил для этого еще и макрос, который проделает эту операцию на всех листах активной книги:</span><br /></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe665d311278623"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub All_Cells_In_All_Sheets_To_Value() Dim wsSh As Object For Each wsSh In Sheets wsSh.UsedRange.Value = wsSh.UsedRange.Value Next wsSh End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe665d311278623-1"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub All_Cells_In_All_Sheets_To_Value()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe665d311278623-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim wsSh As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe665d311278623-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each wsSh In Sheets</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe665d311278623-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       wsSh.UsedRange.Value = wsSh.UsedRange.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe665d311278623-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next wsSh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe665d311278623-6"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Данный макрос необходимо вставить в </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#StandartModule"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">стандартный модуль</span></a><span style=" font-size:8.25pt;"> и выполнить (нажав </span><span style=" font-size:8.25pt; font-weight:600;">F5</span><span style=" font-size:8.25pt;"> в редакторе VBA или непосредственно с листа: нажать </span><span style=" font-size:8.25pt; font-weight:600;">Alt</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">F8</span><span style=" font-size:8.25pt;">-выбрать макрос All_Cells_In_All_Sheets_To_Value-</span><span style=" font-size:8.25pt; font-weight:600;">Выполнить</span><span style=" font-size:8.25pt;">) </span></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так же в книге могут содержаться имена, которые тоже порой довольно неплохо прибавляют вес файлу. Посмотреть их можно, нажав сочетание клавиш <span style=" font-weight:600;">Ctrl</span>+<span style=" font-weight:600;">F3</span>на листе. Но может оказаться так, что имена будут скрытыми, и тогда Вы просто так их не увидите. Отобразить их можно при помощи следующего кода:<br /></li>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe6668090041082"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub All_Names_Visible() Dim objName As Object, wsSh As Object For Each objName In ActiveWorkbook.Names objName.Visible = True Next objName For Each wsSh In Sheets For Each objName In wsSh.Names objName.Visible = True Next objName Next wsSh End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe6668090041082-1"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub All_Names_Visible()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim objName As Object, wsSh As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each objName In ActiveWorkbook.Names</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       objName.Visible = True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next objName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each wsSh In Sheets</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-7"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       For Each objName In wsSh.Names</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-8"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           objName.Visible = True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-9"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Next objName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next wsSh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe6668090041082-11"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Данный код используется как и предыдущий. Он отображает все имена на листе и в книге. После выполнения макроса необходимо повторно нажать сочетание клавиш </span><span style=" font-size:8.25pt; font-weight:600;">Ctrl</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">F3</span><span style=" font-size:8.25pt;"> на листе. Теперь Вы можете удалить ненужные Вам имена. Так же все имена можно сразу удалить при помощи следующего кода:<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe666e086474032"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub Delete_All_Names() Dim objName As Object, wsSh As Object On Error Resume Next For Each objName In ActiveWorkbook.Names objName.Delete Next objName For Each wsSh In Sheets For Each objName In wsSh.Names objName.Delete Next objName Next wsSh End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:80px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7fbe666e086474032-1"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub Delete_All_Names()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim objName As Object, wsSh As Object</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   On Error Resume Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each objName In ActiveWorkbook.Names</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       objName.Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next objName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-7"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each wsSh In Sheets</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-8"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       For Each objName In wsSh.Names</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-9"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           objName.Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Next objName</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-11"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next wsSh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce7fbe666e086474032-12"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Только применяя данный код Вы должны быть уверены, что </span><span style=" font-size:8.25pt; font-weight:600; font-style:italic; color:#ff0000;">Вам действительно не нужны все имена в книге</span><span style=" font-size:8.25pt;">. Т.к. выполнив данный макрос Вы уже не сможете вернуть удаленные имена.</span></p>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Проверьте, нет ли в книге скрытых листов, на которых может содержаться ненужная информация и с которыми можно проделать операции, описанные выше. Как их обнаружить можно узнать, прочитав эти статьи:<br /><a href="http://www.excel-vba.ru/chto-umeet-excel/kak-sdelat-list-skrytym/"><span style=" text-decoration: underline; color:#0000ff;">Как сделать лист скрытым?</span></a><br /><a href="http://www.excel-vba.ru/chto-umeet-excel/kak-sdelat-list-ochen-skrytym/"><span style=" text-decoration: underline; color:#0000ff;">Как сделать лист очень скрытым</span></a> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">После всех этих действий необходимо сохранить файл, чтобы изменения вступили в силу. Только после этого станет видно изменился размер файла или нет. Я бы советовал сохранять файл как копию, если не уверены, что удалили действительно ненужное.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Также см.:</span><span style=" font-size:8.25pt;"><br /></span><a href="http://www.excel-vba.ru/multex/optimizirovat-knigu/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Оптимизировать книгу</span></a></p></body></html>