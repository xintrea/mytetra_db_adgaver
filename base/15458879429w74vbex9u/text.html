<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h2>Импорт данных из Excel в SQL Server</h2>

                <p>Microsoft Office Exel уже довольно давно стал ключевой программой при переносе разных баз, <strong>тк практически любая даже очень старая база работает с Exel и перевести в него данный не состовляет ни каких проблем.</strong>
 Это пошаговое руководство описывает различные способы импорта данных из
 листов Microsoft Excel в базы данных Microsoft SQL Server.</p>
<h3>Требования перед началом</h3>
<p>В приведенном ниже списке перечислены рекомендованные оборудование, 
программное обеспечение, сетевая инфраструктура, а также необходимые 
пакеты обновления:</p>
<ul>
<li>Экземпляр Microsoft SQL Server 7.0, Microsoft SQL Server 2000, Microsoft SQL Server 2005 или Microsoft SQL Server 2008</li>
<li>Microsoft Visual Basic 6.0 для примеров объектов ADO, использующих Visual Basic</li>
</ul>
<p><strong>В ряде разделов данной статьи предполагается, что пользователь обладает достаточными знаниями в следующих областях:</strong></p>
<ul>
<li>Службы преобразования данных</li>
<li>Связанные серверы и распределенные запросы</li>
<li>Разработка объектов ADO на Visual Basic</li>
</ul>
<h3>Описание</h3>
<p>В примерах, приведенных в данной статье, импорт данных Excel выполняется с помощью следующих функций:</p>
<ul>
<li>Службы преобразования данных SQL Server (DTS)</li>
<li>Службы интеграции Microsoft SQL Server 2005 (SSIS)</li>
<li>Связанные серверы SQL Server</li>
<li>Распределенные запросы SQL Server</li>
<li>Поставщик объектов данных ActiveX(ADO) и Microsoft OLE DB для SQL Server</li>
<li>Поставщик ADO и Microsoft OLE DB для Jet 4.0</li>
</ul>
<h3>Примеры</h3>
<h4>Import или Append</h4>
<p>В примерах команд SQL, используемых в статье, показаны запросы Create
 Table для импорта данных Excel в новую таблицу SQL Server с 
использованием конструкций SELECT…INTO…FROM. При сохранении ссылок на 
объекты-источники и получатели выражения, приведенные в примерах, могут 
быть преобразованы в запросы Append с использованием конструкций INSERT 
INTO…SELECT…FROM.</p>
<h4>Использование DTS или SSIS</h4>
<p>Для импорта данных Excel в таблицы SQL Server могут быть использованы
 мастер импорта служб преобразования данных (DTS) SQL Server или мастер 
импорта и экспорта SQL Server. При работе с мастером и выборе исходных 
таблиц Excel помните, что имена объектов Excel со знаком доллара ($) 
являются именами листов (например Лист1$), а имена объектов без знака 
доллара являются названиями именованных диапазонов Excel.</p>
<h4>Использование связанного сервера</h4>
<p>Для упрощения запросов книга Excel может быть настроена как связанный
 сервер в SQL Server.  Для получения дополнительных сведений щелкните 
приведенный ниже номер статьи базы знаний Майкрософт:<a href="http://support.microsoft.com/kb/306397/RU/" target="_blank"> 306397</a> <span class="pLink"> (<a href="http://support.microsoft.com/kb/306397/RU/" rel="nofollow">http://support.microsoft.com/kb/306397/RU/</a> ) </span></p>
<p><strong>Следующая программа импортирует данные из рабочего листа 
«Customers» связанного сервера Excel «EXCELLINK» в новую таблицу SQL 
Server с именем XLImport1:</strong></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SELECT * INTO XLImport1 FROM EXCELLINK...[Customers$]</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">**→</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p><strong>При использовании OPENQUERY источнику может быть передан сквозной запрос:</strong></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SELECT * INTO XLImport2 FROM OPENQUERY(EXCELLINK,</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>‘SELECT * FROM [Customers$]’)</p>
<p>**→</p>
<h4>Использование распределенных запросов</h4>
<p><strong>Если устанавливать существующее подключение к книге Excel как
 связанный сервер нежелательно, данные могут быть импортированы с 
использованием функций OPENDATASOURCE или OPENROWSET. В следующих 
примерах кода также производится импорт данных из рабочего листа Excel 
«Customers» в новые таблицы SQL Server: </strong></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SELECT * INTO XLImport3 FROM OPENDATASOURCE('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>',</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Data Source=C:\test\<span class="skimlinks-unlinked">xltest.xls;Extended</span> Properties=Excel 8.0')...[Customers$]</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SELECT * INTO XLImport4 FROM OPENROWSET('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>',</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Excel 8.0;Database=C:\test\<span class="skimlinks-unlinked">xltest.xls</span>', [Customers$])</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SELECT * INTO XLImport5 FROM OPENROWSET('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>',</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Excel 8.0;Database=C:\test\<span class="skimlinks-unlinked">xltest.xls</span>', 'SELECT * FROM [Customers$]'</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">**→</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4>Использование ADO и SQLOLEDB</h4>
<p>Синтаксис «распределенных запросов», приведенный в разделе Использование распределенных запросов,<strong>
 может быть использован также в приложении ADO для импорта данных Excel в
 SQL Server, если для подключения к SQL Server используется Microsoft 
OLE DB для SQL Server (SQLOLEDB).</strong></p>
<p><strong>Для работы следующего примера программы на Visual Basic 6.0 
требуется добавление ссылки на проект в объекты данных ActiveX (ADO). В 
этом примере показано использование функций OPENDATASOURCE и OPENROWSET 
для подключения SQLOLEDB.</strong></p>
<p><strong><span style="color:#008000;">on Visual Basic</span></strong></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim cn As ADODB.Connection</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim strSQL As String</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim lngRecsAff As Long</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set cn = New ADODB.Connection</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">cn.Open</span> "Provider=SQLOLEDB;Data Source=&lt;server&gt;;" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "Initial Catalog=&lt;database&gt;;User ID=&lt;user&gt;;Password=&lt;password&gt;"</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    'Import by using OPENDATASOURCE.</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    strSQL = "SELECT * INTO XLImport6 FROM " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "OPENDATASOURCE('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>', " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "'Data Source=C:\test\<span class="skimlinks-unlinked">xltest.xls</span>;" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "Extended Properties=Excel 8.0')...[Customers$]"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> strSQL</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    cn.Execute strSQL, lngRecsAff, adExecuteNoRecords</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> "Records affected: " &amp; lngRecsAff</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    'Import by using OPENROWSET and object name.</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    strSQL = "SELECT * INTO XLImport7 FROM " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "OPENROWSET('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>', " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "'Excel 8.0;Database=C:\test\<span class="skimlinks-unlinked">xltest.xls</span>', " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "[Customers$])"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> strSQL</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    cn.Execute strSQL, lngRecsAff, adExecuteNoRecords</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> "Records affected: " &amp; lngRecsAff</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    'Import by using OPENROWSET and SELECT query.</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    strSQL = "SELECT * INTO XLImport8 FROM " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "OPENROWSET('<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>', " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "'Excel 8.0;Database=C:\test\<span class="skimlinks-unlinked">xltest.xls</span>', " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "'SELECT * FROM [Customers$]')"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> strSQL</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    cn.Execute strSQL, lngRecsAff, adExecuteNoRecords</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> "Records affected: " &amp; lngRecsAff</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">cn.Close</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set cn = Nothing</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">**→</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4>Использование ADO и Поставщика данных Jet</h4>
<p>В примере из предыдущего раздела при импорте из Excel в SQL для связи с получателем использовались ADO и поставщик SQLOLEDB. <strong>Для подключения к источнику Excel можно воспользоваться поставщиком данных OLE DB для Jet 4.0.</strong></p>
<p>Используя в выражениях SQL особые конструкции, имеющие три различных 
формата, база данных Jet может ссылаться на внешние базы данных:</p>
<ul>
<li><strong>[<var>Полный путь к базе данных Microsoft Access</var>].[<var>Название таблицы</var>]</strong></li>
<li><strong>[<var>Название ISAM</var>;<var>Строка подключения ISAM</var>].[<var>Название таблицы</var>]</strong></li>
<li><strong>[ODBC;<var>Строка подключения ODBС</var>].[<var>Название таблицы</var>]</strong></li>
</ul>
<p>В этом разделе для создания подключения ODBC к базе данных SQL Server используется третий формат. <strong>Может использоваться имя источника данных (DSN) ODBC или строка подключения без определения DSN:</strong></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#008000;">DSN:</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    [odbc;DSN=&lt;DSN name&gt;;UID=&lt;user&gt;;PWD=&lt;password&gt;]</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#008000;">Подключение без определения DSN:</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   [odbc;Driver={SQL Server};Server=&lt;server&gt;;Database=&lt;database&gt;;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">       UID=&lt;user&gt;;PWD=&lt;password&gt;]</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">**→</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p><strong>Для работы следующего примера программы на Visual Basic 6.0 
требуется добавление ссылки на проект в ADO. В примере показан импорт 
данных Excel в SQL Server через подключение ADO с использованием 
поставщика данных Jet 4.0.</strong></p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">←**</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim cn As ADODB.Connection</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim strSQL As String</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Dim lngRecsAff As Long</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set cn = New ADODB.Connection</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">cn.Open</span> "Provider=<span class="skimlinks-unlinked">Microsoft.Jet.OLEDB.4.0</span>;" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "Data Source=C:\test\<span class="skimlinks-unlinked">xltestt.xls</span>;" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "Extended Properties=Excel 8.0"</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    'Import by using Jet Provider.</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    strSQL = "SELECT * INTO [odbc;Driver={SQL Server};" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "Server=&lt;server&gt;;Database=&lt;database&gt;;" &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "UID=&lt;user&gt;;PWD=&lt;password&gt;].XLImport9 " &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        "FROM [Customers$]"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> strSQL</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    cn.Execute strSQL, lngRecsAff, adExecuteNoRecords</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">Debug.Print</span> "Records affected: " &amp; lngRecsAff</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <span class="skimlinks-unlinked">cn.Close</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Set cn = Nothing</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style="color:#ff0000;">**→</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>Для импорта данных Excel в другие базы данных Microsoft Access, базы 
данных индексно-последовательного метода доступа (ISAM) или базы ODBC 
также могут использоваться конструкции, поддерживаемые поставщиком 
данных Jet.</p>
<h3>Устранение неполадок</h3>
<ul>
<li>Помните, что объекты Excel, имена которых содержат знак доллара ($),
 являются листами (например, Лист1$), другие объекты являются 
именованными диапазонами Excel.</li>
<li>В некоторых ситуациях, особенно если источник данных Excel 
представлен именем таблицы, а не запросом SELECT, столбцы 
таблицы-получателя SQL Server переупорядочиваются по алфавиту.Для 
получения дополнительных сведений о проблеме в работе поставщика данных 
Jet щелкните следующий номер статьи базы знаний Майкрософт:<br>
<a href="http://support.microsoft.com/kb/299484/RU/" target="_blank">299484</a> <span class="pLink"> (<a href="http://support.microsoft.com/kb/299484/RU/" rel="nofollow">http://support.microsoft.com/kb/299484/RU/</a>                         )</span></li>
<li>Обнаружив, что в столбцах Excel содержатся числовые и текстовые 
данные, поставщик данных Jet выбирает «доминирующий» тип данных и 
возвращает NULL вместо значений другого типа.Для получения 
дополнительных сведений об обходе этой проблемы щелкните следующий номер
 статьи базы знаний Майкрософт:<br>
<a href="http://support.microsoft.com/kb/194124/RU/" target="_blank">194124</a> <span class="pLink"> (<a href="http://support.microsoft.com/kb/194124/RU/" rel="nofollow">http://support.microsoft.com/kb/194124/RU/</a>                         )</span></li>
</ul>
<p>—————————————————-</p>
<h2><strong>Полезные ссылки:</strong></h2>
<p><a href="http://support.microsoft.com/kb/306397/RU/" target="_blank">306397</a> (<a href="http://support.microsoft.com/kb/306397/RU/" rel="nofollow">http://support.microsoft.com/kb/306397/RU/</a> )</p>
<p>Использование Excel со связанными серверами SQL Server и распределенными запросами</p>
<p><a href="http://support.microsoft.com/kb/299484/RU/" target="_blank">299484</a> (<a href="http://support.microsoft.com/kb/299484/RU/" rel="nofollow">http://support.microsoft.com/kb/299484/RU/</a> )</p>
<p>При использовании ADOX для получения столбцов таблицы Access столбцы упорядочиваются по алфавиту</p>
<p><a href="http://support.microsoft.com/kb/194124/RU/" target="_blank">194124</a> (<a href="http://support.microsoft.com/kb/194124/RU/" rel="nofollow">http://support.microsoft.com/kb/194124/RU/</a> )</p>
<p>При использовании DAO OpenRecordset данным в Excel присваивается значение NULL</p>
</body>
</html></p></body></html>