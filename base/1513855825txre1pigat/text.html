<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="container"></a><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?19"><span style=" text-decoration: underline; color:#0000ff;">f</span></a><span style=" text-decoration: underline; color:#0000ff;">irststeps.ru</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-title"></a>www.ПЕРВЫЕ ШАГИ.ru :: Шаг 19 -<span style=" font-size:x-large; font-weight:600;">Метод CreateWorkspace</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-credits"></a>4-6 минут </p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="moz-reader-content"></a>Описание<br />Создает новый объект <span style=" font-weight:600;">Workspace</span>.<br /></p>
<pre style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Set рабочаяОбласть = CreateWorkspace(имя, пользователь, пароль, тип)</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Параметры<br /><span style=" font-weight:600;">рабочаяОбласть</span><br />Объектная переменная, представляющая создаваемый объект <span style=" font-weight:600;">Workspace</span>.<br /><span style=" font-weight:600;">имя</span><br />Выражение или переменная типа <span style=" font-weight:600;">String</span>, содержащая уникальное имя нового объекта <span style=" font-weight:600;">Workspace</span>. Дополнительные сведения о допустимых именах объектов <span style=" font-weight:600;">Workspace</span> приведены в разделе для свойства <span style=" font-weight:600;">Name</span>.<br /><span style=" font-weight:600;">Пользователь</span><br />Выражение или переменная типа <span style=" font-weight:600;">String</span>, определяющая владельца нового объекта <span style=" font-weight:600;">Workspace</span>. Дополнительные сведения приведены в разделе для свойства <span style=" font-weight:600;">UserName</span>.<br /><span style=" font-weight:600;">пароль</span><br />Выражение или переменная типа <span style=" font-weight:600;">String</span>, содержащая пароль для нового объекта <span style=" font-weight:600;">Workspace</span>. Пароль может содержать до 14 любых символов кроме пустого символа ASCII 0. Дополнительные сведения о допустимых паролях приведены в разделе для свойства <span style=" font-weight:600;">Password</span>.<br /><span style=" font-weight:600;">тип</span><br />Необязательный. Константа, определяющая тип рабочей области, как это описано в разделе &quot;Значения&quot;: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbUseJet</span> - Создание рабочей области ядра Microsoft Jet. </li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">dbUseODBC</span> - Создание рабочей области ODBCDirect. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечания<br />После создания нового объекта <span style=" font-weight:600;">Workspace</span> с помощью метода <span style=" font-weight:600;">CreateWorkspace</span> открывается сеанс для новой рабочей области и становятся возможными ссылки на объект <span style=" font-weight:600;">Workspace</span> в приложении.<br />Объекты <span style=" font-weight:600;">Workspace</span> не являются постоянными и не сохраняются на диске. После создания нового объекта <span style=" font-weight:600;">Workspace</span> не допускается изменение значения любого из его свойств, за исключением свойства <span style=" font-weight:600;">Name</span>, которое пользователь может изменить перед добавлением объекта <span style=" font-weight:600;">Workspace</span> в семейство <span style=" font-weight:600;">Workspaces</span>.<br />Новый объект <span style=" font-weight:600;">Workspace</span> не обязательно добавлять в семейство перед началом работы с этим объектом. Новый объект <span style=" font-weight:600;">Workspace</span> следует добавлять в семейство только в том случае, если требуется ссылаться на этот объект через семейство <span style=" font-weight:600;">Workspaces</span>.<br />Аргумент тип определяет, представляет ли новый объект <span style=" font-weight:600;">Workspace</span> рабочую область ядра <span style=" font-weight:600;">Microsoft Jet</span> или рабочую область <span style=" font-weight:600;">ODBCDirect</span>. Если значением аргумента тип является константа <span style=" font-weight:600;">dbUseODBC</span> и при этом не создана ни одна рабочая область ядра <span style=" font-weight:600;">Microsoft Jet</span>, то ядро базы данных <span style=" font-weight:600;">Microsoft Jet</span> не будет загружено в память и все операции будут выполняться с источником данных <span style=" font-weight:600;">ODBC</span>, указанным в объекте <span style=" font-weight:600;">Connection</span>. Если аргумент тип опущен, источник данных для объекта <span style=" font-weight:600;">Workspace</span> будет определяться значением свойства <span style=" font-weight:600;">DefaultType</span> объекта <span style=" font-weight:600;">DBEngine</span>. Допускается сосуществование открытых рабочих областей <span style=" font-weight:600;">Microsoft Jet</span> и <span style=" font-weight:600;">ODBCDirect</span>.<br />Для удаления объекта <span style=" font-weight:600;">Workspace</span> из семейства <span style=" font-weight:600;">Workspaces</span> следует закрыть все открытые базы данных, а затем вызвать метод <span style=" font-weight:600;">Close</span> для объекта <span style=" font-weight:600;">Workspace</span>.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример<br />Следующая программа использует метод <span style=" font-weight:600;">CreateWorkspace</span> для создания рабочей области <span style=" font-weight:600;">Microsoft Jet</span> и рабочей области <span style=" font-weight:600;">ODBCDirect</span>. Затем печатаются списки свойств двух рабочих областей.<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Sub CreateWorkspaceX()</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkODBC As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkJet As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkLoop As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim prpLoop As Property</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Создает рабочую область ODBCDirect. До создания рабочей</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' области Microsoft Jet, ядро базы данных Microsoft Jet </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' не будет загружено в память.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Set wrkODBC = CreateWorkspace(&quot;ODBCWorkspace&quot;, &quot;admin&quot;, &quot;&quot;, dbUseODBC)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Workspaces.Append wrkODBC</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	DefaultType = dbUseJet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Создает безымянный объект Workspace с типом, </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' указанным в свойстве DefaultType объекта DBEngine </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' (dbUseJet).</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Set wrkJet = CreateWorkspace(&quot;&quot;, &quot;admin&quot;, &quot;&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Отображает семейство Workspaces.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Debug.Print &quot;Объекты Workspace в семействе Workspaces:&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	For Each wrkLoop In Workspaces</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;    &quot; &amp; wrkLoop.Name</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Next wrkLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	With wrkODBC</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Отображает семейство Properties объекта ODBCDirect.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;Свойства &quot; &amp; .Name</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error Resume Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		For Each prpLoop In .Properties</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;    &quot; &amp; prpLoop.Name &amp; &quot; = &quot; &amp; prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Next prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error GoTo 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	End With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	With wrkJet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Отображает семейство Properties рабочей области </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">		' Microsoft Jet.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;Свойства безымянной рабочей области Microsoft Jet&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error Resume Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		For Each prpLoop In .Properties</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">			Debug.Print &quot;    &quot; &amp; prpLoop.Name &amp; &quot; = &quot; &amp; prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Next prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error GoTo 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	End With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	wrkODBC.Close</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	wrkJet.Close</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">End Sub</span> </pre>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>