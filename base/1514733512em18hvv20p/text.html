<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/print_all_code_of_VBA_project"><span style=" text-decoration: underline; color:#0000ff;">Выгрузка списка макросов (или всего кода целиком) из проекта VBA в текстовый файл</span></a> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/text_files"><span style=" text-decoration: underline; color:#0000ff;">Текстовые файлы</span></a></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/another"><span style=" text-decoration: underline; color:#0000ff;">Разное</span></a> </li></ul></td></tr></table>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> print_all_sub_and_function_names_of_current_project()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' пишет названия функций программы в файл c:\output.txt</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    sub_list = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> iVBComponents = ThisWorkbook.VBProject.VBComponents</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Each</span><span style=" font-family:'monospace';"> iVBComponent </span><span style=" font-family:'monospace'; color:#000080;">In</span><span style=" font-family:'monospace';"> iVBComponents</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">Select</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> iVBComponent.</span><span style=" font-family:'monospace'; color:#000080;">Type</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 100:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">With</span><span style=" font-family:'monospace';"> iVBComponent.CodeModule</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    sub_list = sub_list &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;==============&quot;</span><span style=" font-family:'monospace';"> &amp; vbNewLine &amp; .Name &amp; vbNewLine &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;==============&quot;</span><span style=" font-family:'monospace';"> &amp; vbNewLine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> .CountOfLines</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;Sub &quot;</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">And</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;Exit &quot;</span><span style=" font-family:'monospace';">) = 0 </span><span style=" font-family:'monospace'; color:#000080;">And</span><span style=" font-family:'monospace';"> _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                           (InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;End Sub&quot;</span><span style=" font-family:'monospace';">) &gt; 15 </span><span style=" font-family:'monospace'; color:#000080;">Or</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;End Sub&quot;</span><span style=" font-family:'monospace';">) = 0) </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                            sub_list = sub_list &amp; .Lines(i, 1) &amp; vbNewLine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;Function &quot;</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">And</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;Exit &quot;</span><span style=" font-family:'monospace';">) = 0 </span><span style=" font-family:'monospace'; color:#000080;">And</span><span style=" font-family:'monospace';"> _</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                           (InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;End Function&quot;</span><span style=" font-family:'monospace';">) &gt; 15 </span><span style=" font-family:'monospace'; color:#000080;">Or</span><span style=" font-family:'monospace';"> InStr(1, .Lines(i, 1), </span><span style=" font-family:'monospace'; color:#800000;">&quot;End Function&quot;</span><span style=" font-family:'monospace';">) = 0) </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                            sub_list = sub_list &amp; .Lines(i, 1) &amp; vbNewLine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Select</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> FSO </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> FileSystemObject, ts </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> TextStream, fil </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> File</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FSO = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;scripting.filesystemobject&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> FSO.FileExists(</span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\output.txt&quot;</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> Kill </span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\output.txt&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> ts = FSO.OpenTextFile(</span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\output.txt&quot;</span><span style=" font-family:'monospace';">, 8, </span><span style=" font-family:'monospace'; color:#000080;">True</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ts.Write sub_list: ts.</span><span style=" font-family:'monospace'; color:#000080;">Close</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> ts = </span><span style=" font-family:'monospace'; color:#000080;">Nothing</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FSO = </span><span style=" font-family:'monospace'; color:#000080;">Nothing</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример того, что записывается в файл &quot;c:\output.txt&quot;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">==============<br />Trace_Open_Save<br />==============<br />Sub test988d()<br />Function Get_InitialFileName_for_Trace() As String<br />Function SaveTrace(ByVal Filename As String, ByRef Tr As Trace) As Boolean<br />Sub test_LoadTrace(): Dim Tr As Trace: Set Tr = LoadTrace: Tr.Existed = True: Tr.Show: End Sub<br />Function LoadTrace(Optional ByVal Filename As String = &quot;&quot;) As Trace<br />==============<br />Link<br />==============<br />Function ConvertHPPs(ByRef node As TraceNode, HPPind As Integer) As String<br />Function GetLinkInfo() As String<br />Sub Apply()<br />Private Sub Class_Initialize()<br />Sub MoveLink(ByRef WSource As Warrant, ByRef WDestination As Warrant)<br />Sub DeleteLink(ByRef WSource As Warrant)<br />Sub AddLink(ByRef WDestination As Warrant)<br />Sub Undo()</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> print_all_code_of_current_project()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' пишет весь код данной программы в файл c:\code.vb</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    sub_list = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> iVBComponents = ThisWorkbook.VBProject.VBComponents</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Each</span><span style=" font-family:'monospace';"> iVBComponent </span><span style=" font-family:'monospace'; color:#000080;">In</span><span style=" font-family:'monospace';"> iVBComponents</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">Select</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> iVBComponent.</span><span style=" font-family:'monospace'; color:#000080;">Type</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 100:</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">With</span><span style=" font-family:'monospace';"> iVBComponent.CodeModule</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    sub_list = sub_list &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;==============  &quot;</span><span style=" font-family:'monospace';"> &amp; .Name &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;  ==============&quot;</span><span style=" font-family:'monospace';"> &amp; vbNewLine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> .CountOfLines</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        codeline = Trim$(.Lines(i, 1))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Len(codeline) &gt; 0 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> sub_list = sub_list &amp; codeline &amp; vbNewLine</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Select</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> FSO </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> FileSystemObject, ts </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> TextStream, fil </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> File</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FSO = CreateObject(</span><span style=" font-family:'monospace'; color:#800000;">&quot;scripting.filesystemobject&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> FSO.FileExists(</span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\code.vb&quot;</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> Kill </span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\code.vb&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> ts = FSO.OpenTextFile(</span><span style=" font-family:'monospace'; color:#800000;">&quot;c:\code.vb&quot;</span><span style=" font-family:'monospace';">, 8, </span><span style=" font-family:'monospace'; color:#000080;">True</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ts.Write sub_list: ts.</span><span style=" font-family:'monospace'; color:#000080;">Close</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> ts = </span><span style=" font-family:'monospace'; color:#000080;">Nothing</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">Set</span><span style=" font-family:'monospace';"> FSO = </span><span style=" font-family:'monospace'; color:#000080;">Nothing</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример того, что записывается в файл &quot;c:\code.vb&quot;</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">============== Files_Control ==============<br />Public DectDB As New Collection<br />Public Enum FileIconConst<br />az_Cross = 1: az_Trace = 2: az_Warrant = 3: az_Distr = 4<br />az_Excel = 10: az_Access_Key = 50: az_Settings = 51: az_LogFile = 60<br />End Enum<br />Sub Reg_NewFileTypeEx(ByVal NewExtension As String, ByVal NewDescription As String, ByVal NewIcon As FileIconConst)<br />' регистрирует новый тип файла. иконка файла в соответствии с FileIconConst<br />Const az = &quot;CompanyName&quot;<br />SaveRegString HKEY_CLASSES_ROOT, NewExtension, &quot;&quot;, az &amp; NewExtension<br />SaveRegString HKEY_CLASSES_ROOT, az &amp; NewExtension, &quot;&quot;, NewDescription<br />SaveRegString HKEY_CLASSES_ROOT, az &amp; NewExtension, &quot;EditFlags&quot;, 0<br />Select Case NewIcon ' чтобы файлы можно было открыть EXCEL-ем без лишних вопросов о формате файла </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">7257 просмотров</li></ul></body></html>