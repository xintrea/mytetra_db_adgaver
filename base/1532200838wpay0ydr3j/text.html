<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Анализ текста регулярными выражениями (RegExp) в Excel</span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.planetaexcel.ru/upload/iblock/993/regexp.xlsm"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;"> Скачать пример</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		<br />												</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><img src="13.png" width="418" height="244" style="float: right;" /><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Одной из самых трудоемких и неприятных задач при работе с текстом в Excel является </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">парсинг </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">- разбор буквенно-цифровой &quot;каши&quot; на составляющие и извлечение из нее нужных нам фрагментов. Например:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">извлечение почтового индекса из адреса (хорошо, если индекс всегда в начале, а если нет?)	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">нахождение номера и даты счета из описания платежа в банковской выписке	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">извлечение ИНН из разношерстных описаний компаний в списке контрагентов	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">поиск номера автомобиля или артикула товара в описании и т.д. <br /> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Обычно во подобных случаях, после получасового муторного ковыряния в тексте вручную, в голову начинают приходить мысли как-то автоматизировать этот процесс (особенно если данных много). Решений тут несколько и с разной степенью сложности-эффективности:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использовать <span style=" font-weight:600;">встроенные текстовые функции Excel</span> для поиска-нарезки-склейки текста: <span style=" font-weight:600;">ЛЕВСИМВ </span><span style=" font-weight:600; color:#cccccc;">(LEFT)</span>, <span style=" font-weight:600;">ПРАВСИМВ </span><span style=" font-weight:600; color:#cccccc;">(RIGHT)</span>, <span style=" font-weight:600;">ПСТР </span><span style=" font-weight:600; color:#cccccc;">(MID)</span>, <a href="http://www.planetaexcel.ru/techniques/7/89/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">СЦЕПИТЬ </span></a><a href="http://www.planetaexcel.ru/techniques/7/89/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">(CONCATENATE) </span></a><a href="http://www.planetaexcel.ru/techniques/7/89/"><span style=" text-decoration: underline; color:#0000ff;">и ее аналоги</span></a>, <span style=" font-weight:600;">ОБЪЕДИНИТЬ </span><span style=" font-weight:600; color:#cccccc;">(JOINTEXT)</span>, <a href="http://www.planetaexcel.ru/techniques/7/2602/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">СОВПАД </span></a><a href="http://www.planetaexcel.ru/techniques/7/2602/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">(EXACT)</span></a> и т.д. Этот способ хорош, если в тексте есть четкая логика (например, индекс всегда в начале адреса). В противном случае формулы существенно усложняются и, порой, дело доходит даже до формул массива, что сильно тормозит на больших таблицах.	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование <a href="https://www.planetaexcel.ru/techniques/7/97/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">оператора проверки текстового подобия Like</span></a> из Visual Basic, обернутого в пользовательскую макро-функцию. Это позволяет реализовать более гибкий поиск с использованием символов подстановки (*,#,? и т.д.) К сожалению, этот инструмент не умеет извлекать нужную подстроку из текста - только проверять, содержится ли она в нем.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Кроме вышеперечисленного, есть еще один подход, очень известный в узких кругах профессиональных программистов, веб-разработчиков и прочих технарей - это </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">регулярные выражения</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (Regular Expressions = RegExp = &quot;регэкспы&quot; = &quot;регулярки&quot;). Упрощенно говоря, </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">RegExp - это язык, где с помощью специальных символов и правил производится поиск нужных подстрок в тексте, их извлечение или замена на другой текст</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Регулярные выражения - это очень мощный и красивый инструмент, на порядок превосходящий по возможностям все остальные способы работы с текстом. Многие языки программирования (C#, PHP, Perl, JavaScript...) и текстовые редакторы (Word, Notepad++...) поддерживают регулярные выражения.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Microsoft Excel, к сожалению, не имеет поддержки RegExp по-умолчанию &quot;из коробки&quot;, но это легко исправить с помощью VBA. Откройте редактор Visual Basic с вкладки </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Разработчик </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#cccccc;">(Developer)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или сочетанием клавиш Alt+F11. Затем вставьте новый модуль через меню </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Insert - Module</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и скопируйте туда текст вот такой макрофункции: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">Public Function RegExpExtract(Text As String, Pattern As String, Optional Item As Integer = 1) As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    On Error GoTo ErrHandl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    Set regex = CreateObject(&quot;VBScript.RegExp&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    regex.Pattern = Pattern</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    regex.Global = True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    If regex.Test(Text) Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">        Set matches = regex.Execute(Text)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">        RegExpExtract = matches.Item(Item - 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">        Exit Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">ErrHandl:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">    RegExpExtract = CVErr(xlErrValue)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_659574"></a><span style=" color:#0000ff;">End Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#0000ff;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Теперь можно закрыть редактор Visual Basic и, вернувшись в Excel, опробовать нашу новую функцию. Синтаксис у нее следующий:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">=RegExpExtract( Txt ; Pattern ; Item )</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 где</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Txt </span>- ячейка с текстом, который мы проверяем и из которого хотим извлечь нужную нам подстроку	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Pattern </span>- маска (шаблон) для поиска подстроки	</li>
<li style=" font-family:'DejaVu Sans'; font-size:11pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Item </span>- порядковый номер подстроки, которую надо извлечь, если их несколько (если не указан, то выводится первое вхождение)</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Самое интересное тут, конечно, это Pattern - строка-шаблон из спецсимволов &quot;на языке&quot; RegExp, которая и задает, что именно и где мы хотим найти. Вот самые основные из них - для начала:<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="1" cellpadding="5">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Паттерн</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Описание</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Самое простое - это точка. Она обозначает любой символ в шаблоне на указанной позиции.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\s</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Любой символ, выглядящий как пробел (пробел, табуляция или перенос строки).<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\S</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Анти-вариант предыдущего шаблона, т.е. любой НЕпробельный символ.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\d</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Любая цифра<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;"> \D</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Анти-вариант предыдущего, т.е. любая НЕ цифра<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\w</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Любой символ латиницы (A-Z), цифра или знак подчеркивания<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\W</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Анти-вариант предыдущего, т.е. не латиница, не цифра и не подчеркивание.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">[</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; color:#37b44a;">символы</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 В квадратных скобках можно указать один или несколько символов, разрешенных на указанной позиции в тексте. Например </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">ст[уо]л</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> будет соответствовать любому из слов: </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">стол </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">стул</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.<br />		 Также можно не перечислять символы, а задать их диапазоном через дефис, т.е. вместо </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[ABDCDEF]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> написать </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[A-F]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. или вместо </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[4567]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> ввести </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[4-7]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Например, для обозначения всех символов кириллицы можно использовать шаблон </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[а-яА-ЯёЁ]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">[^</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic; color:#37b44a;">символы</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">]</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Если после открывающей квадратной скобки добавить символ &quot;крышки&quot; </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">^</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, то набор приобретет обратный смысл - на указанной позиции в тексте будут разрешены все символы, кроме перечисленных. Так, шаблон </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">[^ЖМ]уть</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> найдет </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Путь </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Суть</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Забудь</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, но не </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Жуть </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Муть</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">, например.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">|</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Логический оператор </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">ИЛИ </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#cccccc;">(OR)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> для проверки по любому из указанных критериев. Например </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">(счет|счёт|invoice)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> будет искать в тексте любое из указанных слов. Обычно набор вариантов заключается в скобки.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">^</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Начало строки<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">$</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Конец строки<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">\b</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Край слова<br />	</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Если мы ищем определенное количество символов, например, шестизначный почтовый индекс или все трехбуквенные коды товаров, то на помощь нам приходят </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">квантификаторы </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">или </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">кванторы </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">- специальные выражения, задающие количество искомых знаков. Квантификаторы применяются к тому символу, что стоит перед ним:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="1" cellpadding="5">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		   </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Квантор</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Описание</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">?</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Ноль или одно вхождение. Например </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">.?</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> будет означать один любой символ или его отсутствие.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">+</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Одно или более вхождений. Например </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">\d+</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> означает любое количество цифр (т.е. любое число от 0 до бесконечности).<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		  </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">*</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Ноль или более вхождений, т.е. любое количество. Так </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">\s*</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> означает любое количество пробелов или их отсутствие.<br />	</span></p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">{</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#37b44a;">число</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">}</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или<br /> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">{</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#37b44a;">число1</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">,</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; color:#37b44a;">число2</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">}</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />		</span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">		 Если нужно задать строго определенное количество вхождений, то оно задается в фигурных скобках. Например </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">\d{6}</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> означает строго шесть цифр, а шаблон </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; color:#9d0a0f;">\s{2,5}</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> - от двух до пяти пробелов<br />	</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 Теперь давайте перейдем к самому интересному - разбору применения созданной функции и того, что узнали о паттернах на практических примерах из жизни.</span></p></body></html>