<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div id="ctl10_ctl03_PanelHeader" style="width:100%;"><table id="table01" style="line-height: normal" width="100%" cellspacing="5" cellpadding="0" border="0"><tbody><tr><td class="page_header" valign="middle" align="left"><font color="#C91F49">Использование календаря: ActiveX Calendar
                                                        </font>
        </td>
        <td rowspan="3" style="padding: 10px" valign="top" align="left">
            <a id="ctl10_ctl03_ImageLogo" class="HyperlinkCssLogo" title="Использование календаря: ActiveX Calendar" href="http://www.leadersoft.ru/Rus/help/code/Products/11879/images/logo.gif"></a>  
                  </td>
    </tr>
    <tr>
        <td valign="top" align="left">
        <div id="modernbricksmenu2">
            <font color="#C91F49">
            <a id="ctl10_ctl03_img_left" class="img_left" href="http://www.leadersoft.ru/Rus/help/code/Default.aspx"><img src="1.png" style="border-width:0px;"></a>
            </font>
            <ul id="ctl10_ctl03_ProductMenu">
			<li id="current"><a href="http://www.leadersoft.ru/Rus/help/code/Default.aspx?go=product&amp;ProductID=11879">Описание</a></li><li><a href="http://www.leadersoft.ru/Rus/help/code/Default.aspx?go=product&amp;ProductID=11879&amp;t2=galary">Галерея</a></li>
		</ul>
        </div>
             </td>
    </tr>
    <tr>
        <td style="padding:15px;" valign="top" align="left">
            <span id="ctl10_ctl03_ProductDescription">Данный пример 
показывает как можно создать календарь, используя ActiveX Calendar от 
Microsoft. Поставьте ссылку на C:\Program Files\Microsoft 
Office\OFFICE11\MSCALL.OCX. Применяется класс для создания календаря.</span>
        </td>
    </tr>
    </tbody></table>
            <div id="line_green2" class="line_green2">
            </div>

	</div>
<div>
<div id="ctl10_ctl03_ctl00_PanelLine" style="width:100%;">
		
            <table id="Table2" class="bg_line" width="100%" cellspacing="0" cellpadding="0" border="0">
                <tbody><tr>
                    <td style="width: 6px; height: 27px;" valign="top" nowrap="nowrap">
                        <img id="ctl10_ctl03_ctl00_Image2" src="2.png" style="border-width:0px;"></td>
                    <td class="text12" style="font-weight: bold; height: 27px;" width="100%">
                        <span id="ctl10_ctl03_ctl00_Label4" style="font-family:arial;font-size:Small;font-weight:bold;">Свойства продукта</span></td>
                    <td style="height: 27px" valign="middle" nowrap="nowrap">
                    </td>
                </tr>
            </tbody></table>

	</div>
<br>
<table id="ctl10_ctl03_ctl00_DataListProperty" style="font-weight:normal;width:100%;border-collapse:collapse;" cellspacing="0" border="0">
		<tbody><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl00_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl00_Label2">Microsoft Office: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl00_HyperLink1" style="color:Green;">2000,2002,2003,2007,2010</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl01_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl01_Label2">Архив с файлами: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl01_HyperLink1" href="http://www.leadersoft.ru/Rus/Market/Db/Default.aspx?go=product&amp;pid=60" style="color:#C00000;">Перейти</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl02_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl02_Label2">Операционная система: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl02_HyperLink1" style="color:Green;">Windows XP,Vista</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl03_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl03_Label2">Применение: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl03_HyperLink1" style="color:Green;">Базы данных Access</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl04_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl04_Label2">Продажа: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl04_HyperLink1" href="http://www.leadersoft.ru/Rus/Market/Db/Default.aspx?go=order&amp;pid=60" style="color:#C00000;">Купить</a>
    </td><td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl05_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl05_Label2">Файл исходника: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl05_HyperLink1" style="color:Green;">..\Access\01 Автоматизация\la_automat.mdb</a>
    </td>
		</tr><tr>
			<td style="width:50%;" valign="top" align="left">
         <img id="ctl10_ctl03_ctl00_DataListProperty_ctl06_Image1" src="3.png" style="border-width:0px;"><span id="ctl10_ctl03_ctl00_DataListProperty_ctl06_Label2">Язык интерфейса: </span><a id="ctl10_ctl03_ctl00_DataListProperty_ctl06_HyperLink1" style="color:Green;">Русский</a>
    </td><td></td>
		</tr>
	</tbody></table>

<br>
            <table id="Table3" class="bg_line" width="100%" cellspacing="0" cellpadding="0" border="0">
                <tbody><tr>
                    <td style="width: 6px; height: 27px;" valign="top" nowrap="nowrap">
                         </td>
                    <td class="text12" style="font-weight: bold; height: 27px;" width="100%">
                         </td>
                    <td style="height: 27px" valign="middle" nowrap="nowrap">
                    </td>
                </tr>
            </tbody></table>
<br>

<font size="-1" face="Courier New"><font color="#0000aa">Option Compare </font>Database<br>
<font color="#0000aa">Option Explicit</font><br>
<br>
<font color="#0000aa">Public WithEvents </font>CurrentCal <font color="#0000aa">As </font>MicrosoftCal<br>
<br>
<font color="#007700">'   Настройка календаря</font><br>
<font color="#0000aa">Private Sub </font>Form_Load()<br>
    <font color="#0000aa">Set </font>CurrentCal = <font color="#0000aa">New </font>MicrosoftCal<br>
    <font color="#0000aa">Set </font>CurrentCal.Cal = Me.myCal.Object<br>
    <font color="#0000aa">With </font>Me.CurrentCal.Cal <font color="#007700">' Настройка календаря</font><br>
        <font color="#007700">'.Value = Date ' Установка текущей даты</font><br>
        .TitleFontColor = 255 <font color="#007700">' Цвет заголовка</font><br>
        .Year = Year(<font color="#0000aa">Date</font>) <font color="#007700">' Устанавливаем год</font><br>
        .Month = Month(<font color="#0000aa">Date</font>) <font color="#007700">' Устанавливаем месяц</font><br>
        .Day = Day(<font color="#0000aa">Date</font>) <font color="#007700">' Уставливаем день</font><br>
        .NextDay <font color="#007700">' Следующий день</font><br>
        <font color="#007700">'.ShowTitle = False ' Гасим заголовок</font><br>
        <font color="#007700">' Введите точку и установите параметр</font><br>
    <font color="#0000aa">End With</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'   Добавим событие-сообщение для нового класса</font><br>
<font color="#0000aa">Public Sub </font>CurrentCal_Progress(myMsg <font color="#0000aa">As String</font>)<br>
    <font color="#0000aa">If </font>Me.butEvents <font color="#0000aa">Then</font><br>
        Me.myEvents = myMsg &amp; vbNewLine &amp; Me.myEvents<br>
        DoEvents<br>
    <font color="#0000aa">End If</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'   Установлена дата</font><br>
<font color="#0000aa">Public Sub </font>myCal_AfterUpdate()<br>
    <font color="#007700">'CurrentCal_Progress "Date: " &amp; Me.myCal</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'   События для формы</font><br>
<font color="#0000aa">Private Sub </font>myCal_GotFocus()<br>
    CurrentCal_Progress <font color="#660000">"GotFocus"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>myCal_LostFocus()<br>
    CurrentCal_Progress <font color="#660000">"LostFocus"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>butEvents_AfterUpdate()<br>
    Me.myEvents = <font color="#660000">""</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<br>
<font color="#007700">' Объявляем класс Calendar</font><br>
<font color="#0000aa">Public WithEvents </font>Cal <font color="#0000aa">As </font>Calendar<br>
<br>
<font color="#007700">' Объявляем событие для сообщений</font><br>
<font color="#0000aa">Public Event </font>progress(strMsg <font color="#0000aa">As String</font>)<br>
<br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'  События при создании/уничтожении класса</font><br>
<font color="#0000aa">Private Sub </font>Class_Initialize()<br>
   <font color="#007700">' Инициализация</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Class_Terminate()<br>
   <font color="#007700">' Сохраняем данные</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'  События до/после редактирования метки узла</font><br>
<font color="#0000aa">Private Sub </font>Cal_AfterUpdate()<br>
   funPrintEvent <font color="#660000">"AfterUpdate: "</font> &amp; Me.Cal.Value<br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_BeforeUpdate(Cancel <font color="#0000aa">As Integer</font>)<br>
   funPrintEvent <font color="#660000">"BeforeUpdate: "</font> &amp; Me.Cal.Value<br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_NewMonth()<br>
   funPrintEvent <font color="#660000">"NewMonth: "</font> &amp; Me.Cal.Value<br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_NewYear()<br>
   funPrintEvent <font color="#660000">"NewYear: "</font> &amp; Me.Cal.Value<br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'  События мышки</font><br>
<font color="#0000aa">Private Sub </font>Cal_Click()<br>
   funPrintEvent <font color="#660000">"Click"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_DblClick()<br>
   funPrintEvent <font color="#660000">"DblClick"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'  События клавиатуры</font><br>
<font color="#0000aa">Private Sub </font>Cal_KeyDown(KeyCode <font color="#0000aa">As Integer</font>, <font color="#0000aa">ByVal </font>Shift <font color="#0000aa">As Integer</font>)<br>
   funPrintEvent <font color="#660000">"KeyDown (KeyCode: "</font> &amp; KeyCode &amp; <font color="#660000">", Shift = "</font> &amp; Shift &amp; <font color="#660000">")"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_KeyPress(KeyAscii <font color="#0000aa">As Integer</font>)<br>
   funPrintEvent <font color="#660000">"KeyPress: "</font> &amp; KeyAscii<br>
<font color="#0000aa">End Sub</font><br>
<hr><font color="#0000aa">Private Sub </font>Cal_KeyUp(KeyCode <font color="#0000aa">As Integer</font>, <font color="#0000aa">ByVal </font>Shift <font color="#0000aa">As Integer</font>)<br>
    funPrintEvent <font color="#660000">"KeyUp (KeyCode: "</font> &amp; KeyCode &amp; <font color="#660000">", Shift = "</font> &amp; Shift &amp; <font color="#660000">")"</font><br>
<font color="#0000aa">End Sub</font><br>
<hr><br>
<font color="#007700">'==============================================================</font><br>
<font color="#007700">'   Функция сообщающая о получении событий</font><br>
<font color="#0000aa">Private Function </font>funPrintEvent(myMsg <font color="#0000aa">As String</font>)<br>
    <font color="#0000aa">RaiseEvent </font>progress(myMsg) <font color="#007700">' Генерируем событие для узла</font><br>
<font color="#0000aa">End Function</font></font></div>
</body>
</html></p></body></html>