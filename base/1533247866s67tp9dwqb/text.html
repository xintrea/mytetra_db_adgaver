<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table class="contentpaneopen"><tbody><tr><td class="contentheading" width="100%">Способы интеграции MS ACCESS и MS Outlook								</td>
				                                <td class="buttonheading" width="100%" align="right">
					<a href="http://hiprog.com/index2.php?option=com_content&amp;task=view&amp;id=251661546&amp;pop=1&amp;page=0" target="_blank" onclick="window.open('http://hiprog.com/index2.php?option=com_content&amp;task=view&amp;id=251661546&amp;pop=1&amp;page=0','win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'); return false;" title="Печать">
						<img src="1.png" alt="Печать" name="Печать" border="0" align="middle"></a>
                                </td>
                                			<td class="buttonheading" width="100%" align="right">
				<a href="http://hiprog.com/index2.php?option=com_content&amp;task=emailform&amp;id=251661546&amp;itemid=99999999" target="_blank" onclick="window.open('http://hiprog.com/index2.php?option=com_content&amp;task=emailform&amp;id=251661546&amp;itemid=99999999','win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=400,height=250,directories=no,location=no'); return false;" title="E-mail">
					<img src="2.png" alt="E-mail" name="E-mail" border="0" align="middle"></a>
			</td>
						</tr>
			</tbody></table>
			
		<table class="contentpaneopen">
				<tbody><tr>
			<td colspan="2" width="70%" valign="top" align="left">
			<span class="writtenby">
			 Автор osmor			</span>
			  
			</td>
		</tr>
					<tr>
				<td colspan="2" class="createdate" valign="top">
				 18.09.2006 г.				</td>
			</tr>
					<tr>
			<td colspan="2" valign="top">
			<p>Данной статьей автор не ставит перед собой задачу рассказать о 
всех возможных способах взаимодействия MS Access и MS Outlook или 
сравнить между собой несколько способов.<br>   Задача данной статьи 
помочь начинающим программистам получить начальную информацию о путях 
интеграции MS Access и  MS Outlook и дать ссылки на справочные 
материалы.</p> 

<p>Вся информация, приведенная в данной статье взята из HELP и с сайта <a href="http://msdn.microsoft.com">msdn.microsoft.com</a></p> <p><strong><font color="#0000ff">1. Связывание таблиц</font></strong></p> <p>Самый простой способ это использовать связанные таблицы.</p> <p>Access
 позволяет прилинковать таблицы MSOutlook. Достаточно просто вызвать 
контекстное меню на закладке "Таблицы" и в окне выбора файла в качестве 
типа файлов указать "Outlook". Далее нужно выбрать какие данные вы 
ходите прилинковать папку "входящие" , "адресную книгу" или задачи. И 
вот уже в окне Aсcess появилась связанная таблица с соответствующими 
данными. Данные в прилинкованных таблицах Outlook доступны только для 
чтения.</p> <p>Есть только маленький нюанс, для того что бы это стало 
возможным, нужно установить Microsoft Office Outlook в качестве почтовой
 программы по умолчанию.</p> <p><strong><font color="#0000ff">2. Использование  MS Outlook View Control.</font></strong></p> <p>MS
 Outlook View Control представляет собой ActiveX который легко 
встраивается в вашу программу (не обязательно  Access), и предоставляет 
методы и свойства для работы с Outlook. Это фактически Outlook c 
миниатюре, внешний вид представления данных ничем не отличается от 
представления этих данных в Outlook. Минимального программирования 
достаточно для обеспечения пользователю доступа ко всем основным 
функциям Outlook. </p> <p>Как использовать  MS Outlook View Control в своей программе можно посмотреть в моем примере  : <a href="http://hiprog.com/index.php?option=com_content&amp;task=view&amp;id=251661547&amp;Itemid=35%27">http://hiprog.com/index.php?option=com_content&amp;task=view&amp;id=251661547&amp;Itemid=35</a></p> <p>MS
 Outlook View Control для версий начиная с Outlook2000 доступен для 
загрузки на сайте MS. И конечно там есть вся необходимая документация по
 работе с ним. Вот несколько полезных ссылок:<br>   <a href="http://support.microsoft.com/kb/281618/">http://support.microsoft.com/kb/281618/</a><br><a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=831F957F-3190-48DA-A099-2BDBC7397623">http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=831F957F-3190-48DA-A099-2BDBC7397623</a><br> <a href="http://support.microsoft.com/kb/q303835/">http://support.microsoft.com/kb/q303835/</a><br> <a href="http://support.microsoft.com/kb/291407/">http://support.microsoft.com/kb/291407/</a></p> <p><strong><font color="#0000ff">3. Использование технологии COM.</font></strong></p> <p>Outlook
 как и другие продукты входящие в состав MSOffice поддерживают 
технологию COM, т.е. доступ к его объектной модели возможен из других 
программ. Для работы нужно только одно, знать эту объектную модель.<br> 
Информацию о объектах, методах, свойствах и событиях Outlook можно 
почерпнуть в справочном файле, он обычно расположен в папке с офисом, и 
называется VBAOLХХ.CHM (где ХХ - версия офиса).<br> Так же этот файл доступен на сайте MS:<br><a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A1CEAD80-23E2-456F-8618-4DA50CC2C38C&amp;displaylang=en"> http://www.microsoft.com/downloads/details.aspx?FamilyId=A1CEAD80-23E2-456F-8618-4DA50CC2C38C&amp;displaylang=en</a> </p> <p>Там же можно найти множество примеров: </p> <p><a href="http://msdn.microsoft.com/office/download/codesample/default.aspx?pull=/library/en-us/dno2k3ta/html/odc_ac_olauto.asp">Using Automation in Microsoft Office Access 2003 to Work with Microsoft Office Outlook 2003 </a><br> <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;161088">Using Automation to Send a Microsoft Outlook Message</a><br> <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;161012">How to Create a New Contact Item in Outlook with Automation</a><br> <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;162371">Using Automation to Add a Task/Reminder to MS Outlook</a><br> <a href="http://support.microsoft.com/kb/291120/en-us">How to automate Outlook 2002 from another program</a></p> <p>Ниже приведены несколько функций демонстрирующих возможности данного способа доступу к данным Outlook:<br>   <strong>(Замечание, предполагается что в программе установлена ссылка на MS Outlook)</strong></p>   <table class="module" width="98%" border="0" bgcolor="#ffffff" align="center"><tbody><tr><td><font face="Courier New"> <font color="navy">Function</font> ListOLTasks()<br> <font color="green">'список задач</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderTask As Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_ItemTask As Outlook.TaskItem<br> <font color="navy">Dim</font> RecipientTask As Recipient<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">' получаем ссылку на папку задач</font><br> <font color="navy">Set</font> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br> <font color="green">' перебираем все задачи в папке</font><br> <font color="navy">For Each</font> OL_ItemTask  <font color="navy">In</font> OL_FolderTask.Items<br>     <font color="navy"> With </font> OL_ItemTask<br> <font color="green">    'для задачи выводим тему, описание, дату начала, срок исполнения, дату выполнения и исполнителей</font><br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Tema: " &amp; .Subject<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Описание: " &amp; .Body<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Начало: " &amp; .StartDate<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Срок: " &amp; .DueDate<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Выполнена: " &amp; .DateCompleted<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Исполнители: " &amp; .Owner<br> <font color="green">       'если коллекция получателей не пустая, то выводим список получателей задачи</font><br>      <font color="navy">If</font> .Recipients.Count &gt; 0 <font color="navy">Then</font><br>       <font color="navy">Debug</font>.<font color="navy">Print</font> "Адреса получателей: ";<br>           <font color="navy">For Each</font> RecipientTask  <font color="navy">In</font> .Recipients<br>              <font color="navy">Debug</font>.<font color="navy">Print</font> RecipientTask.Address;<br>           <font color="navy">Next</font><br>      <font color="navy">End  If</font><br>    <font color="navy">End  With </font><br>    <font color="navy">Debug</font>.<font color="navy">Print</font><br>    <font color="navy">Debug</font>.<font color="navy">Print</font> "_______________________________________________"<br>  <font color="navy">Next</font><br> <font color="navy">End Function</font><hr>  <font color="navy">Function</font> ListOLInbox()<br> <font color="green">'спиcок писем в папке "входящие"</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderMail <font color="navy">As</font> Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_ItemMail <font color="navy">As</font> Outlook.MailItem<br> <font color="navy">Dim</font> OL_Attachment <font color="navy">As</font> Outlook.Attachment<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">' получаем ссылку на папку Входящие</font><br> <font color="navy">Set</font> OL_FolderMail = OL_NameSpace.GetDefaultFolder(olFolderInbox)<br> <font color="green">' перебираем все письма в папке</font><br> <font color="navy">For Each</font> OL_ItemMail  <font color="navy">In</font> OL_FolderMail.Items<br>     <font color="navy">With </font> OL_ItemMail<br> <font color="green">  'выводим тему, время получения, имя и адрес отправителя и текст письма</font><br>   <font color="navy">Debug</font>.<font color="navy">Print</font> .BodyFormat<br>   <font color="navy">Debug</font>.<font color="navy">Print</font> "Tema: " &amp; .Subject<br>   <font color="navy">Debug</font>.<font color="navy">Print</font> "Получено: " &amp; .ReceivedTime<br>   <font color="navy">Debug</font>.<font color="navy">Print</font> "Имя и адрес отправителя: " &amp; .SenderName &amp; " (" &amp; .SenderEmailAddress &amp; ")"<br>   <font color="navy">Debug</font>.<font color="navy">Print</font> "Текст письма: " &amp; .Body<br> <font color="green">  'если есть вложения выводим название вложенного файла</font><br>   <font color="navy">If</font> .Attachments.Count &gt; 0 <font color="navy">Then</font><br>    <font color="navy">Debug</font>.<font color="navy">Print</font> "Вложения: "<br>      <font color="navy">For Each</font> OL_Attachment  <font color="navy">In</font> .Attachments<br>         <font color="navy">Debug</font>.<font color="navy">Print</font> OL_Attachment.FileName<br>      <font color="navy">Next</font><br>   <font color="navy">End If</font><br> <font color="navy">End   With</font> <br> <font color="navy">Debug</font>.<font color="navy">Print</font> "_______________________________________________"<br> <font color="navy">Next</font><br> <font color="navy">End Function</font><hr><br>  <font color="navy">Function</font> ListOLContacts()<br> <font color="green">'спиcок Контактов</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderContsct <font color="navy">As</font> Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_ItemContact <font color="navy">As</font> Outlook.ContactItem<br> <font color="navy">Dim</font> OL_Attachment <font color="navy">As</font> Outlook.AddressEntry<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">'получаем ссылку на папку "Контакты"</font><br> <font color="navy">Set</font> OL_FolderContsct = OL_NameSpace.GetDefaultFolder(olFolderContacts)<br> <font color="green">' перебираем все контакты в папке</font><br>   <font color="navy">For Each</font> OL_ItemContact  <font color="navy">In</font> OL_FolderContsct.Items<br>          <font color="navy">With </font>  OL_ItemContact<br> <font color="green">    'выводим имя, 3 возможных E-mail, домашний и моблиный телефоны</font><br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "Имя: " &amp; .Subject<br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "E-mai №1: " &amp; .Email1Address<br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "E-mai №2: " &amp; .Email2Address<br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "E-mai №3: " &amp; .Email3Address<br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "Домашний телефон: " &amp; .HomeTelephoneNumber<br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "Мобильный телефон: " &amp; .MobileTelephoneNumber<br>    <font color="navy">End    With </font><br>    <font color="navy">Debug</font>.<font color="navy">Print</font> "_______________________________________________"<br>   <font color="navy">Next</font><br> <font color="navy">End Function</font><hr> <font color="navy">Function</font> ListOLMeeting()<br> <font color="green">'список встреч назначенных на следующую неделю</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderCalendar <font color="navy">As</font> Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_CalendarItems <font color="navy">As</font> Outlook.Items<br> <font color="navy">Dim</font> OL_MeetingItem <font color="navy">As</font> Object<br> <font color="navy">Dim</font> OL_Attendee <font color="navy">As</font> Recipient<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">' получаем ссылку на папку календарь</font><br> <font color="navy">Set</font> OL_FolderCalendar = OL_NameSpace.GetDefaultFolder(olFolderCalendar)<br> <font color="green">'используя метод Restrict отбираем только те записи</font><br> <font color="green">'у которых свойство start &gt; больше  сегодняшней даты и меньше чем сегодня плюс 7 дней</font><br> <font color="green">' т.е.  те которые назначены на след неделю</font><br> <font color="navy">Set</font> OL_CalendarItems = OL_FolderCalendar.Items.Restrict("[start]&gt; '" &amp; Date &amp; "' <font color="navy">And</font> [start] &lt;= '" &amp; Date + 7 &amp; "'")<br>   <font color="navy">For Each</font> OL_MeetingItem In OL_CalendarItems <font color="green">' перебираем все отобранне записи</font><br>          <font color="navy">With </font> OL_MeetingItem<br> <font color="green">    ' если  найденная запись - встреча то выводит информацию о</font><br>     <font color="navy">If</font> .Class = olAppointment <font color="navy">Then</font><br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Tema: " &amp; .Subject<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Описание: " &amp; .Body<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Начало: " &amp; .Start<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Продолжительность: " &amp; .Duration &amp; " мин."<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> "Место встречи: " &amp; .Location<br> <font color="green">     'если коллекция участников получателей не пустая, то выводим список участников</font><br>      <font color="navy">If</font> .Recipients.Count &gt; 0 <font color="navy">Then</font><br>       <font color="navy">Debug</font>.<font color="navy">Print</font> "Приглашены: ",<br>           <font color="navy">For Each</font> OL_Attendee  <font color="navy">In</font> .Recipients<br>                <font color="navy">Debug</font>.<font color="navy">Print</font> OL_Attendee.Name; "; ";<br>           <font color="navy">Next</font><br>      <font color="navy">End If</font><br>     <font color="navy">End If</font><br>    <font color="navy">End  With </font> <br>     <font color="navy">Debug</font>.<font color="navy">Print</font><br>     <font color="navy">Debug</font>.<font color="navy">Print</font> "_______________________________________________"<br>    <font color="navy">Next</font><br> <font color="navy">End Function</font><hr><br> <br> <font color="navy">Function</font> OpenExistOLContacts(strNameContact <font color="navy">AsString</font>)<br> <font color="green">'Открывает существующий контакт в имени которых содержится переданное значение</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderContsct <font color="navy">As</font> Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_ItemContact <font color="navy">As</font> Outlook.ContactItem<br> <font color="navy">Dim</font> OL_Attachment <font color="navy">As</font> Outlook.AddressEntry<br> <br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application") <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI") <font color="green">'получаем Namespace</font><br> <font color="green">'получаем ссылку на папку "Контакты"</font><br> <font color="navy">Set</font> OL_FolderContsct = OL_NameSpace.GetDefaultFolder(olFolderContacts)<br>   <font color="navy">For Each</font> OL_ItemContact  <font color="navy">In</font> OL_FolderContsct.Items <font color="green">' перебираем все контакты в папке<br> ' если заголовок контакта содержит искомую строку, то открываем его</font><br>    <font color="navy">If</font> InStr(1, OL_ItemContact.Subject, strNameContact) <font color="navy">Then</font> OL_ItemContact.Display<br>  <font color="navy">Next</font><br> <font color="navy">End Function</font><hr><br> <br> <font color="navy">Function</font> OpenExistOLTasks()<br> <font color="green">'Открывает все не закрытые задачи</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderTask As Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_ItemTask As Outlook.TaskItem<br> <font color="navy">Dim</font> RecipientTask As Recipient<br> <br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application") <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI") <font color="green">'получаем Namespace</font><br> <font color="green">' получаем ссылку на папку задач</font><br> <font color="navy">Set</font> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br>   <font color="navy">For Each</font> OL_ItemTask  <font color="navy">In</font> OL_FolderTask.Items <font color="green">' перебираем все задачи в папке</font><br>     <font color="navy">If</font> OL_ItemTask.Status &lt;&gt; olTaskComplete <font color="navy">Then</font> OL_ItemTask.Display<br>   <font color="navy">Next</font><br> <font color="navy">End Function</font><hr>  <font color="navy">Function</font> CreateNewTask()<br> <font color="green">'создает новую задачу повторяющуюся каждые 3 недели</font><br> <font color="green">'и назначенает ее другому ответсветнному</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_ItemTask As Outlook.TaskItem<br> <font color="navy">Dim</font> RecipientTask As Recipient<br> <font color="navy">Dim</font> OL_Pattern <font color="navy">As</font> Outlook.RecurrencePattern<br> <br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application") <font color="green"> ' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_ItemTask = OL_App.CreateItem(OLTaskItem) <font color="green"> ' создаем новую задачу</font><br> <font color="navy">Set</font> OL_Pattern = OL_ItemTask.GetRecurrencePattern <font color="green"> ' получаем ссылку на объект</font><br> <font color="green">'RecurrencePattern содержащий информацию о периодичности задачи или встречи</font><br>      <font color="navy">With </font>  OL_Pattern<br> <font color="green">    ' устанавливаем частоту повторений (еженедельно)</font><br>   .RecurrenceType = olRecursWeekly<br> <font color="green">    ' интервал повторений (раз в 2 недели)</font><br>   .Interval = 2<br> <font color="green">    ' создавать новую задача с указанной частотой после завершения предудущей</font><br>     .Regenerate = True<br> <font color="navy">End  With </font> <br>     <font color="navy">With </font>  OL_ItemTask<br>   .Subject = "Tema задачи"<br>   .Body = "Описание задачи"<br>   .StartDate = Date <font color="green"> ' дата начала выполнения задачи</font><br>   .DueDate = DateAdd("y", 5, Date) <font color="green"> ' дата окончания</font><br>   .Assign <font color="green"> ' назначим эту задачу некому Иванову</font><br>    <font color="navy">Set</font> RecipientTask = OL_ItemTask.Recipients.Add("Иванов Иван")<br>   .Save <font color="green"> ' сохраним задачу</font><br>   .Display (True) <font color="green"> 'покажем задачу в модальном окне</font><br> <font color="navy">End  With </font><br> <font color="navy">End Function</font><hr>  <font color="navy">Function</font> CreateNewMemo()<br> <font color="green">'создает новое письмо  с вложением для нескольких адресатов</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_ItemMail <font color="navy">As</font> Outlook.MailItem<br> <font color="navy">Dim</font> RecipientTask As Recipient<br> <font color="navy">Dim</font> OL_Pattern <font color="navy">As</font> Outlook.RecurrencePattern<br> <br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application") <font color="green"> ' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_ItemMail = OL_App.CreateItem(olMailItem) <font color="green"> ' создаем новое письмо</font><br>      <font color="navy">With </font>  OL_ItemMail<br>    .To = "
 <a href="mailto:osmor@mail.ru">osmor@mail.ru</a>" <font color="green"> 'адрес получателя</font><br>    .CC = "
 <a href="mailto:osmor@mail.ru">osmor@mail.ru</a>" <font color="green">'копия</font><br>    .BodyFormat = olFormatHTML <font color="green"> 'формат письма</font><br>    .Subject = "Отчет по продажам за " &amp; CStr(Date) <font color="green"> ' заголовок письма</font><br> <font color="green"> ' текст письма. Для красоты HTML</font><br>    .HTMLBody = "&lt;body&gt;&lt;div align='center'&gt; &lt;table width='50%' border='1'&gt;" &amp; _<br>    "&lt;caption align='top'&gt;  Продажи по салонам за " &amp; CStr(Date) &amp; "&lt;/caption&gt;" &amp; _<br>    "&lt;tr&gt;&lt;th cope='col' width='60%'&gt;Салон &lt;th width='40%'&gt;Cумма" &amp; _<br>
    "&lt;tr&gt;&lt;td&gt;Алексеевская &lt;td align='right'&gt;25 021 
&lt;tr&gt;&lt;td&gt;Маросейка&lt;td align='right'&gt;28 452" &amp; _<br>    "&lt;tr&gt;&lt;td&gt;Охотный ряд &lt;td align='right'&gt;22 245&lt;tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/body&gt;"<br> <font color="green"> 'вложение. Если файл не существует, то будет ошибка</font><br>    .Attachments.Add "c:/Forum_ex.INF"<br>    .Attachments.Add "c:/FORUM_EX.MDX"<br>    .OriginatorDeliveryReportRequested = True  <font color="green"> 'Уведомление о доставке</font><br>    .ReadReceiptRequested = True <font color="green"> 'Уведомление о прочтении</font><br>    .Save <font color="green"> ' сохраним письмо</font><br>    .Send <font color="green"> ' отправим письмо</font><br> <font color="navy">End  With </font><br> <font color="navy">End Function</font><hr>  <font color="navy">Function</font> CreateNewMeeting()<br> <font color="green">'создает новую встречу</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_ItemMeeting <font color="navy">As</font> Outlook.AppointmentItem<br> <font color="navy">Dim</font> OL_Attendee <font color="navy">As</font> Outlook.Recipient<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">' создаем новую встречу</font><br> <font color="navy">Set</font> OL_ItemMeeting = OL_App.CreateItem(olAppointmentItem)<br>      <font color="navy">With </font>  OL_ItemMeeting<br>   .Subject = "Предлагаю попить пива"<br>   .Body = "Возникла острая необходимость встретиться."<br>   .MeetingStatus = olMeeting <font color="green"> 'статус свстречи</font><br> <font color="green">  ' назначим встречу на завтра в 18:00</font><br>   .Start = Date + 1 + CDate("18:00")<br>   .Duration = 120 <font color="green"> 'продолжительность 2 часа</font><br> <font color="green">  'установим напоминание за 1 час до начала встречи</font><br>   .ReminderSet = True<br>   .ReminderMinutesBeforeStart = 60<br> <font color="green">  'добавим участников встречи</font><br>   <font color="navy">Set</font> OL_Attendee = .Recipients.Add("Bill Gates")<br>     OL_Attendee.<font color="navy">Type</font> = olRequired <font color="green">'обязательынй участник&gt;</font><br>   <font color="navy">Set</font> OL_Attendee = .Recipients.Add("George W. Bush")<br>     OL_Attendee.<font color="navy">Type</font> = olOptional <font color="green">'не обязательынй участник</font><br> <font color="green">  'место встречи</font><br>   .Location = "На углу у Патриарших"<br>   .Save <font color="green">' сохраним встречу</font><br>   .Display (True) <font color="green">'покажем задачу в модальном окне</font><br> <font color="navy">End   With </font><br> <font color="navy">End Function</font><hr> <font color="navy">Function</font> ViewOLTasks()<br> <font color="green">'Выводит список View доступных для папки задачи и</font><br> <font color="green">'открывает список задач c применением случайного доступного вида</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderTask As Outlook.MAPIFolder<br> <font color="navy">Dim</font> OL_View <font color="navy">As</font> View<br> <font color="navy">Dim</font> I <font color="navy">AsInteger</font><br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">' получаем ссылку на папку задач</font><br> <font color="navy">Set</font> OL_FolderTask = OL_NameSpace.GetDefaultFolder(olFolderTasks)<br>     <font color="navy">With </font> OL_FolderTask<br> <font color="green">' перебираем все доступные для папки виды (Views)</font><br>   <font color="navy">Debug</font>.<font color="navy">Print</font> "Доступные виды:"<br>   <font color="navy">For Each</font> OL_View  <font color="navy">In</font> .Views<br>      <font color="navy">Debug</font>.<font color="navy">Print</font> OL_View.Name<br>    <font color="navy">Next</font><br> <font color="green">   ' поучаем случаное число</font><br>    Randomize<br>    I = Int(.Views.Count * Rnd()) + 1<br>    OL_FolderTask.Views(I).Apply <font color="green">'применяем выбранный вид</font><br>    .Display <font color="green">'открываем окно в папкой "Задачи"</font><br> <font color="navy">End    With </font><br> <font color="green">'для примера получим значение CurrenView через объект Explorer</font><br> <font color="navy">Debug</font>.<font color="navy">Print</font> "Установлен вид - " &amp; OL_App.ActiveExplorer.CurrentView<br> <br> <font color="navy">End Function</font><hr>  <font color="navy">Function</font> ViewOLCalendar()<br> <font color="green">'Открывает паку каледарь</font><br> <font color="navy">Dim</font> OL_App <font color="navy">As</font> Outlook.Application<br> <font color="navy">Dim</font> OL_NameSpace <font color="navy">As</font> Outlook.NameSpace<br> <font color="navy">Dim</font> OL_FolderCalendar <font color="navy">As</font> Outlook.MAPIFolder<br> <font color="green">' получаем объект Outlook</font><br> <font color="navy">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="green">'получаем Namespace</font><br> <font color="navy">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br> <font color="green">' получаем ссылку на папку Календарь</font><br> <font color="navy">Set</font> OL_FolderCalendar = OL_NameSpace.GetDefaultFolder(olFolderCalendar)<br> OL_FolderCalendar.Display <font color="green">'открываем окно в папкой "Календарь"</font><br> <br> <font color="navy">End Function</font><hr>  <br> <font color="#000080">Function</font> Send_Receive()<br> <font color="#008000">'Принудительная отправка/прием почты</font><br> <font color="#000080">Dim</font> OL_App <font color="#000080">As</font> Outlook.Application<br> <font color="#000080">Dim</font> OL_NameSpace <font color="#000080">As</font> Outlook.NameSpace<br> <font color="#000080">Dim</font> OL_FolderCalendar <font color="#000080">As</font> Outlook.MAPIFolder<br> <font color="#008000">' получаем объект Outlook</font><br> <font color="#000080">Set</font> OL_App = CreateObject("Outlook.Application")<br> <font color="#008000">'получаем Namespace</font><br> <font color="#000080">Set</font> OL_NameSpace = OL_App.GetNamespace("MAPI")<br>   <font color="#000080">Dim</font> oSyncs <font color="#000080">As</font> Outlook.SyncObjects<br>  <font color="#000080">Dim</font> oSync <font color="#000080">As</font> Outlook.SyncObject<br> <br>    <font color="#000080">Set</font> oSyncs = OL_NameSpace.SyncObjects<br>    <font color="#000080">Set</font> oSync = oSyncs.Item("Все учетные записи") <font color="#008000"><br>'если английский Outlook то "All Accounts"</font><br>    oSync.Start<br> <font color="#000080">End Function</font><br> <br> <br>  </font></td></tr></tbody></table> <br><br> Не берусь судить какой из перечисленных выше способов лучше... все зависит от поставленной задачи. </td></tr></tbody></table>
</body>
</html></p></body></html>