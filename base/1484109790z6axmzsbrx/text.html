<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1. Такой вариант подходит. Можете написать, как это сделать?<br />2. Но мне интересно, может ли VBA с текстовым файлом выполнить следующие действия: открыть его, прочитать первую строку, прочитать вторую строку, записать значение в третью строку, записать значение в четвёртую строку, закрыть его.<br />При этом не создавая дополнительных файлов.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пункт 1<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">Sub Макрос1()<br /><br />    Const strFN_Source As String = &quot;C:\Users\User\Desktop\Источник.txt&quot;<br />    Const strFN_Res As String = &quot;C:\Users\User\Desktop\Результат.txt&quot;<br />    <br />    Dim strLine As String<br />    Dim i As Long<br />    <br />    <br />    ' Открытие файла-источника.<br />    Open strFN_Source For Input As #1<br />    ' Создание файла-результата.<br />    Open strFN_Res For Output As #2<br />        <br />    ' В цикле двигаемся по строкам текстового файла.<br />    Do While VBA.EOF(1) = False<br />        <br />        ' С помощью переменной i определяем, на какой строке мы находимся.<br />        i = i + 1<br />        <br />        ' Смотрим, на какой строке мы находимся, чтобы сделать нужное действие.<br />        ' Если мы находимся на второй строке, то мы вставим свои данные,<br />            ' а не будем копировать данные из текстового файла.<br />        If i = 2 Then<br />            <br />            ' Запись в файл-результат нужных данных.<br />            Print #2, &quot;нужные данные&quot;<br />            ' Делаем бессмысленное действие, чтобы курсор перешёл в следующую строку,<br />                ' и чтобы строка не была взята из файла-источника.<br />            Line Input #1, strLine<br /><br />        Else<br />            <br />            ' Копирование строки из файла-источника в переменную strLine.<br />            Line Input #1, strLine<br />            ' Запись данных из переменной strLine в файл-результат.<br />            Print #2, strLine<br />            <br />        End If<br />        <br />    Loop<br />        <br />    Close #1<br />    Close #2<br /><br />End Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br />Пункт 2<br /><br />Можно ли записать данные в нужную строку без использования дополнительного текстового файла - я не знаю. В последовательном доступе - это точно нельзя сделать. Можно попробовать произвольный или бинарный доступ. Но я такое ни разу не делал.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>