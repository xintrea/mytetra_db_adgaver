<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h2>Шаг 2 - Объект DBEngine</h2><div style="margin:10px;"><div style="margin-top:100px;margin-left:20px;float:right">


<ins id="aswift_1_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:120px;height:600px;" width="120" height="600" frameborder="0"></iframe></ins></ins>
</div><p>Замечания<br>
Объект <b>DBEngine</b> является объектом самого верхнего уровня в модели объектов доступа к данным (<b>DAO</b>).<br>
Объект <b>DBEngine</b> содержит в себе и управляет всеми другими объектами в иерархии объектов доступа к данным (<b>DAO</b>).  Создание дополнительных объектов <b>DBEngine</b> невозможно, а сам объект <b>DBEngine</b> не является компонентом ни одного семейства.<br>
Способ ссылок на источник данных <b>ODBC</b> непосредственно через объекты доступа к данным (<b>DAO</b>) называют "рабочей областью <b>ODBCDirect</b>".  Это делается, чтобы отличать этот способ от непрямых ссылок на источник данных <b>ODBC</b> через ядро базы данных <b>Microsoft Jet</b> с использованием "рабочей области <b>Microsoft Jet</b>".  В каждом из способов доступа к источнику данных <b>ODBC</b> требуется один из двух возможных типов объекта <b>Workspace</b>.  Для того чтобы указать используемый по умолчанию тип объекта <b>Workspace</b>, создаваемого в объекте <b>DBEngine</b>, следует определить свойство <b>DefaultType</b>.  Тип объекта <b>Workspace</b> и тип соответствующего источника данных определяют доступные для использования объекты доступа к данным, методы и свойства.<br>
Для баз данных или подключений любого типа данный объект позволяет:
</p><ol>
<li>Использовать свойство <b>Version</b> для получения номера версии объектов доступа к данным (<b>DAO</b>).
</li><li>Использовать свойство <b>LoginTimeout</b> для получения или установки интервала ожидания для подключения <b>ODBC</b>, а также использовать метод <b>RegisterDatabase</b> для передачи сведений <b>ODBC</b> ядру базы данных <b>Microsoft Jet</b>.  Эти возможности используются одинаково, вне зависимости от того, выполняется ли подключение к источнику данных <b>ODBC</b> через ядро <b>Microsoft Jet</b> или в рабочей области <b>ODBCDirect</b>.
</li><li>Использовать свойство <b>DefaultType</b>, чтобы указать тип подключения, используемый по умолчанию создаваемым объектом <b>Workspace</b>, т.е. либо рабочую область <b>Microsoft Jet</b>, либо <b>ODBCDirect</b>.
</li><li>Использовать свойства <b>DefaultPassword</b> и <b>DefaultUser</b>, чтобы указать используемые по умолчанию имя пользователя и пароль для объекта <b>Workspace</b>.
</li><li>Использовать метод <b>CreateWorkspace</b> для создания нового объекта <b>Workspace</b>.  При этом  необязательные аргументы позволяют указать параметры, имеющие приоритет над значениями свойств <b>DefaultType</b>, <b>DefaultPassword</b> и <b>DefaultUser</b>.
</li><li>С помощью метода <b>OpenDatabase</b> открыть базу данных в стандартном объекте <b>Workspace</b> и вызывать методы <b>BeginTrans</b>, <b>Commit</b> и <b>Rollback</b> для управления транзакциями в стандартном объекте <b>Workspace</b>.
</li><li>Использовать семейство <b>Workspaces</b> для ссылок на конкретные объекты <b>Workspace</b>.
</li><li>Использовать семейство <b>Errors</b> для получения сведений об ошибках доступа к данным.
</li></ol>
<p>Другие свойства и методы являются доступными только при использовании объектов доступа к данным (<b>DAO</b>) совместно с ядром базы данных <b>Microsoft Jet</b>.  Они используются для управления ядром базы данных <b>Microsoft Jet</b>,
 определении его свойств и выполнения операций над временными объектами,
 не являющимися компонентами семейств. Например, пользователь имеет 
возможность:
</p><ol><li>Использовать метод <b>CreateDatabase</b> для создания нового объекта <b>Database Microsoft Jet</b>.
</li><li>Использовать метод <b>Idle</b> для предоставления ядру <b>Microsoft Jet</b> возможности завершить незаконченные операции.
</li><li>Использовать методы <b>CompactDatabase</b> и <b>RepairDatabase</b> для обработки файлов баз данных.
</li><li>С помощью свойств <b>IniPath</b> и <b>SystemDB</b> указать положение данных о <b>Microsoft Jet</b> в реестре <b>Windows</b> и положение системной базы данных <b>Microsoft Jet</b>, соответственно.  Метод <b>SetOption</b> позволяют указать параметры, имеющие приоритет над параметрами ядра <b>Microsoft Jet</b>, заданными в реестре <b>Windows</b>.
</li></ol>
<p>После изменения значений свойств <b>DefaultType</b> и <b>IniPath</b> новые значения свойств будут применяться только при создании новых объектов <b>Workspace</b>.  Свойства существующих объектов изменены не будут.
</p><p>Полный список методов, свойств и семейств, поддерживаемых объектом <b>DBEngine</b>, см в разделе Общие сведения.
</p><p>Для ссылки на семейство, принадлежащее объекту <b>DBEngine</b>, или на его метод и свойство используется следующий синтаксис:
</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">[DBEngine.][семейство | метод | свойство]</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>Пример<br>
В данном примере выводится перечень семейств в объекте <b>DBEngine</b>.  Дополнительные примеры см. в разделах справки для свойств и методов объекта <b>DBEngine</b>.<br>
</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub DBEngineX()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	Dim wrkLoop As Workspace</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	Dim prpLoop As Property</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	With DBEngine</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		Debug.Print "Свойства объекта DBEngine"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		<i>' Перечисление компонентов семейства Properties объекта</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		' DBEngine. Перехват свойств, значения которых </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		' являются недопустимыми в данном контексте.</i></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		For Each prpLoop In .Properties</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			On Error Resume Next</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			Debug.Print "    " &amp; prpLoop.Name &amp; " = " &amp; prpLoop</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			On Error GoTo 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		Next prpLoop</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	Debug.Print "Семейство Workspaces объекта DBEngine"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		<i>' Перечисление компонентов семейства Workspaces </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		' объекта DBEngine.</i></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		For Each wrkLoop In .Workspaces</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			Debug.Print "    " &amp; wrkLoop.Name</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			<i>' Перечисление компонентов семейства Properties каждого </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			' объекта Workspace. Перехват свойств, значения которых</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			' являются недопустимыми в данном контексте.</i></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			For Each prpLoop In wrkLoop.Properties</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">				On Error Resume Next</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">				Debug.Print "        " &amp; prpLoop.Name &amp; " = " &amp; prpLoop</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">				On Error GoTo 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">			Next prpLoop</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">		Next wrkLoop</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">	End With</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div><center><hr><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?1">Предыдущий Шаг</a> | <a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?3">Следующий Шаг</a> | <a href="http://www.firststeps.ru/vba/vbahelp/daohelp/daohelp1.html">Оглавление</a></center>
</body>
</html></p></body></html>