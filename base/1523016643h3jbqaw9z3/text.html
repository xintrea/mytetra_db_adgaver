<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div class="container"><div class="line number1 index0 alt2"><code class="vb comments">'Объявление функции WinAPI (ole32.dll)</code></div><div class="line number2 index1 alt1"><code class="vb keyword">Declare</code> <code class="vb keyword">Function</code> <code class="vb plain">CoCreateGuid </code><code class="vb keyword">Lib</code> <code class="vb string">"ole32"</code> <code class="vb plain">(pguid </code><code class="vb keyword">As</code> <code class="vb plain">GUID) </code><code class="vb keyword">As</code> <code class="vb keyword">Long</code></div><div class="line number3 index2 alt2"> </div><div class="line number4 index3 alt1"><code class="vb comments">'объявление типа данных, используемого WinAPI-функцией CoCreateGuid</code></div><div class="line number5 index4 alt2"><code class="vb plain">Type GUID</code></div><div class="line number6 index5 alt1"><code class="vb spaces">    </code><code class="vb plain">Data1 </code><code class="vb keyword">As</code> <code class="vb keyword">Long</code></div><div class="line number7 index6 alt2"><code class="vb spaces">    </code><code class="vb plain">Data2 </code><code class="vb keyword">As</code> <code class="vb keyword">Integer</code></div><div class="line number8 index7 alt1"><code class="vb spaces">    </code><code class="vb plain">Data3 </code><code class="vb keyword">As</code> <code class="vb keyword">Integer</code></div><div class="line number9 index8 alt2"><code class="vb spaces">    </code><code class="vb plain">Data4(7) </code><code class="vb keyword">As</code> <code class="vb keyword">Byte</code></div><div class="line number10 index9 alt1"><code class="vb keyword">End</code> <code class="vb plain">Type</code></div><div class="line number11 index10 alt2"> </div><div class="line number12 index11 alt1"> </div><div class="line number13 index12 alt2"><code class="vb comments">'Функция создает GUID и возвращает его в виде строки без разделителей</code></div><div class="line number14 index13 alt1"><code class="vb keyword">Public</code> <code class="vb keyword">Function</code> <code class="vb plain">CreateGuid() </code><code class="vb keyword">As</code> <code class="vb keyword">String</code></div><div class="line number15 index14 alt2"> </div><div class="line number16 index15 alt1"><code class="vb comments">'значение,возвращаемое при успешном создании GUID</code></div><div class="line number17 index16 alt2"><code class="vb keyword">Const</code> <code class="vb plain">S_OK </code><code class="vb keyword">As</code> <code class="vb keyword">Long</code> <code class="vb plain">= 0</code></div><div class="line number18 index17 alt1"> </div><div class="line number19 index18 alt2"><code class="vb keyword">Dim</code> <code class="vb plain">GuidPointer </code><code class="vb keyword">As</code> <code class="vb plain">GUID</code></div><div class="line number20 index19 alt1"><code class="vb keyword">Dim</code> <code class="vb plain">strData4 </code><code class="vb keyword">As</code> <code class="vb keyword">String</code></div><div class="line number21 index20 alt2"><code class="vb keyword">Dim</code> <code class="vb plain">i </code><code class="vb keyword">As</code> <code class="vb keyword">Byte</code></div><div class="line number22 index21 alt1"> </div><div class="line number23 index22 alt2"><code class="vb plain">strData4 = </code><code class="vb string">""</code></div><div class="line number24 index23 alt1"><code class="vb comments">'Если успешно создан GUID, формируем его представление в виде строки</code></div><div class="line number25 index24 alt2"><code class="vb keyword">If</code> <code class="vb plain">CoCreateGuid(GuidPointer) = S_OK </code><code class="vb keyword">Then</code></div><div class="line number26 index25 alt1"><code class="vb spaces">    </code><code class="vb keyword">With</code> <code class="vb plain">GuidPointer</code></div><div class="line number27 index26 alt2"><code class="vb spaces">        </code><code class="vb plain">CreateGuid = Hex(.Data1) &amp; Hex(.Data2) &amp; Hex(.Data3)</code></div><div class="line number28 index27 alt1"><code class="vb spaces">        </code><code class="vb keyword">For</code> <code class="vb plain">i = 0 </code><code class="vb keyword">To</code> <code class="vb plain">7</code></div><div class="line number29 index28 alt2"><code class="vb spaces">            </code><code class="vb plain">strData4 = strData4 &amp; Hex(.Data4(i))</code></div><div class="line number30 index29 alt1"><code class="vb spaces">        </code><code class="vb keyword">Next</code> <code class="vb plain">i</code></div><div class="line number31 index30 alt2"><code class="vb spaces">    </code><code class="vb keyword">End</code> <code class="vb keyword">With</code></div><div class="line number32 index31 alt1"><code class="vb keyword">End</code> <code class="vb keyword">If</code></div><div class="line number33 index32 alt2"><code class="vb plain">CreateGuid = CreateGuid &amp; strData4</code></div><div class="line number34 index33 alt1"> </div><div class="line number35 index34 alt2"><code class="vb keyword">End</code> <code class="vb keyword">Function</code></div></div>
</body>
</html></p></body></html>