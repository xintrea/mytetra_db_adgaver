<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lbArtHeader"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">П</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">роверка наличия поля в таблице</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">																		</span></p></td></tr>
<tr>
<td colspan="2">
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	 				</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">											</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Описание: Пример функций, которые проверяют наличие поля в таблице<br /></span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Автор: </span><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Дмитрий Сонных  (AKA Joss)</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Добавил на сайт:  </span><a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img src="1.png" width="16" /></a><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  21.04.2011</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">FAQ: Проверка наличия поля в таблице<br />Иногда возникает необходимость узнать наличие определённого поля в таблице базы данных. Я с этим столкнулся, когда собирал статистические отчёты из организаций. Они были выполнены в одной и той же программе, но в разных версиях. Хотя и высылаешь пользователям новые версии программы, они или теряют их или забывают заменить старые на новые. Пришлось разработать несколько функций для определения наличия конкретного поля в нужной таблице.<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Проверка наличия поля в таблице. Метод ADO.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br />Не забудьте для использования метода ADO добавить в </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">References</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Microsoft ADO Ext. for DDL and Security</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Microsoft ActiveX Data Objects Library</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Их версии зависят от версий Microsoft Access и обновлений, установленных на компьютере.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Procedure : fnFieldExist</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' DateTime  : 04.09.2009 11:16</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Author    : DSonnyh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Purpose   : Проверка наличия нужного поля в таблице</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fnFieldsExists(strTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, strFieldsName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' strTableName - имя таблицы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' strFieldsName - имя поля в таблице</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> bResult </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cnn </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADODB.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cat </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADOX.Catalog</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADOX.Table</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADOX.Column</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fnFieldsExists_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cnn = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">New</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADODB.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cat = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">New</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ADOX.Catalog</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    cat.ActiveConnection = CurrentProject.Connection</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> i </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Integer</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cat.Tables</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Type</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;TABLE&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Or</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Type</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;LINK&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.Name = strTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.Columns </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm.Name = strFieldsName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                        bResult = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cat = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cnn = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    fnFieldsExists = bResult</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_fnFieldsExists:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">fnFieldsExists_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ошибка &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Err.Number &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot; (&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Err.Description &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;) в процедуре fnFieldsExists&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_fnFieldsExists</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Проверка наличия поля в таблице. Метод DAO.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br />Не забудьте добавить в References ссылку на </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; font-style:italic;">Microsoft DAO Object Library</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. Обычно она бывает версии 3.51 (A97) и 3.6 (A2000+).<br />Тут я решил немного поэкспетиментировать и испольсовать не коллекцию таблиц и столбцов (</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Tables и Columns</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">), а коллекцию полей запроса (</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Fields</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">).<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Procedure : fnFieldExistDAO</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' DateTime  : 03.09.2009 10:26</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Author    : DSonnyh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Purpose   : Проверка наличия нужного поля в таблице методом DAO</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fnFieldsExistsDAO(strTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, strFieldsName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' strTableName - имя таблицы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' strFieldsName - имя поля в таблице</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> bResult </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> rst </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DAO.Recordset</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Field</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fnFieldsExistsDAO_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> rst = CurrentDb.OpenRecordset(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Select * from &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; strTableName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> rst.Fields</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld.Name = strFieldsName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            bResult = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    rst.Close</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> rst = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    fnFieldsExistsDAO = bResult</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_fnFieldsExistsDAO:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">fnFieldsExistsDAO_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ошибка &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Err.Number &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot; (&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; Err.Description &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;) в процедуре fnFieldsExistsDAO&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_fnFieldsExistsDAO</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Этим методом можно проверить наличие поля не только в таблице, но и в хранимом запросе Access. Но это представляет чисто академический иньерес. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:history.back(1)"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">[Back]</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />																													</span></p></td></tr>
<tr>
<td colspan="2"></td></tr>
<tr>
<td colspan="2"></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">																	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">							</span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="63172"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Д</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">ля коллекции</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">АлексейЕ						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(63172)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=63172&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Пользовал скрытый объект WizHook в Access'е.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ColumnExists(strNameTable </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, strNameColumn </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> strNameColumns  </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    WizHook.Key = 51488399</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    strNameColumns = WizHook.GetColumns(strNameTable)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    ColumnExists = (</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">InStr</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">(1, </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;;&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; strNameColumns, </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;;&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; strNameColumn &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;;&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) &gt; 0)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Также, данной функцией можно определить наличие поля в запросе			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">22.04.2011 17:45</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="63841"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">М</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">ожно и через обработку ошибки</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="mailto:e2li@yandex.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">V.Kim</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(63841)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=63841&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Public Function fnFieldsExistsDAO2(strTableName As String, strFieldsName As String) As Boolean</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />' strTableName <br />' strFieldsName<br /><br />    Dim bResult As Boolean<br /><br />    Dim rst As DAO.Recordset<br />    Dim fld As Field<br /><br />    On Error Resume Next<br />    fnFieldsExistsDAO2 = False<br />    Set rst = CurrentDb.OpenRecordset(&quot;Select * from &quot; &amp; strTableName)<br />    If Err &lt;&gt; 0 Then GoTo fnFieldsExistsDAO_Error<br />    <br />    Set fld = rst.Fields(strFieldsName)<br />    If Err &lt;&gt; 0 Then Err.Clear Else fnFieldsExistsDAO2 = True<br />    <br />    rst.Close<br />    Set rst = Nothing<br />    <br />    Exit Function<br /><br />fnFieldsExistsDAO_Error:<br />    MsgBox &quot;Ошибка &quot; &amp; Err.Number &amp; &quot; (&quot; &amp; Err.Description &amp; &quot;) в процедуре fnFieldsExistsDAO2&quot;<br />    Err.Clear<br />End Function<br />			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">05.10.2011 18:11</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="65268"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">П</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">оик поля в запросе</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img src="12.png" width="16" /></a><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(65268)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=65268&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Если вы хотите определить наличие поля в запросе (для ADO), то в операторе IF надо добавить тип tdf.Type = &quot;VIEW&quot; - вот так.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> cat.Tables</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Type</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;TABLE&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Or</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Type</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;LINK&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Or</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Type</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;VIEW&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.Name = strTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf.Columns </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm.Name = strFieldsName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                        bResult = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> clm</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">07.07.2012 22:05</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="68155"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">С</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">писок полей запроса</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img src="12.png" width="16" /></a><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(68155)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=68155&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Статья Даниэля Пино &quot;Список полей запроса&quot;, взята </span><a href="https://www.devhut.net/category/ms-access/ms-access-vba/page/20/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">здесь </span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />****************************************************************************************<br />Следующая функция вернет список всех полей/столбцов, отображаемых в запросе.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Procedure : listQueryFields</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Author    : CARDA Consultants Inc.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Website   : http://www.cardaconsultants.com</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Purpose   : Возвращает список всех полей (имена столбцов) отображаемых в запросе</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Copyright : The following code may be used as you please, but may not be resold, as</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'             long as the header (Author, Website &amp; Copyright) remains with the code.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Входные переменные:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' ~~~~~~~~~~~~~~~~</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' strQryName - Имя запроса для отображения полей.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' История изменений:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Rev       Date(yyyy/mm/dd)        Description</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' **************************************************************************************</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' 1         2007-June-01            Initial Release</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> listQueryFields(strQryName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> listQueryFields_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DAO.Database</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> qryfld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DAO.QueryDef</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Field</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db = CurrentDb()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> qryfld = db.QueryDefs(strQryName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">For</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Each</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">In</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> qryfld.Fields    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'перебор всех полей запроса</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        Debug.Print fld.Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">:   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> qryfld = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">listQueryFields_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MS Access обнаружил следующую ошибку&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; vbCrLf &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Номер ошибки: &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    Err.Number &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Источник ошибки: listQueryFields&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Описание ошибки: &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    Err.Description, vbCritical, </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Произошла ошибка!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">22.09.2017 15:33</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="68157"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">M</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">S Access VBA – Determine if a Field Exists in a Table (Daniel Pineault)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img src="12.png" width="16" /></a><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(68157)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=68157&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Статья Даниэля Пино &quot;Определение наличия поля в таблице&quot;, взята </span><a href="https://www.devhut.net/2010/06/10/ms-access-vba-determine-if-a-field-exists-in-a-table/comment-page-1/#comment-1640"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">здесь </span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />****************************************************************************************<br />Иногда нужен способ определить, содержит ли таблица конкретное поле? Следующая процедура позволяет вам это проверить.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Procedure : DoesTblFieldExist</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Author    : CARDA Consultants Inc.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Website   : http://www.cardaconsultants.com</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Purpose   : определить, существует ли поле в указанной таблицей </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Copyright : The following may be altered and reused as you wish so long as the</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'             copyright notice is left unchanged (including Author, Website and</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'             Copyright).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Входные переменные: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' ~~~~~~~~~~~~~~~~</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' sTableName: Имя таблицы для проверки существования поля</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' sFieldName: Имя поля для проверки существования в таблице</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Пример использования: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' ~~~~~~~~~~~~~~~~</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' DoesTblFieldExist(&quot;Table1&quot;,&quot;Field1&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' История изменений:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Rev       Date(yyyy/mm/dd)        Description</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' **************************************************************************************</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' 1         2010-Feb-02             Initial Release</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DoesTblFieldExist(sTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, sFieldName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db            </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DAO.Database</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf           </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> TableDef</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> I             </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> bTableExists  </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Инициализируем переменные</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   DoesTblFieldExist = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   bTableExists = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db = CurrentDb()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf = db.TableDefs(sTableName)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   bTableExists = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   I = tdf.Fields(sFieldName).Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   DoesTblFieldExist = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Если мы здесь, то всё в порядке</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">                               </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> tdf = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> db = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Nothing</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Err.Number = 3265 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">And</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> bTableExists = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">False</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Таблица не найдена в текущей базе данных </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Указанная таблица не найдена в текущей базе данных&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, vbCritical</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">ElseIf</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Err.Number = 3265 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">And</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> bTableExists = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Поле не найдено в указанной таблице</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      MsgBox </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MS Access обнаружил следующую ошибку&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; vbCrLf &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Номер ошибки: &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      Err.Number &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Источник ошибки: DoesTblFieldExist&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; vbCrLf &amp; </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Описание ошибки: &quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      Err.Description, vbCritical, </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Произошла ошибка!&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Resume</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">_Handler_</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">22.09.2017 16:13 (последнее изменение - 03.10.2017 10:01) </span><a href="http://am.rusimport.ru/MSAccess/f2_History.aspx?id=68157"><img src="23.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">	</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><img src="5.png" width="16" height="16" /></a><a name="68314"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?ID=740"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">о</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">т Hauder</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img src="12.png" width="16" /></a><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:MarkAsUnread(68314)"><img src="6.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><a href="http://am.rusimport.ru/MSAccess/postMSG.aspx?type=-2&amp;parent=68314&amp;topic=740"><img src="7.png" width="16" /></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 									</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">От Hauder</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Аргументы:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> strTableName - имя таблицы, strFieldName - имя поля <br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Назначение:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Определяет существует ли в таблице strTableName поле с названием strFieldName <br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Возвращает:</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> true - существует, false - нет <br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Public</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> IsFieldPresent(strTableName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, strFieldName </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">String</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Dim</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Field </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">On</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Error</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">GoTo</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> m1 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Set</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> fld = CurrentDb.TableDefs(strTableName).Fields(strFieldName) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">IsFieldPresent = </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Exit</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">m1: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">Err.Clear </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">22.08.2018 12:17</span></p></td></tr></table></body></html>