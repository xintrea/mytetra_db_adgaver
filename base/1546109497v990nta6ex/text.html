<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="lbArtHeader"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">П</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">рограммное скрытие/восстановление и сворачивание/разворачивание ленты Ribbon (Access 2010 и выше).</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">																</span></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">					</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p></td></tr>
<tr>
<td colspan="2">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">								</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Описание: Из названия всё ясно. Для начинающих.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Автор: </span><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Дмитрий Сонных  (AKA Joss)</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">   </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Добавил на сайт:  </span><a href="mailto:banderlogi@bk.ru"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">Joss</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  16.06.2017</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Начиная с версии 2007 в Офисе вместо старого меню появилась так называемая &quot;Лента&quot; (</span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Ribbon</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">). Следовательно появились и новые команды для управления этими &quot;Лентами&quot;.<br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;"><br />Программно скрыть/восстановить ленту.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Бывает необходимо, чтобы запретить пользователям &quot;лишние&quot; действия.<br />Скрывается Ribbon командой </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   DoCmd.ShowToolbar </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, acToolbarNo</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> а восстанавливается </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   DoCmd.ShowToolbar </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, acToolbarYes </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Команды можно оформить подпрограммами или функциями. <br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Sub</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> HideRibbon()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">DoCmd.ShowToolbar </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, acToolbarNo</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Sub</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> ShowRibbon()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">DoCmd.ShowToolbar </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">, acToolbarYes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Эти команды работают так же в Access (и Офисе) 2007.<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Свернуть/развернуть ленту.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Делается для того, чтобы освободить больше места под полезную информацию. В отличии от первого случая, пользователь всегда может свернуть/развернуть ленту, нажав на стрелочку, находящуюся рядом со знаком вопроса в правой части строки меню.<br />Команда для смены состояния ленты всего одна </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   CommandBars.ExecuteMso </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MinimizeRibbon&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> и работает она как триггер, поочерёдно разворачивая и сворачивая ленту. Так, что если Вам надо свернуть ленту, то сначала надо проверить её состояние. Проверить состояние ленты можно запрашивая её размер. Вот так<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> CommandBars(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">).Height &gt; 100 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      CommandBars.ExecuteMso </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MinimizeRibbon&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">      DoEvents</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Эта команда работает только в Access начиная с версии 2010. В 2007 аксе выдает ошибку </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Runtime eroor #5</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">. По-этому я и включил упоминания об этой версии в заголовок статьи.<br />Свернуть/развернуть ленту можно нажав на клавиатуре комбинацию клавиш </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Ctrl + F1</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или программно эмулировав нажатие командой </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">   SendKeys (</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;^{F1}&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">) </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">' Ctrl + F1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Но при этом может меняться состояние NumLock, что не хорошо.<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Примечание.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />Команда </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">CommandBars.ExecuteMso</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> работает только начиная с версии 2010. Но многие до сих пор пользуются версией 2003, где эта команда не обрабатывается и выдаётся сообщение об ошибке. Обойти это можно использовав операторы условной компиляции. В версии 2010 и выше используется VBA7. Так что я доработал код следующим образом </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DbRibbonMinimize()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">#</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> vba7 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Not</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> RibbonState() </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        Application.Echo </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        CommandBars.ExecuteMso </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MinimizeRibbon&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">        Application.Echo </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">#</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> RibbonState() </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#008000;">'Result: 0=normal, -1=autohide</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    RibbonState = (CommandBars(</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;Ribbon&quot;</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;">).Controls(1).Height &lt; 100)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> Такая программа прекрасно компилируется как в Access 2003, так и в Access 2010.<br /><br />Использованы материалы с сайта SQL.RU<br /></span><a href="http://www.sql.ru/forum/1249824/kak-programmno-svernut-razvernut-lentu-access-2007-i-vyshe"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.sql.ru/forum/1249824/kak-programmno-svernut-razvernut-lentu-access-2007-i-vyshe</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /></span><a href="http://www.sql.ru/forum/862643/programmno-skryt-lentu-menu-ribbon"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.sql.ru/forum/862643/programmno-skryt-lentu-menu-ribbon</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />а так же<br /></span><a href="http://www.accessribbon.de/en/index.php?FAQ:19"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.accessribbon.de/en/index.php?FAQ:19</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="javascript:history.back(1)"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">[Back]</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />												</span></p></td></tr>
<tr>
<td colspan="2"></td></tr>
<tr>
<td colspan="2"></td></tr>
<tr>
<td colspan="2"></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">							</span></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td bgcolor="#cacaca">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://am.rusimport.ru/MSAccess/topic.aspx?id=805"><img src="5.png" width="16" height="16" /></a><a name="68125"></a><a href="http://am.rusimport.ru/MSAccess/topic.aspx?id=805"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">С</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">ворачивание ленты без использования условной компиляции</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						</span></p></td>
<td bgcolor="#cacaca"></td>
<td bgcolor="#cacaca"></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">				</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; background-color:#eeeeee;">Если Вы не хотите использовать условную компиляцию, то можете воспользоваться предложением пользователя </span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Akina</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> с сайта SQL.RU<br /><br /></span><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Переместите код минимизации в процедуру. Вместо условной компиляции примените обращение к этой процедуре по условию.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> DbRibbonMinimize() </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">As</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Boolean</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> Val(SysCmd(acSysCmdAccessVer)) &gt; 12 </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Call</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> PerformMinimize</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt; background-color:#eff0f1;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Private</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> PerformMinimize()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Not</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> RibbonState() </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    Application.Echo </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    CommandBars.ExecuteMso </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#0000ff;">&quot;MinimizeRibbon&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; background-color:#eff0f1;">    Application.Echo </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">End</span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt;"> </span><span style=" font-family:'Courier New,Courier,sans-serif'; font-size:11pt; color:#00008b;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-style:italic;">Компиляция процедуры, конечно, выполняется, но вот проверка существования метода CommandBars.ExecuteMso выполняется только в момент обращения к процедуре. Соответственно если версия Access не знает про этот метод, то условие в DbRibbonMinimize не вызывает процедуру, и ошибки не будет.</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br /><br />Взято здесь </span><a href="http://www.sql.ru/forum/1262455/kompilyaciya-koda-v-zavisimosti-ot-versii-access"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">http://www.sql.ru/forum/1262455/kompilyaciya-koda-v-zavisimosti-ot-versii-access</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">			</span></p></td></tr>
<tr>
<td bgcolor="#eeeeee">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">13.06.2017 11:14</span></p></td></tr></table></body></html>