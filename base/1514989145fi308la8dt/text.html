<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Что такое функция пользователя(UDF)? </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если потребовалось заиметь в Excel функцию, которой там еще нет, но она очень нужна или её применение значительно упростило бы жизнь при выполнение определенных задач, то самое время посмотреть в сторону функций пользователя.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Функция пользователя(UDF) - или в дословном переводе </span><span style=" font-size:8.25pt; font-weight:600;">Функция, Определенная Пользователем</span><span style=" font-size:8.25pt;">, т.к. в оригинале она звучит как: </span><span style=" font-size:8.25pt; font-weight:600;">User Defined Function</span><span style=" font-size:8.25pt;">. Так же их называют пользовательские функции.<br />Такие функции вызываются через </span><span style=" font-size:8.25pt; font-weight:600;">Мастер функций</span><span style=" font-size:8.25pt;"> -категория </span><span style=" font-size:8.25pt; font-weight:600;">Определенные пользователем (User Defined)</span><span style=" font-size:8.25pt;">:<br /></span><img src="image5151.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Так что же это за функции такие? Функция пользователя это функция, написанная при помощи языка </span><span style=" font-size:8.25pt; font-weight:600; color:#800000;">Visual Basic for Application (VBA)</span><span style=" font-size:8.25pt;"> и вызываемая как любая другая функция с листа. Но т.к. эти функции пишутся самостоятельно - можно создать любую функцию, которая будет делать то, что ни одна стандартная функция делать не умеет. Естественно, теперь возникает вопрос как написать такую функцию. Для написания </span><span style=" font-size:8.25pt; font-weight:600;">UDF</span><span style=" font-size:8.25pt;"> понадобятся хотя бы базовые знания языка VBA. Я в статье опишу лишь принципы создания таких функций и после прочтения вы сможете создать простейшую функцию. Но это никак не означает, что я научу создавать функции на все случаи жизни, ибо это сводится к обучению самому языку программирования. Именно поэтому в статье рассмотрим лишь основные моменты и то, как уже написанные функции применить к своей книге.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Самое главное, что необходимо усвоить - функция пользователя:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#ff0000;">не может</span> изменять значения других ячеек (<a href="http://www.excel-vba.ru/chto-umeet-excel/kak-funkciej-polzovatelya-izmenit-znachenie-drugoj-yachejki/"><span style=" text-decoration: underline; color:#0000ff;">с небольшими недокументированными исключениями</span></a>)</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#ff0000;">не может</span> изменять форматы ячеек либо присваивать форматы (<a href="http://www.excel-vba.ru/chto-umeet-excel/kak-funkciej-polzovatelya-izmenit-znachenie-drugoj-yachejki/"><span style=" text-decoration: underline; color:#0000ff;">с небольшими недокументированными исключениями</span></a>)</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#336600;">может</span> возвращать результат только в ту ячейку, в которой записана сама функция</li></ol>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как создать функцию пользователя</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Предполагается, что Вы уже обладаете начальными навыками написания процедур в VBA и умеете создавать эти самые процедуры, хотя бы самые простые.<br />Однако прежде чем читать дальше советую ознакомиться так же со статьей: </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Что такое модуль? Какие бывают модули?</span></a><span style=" font-size:8.25pt;"><br />Основные моменты, которые следует помнить при создании функции пользователя:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">в отличие от процедуры<span style=" font-style:italic;">(</span><span style=" font-style:italic; color:#0000ff;">Sub</span><span style=" font-style:italic;">)</span> функция всегда начинается именно со слова <span style=" font-style:italic; color:#0000ff;">Function</span>, а не <span style=" font-style:italic; color:#0000ff;">Sub</span>;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">в теле функции всегда должно быть присвоение ей значения, иначе функция не вернет необходимый результат;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">функция должна располагаться в <a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#StandartModule"><span style=" text-decoration: underline; color:#0000ff;">стандартном модуле</span></a> или в <a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#ThisWorkbook"><span style=" text-decoration: underline; color:#0000ff;">модуле книги</span></a>, если Вы планируете вызывать её непосредственно с листа Excel</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">функции пользователя &quot;привязаны&quot; к той книге, в которой созданы и по умолчанию не будут работать в других (для этого надо будет всегда указывать имя книги с функцией). Чтобы созданные функции работали удобно и без проблем в любой книге необходимо книгу с функциями сохранить как надстройку: <a href="http://www.excel-vba.ru/chto-umeet-excel/kak-sozdat-svoyu-nadstrojku/"><span style=" text-decoration: underline; color:#0000ff;">Как создать свою надстройку?</span></a></li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788ecc0347630237"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction MySum(vArg1 As Double, vArg2 As Double) Dim dblSum as Double 'получаем сумму двух аргументов dblSum = vArg1 + vArg2 'присваиваем функции значение, чтобы она вернула его на лист(обязательно!) MySum = dblSum 'MySum имя функции и именно ему необходимо передать результат End Function </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788ecc0347630237-1"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction MySum(vArg1 As Double, vArg2 As Double)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim dblSum as Double</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'получаем сумму двух аргументов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   dblSum = vArg1 + vArg2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'присваиваем функции значение, чтобы она вернула его на лист(обязательно!)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   MySum = dblSum 'MySum имя функции и именно ему необходимо передать результат</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecc0347630237-7"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Function</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В приведенном выше коде я упростил стандартную функцию </span><span style=" font-size:8.25pt; font-weight:600;">СУММ (SUM)</span><span style=" font-size:8.25pt;"> до двух аргументов. Записанная на лист функция будет иметь такой вид: =Mysum(</span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;">;</span><span style=" font-size:8.25pt; color:#336600;">A2</span><span style=" font-size:8.25pt;">), где:<br /></span><span style=" font-size:8.25pt; color:#0000ff;">A1</span><span style=" font-size:8.25pt;"> - первый аргумент</span><span style=" font-size:8.25pt; font-style:italic;">(vArg1)</span><span style=" font-size:8.25pt;">, ссылка на ячейку или число<br /></span><span style=" font-size:8.25pt; color:#336600;">A2</span><span style=" font-size:8.25pt;"> - второй аргумент</span><span style=" font-size:8.25pt; font-style:italic;">(vArg2)</span><span style=" font-size:8.25pt;">, ссылка на ячейку или число<br />Функция вернет </span><span style=" font-size:8.25pt; font-weight:600;">#ЗНАЧ! (#VALUE!)</span><span style=" font-size:8.25pt;">, если в качестве одного из аргументов передано не числовое значение.<br /> <br />Еще одна простая функция, которая вернет строку до первого пробела: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788eccb678950865"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction getWordBeforeSpace(Text As String) As String Dim i As Long Dim Result As String 'переменная для результата i = InStr(1, Text, &quot; &quot;, 1) 'ищем позицию первого пробела в переданном тексте 'если пробел есть и он не первым символом If i &gt; 1 Then Result = Mid(Text, 1, i - 1) 'получаем текст до первого пробела Else 'если пробела нет - возвращаем все строку Result = Text End If 'присваиваем результат функции для возврата его на лист getWordBeforeSpace = Result End Function </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">14 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788eccb678950865-1"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction getWordBeforeSpace(Text As String) As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim i As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim Result As String 'переменная для результата</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   i = InStr(1, Text, &quot; &quot;, 1) 'ищем позицию первого пробела в переданном тексте</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'если пробел есть и он не первым символом</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   If i &gt; 1 Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-7"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Result = Mid(Text, 1, i - 1) 'получаем текст до первого пробела</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-8"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-9"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'если пробела нет - возвращаем все строку</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Result = Text</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-11"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-12"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'присваиваем результат функции для возврата его на лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-13"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   getWordBeforeSpace = Result</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788eccb678950865-14"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Function</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Text</span><span style=" font-size:8.25pt;"> - ссылка на ячейку или непосредственно текст, первое слово из которого надо извлечь. Если переданный текст не будет содержать пробелов или это будет число - функция вернет весь текст. Если ячейка будет пустая - функция вернет пусто и не выдаст ошибки.<br />Эту функцию можно записать и намного короче: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788ecd1096466962"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction getWordBeforeSpace(Text As String) As String getWordBeforeSpace = Split(Text, &quot; &quot;)(0) End Function </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce4788ecd1096466962-1"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction getWordBeforeSpace(Text As String) As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecd1096466962-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   getWordBeforeSpace = Split(Text, &quot; &quot;)(0)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce4788ecd1096466962-3"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Function</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Но в таком виде функция вернет значение ошибки </span><span style=" font-size:8.25pt; font-weight:600;">#ЗНАЧ!(#VALUE!)</span><span style=" font-size:8.25pt;">, если ячейка с текстом будет пустой. Вдаваться в подробности не буду. Могу лишь написать, что функция VBA </span><span style=" font-size:8.25pt; font-weight:600;">Split</span><span style=" font-size:8.25pt;"> разбивает указанный текст на отдельные части, используя для разбиения указанный разделитель. И создает из разбитых частей одномерный массив с нижней границей, равной нулю. А функция выше просто возвращает первый элемент этого массива.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> <br />Как вставить уже имеющийся код функции к себе в книгу</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для начала необходимо создать </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli#StandartModule"><span style=" font-size:8.25pt; font-style:italic; text-decoration: underline; color:#0000ff;">стандартный модуль</span></a><span style=" font-size:8.25pt;">. Затем в этот модуль вставить через копирование</span><span style=" font-size:8.25pt; font-style:italic;">(или записать вручную)</span><span style=" font-size:8.25pt;"> имеющийся код. Все, теперь функция доступна из диспетчера функций в категории </span><span style=" font-size:8.25pt; font-weight:600;">Определенные пользователем(User defined)</span><span style=" font-size:8.25pt;">, так же можно будет вводить эту функцию напрямую в ячейки той книги, в которой содержится код функции. Чтобы функция заработала очень важно </span><a href="http://www.excel-vba.ru/chto-umeet-excel/pochemu-ne-rabotaet-makros/"><span style=" font-size:8.25pt; font-style:italic; text-decoration: underline; color:#0000ff;">разрешить макросы</span></a><span style=" font-size:8.25pt;">. Иначе результатом будет ошибка </span><span style=" font-size:8.25pt; font-weight:600;">#ИМЯ!(#NAME!</span><span style=" font-size:8.25pt;">)</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если Вы используете версию Excel 2007 и выше, то книгу необходимо будет сохранить с поддержкой макросов: Меню -Сохранить как -Книга Excel с поддержкой макросов.</span></p></body></html>