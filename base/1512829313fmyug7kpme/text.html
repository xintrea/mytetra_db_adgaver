<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="container"></a><a href="https://analitica.jimdo.com/%D0%BF%D1%80%D0%BE%D0%B4%D0%B2%D0%B8%D0%BD%D1%83%D1%82%D0%BE%D0%B5/%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D1%8B-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%B0-%D0%BC%D0%B0%D0%BA%D1%80%D0%BE%D1%81%D0%B0/"><span style=" text-decoration: underline; color:#0000ff;">a</span></a><span style=" text-decoration: underline; color:#0000ff;">nalitica.jimdo.com</span> </p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-title"></a><span style=" font-size:xx-large; font-weight:600;">А</span><span style=" font-size:xx-large; font-weight:600;">втозапуск при открытии файла - Макросы в Excel</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-credits"></a>2-3 минуты </p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="moz-reader-content"></a>Многие вещи хотелось бы запускать автоматически при открытии файла: вызов формы, добавление кнопок на панель инструментов, создание резервной копии открытого файла и многое другое. Запустить всё что угодно при открытии файла можно, задав название макроса <span style=" font-weight:600;">auto_open</span>, например: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">    Sub auto_open()</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">          MsgBox(“Hello, World!”)</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">    End sub</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cc-m-8429398585"></a>Если вы хотите запустить один макрос из другого макроса, вам нужно просто написать его название. Например запустим макрос с названием another_macro </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">    Sub run_macro()</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">        another_macro</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">    End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cc-m-8351355685"></a>Часто используемые макросы должны быть всегда под рукой. Добавить на ленту или панель быстрого доступа кнопку запуска конкретного макроса – самый логичный и простой способ решения проблемы. Добавить кнопку вручную на панель доступа можно в настройках панели быстрого доступа. Мы же рассмотрим, как автоматически добавить кнопку запуска макроса на ленту. Такой код может запускаться, например, при открытии файла с макросом и особенно полезен при предоставлении макросов другим пользователям – не требуется дополнительных действий, а доступ к макросу прост и понятен. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, чтоб добавить кнопку, нужен следующий код: </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">        Application.CommandBars.Add(Name:=&quot; </span><span style=" font-weight:600; font-style:italic;">my_cmd_bar</span><span style=" font-style:italic;"> &quot;, Position:=msoBarTop, Temporary:=True).Visible = True</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">        Set </span><span style=" font-weight:600; font-style:italic;">button_01</span><span style=" font-style:italic;"> = Application.CommandBars(&quot;</span><span style=" font-weight:600; font-style:italic;">my_cmd_bar</span><span style=" font-style:italic;">&quot;).Controls.Add(Type:=msoControlButton)</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">        With </span><span style=" font-weight:600; font-style:italic;">button_01</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">            .Tag = &quot;</span><span style=" font-weight:600; font-style:italic;">tag_name</span><span style=" font-style:italic;">&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">            .OnAction = &quot;</span><span style=" font-weight:600; font-style:italic;">macro_name</span><span style=" font-style:italic;">&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">            .FaceId = </span><span style=" font-weight:600; font-style:italic;">602</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">            .Caption = &quot;</span><span style=" font-weight:600; font-style:italic;">подпись к кнопке</span><span style=" font-style:italic;">&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">        EndWith</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Иконки можно выбрать вот <a href="http://www.outlookexchange.com/articles/toddwalker/BuiltInOLKIcons.asp"><span style=" text-decoration: underline; color:#0000ff;">тут</span></a>. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>