<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://pamirych.ru/%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%ba-excel-%d0%ba%d0%b0%d0%ba-%d0%ba-%d0%b1%d0%b4/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">Подключение к Excel как к БД</span></a></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-1"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">   </span><span style=" font-size:13px;">Dim tbl As DataTable</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-2"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">   </span><span style=" font-size:13px;">Dim da As New OleDb.OleDbDataAdapter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-3"></a><span style=" font-size:13px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-4"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">   </span><span style=" font-size:13px;">Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-5"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">Dim fname As String = &quot;C:\1.xls&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-6"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">Dim cn As New OleDb.OleDbConnection(&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; fName &amp; &quot;;Extended Properties=&quot;&quot;Excel 8.0;HDR=NO;IMEX=1&quot;&quot;&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-7"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">cn.Open()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-8"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">da.SelectCommand = New OleDb.OleDbCommand(&quot;Select [F1] from [Лист3$]&quot;, cn)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-9"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">tbl = New DataTable</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-10"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">da.Fill(tbl)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-11"></a><span style=" font-size:13px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-12"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">'DataGridView1.DataSource = tbl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-13"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">ListBox1.DisplayMember = &quot;F1&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-14"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">       </span><span style=" font-size:13px;">ListBox1.DataSource = tbl</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-15"></a><span style=" font-size:13px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5ab6c164be25c458376938-16"></a><span style=" font-size:13px;"> </span><span style=" font-size:13px;">   </span><span style=" font-size:13px;">End Sub</span></p></body></html>