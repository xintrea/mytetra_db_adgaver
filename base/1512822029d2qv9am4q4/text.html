<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="container"></a><a href="https://analitica.jimdo.com/%D0%BF%D1%80%D0%BE%D0%B4%D0%B2%D0%B8%D0%BD%D1%83%D1%82%D0%BE%D0%B5/word-%D0%B8-excel/"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">a</span></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; text-decoration: underline; color:#0000ff;">nalitica.jimdo.com</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-title"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:5pt; font-weight:600;">О</span><span style=" font-family:'MS Shell Dlg 2'; font-size:5pt; font-weight:600;">ткрыть Word из Excel - Макросы в Excel</span><span style=" font-family:'MS Shell Dlg 2'; font-size:5pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-credits"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">3</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">-4 минуты </span></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="moz-reader-content"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">К</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">огда вы работаете в рамках одного приложения, нет необходимости прописывать название приложения. Другое дело работа в нескольких программах. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Чтобы открыть Word из Excel пишем: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    ' запустить Word им сделать его видимым  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    Set wa = CreateObject(&quot;Word.Application&quot;) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        wa.Visible = True </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    ' открыть конкретный файл, wd_full_name - полное имя файла, включая путь к нему </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    Set wd = wa.Documents.Open(wd_full_name) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Теперь любые операции с этим файлом возможны при обращении к нему по заданному нами имени - wd. Например, </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    wd.Save </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    wd.Close </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Собственно, таким образом можно открыть Word из любого приложения, а не только из Excel. Аналогично обстоит дело и с другими приложениями. Например, вот так открывается Excel. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    Set xl = CreateObject(&quot;Excel.Application&quot;)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    xl.Visible = True</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">    Set xlfile = xl.Workbooks.Open(xlfile_full_name)</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Не забываем определять переменные xl и xlfile (хотя иногда это не приводит к ошибке). Причем лучше определять их не как объекты конкретного класса ( </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">Dim xlfile As Workbook</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">), а как просто абстрактный объект - </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-style:italic;">Dim xlfile AsObject</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">. Практика показывает, что так возникает гораздо меньше ошибок. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="cc-m-8351354485"></a><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">С</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">лияние Word и Excel нужно, когда нужно делать много стандартных документов. Создаем шаблон документа, настраиваем слияние, проставляем поля. Теперь заполняем строки в Excel. Создание 10 шаблонных документов потребует от нас следующих действий: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">- нажать на стрелку для перехода на нужную строку </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">- сохранить Word как новый документ в нужную папку </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">и так 10 раз. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">А если нужно сделать 50 документов? </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Чтобы не заниматься глупым нажатием на стрелку, можно доверить генерацию макросу (до этого назовем нужный вордовский файл </span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:600;">myfile</span><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">): </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    With myfile.MailMerge </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        .MainDocumentType = wdFormLetters </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        .OpenDataSource Name:=myfile_name, SQLStatement:=&quot;SELECT * FROM     `'тут_название_excel-файла$'`&quot;, _ </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        ConfirmConversions:=True, ReadOnly:=False, LinkToSource:=True, _ </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">             Revert:=False, _ </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        SubType:=wdMergeSubTypeAccess </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">        .ViewMailMergeFieldCodes = False </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    End With </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    ' открываем нужную запись в рассылке, допустим n-ную </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    myfile.MailMerge.DataSource.ActiveRecord = n </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    ' сохраняем в нужную папку </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    myfile.SaveAs Filename:=myfile_new_name, FileFormat:=wdFormatDocument, LockComments:=False, Password:=&quot;&quot;,addToRecentFiles:=True, WritePassword:=&quot;&quot;, ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:=False </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:4px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt; color:#0a106a;">    myfile.Close </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'MS Shell Dlg 2'; font-size:9pt;">Обратите внимание, что слияние должно быть предварительно настроено. Нет смысла проставлять поля слияния макросом, это долго и неэффективно. Использовать же готовый шаблон можно легко и быстро. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'MS Shell Dlg 2'; font-size:9pt;"><br /></p></body></html>