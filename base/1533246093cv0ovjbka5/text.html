<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table id="tblPlaceArt" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td colspan="2" align="center"><span id="lbArtHeader" class="ArtHeader">Просмотр содержимого папки (каталога)</span></td>
									</tr>
									<tr>
										<td colspan="2" align="center">
											<p>
												<span id="lbArtObr" class="ArtObr">(обращений: <b>1576</b> с 28.04.2016)</span><br>
												<br>
												<span id="lbIssueListH">Разделы:</span> 
												<span id="lbIssueList"><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=20">Полезные функции</a>, <a href="http://am.rusimport.ru/MsAccess/content.aspx?id=23">ЧаВо (FAQ)</a></span></p>
											<p> </p>
										</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbBody"><p><span class="ArtPartHead">Описание: </span>Для начинающих. Всё ясно из названия.</p><p><span class="ArtPartHead">Автор: </span><a href="mailto:banderlogi@bk.ru">Дмитрий Сонных  (AKA Joss)</a>   </p><p><span class="ArtPartHead">Добавил на сайт: </span> <a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="1.png" width="16" border="0"></a><a href="mailto:banderlogi@bk.ru">Joss</a>  28.04.2016</p>Иногда,
 для автоматизации процесса загрузки однотипных данных пришедших из 
разных источников, необходимо определить содержимое нужной папки 
(каталога). Проще говоря получить список находящихся в ней файлов. Это 
можно сделать при помощи следующего кода<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Dim</font> strFolder <font color="darkblue">As</font> <font color="darkblue">String</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Dim</font> Path <font color="darkblue">As</font> <font color="darkblue">String</font>, fName <font color="darkblue">As</font> <font color="darkblue">String</font>, i <font color="darkblue">As</font> <font color="darkblue">Integer</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    strFolder = <font color="blue">"c:\ImportXLS\"</font> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Path = strFolder &amp; <font color="blue">"*.*"</font> <font color="green">' можно и "*.xls"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>fName = Dir(Path)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">If</font> Len(fName) = 0 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Debug.Print <font color="blue">"Папка пуста"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Else</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    i = 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Do</font> <font color="darkblue">While</font> fName &lt;&gt; <font color="blue">""</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        i = i + 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Debug.Print i, fName</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        fName = Dir</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Loop</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Debug.Print <font color="blue">"Просмотр окончек"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">If</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>Пример взят с сайта SQL.RU<br><br><b>P.S.</b> Первоначально пробовал написать пример с помощью <i>FileSystemObject</i>, но оказалось, что в семействе <i>Files </i>к объектам <i>File </i>можно обращаться только по именам, а не по номеру в семействе. А жаль. <p><a href="javascript:history.back(1)">[Back]</a></p><br></span>
											</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											
<table class="Rating" id="tblPlace" width="100%" cellspacing="0" cellpadding="0" border="0">
	<tbody><tr>
		<td style="WIDTH: 30%" valign="top"><span id="Rating1_lbBar">Текущий рейтинг:<br>0 из 5 (проголосовало:0).<br><img src="2.png"></span></td>
		<td valign="top">
			<table id="Rating1_pnlLogin" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<span id="Rating1_lbNoUser">Здравствуйте!<br>Для участия в рейтинге необходимо залогиниться на сайт.<br>Это
 сделано для того, чтобы более точно производить оценку статей (чтобы 
одному и тому же человеку было труднее голосовать несколько раз, портя 
тем самым статистику.<br>
Эта процедура очень быстрая и, надеюсь, Вас не затруднит :).<br>
Все мысли по поводу работы сайта всегда можно высказать на <a href="http://am.rusimport.ru/MsAccess/f.aspx?type=2">форуме</a>!<br>
</span>
				<a id="Rating1_lnkLogin" href="http://am.rusimport.ru/MsAccess/login.aspx?ReturnURL=topic.aspx?id=796">Вход на сайт</a>
			
	</td></tr></tbody></table>
			</td>
	</tr>
</tbody></table>
</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbComment"><br><table class="ArtCommentHead" width="100%"><tbody><tr><td><a name="comments" class="ArtCommentHead">Обсуждение статьи:</a>  <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=0&amp;topic=796" target="blank"><img src="3.png" title="Добавить комментарий" width="16" border="0"></a> <a href="javascript:Subscribe(-2,796)"><img src="4.png" title="Подписаться на комментарии к этой теме" <="" a="" width="16" border="0"></a></td></tr></tbody></table></span></td>
									</tr>
									<tr>
										<td colspan="2" align="left"></td>
									</tr>
								</tbody></table>
							

<table id="Table1" width="100%" cellspacing="0" cellpadding="0" bordercolor="#CACACA" border="1">
	<tbody><tr>
		<td>
			<table id="_ctl0_pnlHead" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<table id="tblHead" width="100%" cellspacing="0" cellpadding="0" bordercolor="#000000" border="0">
					<tbody><tr bgcolor="#CACACA">
						<td style="WIDTH: 70%"><a name="67778"></a><a class="ml" href="http://am.rusimport.ru/MsAccess/topic.aspx?id=796"><img src="5.png" width="16" height="16" border="0">Примечание к примеру</a></td>
						<td align="right"><a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="6.png" width="16" border="0"></a><a class="" href="mailto:banderlogi@bk.ru">Joss</a></td>
						<td style="WIDTH: 15%" align="right"><a href="javascript:MarkAsUnread(67778)"><img src="7.png" title="Пометить сообщение как непрочитанное" width="16" border="0"></a> <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=67778&amp;topic=796" target="blank"><img src="8.png" title="Ответить" width="16" border="0"></a> </td>
					</tr>
				</tbody></table>
			
	</td></tr></tbody></table>
		</td>
	</tr>
	<tr bgcolor="#eeeeee">
		<td>Если в оператор <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   fName = Dir(Path)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> добавить параметр <i><b>vbDirectory</b></i>, то будут выведены так же папки, входящие в указанную папку и ссылки на вышестоящую ".." и корневую "." папки. <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   fName = Dir(Path, vbDirectory)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> </td>
	</tr>
	
	<tr bgcolor="#eeeeee">
		<td><font size="1">06.04.2016 13:33</font></td>
	</tr>
</tbody></table>
<br>


<table id="Table1" width="100%" cellspacing="0" cellpadding="0" bordercolor="#CACACA" border="1">
	<tbody><tr>
		<td>
			<table id="_ctl1_pnlHead" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<table id="tblHead" width="100%" cellspacing="0" cellpadding="0" bordercolor="#000000" border="0">
					<tbody><tr bgcolor="#CACACA">
						<td style="WIDTH: 70%"><a name="67779"></a><a class="ml" href="http://am.rusimport.ru/MsAccess/topic.aspx?id=796"><img src="5.png" width="16" height="16" border="0">Ещё раз о FileSystemObject</a></td>
						<td align="right"><a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="6.png" width="16" border="0"></a><a class="" href="mailto:banderlogi@bk.ru">Joss</a></td>
						<td style="WIDTH: 15%" align="right"><a href="javascript:MarkAsUnread(67779)"><img src="7.png" title="Пометить сообщение как непрочитанное" width="16" border="0"></a> <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=67779&amp;topic=796" target="blank"><img src="8.png" title="Ответить" width="16" border="0"></a> </td>
					</tr>
				</tbody></table>
			
	</td></tr></tbody></table>
		</td>
	</tr>
	<tr bgcolor="#eeeeee">
		<td>Всё-таки и при помощи <i>FileSystemObject</i> можно получить список файлов. Но через коллекцию.<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> FilenamesCollection(<font color="darkblue">ByVal</font> FolderPath <font color="darkblue">As</font> <font color="darkblue">String</font>, <font color="darkblue">Optional</font> <font color="darkblue">ByVal</font> Mask <font color="darkblue">As</font> <font color="darkblue">String</font> = <font color="blue">""</font>, _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                              <font color="darkblue">Optional</font> <font color="darkblue">ByVal</font> SearchDeep <font color="darkblue">As</font> <font color="darkblue">Long</font> = 999) <font color="darkblue">As</font> <font color="darkblue">Collection</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="green">' Получает в качестве параметра путь к папке FolderPath,</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' маску имени искомых файлов Mask (будут отобраны только файлы с такой маской/расширением)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' и глубину поиска SearchDeep в подпапках (если SearchDeep=1, то подпапки не просматриваются).</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' Возвращает коллекцию, содержащую полные пути найденных файлов</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' (применяется рекурсивный вызов процедуры GetAllFileNamesUsingFSO)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Dim</font> FSO <font color="darkblue">As</font> <font color="darkblue">Object</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Set</font> FilenamesCollection = <font color="darkblue">New</font> <font color="darkblue">Collection</font>    <font color="green">' создаём пустую коллекцию</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">Set</font> FSO = CreateObject(<font color="blue">"Scripting.FileSystemObject"</font>)    <font color="green">' создаём экземпляр FileSystemObject</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    GetAllFileNamesUsingFSO FolderPath, Mask, FSO, FilenamesCollection, SearchDeep <font color="green">' поиск</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">Set</font> FSO = <font color="darkblue">Nothing</font>    <font color="green">' очистка строки состояния Excel</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> GetAllFileNamesUsingFSO(<font color="darkblue">ByVal</font> FolderPath <font color="darkblue">As</font> <font color="darkblue">String</font>, <font color="darkblue">ByVal</font> Mask <font color="darkblue">As</font> <font color="darkblue">String</font>, <font color="darkblue">ByRef</font> FSO, _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                                  <font color="darkblue">ByRef</font> FileNamesColl <font color="darkblue">As</font> <font color="darkblue">Collection</font>, <font color="darkblue">ByVal</font> SearchDeep <font color="darkblue">As</font> <font color="darkblue">Long</font>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="green">' перебирает все файлы и подпапки в папке FolderPath, используя объект FSO</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' перебор папок осуществляется в том случае, если SearchDeep &gt; 1</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="green">' добавляет пути найденных файлов в коллекцию FileNamesColl</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>     <font color="darkblue">On</font> <font color="darkblue">Error</font> <font color="darkblue">Resume</font> <font color="darkblue">Next</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Dim</font> curfold <font color="darkblue">As</font> <font color="darkblue">Object</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Dim</font> fil <font color="darkblue">As</font> <font color="darkblue">Object</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Dim</font> sfol <font color="darkblue">As</font> <font color="darkblue">Variant</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Set</font> curfold = FSO.GetFolder(FolderPath)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">If</font> <font color="darkblue">Not</font> curfold Is <font color="darkblue">Nothing</font> <font color="darkblue">Then</font>    <font color="green">' если удалось получить доступ к папке</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        <font color="green">' раскомментируйте эту строку для вывода пути к просматриваемой</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>        <font color="green">' в текущий момент папке в строку состояния Excel</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>        <font color="green">' Application.StatusBar = "Поиск в папке: " &amp; FolderPath</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">For</font> <font color="darkblue">Each</font> fil <font color="darkblue">In</font> curfold.Files    <font color="green">' перебираем все файлы в папке FolderPath</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>            <font color="darkblue">If</font> fil.Name Like <font color="blue">"*"</font> &amp; Mask <font color="darkblue">Then</font> FileNamesColl.Add fil.Path</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">Next</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         SearchDeep = SearchDeep - 1    <font color="green">' уменьшаем глубину поиска в подпапках</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>         <font color="darkblue">If</font> SearchDeep <font color="darkblue">Then</font>    <font color="green">' если надо искать глубже</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>             <font color="darkblue">For</font> <font color="darkblue">Each</font> sfol <font color="darkblue">In</font> curfold.SubFolders    <font color="green">' перебираем все подпапки в папке FolderPath</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>                GetAllFileNamesUsingFSO sfol.Path, Mask, FSO, FileNamesColl, SearchDeep</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">             <font color="darkblue">Next</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">Set</font> fil = <font color="darkblue">Nothing</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">Set</font> curfold = <font color="darkblue">Nothing</font>    <font color="green">' очищаем переменные</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>Ну и пример использования. Обрабатывается не только папка, но и входящие в неё подпапки<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Public</font> <font color="darkblue">Sub</font> FileInFolder()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="green">' Пример использования функции</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">On</font> <font color="darkblue">Error</font> <font color="darkblue">GoTo</font> FileInFolder_<font color="darkblue">Error</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Dim</font> folder$, coll <font color="darkblue">As</font> <font color="darkblue">Collection</font>, File</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     folder$ = <font color="blue">"\\I-server-one\shara\ОНС_модуль_загрузка\"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">If</font> Dir(folder$, vbDirectory) = <font color="blue">""</font> <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         MsgBox <font color="blue">"Не найдена папка «"</font> &amp; folder$ &amp; <font color="blue">"»"</font>, vbCritical, <font color="blue">"Нет папки"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">Exit</font> <font color="darkblue">Sub</font>        <font color="green">' выход, если папка не найдена</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Set</font> coll = FilenamesCollection(folder$) <font color="green">' можно и так (folder$, "*.xls") - получаем список файлов XLS из папки</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">If</font> coll.Count = 0 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         MsgBox <font color="blue">"В папке «"</font> &amp; Split(folder$, <font color="blue">"\"</font>)(UBound(Split(folder$, <font color="blue">"\"</font>)) - 1) &amp; _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                <font color="blue">"» нет ни одного подходящего файла!"</font>, _</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                vbCritical, <font color="blue">"Файлы для обработки не найдены"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         <font color="darkblue">Exit</font> <font color="darkblue">Sub</font>        <font color="green">' выход, если нет файлов</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="green">' перебираем все найденные файлы</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">For</font> <font color="darkblue">Each</font> File <font color="darkblue">In</font> coll</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">         Debug.Print File        <font color="green">' выводим имя файла в окно Immediate</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    <font color="darkblue">Next</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Exit</font>_FileInFolder:</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">On</font> <font color="darkblue">Error</font> <font color="darkblue">GoTo</font> 0</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">Exit</font> <font color="darkblue">Sub</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">FileInFolder_<font color="darkblue">Error</font>:</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     MsgBox <font color="blue">"Error "</font> &amp; Err.Number &amp; <font color="blue">" ("</font> &amp; Err.Description &amp; <font color="blue">") in procedure FileInFolder"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">     <font color="darkblue">Resume</font> <font color="darkblue">Exit</font>_FileInFolder</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Sub</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Источник тот же.</td>
	</tr>
	
	<tr bgcolor="#eeeeee">
		<td><font size="1">06.04.2016 13:50 (последнее изменение - 06.04.2016 14:02) <a href="http://am.rusimport.ru/MsAccess/f2_History.aspx?id=67779" target="blank"><img src="13.png" title="История изменения сообщения" width="16" border="0"></a></font></td></tr></tbody></table>
</body>
</html></p></body></html>