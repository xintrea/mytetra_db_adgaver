<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Const</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> HKEY_LOCAL_MACHINE </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">H80000002<br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Const</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> HKEY_CURRENT_USER </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">H80000001<br /><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Public</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> oReg </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">As</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#6a5acd;">Object</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Private</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Sub</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Form_Load</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">()</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Set</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> oReg </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> GetObject</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">(</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">&quot;winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv&quot;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    test<br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Sub</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br /><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Sub</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> test</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">()</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Dim</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> sValues</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">()</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Dim</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> sTypes</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">()</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Dim</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> sKey        </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">As</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#6a5acd;">String</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Dim</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> lret        </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">As</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#6a5acd;">Long</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />   <br />    sKey </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">&quot;Environment&quot;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />   <br />    lret </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> oReg</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">.EnumValues(</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">HKEY_CURRENT_USER, sKey, sValues, sTypes</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />   <br />    </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Stop</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Sub</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В данном примере мы получаем перечень параметров<br />подраздела: HKCU\Environment<br /><br />По достижении оператора Stop, в окне Locals (View -&gt; Locals Windows (рус. - окно местных </span><img src="image32083.png" /><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">))<br />мы увидим 2 массива:<br /><br />sValues - список параметров<br />sTypes - типы этих параметров<br /><br /></span><img src="image11050.png" /><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br /><br />Индексы массивов соответствуют друг другу.<br />К примеру,<br />sTypes(1) = 2<br />sValues(1) = &quot;TMP&quot;<br /><br />Это значит, что параметр TMP имеет тип 2.<br />Далее смотрим расшифровку:</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Код (vb.net):</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Public</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Enum</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> REG_TYPE<br />    REG_SZ </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">1</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    REG_EXPAND_SZ </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">2</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    REG_BINARY </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">3</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    REG_DWORD </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">4</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br />    REG_MULTI_SZ </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">=</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#a52a2a;">7</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; color:#000000;">&amp;</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"><br /></span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#0000ff;">Enum</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Тип 2 - это REG_EXPAND_SZ. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p></body></html>