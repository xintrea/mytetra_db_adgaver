<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Определение:<br /></span><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">версии,</span></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">разрядности,</span></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">сборки,</span></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">семейства операционной системы,</span></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">разрядности среды, из которой запущен Batch</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (DOS): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#33cc33;">@</span><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> off<br /><a href="http://www.ss64.com/nt/setlocal.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">SetLocal</span></a> EnableExtensions<br /><br /><a href="http://www.ss64.com/nt/call.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">call</span></a> :<span style=" font-weight:600; color:#b100b1;">GetSystemVersion</span> &quot;OSVer&quot; &quot;Core&quot; &quot;Build&quot; &quot;Family&quot; &quot;EnvironCore&quot;<br /><br /><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> Версия ОС:      <span style=" color:#33cc33;">%</span><span style=" color:#448888;">OSVer</span><span style=" color:#33cc33;">%</span><br /><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> Рязрядность ОС: <span style=" color:#33cc33;">%</span><span style=" color:#448888;">Core</span><span style=" color:#33cc33;">%</span><br /><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> Сборка:         <span style=" color:#33cc33;">%</span><span style=" color:#448888;">Build</span><span style=" color:#33cc33;">%</span><br /><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> Семейство:      <span style=" color:#33cc33;">%</span><span style=" color:#448888;">Family</span><span style=" color:#33cc33;">%</span><br /><a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> Разрядность среды запуска Batch: <span style=" color:#33cc33;">%</span><span style=" color:#448888;">EnvironCore</span><span style=" color:#33cc33;">%</span><br /><br /><a href="http://www.ss64.com/nt/pause.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">pause</span></a><br /><a href="http://www.ss64.com/nt/exit.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">Exit</span></a> /B<br /><br />:<span style=" font-weight:600; color:#b100b1;">GetSystemVersion</span> [OSVersion] [OSCore] [OSBuild] [OSFamily] [EnvironmentCore]<br /><span style=" font-style:italic; color:#b100b1;">:: Определить версию ОС</span><br /><span style=" font-style:italic; color:#b100b1;">:: %1-исх.Переменная для хранения названия ОС</span><br /><span style=" font-style:italic; color:#b100b1;">:: %2-исх.Переменная для хранения разрядности ОС</span><br /><span style=" font-style:italic; color:#b100b1;">:: %3-исх.Переменная для хранения версии сборки ОС</span><br /><span style=" font-style:italic; color:#b100b1;">:: %4-исх.Переменная, идентифицирующая семейство ОС (9x, NT, Vista)</span><br /><span style=" font-style:italic; color:#b100b1;">:: %5-исх.Переменная, идентифицирующая разрядность среды, из-под которой запущен скрипт</span><br />  <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">Set</span></a> &quot;xOS=x64&quot;<span style=" color:#33cc33;">&amp;</span> <a href="http://www.ss64.com/nt/if.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">If</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">PROCESSOR_ARCHITECTURE</span><span style=" color:#33cc33;">%</span>&quot;==&quot;x86&quot; <a href="http://www.ss64.com/nt/if.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">If</span></a> <a href="http://www.ss64.com/nt/not.html"><span style=" font-weight:600; text-decoration: underline; color:#000000;">Not</span></a> <a href="http://www.ss64.com/nt/defined.html"><span style=" font-weight:600; text-decoration: underline; color:#000000;">Defined</span></a> PROCESSOR_ARCHITEW6432 <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">Set</span></a> &quot;xOS=x32&quot;<br />  <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~2</span>=<span style=" color:#33cc33;">%</span><span style=" color:#448888;">xOS</span><span style=" color:#33cc33;">%</span>&quot;<br />  <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~5</span>=x32&quot;<span style=" color:#33cc33;">&amp;</span> <a href="http://www.ss64.com/nt/if.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">if</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">xOS</span><span style=" color:#33cc33;">%</span>&quot;==&quot;x64&quot; <a href="http://www.ss64.com/nt/echo.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">echo</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">PROGRAMFILES</span><span style=" color:#33cc33;">%</span>&quot; <span style=" color:#33cc33;">|&gt;</span><a href="http://www.ss64.com/nt/nul.html"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">nul</span></a> find &quot;x86&quot; <span style=" color:#33cc33;">||</span> <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~5</span>=x64&quot;<br />  <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;_key=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;<br />  <a href="http://www.ss64.com/nt/for.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">For</span></a> /f &quot;tokens=2*&quot; <span style=" color:#33cc33;">%%</span><span style=" color:#448888;">a</span> <a href="http://www.ss64.com/nt/in.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">In</span></a> <span style=" color:#33cc33;">(</span>'Reg.exe query &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">_key</span><span style=" color:#33cc33;">%</span>&quot; /v &quot;CurrentBuildNumber&quot;<span style=" color:#33cc33;">^|</span>Find &quot;CurrentBuildNumber&quot;'<span style=" color:#33cc33;">)</span> <a href="http://www.ss64.com/nt/do.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">do</span></a> <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~3</span>=<span style=" color:#33cc33;">%%</span>~b&quot;<br />  <a href="http://www.ss64.com/nt/for.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">For</span></a> /f &quot;tokens=2*&quot; <span style=" color:#33cc33;">%%</span><span style=" color:#448888;">a</span> <a href="http://www.ss64.com/nt/in.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">In</span></a> <span style=" color:#33cc33;">(</span>'Reg.exe query &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">_key</span><span style=" color:#33cc33;">%</span>&quot; /v &quot;CurrentVersion&quot;<span style=" color:#33cc33;">^|</span>Find &quot;CurrentVersion&quot;'<span style=" color:#33cc33;">)</span> <a href="http://www.ss64.com/nt/do.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">do</span></a> <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;_ver=<span style=" color:#33cc33;">%%</span>~b&quot;<br />  <a href="http://www.ss64.com/nt/for.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">For</span></a> /f &quot;tokens=2*&quot; <span style=" color:#33cc33;">%%</span><span style=" color:#448888;">a</span> <a href="http://www.ss64.com/nt/in.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">In</span></a> <span style=" color:#33cc33;">(</span>'Reg.exe query &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">_key</span><span style=" color:#33cc33;">%</span>&quot; /v &quot;ProductName&quot;<span style=" color:#33cc33;">^|</span>Find &quot;ProductName&quot;'<span style=" color:#33cc33;">)</span> <a href="http://www.ss64.com/nt/do.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">do</span></a> <a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~1</span>=<span style=" color:#33cc33;">%%</span>~b&quot;<br />  <a href="http://www.ss64.com/nt/if.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">if</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">_ver:~0,1</span><span style=" color:#33cc33;">%</span>&quot;==&quot;6&quot; <span style=" color:#33cc33;">(</span><a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~4</span>=Vista&quot;<span style=" color:#33cc33;">)</span> <a href="http://www.ss64.com/nt/else.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">else</span></a> <span style=" color:#33cc33;">(</span><a href="http://www.ss64.com/nt/set.html"><span style=" font-weight:600; text-decoration: underline; color:#b1b100;">set</span></a> &quot;<span style=" color:#33cc33;">%</span><span style=" color:#448888;">~4</span>=NT&quot;<span style=" color:#33cc33;">)</span><br /><a href="http://www.ss64.com/nt/exit.html"><span style=" font-weight:600; text-decoration: underline; color:#00b100;">Exit</span></a> /B <a href="https://safezone.cc/attachments/sysversion-zip.13932/"><span style=" text-decoration: underline; color:#0000ff;">Посмотреть вложение SysVersion.zip</span></a><span style=" text-decoration: underline;"> </span></p></body></html>