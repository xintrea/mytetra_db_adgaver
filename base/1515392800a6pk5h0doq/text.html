<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Шаг 157 - Объект TableDef</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><a name="aswift_1_expand"></a>Описание<br />Объект <span style=" font-weight:600;">TableDef</span> (таблица) представляет сохраненное определение основной таблицы или присоединенной таблицы (только в рабочей области <span style=" font-weight:600;">Microsoft Jet</span>). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Замечания<br />Работа с определением таблицы проводится с помощью объекта <span style=" font-weight:600;">TableDef</span> и его методов и свойств. Например, данный объект позволяет: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Выполнить в базе данных просмотр структуры полей и индексов любой локальной, присоединенной или внешней таблицы. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Прочитать или задать значения свойств <span style=" font-weight:600;">Connect</span> (подключение) и <span style=" font-weight:600;">SourceTableName</span> (имя таблицы-источника) для присоединенных таблиц и вызвать метод <span style=" font-weight:600;">RefreshLink</span> для обновления связей с присоединенными таблицами. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Прочитать или задать значения свойств <span style=" font-weight:600;">ValidationRule</span> и <span style=" font-weight:600;">ValidationText</span>, определяющих условия на значение. </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Использовать метод <span style=" font-weight:600;">OpenRecordset</span> для создания на основе описания таблицы объекта <span style=" font-weight:600;">Recordset</span> типа таблицы, динамического набора записей, объекта динамического типа, статического набора записей или статического набора записей с последовательным доступом. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Для основных таблиц свойство <span style=" font-weight:600;">RecordCount</span> содержит число записей в указанной таблице базы данных. Для присоединенных таблиц свойство <span style=" font-weight:600;">RecordCount</span> всегда имеет значение -1.<br />Для создания нового объекта <span style=" font-weight:600;">TableDef</span> используется метод <span style=" font-weight:600;">CreateTableDef</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Добавление поля в таблицу: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Проверьте, что все объекты <span style=" font-weight:600;">Recordset</span>, базирующиеся на этой таблице, не открыты ни одним пользователем. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Вызовите метод <span style=" font-weight:600;">CreateField</span>, чтобы создать объектную переменную для объекта <span style=" font-weight:600;">Field</span> и задать ее свойства. </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Добавьте объект <span style=" font-weight:600;">Field</span> в семейство <span style=" font-weight:600;">Fields</span> объекта <span style=" font-weight:600;">TableDef</span> с помощью метода <span style=" font-weight:600;">Append</span>. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Допускается удаление объекта <span style=" font-weight:600;">Field</span> из семейства <span style=" font-weight:600;">TableDefs</span>, если этот объект не был использован при создании индексов, однако, при этом будут потеряны все содержащиеся в поле данные.<br />Создание в базе данных новой таблицы: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Вызовите метод <span style=" font-weight:600;">CreateTableDef</span> для создания объекта <span style=" font-weight:600;">TableDef</span>. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Задайте свойства объекта. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Для каждого поля в таблице создайте объектную переменную для объекта <span style=" font-weight:600;">Field</span> и задайте ее свойства с помощью метода <span style=" font-weight:600;">CreateField</span>. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Добавьте объект <span style=" font-weight:600;">Field</span> в семейство <span style=" font-weight:600;">Fields</span> объекта <span style=" font-weight:600;">TableDef</span> с помощью метода <span style=" font-weight:600;">Append</span>. </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Добавьте новый объект <span style=" font-weight:600;">TableDef</span> в семейство <span style=" font-weight:600;">TableDefs</span> объекта <span style=" font-weight:600;">Database</span> с помощью метода <span style=" font-weight:600;">Append</span>. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Присоединение таблицы к базе данных: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Вызовите метод <span style=" font-weight:600;">CreateTableDef</span> для создания объекта <span style=" font-weight:600;">TableDef</span>. </li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Задайте значения свойств <span style=" font-weight:600;">Connect</span> и <span style=" font-weight:600;">SourceTableName</span> (и, при необходимости, свойства <span style=" font-weight:600;">Attributes</span>). </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">Добавьте объект <span style=" font-weight:600;">TableDef</span> в семейство <span style=" font-weight:600;">TableDefs</span> объекта <span style=" font-weight:600;">Database</span> с помощью метода <span style=" font-weight:600;">Append</span>. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;">При ссылках на объект <span style=" font-weight:600;">TableDef</span> используют его порядковый номер в семействе или значение свойства <span style=" font-weight:600;">Name</span>(имя): </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TableDefs(0)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TableDefs(&quot;имя&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:10px; margin-right:10px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TableDefs![имя]</span></pre></body></html>