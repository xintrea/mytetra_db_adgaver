<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table id="tblPlaceArt" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td colspan="2" align="center"><span id="lbArtHeader" class="ArtHeader">FAQ: Макросы данных (Access 2010 и выше)</span></td>
									</tr>
									<tr>
										<td colspan="2" align="center">
											<p>
												<span id="lbArtObr" class="ArtObr">(обращений: <b>76</b> с 01.10.2018)</span><br>
												<br>
												<span id="lbIssueListH">Разделы:</span> 
												<span id="lbIssueList"><a href="http://am.rusimport.ru/MSAccess/content.aspx?id=22">Статьи</a>, <a href="http://am.rusimport.ru/MSAccess/content.aspx?id=23">ЧаВо (FAQ)</a></span></p>
											<p> </p>
										</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbBody"><p><span class="ArtPartHead">Описание: </span>Новинка Access 2010. Своеобразная замена триггеров, таких как в сервере Microsoft SQL Server. Для любопытных.<br></p><p><span class="ArtPartHead">Автор: </span><a href="mailto:banderlogi@bk.ru">Дмитрий Сонных  (AKA Joss)</a>   </p><p><span class="ArtPartHead">Добавил на сайт: </span> <a href="http://am.rusimport.ru/MSAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="1.png" width="16" border="0"></a><a href="mailto:banderlogi@bk.ru">Joss</a>  01.10.2018</p><table><tbody><tr><td><p><span class="ArtPartHead">Скачать: </span></p></td><td><a href="http://am.rusimport.ru/MSAccess/download.aspx?id=827">DataMacros.rar</a> (160133 байт) <font size="2">(скачиваний: <b>8</b> с 01.10.2018)</font></td></tr></tbody></table>В
 большинстве своем разработчики на Microsoft Access не любят писать 
макросы. Макросы, за исключением некоторых обстоятельств (например 
создание клавиш автоматизации и макроса AutoExec), рассматриваются в 
мире расширяемости приложений как граждане второго сорта. Макросы нужны 
пользователям для начального освоения Microsoft Access, чтобы 
впоследствии перейти к программированию на Microsoft Visual Basic for 
Applications (VBA). Хотя используемые при написании макросов 
макрокоманды (производные от объекта DoCmd) соответствуют методам VBA, 
конструктор макросов выглядит весьма бледно на фоне редактора Visual 
Basic. <br><br>С выпуском Access 2010 проектирование и использование 
макросов обогатилось рядом новых возможностей, которые понравятся как 
пользователям, так и разработчикам. Новые возможности включают 
улучшенный конструктор макросов, макросы данных, основанные на таблицах,
 и изменения в процессе создания выражений. Улучшенный конструктор 
макросов позволяет создавать более гибкие, понятные и удобные в 
сопровождении макросы. Макросы теперь можно привязывать к таблицам, 
после чего каждый объект, создаваемый на основе соответствующей таблицы,
 будет наследовать связанный макрос. Построитель выражений теперь 
поддерживает технологию IntelliSense, упрощающую создание выражений.<br><br><b>Макросы данных</b>
 — это новая функция Access 2010, которая позволяет добавлять логику в 
события, которые происходят в таблицах (например, добавление, обновление
 или удаление данных). Они похожи на триггеры в сервере Microsoft SQL 
Server. В данной статье описаны процедуры создания и отладки макросов 
данных.<br><br><i><b>Примечание</b></i>: <i>Логика макроса данных 
работает только с локальными таблицами, а не со связанными таблицами; 
это ограничение можно обойти при использовании интерфейсной базы данных 
Access и базы данных Access с таблицами путем добавления макросов данных
 в исходную таблицу.<br></i><br>Управление макросами данных 
осуществляется с помощью вкладки Таблица при просмотре таблицы в режиме 
таблицы, а также в режиме конструктора на вкладке Конструктор; в группе 
Макросы в области навигации они не отображаются. Макросы данных можно 
использовать, в частности, для проверки и обеспечения точности данных в 
таблице. Существует два основных типа макросов данных. Макросы первого 
типа (так называемые макросы данных, управляемые событиями) вызываются 
событиями в таблице. Макросы второго типа (именованные макросы данных) 
запускаются путем вызова по имени.<br><br><font color="brown"><b>Создание макроса данных, управляемого событием</b></font><br>События
 в таблице возникают при каждом добавлении, обновлении или удалении 
данных. Можно запрограммировать запуск макроса данных после любого из 
этих трех событий или непосредственно перед событием удаления или 
изменения. Чтобы привязать макрос данных к событию таблицы, используйте 
описанную ниже процедуру.<br>1. В области навигации дважды щелкните таблицу, в которую нужно добавить макрос данных.<br>2.
 На вкладке Таблица в группе До событий или После событий выберите 
событие, к которому нужно привязать макрос. Например, чтобы создать 
макрос данных, выполняемый после удаления записи из таблицы, выберите 
событие После удаления.<br><br><i><b>Примечание:</b> Если с событием уже связан макрос, значок этого события на ленте будет выделен.<br>Будет открыт конструктор макросов. Если для данного события уже был создан макрос, он будет отображен.</i><br><br>3. Введите макрокоманды, которые нужно включить в макрос.<br>4. Сохраните и закройте макрос.<br><br><font color="brown"><b>Создание именованного макроса данных</b></font><br>Именованный
 (или «автономный») макрос данных связывается с определенной таблицей, 
но не с событием. Именованный макрос можно вызывать из любого другого 
макроса данных или обычного макроса.<br>1. В области навигации дважды щелкните таблицу, в которую нужно добавить макрос данных.<br>2.
 На вкладке Таблица в группе Именованные макросы выберите пункт 
Именованный макрос, а затем — команду Создать именованный макрос.<br>Будет открыт конструктор макросов, где можно добавить макрокоманды.<br><br><font color="brown"><b>Сведения о параметрах</b></font><br>С
 помощью параметров в именованный макрос передаются значения, которые 
затем можно использовать в условных операторах или в расчетах. Кроме 
того, с помощью параметров из обычных макросов в макрос данных 
передаются ссылки на объекты.<br><br><i><b>Примечание:</b> Параметры недоступны в макросы данных событий диск.</i><br><br><font color="brown"><b>Добавление параметра в макрос данных</b></font><br>1. Вверху макроса нажмите кнопку Создать параметр.<br>2. В поле Имя введите уникальное имя для параметра. Это имя будет использоваться для указания параметра в выражениях.<br>3.
 При необходимости введите описание параметра в окне Описание. 
Рекомендуется сделать это, так как позже при использовании параметра 
текст описания будет отображаться в виде подсказки. Это поможет 
запомнить назначение параметра.<br>Для запуска именованного макроса из 
другого макроса необходимо использовать макрокоманду 
ЗапускМакросаДанных. Для каждого из созданных параметров в макрокоманде 
предусмотрено поле, в котором можно указать необходимое значение.<br><br><font color="brown"><b>Управление макросами данных</b></font><br>Макросы
 данных не отображаются в области навигации в группе Макросы. Для 
создания, редактирования, переименования и удаления макросов данных 
необходимо использовать команды ленты, когда таблица открыта в режиме 
таблицы или в режиме конструктора.<br><br><font color="brown"><b>Изменение макроса данных, управляемого событием</b></font><br>1. В области навигации дважды щелкните таблицу, содержащую макрос данных, который необходимо изменить.<br>2.
 На вкладке Таблица в группе До событий или После событий выберите 
событие, макрос которого необходимо изменить. Например, чтобы изменить 
макрос данных, выполняемый после удаления записи из таблицы, выберите 
событие После удаления.<br><i><b><br>Примечание:</b> Если с событием еще не связан макрос, его значок в меню не будет выделен.<br>Будет открыт конструктор макросов, где можно изменить макрос.<br></i><br><font color="brown"><b>Изменение именованного макроса данных</b></font><br>1. В области навигации дважды щелкните любую таблицу, чтобы открыть ее в режиме таблицы.<br>2.
 На вкладке Таблица в группе Именованные макросы выберите пункт 
Именованный макрос, а затем наведите указатель мыши на команду Изменить 
именованный макрос.<br>3. В подменю выберите макрос данных, который необходимо изменить.<br>Будет открыт конструктор макросов, где можно изменить макрос.<br><br><font color="brown"><b>Переименование именованного макроса данных</b></font><br>1. В области навигации дважды щелкните любую таблицу, чтобы открыть ее в режиме таблицы.<br>2.
 На вкладке Таблица в группе Именованные макросы выберите пункт 
Именованный макрос, а затем — команду Переименовать или удалить макрос.<br>3.
 В диалоговом окне Диспетчер макросов данных выберите команду 
Переименовать рядом с макросом данных, который нужно переименовать.<br>Будет выделено текущее имя макроса.<br>4. Введите новое имя или измените существующее и нажмите клавишу ВВОД.<br><br><font color="brown"><b>Удаление макроса данных</b></font><br>Для удаления любого именованного макроса данных или макроса данных, управляемого событием, выполните действия, описанные ниже.<br>1. В области навигации дважды щелкните любую таблицу, чтобы открыть ее в режиме таблицы.<br>2.
 На вкладке Таблица в группе Именованные макросы выберите пункт 
Именованный макрос, а затем — команду Переименовать или удалить макрос.<br>3.
 В диалоговом окне Диспетчер макросов данных выберите команду Удалить 
рядом с макросом данных, который требуется переименовать.<br><br><i><b>Примечание:</b> Также можно удалить макрос событиями, удалив все свои действия.<br></i><br><font color="brown"><b>Отладка макросов данных</b></font><br>Для
 макросов данных недоступны некоторые стандартные средства отладки, 
например команда "По шагам" и макрокоманда "ОкноСообщения". Однако при 
возникновении проблем с макросом данных для поиска ошибок в нем можно 
использовать таблицу журнала приложения в сочетании с макрокомандами 
"ПриОшибке", "ВыводОшибки" и "РегистрацияСобытия".<br><br><font color="brown"><b>Отображение таблицы журнала приложения</b></font><br>Таблица
 журнала приложения — это системная таблица (с названием 
USysApplicationLog), которая по умолчанию не отображается в области 
навигации. При возникновении ошибок в макросе данных просмотр сведений в
 этой таблице поможет понять суть проблемы.<br>Чтобы просмотреть таблицу журнала приложения, выполните перечисленные ниже действия.<br>1. В меню Файл откройте представление Microsoft Backstage.<br>2. На вкладке Сведения выберите команду Просмотр таблицы журнала приложения.<br><br><i><b>Примечание:</b>
 Если кнопка Просмотр таблицы журнала приложения не отображается, это 
означает, что таблицы журнала приложения еще не был создан для этой базы
 данных. После выполнил события кнопки будет отображаться на вкладке 
сведения.</i><br><br>Строки в таблице журнала приложения можно создавать
 с помощью команды "РегистрацияСобытия" или "ВыводОшибки", а управлять 
откликом Access на ошибки можно с помощью команды "ПриОшибке".<br><br><b>Источники</b><br><a href="https://msdn.microsoft.com/ru-ru/library/office/gg435977(v=office.14).aspx">Работа с макросами и выражениями в Access 2010</a><br><a href="https://msdn.microsoft.com/ru-ru/library/office/ff955606(v=office.14).aspx">Новые возможности Office 2010 для разработчиков</a><br><a href="https://support.office.com/ru-ru/article/%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BC%D0%B0%D0%BA%D1%80%D0%BE%D1%81%D0%B0-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-b1b94bca-4f17-47ad-a66d-f296ef834200">Создание макроса данных</a></span></td></tr></tbody></table>
</body>
</html></p></body></html>