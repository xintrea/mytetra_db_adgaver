<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="container"></a><a href="http://www.firststeps.ru/vba/vbahelp/daohelp/r.php?37"><span style=" text-decoration: underline; color:#0000ff;">f</span></a><span style=" text-decoration: underline; color:#0000ff;">irststeps.ru</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-title"></a>www.ПЕРВЫЕ ШАГИ.ru :: Шаг 37 - <span style=" font-size:x-large; font-weight:600;">Объект Workspace</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="reader-credits"></a>5-7 минут </p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="moz-reader-content"></a>Описание<br />Объект <span style=" font-weight:600;">Workspace</span> определяет именованный сеанс работы пользователя. Этот объект содержит открытые базы данных и предоставляет механизмы для одновременного выполнения транзакций, а также, в рабочей области <span style=" font-weight:600;">Microsoft Jet</span>, поддерживает работу защищенной рабочей группы. Этот объект также определяет, осуществляется ли доступ к внешним данным через ядро базы данных <span style=" font-weight:600;">Microsoft Jet</span> или через механизм <span style=" font-weight:600;">ODBCDirect</span>.<br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Замечания<br />Объект <span style=" font-weight:600;">Workspace</span> является непостоянным объектом, который определяет, осуществляется ли доступ к внешним данным через ядро базы данных <span style=" font-weight:600;">Microsoft Jet</span> или через механизм <span style=" font-weight:600;">ODBCDirect</span>. Объект <span style=" font-weight:600;">Workspace</span> используется для управления текущим сеансом работы или для запуска дополнительного сеанса. В каждом работы допускается открытие нескольких баз данных или подключений, а также выполнение транзакций. Например, данный объект позволяет: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Открыть именованный сеанс с использованием свойств <span style=" font-weight:600;">Name</span>, <span style=" font-weight:600;">UserName</span> и <span style=" font-weight:600;">Type</span>. Сеанс работы создает область определения, в которой возможно открытие нескольких баз данных и проведение одной серии вложенных транзакций.<br /></li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вызвать метод <span style=" font-weight:600;">Close</span> для закрытия сеанса. </li>
<li style="" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вызвать метод <span style=" font-weight:600;">OpenDatabase</span> для открытия одной или нескольких существующих баз данных в данном объекте <span style=" font-weight:600;">Workspace</span>. </li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использовать методы <span style=" font-weight:600;">BeginTrans</span>, <span style=" font-weight:600;">CommitTrans</span> и <span style=" font-weight:600;">Rollback</span> для управления вложенными транзакциями в пределах объекта <span style=" font-weight:600;">Workspace</span>, а также использовать несколько объектов <span style=" font-weight:600;">Workspace</span> для одновременного выполнения нескольких пересекающихся транзакций. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме того, при работе с базой данных <span style=" font-weight:600;">Microsoft Jet</span> имеется возможность установить систему защиты, основанную на использовании имен пользователей и паролей: </p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Семейства <span style=" font-weight:600;">Groups</span> и <span style=" font-weight:600;">Users</span> позволяют установить разрешения на доступ к объектам для пользователей и групп в объекте <span style=" font-weight:600;">Workspace</span>. </li>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Семейство <span style=" font-weight:600;">IsolateODBCTrans</span> позволяет изолировать множественные транзакции, в которых используется одна и та же база данных, подключенная к ядру <span style=" font-weight:600;">Microsoft Jet</span>. </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При первой ссылке или первом вызове объекта <span style=" font-weight:600;">Workspace</span> автоматически создается стандартная рабочая область <span style=" font-weight:600;">DBEngine.Workspaces(0)</span>, в которой свойства <span style=" font-weight:600;">Name</span> и <span style=" font-weight:600;">UserName</span> по умолчанию получают значения, соответственно, <span style=" font-weight:600;">&quot;#Default Workspace#&quot;</span> и <span style=" font-weight:600;">&quot;Admin&quot;</span>. Если система защиты баз данных активизирована, то значением свойства <span style=" font-weight:600;">UserName</span> становится имя подключенного пользователя. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для создания объекта <span style=" font-weight:600;">Workspace ODBCDirect</span>, позволяющего избежать загрузки ядра базы данных <span style=" font-weight:600;">Microsoft Jet</span> в память, следует задать константу <span style=" font-weight:600;">dbUseODBC</span> в свойстве <span style=" font-weight:600;">DefaultType</span> объекта <span style=" font-weight:600;">DBEngine</span> или в аргументе тип метода <span style=" font-weight:600;">CreateWorkspace</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В транзакциях участвуют все базы данных, входящие в состав данного объекта <span style=" font-weight:600;">Workspace</span>, даже если при этом открыто несколько объектов <span style=" font-weight:600;">Database</span>. Например, если пользователь вызывает метод <span style=" font-weight:600;">BeginTrans</span>, обновляет несколько записей в базе данных, а затем удаляет записи в другой базе данных, то при вызове метода <span style=" font-weight:600;">Rollback</span> свертываются (отменяются) и операции удаления, и операции обновления. Для того чтобы транзакции выполнялись независимо для разных объектов <span style=" font-weight:600;">Database</span>, следует создать или открыть независимые объекты <span style=" font-weight:600;">Workspace</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Объекты <span style=" font-weight:600;">Workspace</span> создаются с помощью метода <span style=" font-weight:600;">CreateWorkspace</span>. Если предполагается ссылаться на новый объект <span style=" font-weight:600;">Workspace</span> через семейство, то необходимо после создания объекта добавить этот объект в семейство <span style=" font-weight:600;">Workspaces</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Допускается также использование нового объекта <span style=" font-weight:600;">Workspace</span> без его добавления в семейство. Ссылки на объект при этом осуществляются через объектную переменную, которой присвоен объект. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При ссылках на объект <span style=" font-weight:600;">Workspace</span> используют его порядковый номер в семействе или значение свойства <span style=" font-weight:600;">Name</span> (имя): </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">DBEngine.Workspaces(0)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">DBEngine.Workspaces(&quot;имя&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">DBEngine.Workspaces![имя]</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример<br />Следующая программа использует метод <span style=" font-weight:600;">CreateWorkspace</span> для создания рабочей области <span style=" font-weight:600;">Microsoft Jet</span> и рабочей области <span style=" font-weight:600;">ODBCDirect</span>. Затем печатаются списки свойств двух рабочих областей.<br /></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Sub CreateWorkspaceX()</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkODBC As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkJet As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim wrkLoop As Workspace</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Dim prpLoop As Property</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Создает рабочую область ODBCDirect. До создания рабочей</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' области Microsoft Jet, ядро базы данных Microsoft Jet </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' не будет загружено в память.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Set wrkODBC = CreateWorkspace(&quot;ODBCWorkspace&quot;, &quot;admin&quot;, &quot;&quot;, dbUseODBC)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Workspaces.Append wrkODBC</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	DefaultType = dbUseJet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Создает безымянный объект Workspace с типом, </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' указанным в свойстве DefaultType объекта DBEngine </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">	' (dbUseJet).</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Set wrkJet = CreateWorkspace(&quot;&quot;, &quot;admin&quot;, &quot;&quot;)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	' Отображает семейство Workspaces.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Debug.Print &quot;Объекты Workspace в семействе Workspaces:&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	For Each wrkLoop In Workspaces</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;    &quot; &amp; wrkLoop.Name</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	Next wrkLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	With wrkODBC</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Отображает семейство Properties объекта ODBCDirect.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;Свойства &quot; &amp; .Name</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error Resume Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		For Each prpLoop In .Properties</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;    &quot; &amp; prpLoop.Name &amp; &quot; = &quot; &amp; prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Next prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error GoTo 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	End With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	With wrkJet</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		</span><span style=" font-family:'Courier New,courier'; font-style:italic;">' Отображает семейство Properties рабочей области </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-style:italic;">		' Microsoft Jet.</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Debug.Print &quot;Свойства безымянной рабочей области Microsoft Jet&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error Resume Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		For Each prpLoop In .Properties</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">			Debug.Print &quot;    &quot; &amp; prpLoop.Name &amp; &quot; = &quot; &amp; prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		Next prpLoop</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">		On Error GoTo 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	End With</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	wrkODBC.Close</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">	wrkJet.Close</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">End Sub</span> </pre>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>