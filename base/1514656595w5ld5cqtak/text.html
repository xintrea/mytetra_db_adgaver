<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">'Получить номер версии операционной системы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ver = <span style=" font-weight:600; color:#e56717;">CreateObject</span>(<span style=" color:#800000;">&quot;WScript.Shell&quot;</span>).RegRead(<span style=" color:#800000;">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion&quot;</span>)<br />msgbox ver</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">'Определить разрядность операционной системы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Function</span> GetOSBitness<span style=" color:#000000;">()</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">Resume</span> <span style=" font-weight:600; color:#0000ff;">Next</span><br />    GetOSBitness <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;x64&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> oShell<span style=" color:#000000;">.ExpandEnvironmentStrings(</span><span style=" color:#a52a2a;">&quot;%PROCESSOR_ARCHITECTURE%&quot;</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;x86&quot;</span> <span style=" font-weight:600; color:#0000ff;">and</span> oShell<span style=" color:#000000;">.ExpandEnvironmentStrings(</span><span style=" color:#a52a2a;">&quot;%PROCESSOR_ARCHITEW6432%&quot;</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;%PROCESSOR_ARCHITEW6432%&quot;</span> <span style=" font-weight:600; color:#0000ff;">then</span> GetOSBitness <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;x32&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">'Определить семейство ОС (NT или Vista).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'NT - XP, 2003; Vista - собственно Vista и выше.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Function</span> GetOSFamily<span style=" color:#000000;">()</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">Resume</span> <span style=" font-weight:600; color:#0000ff;">Next</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ver: ver <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;WScript.Shell&quot;</span><span style=" color:#000000;">).RegRead(</span><span style=" color:#a52a2a;">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion&quot;</span><span style=" color:#000000;">)</span><br />    GetOSFamily <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Vista&quot;</span>: <span style=" font-weight:600; color:#0000ff;">if</span> <a href="http://www.google.com/search?q=LEFT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">Left</span></a><span style=" color:#000000;">(</span>ver,<span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;5&quot;</span> <span style=" font-weight:600; color:#0000ff;">then</span> GetOSFamily <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;NT&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p></body></html>