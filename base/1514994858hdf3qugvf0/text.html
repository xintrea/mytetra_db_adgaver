<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как защитить проект VBA паролем<span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для тех кто уже освоился более-менее в программировании на Visual Basic for Application рано или поздно непременно встает вопрос: как защитить свой код от изменений или даже от просмотра? Как правило это делается в файлах, которые в дальнейшем &quot;гуляют по рукам&quot;. Т.е. автор создал и потом файл отсылается или другим пользователям, или клиентам, поставщикам и т.п. Чтобы у тех, кто будет в дальнейшем работать с этим файлом, не было возможности подсмотреть проект и тем более что-то в нем изменить. В каких-то случаях цель такой защиты это защита &quot;от дурака&quot;: чтобы по незнанию не изменили так, что файл просто откажется работать. Так же есть и другая причина - код является &quot;коммерческим&quot; и в нем присутствует некая защита от использования функционала по истечению ДЕМО-периода и надо закрыть код, чтобы эту защиту не &quot;сломали&quot;.<br />По сути защитить проект VBA стандартными средствами совсем не сложно. Переходим в проект VBA (</span><span style=" font-size:8.25pt; font-weight:600;">Alt</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">F11</span><span style=" font-size:8.25pt;">), далее:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Tools</span> -<span style=" font-weight:600;">VBAProject Properties</span> -вкладка <span style=" font-weight:600;">Protection</span>;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">устанавливаем галочку &quot;<span style=" font-weight:600;">Lock project for viewing</span>&quot;. Если галочка не установлена, то весь код можно будет просматривать и изменять, но изменить или просмотреть свойства самого проекта будет уже невозможно без снятия пароля;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">вписываем пароль в полях <span style=" font-weight:600;">Password</span> и <span style=" font-weight:600;">Confirm password</span>.</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Чтобы снять пароль с проекта VBA необходимо перейти в проект VBA (</span><span style=" font-size:8.25pt; font-weight:600;">Alt</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">F11</span><span style=" font-size:8.25pt;">) и:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Tools</span> -<span style=" font-weight:600;">VBAProject Properties</span> -вкладка <span style=" font-weight:600;">Protection</span>;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">снимаем галочку &quot;<span style=" font-weight:600;">Lock project for viewing</span>&quot;;</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">удаляем пароль в полях <span style=" font-weight:600;">Password</span> и <span style=" font-weight:600;">Confirm password</span></li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Хочу так же отметить, что пароль от проекта VBA ломается на ура(программ для этого достаточно в сети, перечислять не буду - кому надо сможет найти, а кто не сможет - значит не так уж и надо). Корпорацией Microsoft данный пароль точно не разрабатывался для защиты проекта от несанкционированного взлома и скорее был направлен больше на защиту от дурака. А может дело в том, что сам VBE практически не дорабатывался чуть ли не с самого его создания.<br />В любом случае, для тех, кто хочет чуть надежнее защитить свой проект VBA лучше использовать для этого сторонние утилиты. Например, очень хорошая программа для рядовых пользователей Protect VBA от eliansoft (</span><a href="http://ww1.eliansoft.com"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">http://www.eliansoft.com</span></a><span style=" font-size:8.25pt;">). Данная программа делает недоступным проект VBA. Никаких паролей вводить не надо - проект просто недоступен даже для ввода пароля. Последняя бесплатная версия была 1.6. Сейчас в сети её уже практически не найти в бесплатном варианте, т.к. разработчики убрали её с офф.сайта и постарались убрать отовсюду, видимо. Но т.к. у меня эта программа есть - выкладываю здесь, но </span><span style=" font-size:8.25pt; font-weight:600;">скачать можно только после регистрации на сайте</span><span style=" font-size:8.25pt;"> (чтобы тот же eliansoft не смог добраться).<br />Скачать Protect VBA</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image23281.png" /><span style=" font-size:8.25pt;">  </span><span style=" font-size:8.25pt; font-weight:600;">Protect_VBA.zip</span><span style=" font-size:8.25pt;"> (287,1 KiB, 104 скачиваний)<br /></span><span style=" font-size:8.25pt; font-style:italic;">You do not have permission to download this file.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как использовать:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">создаете файл с кодом, сохраняете, закрываете</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">запускаете <span style=" font-weight:600;">Protect VBA</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">выбираете файл, проект VBA которого надо защитить</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">нажимаете <span style=" font-weight:600;">Protect</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">будет предложено выбрать папку для сохранения защищенного файла. Здесь лучше заранее создать папку для сохранения файла, т.к. программа делает копию оригинального файла и не даст сохранить непосредственно тот же файл. Что к лучшему - ведь должен же у нас остаться файл с открытыми кодами :)</li></ul></body></html>