<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<p>Определить координаты значка программы в панели задач - Visual Basic .NET»</p><div class="bd-clipboard"><span class="btn-clipboard">Копировать</span></div><p style=" background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><ol class="linenums"><li class="L0"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Class</span><span class="pln"> </span><span class="typ">Form1</span></li><li class="L1"><span class="pln">    </span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Declare</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span><span class="typ">GetSystemMetrics</span><span class="pln"> </span><span class="typ">Lib</span><span class="pln"> </span><span class="str">"user32.dll"</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> smIndex </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span></li><li class="L2"><span class="pln">    </span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Declare</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span><span class="typ">FindWindow</span><span class="pln"> </span><span class="typ">Lib</span><span class="pln"> </span><span class="str">"user32"</span><span class="pln"> </span><span class="typ">Alias</span><span class="pln"> </span><span class="str">"FindWindowA"</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> lpClassName </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> lpWindowName </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span></li><li class="L3"><span class="pln">    </span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Declare</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span><span class="typ">GetWindowRect</span><span class="pln"> </span><span class="typ">Lib</span><span class="pln"> </span><span class="str">"user32"</span><span class="pln"> </span><span class="typ">Alias</span><span class="pln"> </span><span class="str">"GetWindowRect"</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> hwnd </span><span class="typ">As</span><span class="pln"> </span><span class="typ">IntPtr</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> lpRect </span><span class="typ">As</span><span class="pln"> RECT</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span></li><li class="L4"><span class="pln">    </span><span class="str">'Private Declare Function SystemParametersInfo Lib "user32" Alias "SystemParametersInfoA" (ByVal uAction As Integer, ByVal uParam As Integer, ByRef lpvParam As IntPtr, ByVal fuWinIni As Integer) As Integer</span></li><li class="L5"><span class="str">    Private Structure RECT</span></li><li class="L6"><span class="str">        Dim left As Integer</span></li><li class="L7"><span class="str">        Dim top As Integer</span></li><li class="L8"><span class="str">        Dim right As Integer</span></li><li class="L9"><span class="str">        Dim bottom As Integer</span></li><li class="L0"><span class="str">    End Structure</span></li><li class="L1"><span class="str">    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click</span></li><li class="L2"><span class="str">        Dim S As String = "", R As RECT</span></li><li class="L3"><span class="str">        GetWindowRect(FindWindow("Shell_TrayWnd", ""), R)</span></li><li class="L4"><span class="str">        S &amp;= "Разрешение: " &amp; My.Computer.Screen.Bounds.Size.Width &amp; " х " &amp; My.Computer.Screen.Bounds.Size.Height &amp; vbCrLf &amp; vbCrLf</span></li><li class="L5"><span class="str">        S &amp;= "Размеры ячейки сетки для свернутого окна: " &amp; vbCrLf &amp; _</span></li><li class="L6"><span class="str">             "Ширина: " &amp; GetSystemMetrics(47) &amp; vbCrLf &amp; "Высота: " &amp; GetSystemMetrics(48) &amp; vbCrLf &amp; vbCrLf</span></li><li class="L7"><span class="str">        S &amp;= "Координаты панели задач: " &amp; vbCrLf &amp; _</span></li><li class="L8"><span class="str">             "Левый край: " &amp; R.left &amp; vbCrLf &amp; "Правый край: " &amp; R.right &amp; vbCrLf &amp; _</span></li><li class="L9"><span class="str">             "Верх: " &amp; R.top &amp; vbCrLf &amp; "Низ: " &amp; R.bottom</span></li><li class="L0"><span class="str">        MsgBox(S)</span></li><li class="L1"><span class="str">    End Sub</span></li><li class="L2"><span class="str">End Class</span></li></ol></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
</body>
</html></p></body></html>