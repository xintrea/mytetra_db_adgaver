<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ошибка Too Many Line Continuations </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В VBA ошибка </span><span style=" font-size:8.25pt; font-weight:600;">Too Many Line Continuations</span><span style=" font-size:8.25pt;"> весьма редкая, что делает её несколько экзотичной. И тем не менее, столкнуться с ней можно даже ничего не программируя, а просто при </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-makros-i-gde-ego-iskat/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">записи макроса</span></a><span style=" font-size:8.25pt;">.<br /> <br />Почему появляется ошибка Too Many Line Continuations<br />Прежде чем разобрать причину ошибки и способы её устранения, сначала неплохо бы немного теории. Предположу, что раз зашли на эту страницу - значит уже познакомились с макросами хотя бы поверхностно (если нет - статья в помощь: </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-makros-i-gde-ego-iskat/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Что такое макрос и где его искать?</span></a><span style=" font-size:8.25pt;">). Т.к. макрос это код программы, значит этот код должен быть где-то записан. И записываются все коды в модулях (подробнее про модули: </span><a href="http://www.excel-vba.ru/chto-umeet-excel/chto-takoe-modul-kakie-byvayut-moduli/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Что такое модуль? Какие бывают модули?</span></a><span style=" font-size:8.25pt;">). Помимо ограничений, накладываемых синтаксисом языка программирования (в данном случае это VBA), есть и иные ограничения - будем называть их физическими. К физическим ограничениям относятся:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">максимальный размер одного модуля не должен превышать <span style=" font-weight:600;">64Кб</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">количество символов в имени переменной или константы не должно превышать <span style=" font-weight:600;">255 символов</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">длина строки не должна превышать <span style=" font-weight:600;">1023 символа</span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">количество физических строк внутри одной логической не должно превышать <span style=" font-weight:600;">25</span>. Иными словами - переносов на строки не может быть более 24</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Возможно я перечислил здесь не все физические ограничения - но для начальной теории и понимания разбираемой ошибки более чем достаточно.<br />Плюс пара терминов, которые нам пригодятся:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Физическая строка - строка кода(да и вообще любого текста) в привычном её понимании. Т.е. все то, что умещается в одну визуальную строку без всяких переносов.</li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Логическая строка - может состоять из нескольких физических, но составляет в дальнейшем одну непрерывную логическую конструкцию.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Начнем с очевидного: при написании кодов хоть и есть возможность записать в одну физическую строку кода до 1023 символов, на практике это ни фига не удобно. Т.к. прокручивание ползунка внизу окна редактора для просмотра всей строки никак не совпадает с представлениями о комфортной работе с текстом. Именно поэтому часто длинные логические строки кода разбиваются на несколько физических:<br /></span><img src="image25461.png" /><span style=" font-size:8.25pt;"><br />Для разбиения логической строки на несколько физических применяется специальный оператора разбиения, состоящий из последовательно записанных пробела и знака нижнего подчеркивания: &quot; _&quot;. Они должны быть записаны именно так и именно в этой последовательности. При этом следует учитывать, что не в любом месте строки допускается делать переносы. Например, в приведенном выше коде можно разбить строку по каждому аргументу: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d31649086095"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">election.PasteSpecial Paste:=xlPasteValues, _ Operation:=xlNone, _ SkipBlanks:=False, _ Transpose:=False </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d31649086095-1"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">election.PasteSpecial Paste:=xlPasteValues, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d31649086095-2"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Operation:=xlNone, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d31649086095-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       SkipBlanks:=False, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d31649086095-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Transpose:=False</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Однако в коде есть специальный оператор, указывающий на принадлежность значения конкретному аргументу: </span><span style=" font-size:8.25pt; font-weight:600;">:=</span><span style=" font-size:8.25pt;">. И этот оператор не допускается разбивать на строки. Такое разбиение вызовет ошибку синтаксиса и вся логическая строка будет подсвечена красным:<br />Selection.PasteSpecial Paste:=xlPasteValues, _<br />Operation: _<br />=xlNone, SkipBlanks:=False, Transpose:=False<br />Так же не допускается прямое разбиение текста в кавычках:<br /><br />Range(&quot;D1 _<br />&quot;).Select<br />'<br />Range(&quot;D _<br />1&quot;).Select<br />В данном случае необходимо либо закрыть кавычки и не разбивать текст(в первом случае):<br />Range(&quot;D1&quot; _<br />).Select<br />либо установить закрывающие кавычки для каждого фрагмента текста и объединить их специальным символом объединения текста(&amp; - амперсандом):<br />Range(&quot;D&quot; &amp; _<br />&quot;1&quot;).Select<br />И вот теперь, когда разобрались с тем как записываются строки и как их можно разбивать и какие ограничения накладываются на строки - совершенно не сложно догадаться, что означает ошибка Too Many Line Continuations. В дословном переводе - </span><span style=" font-size:8.25pt; font-weight:600;">Слишком много линий продолжения</span><span style=" font-size:8.25pt;">. В нашем случае - слишком много физических строк внутри одной логической или слишком много операторов разбиения(</span><span style=" font-size:8.25pt; font-weight:600;">&quot; _&quot;</span><span style=" font-size:8.25pt;">). Как мы помним - операторов не может быть более 24, а следовательно физических строк внутри одной логической не может быть более 25.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Как устранить ошибку?<br />Если ошибка возникла при написании кода самостоятельно - то здесь проблем возникнуть не должно. Можно ради работы кода пожертвовать удобством чтения в одной строке и просто убрать пару переносов на строки, объединив их в одну физическую:<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d3d961823684"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">Вместо такой строки s = &quot;1&quot; &amp; _ &quot;2&quot; &amp; _ &quot;3&quot; &amp; _ &quot;4&quot; &amp; _ &quot;5&quot; 'записать так s = &quot;1&quot; &amp; &quot;2&quot; &amp; _ &quot;3&quot; &amp; &quot;4&quot; &amp; _ &quot;5&quot; 'хотя, конечно в данном конкретном случае правильнее так: s = &quot;12&quot; &amp; _ &quot;34&quot; &amp; _ &quot;5&quot; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">14 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d3d961823684-1"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">Вместо такой строки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-2"></a><span style=" font-size:8.25pt;">s</span><span style=" font-size:8.25pt;"> = &quot;1&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-3"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;2&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-4"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;3&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-5"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;4&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-6"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;5&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-7"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">записать так</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-8"></a><span style=" font-size:8.25pt;">s</span><span style=" font-size:8.25pt;"> = &quot;1&quot; &amp; &quot;2&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-9"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;3&quot; &amp; &quot;4&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;5&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-11"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">хотя, конечно в данном конкретном случае правильнее так:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-12"></a><span style=" font-size:8.25pt;">s</span><span style=" font-size:8.25pt;"> = &quot;12&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-13"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;34&quot; &amp; _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d3d961823684-14"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       &quot;5&quot;</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Куда хуже, когда ошибка возникает при записи макроса. Да, такое тоже может быть. При этом совершенно очевидно, что больше смахивает на бред, но все же - макрорекордер очень любит разбивать логические строки на физические. При этом длина каждой физической строки едва дотягивает до 100 символов как правило. Конечно, в подавляющем большинстве случаев и этого за глаза хватает. Но бывают ведь и исключения. Например, если попытаться записать макрорекордером разбиение текста на столбцы(Данные -Текст по столбцам) примерно такого текста(просто 200 раз повторяется &quot;текст &quot;):<br />текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст текст <br />применив в качестве разделителя пробел, то практически 100% получим ошибку </span><span style=" font-size:8.25pt; font-weight:600;">Too Many Line Continuations</span><span style=" font-size:8.25pt;"> и при этом код будет записан не полностью и оборвется на какой-то строке. У меня, например, кода хватило лишь для назначения формата 134 слову:<br /></span><img src="image32601.png" /><span style=" font-size:8.25pt;"><br />Вот в этом случае не остается ничего другого, как разбивать текст в ячейках на блоки. По сути самым оптимальным на мой взгляд будет посмотреть на каком фрагменте завершилась запись(в моем случае на Array(133,1),Array(134,1),) и попробовать разделить текст на блоки так, чтобы каждый блок содержал менее 130 фрагментов текста итоговых данных. Т.к. макрос записывался с целью автоматизации, то в данном случае очевидно, что записывался он с целью избавиться от ручных преобразований. А значит разбивать такой текст на блоки представляется не целесообразным и надо придумывать как все же все это автоматизировать. И здесь лучше уж перебдить и тем же макросом сначала перенести данные на другой лист, там кодом раскидать данные на части в разные столбцы и после этого на другой лист по очереди выгружать каждый из разбитых столбцов. Понимаю, что из такого пояснения даже посвященный не сильно поймет задумку, что уж говорить о начинающих. Поэтому в статье привожу пример такого кода, который также приложен файлом к статье. Код берет выделенный текст, определяет количество фрагментов для разбиения и если их больше 100 - разбивает кодом без всяких ошибок.<br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d46477931338"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">--------------------------------------------------------------------------------------- ' Author : The_Prist(Щербаков Дмитрий) ' Профессиональная разработка приложений для MS Office любой сложности ' Проведение тренингов по MS Excel ' http://www.excel-vba.ru ' WebMoney - R298726502453; Яндекс.Деньги - 41001332272872 ' Purpose: http://www.excel-vba.ru/chto-umeet-excel/oshibka-too-many-line-continuations/ '--------------------------------------------------------------------------------------- Sub T2Cols() Const sDelim As String = &quot; &quot; 'разделитель текста Const lLIMIT_DelimCnt As Long = 100 'максимальное кол-во фрагментов в блоке Dim aFieldInfo 'массив назначения типов Dim ws As Worksheet, wsres As Worksheet Dim asSp, iTmpLen As Long Dim rTxt As Range, arr, aBreak, aTmp, aFTmp Dim lDelimCnt As Long, lMaxDelimCnt As Long, lMaxBreaks As Long Dim lr As Long, lt As Long, lc As Long, lcc As Long Dim s As String 'берем только первый столбец выделенного текста Set rTxt = Selection.Columns(1) 'отсекаем ячейки в конце столбца, не содержащие данных Set rTxt = Intersect(rTxt.Parent.UsedRange, rTxt) If rTxt Is Nothing Then Exit Sub Application.ScreenUpdating = 0 arr = rTxt.Value If Not IsArray(arr) Then ReDim arr(1 To 1, 1 To 1) arr(1, 1) = rTxt.Value End If 'определяем максимальное кол-во разделителей во всем диапазоне For lr = 1 To UBound(arr, 1) s = arr(lr, 1) If Len(s) Then lDelimCnt = Len(s) - Len(Replace(s, sDelim, &quot;&quot;)) If lMaxDelimCnt &lt; lDelimCnt Then lMaxDelimCnt = lDelimCnt End If End If Next 'максимальное кол-во блоков текста lMaxBreaks = Application.RoundUp(lMaxDelimCnt / lLIMIT_DelimCnt, 0) + 1 'создаем массив блоков текста для дальнейшего разбиения стандартными средствами If lMaxDelimCnt &gt; lLIMIT_DelimCnt Then ReDim aBreak(1 To UBound(arr, 1), 1 To lMaxBreaks) ReDim aFieldInfo(1 To lMaxBreaks) For lr = 1 To UBound(arr, 1) s = arr(lr, 1) If Len(s) Then asSp = Split(s, sDelim) lcc = 0 For lc = 0 To UBound(asSp) Step lLIMIT_DelimCnt lcc = lcc + 1 If (UBound(asSp) - (lc)) &lt; lLIMIT_DelimCnt Then iTmpLen = UBound(asSp) - lc Else iTmpLen = lLIMIT_DelimCnt - 1 End If ReDim aTmp(iTmpLen) ReDim aFTmp(iTmpLen) For lt = lc To lc + iTmpLen aTmp(lt - lc) = asSp(lt) aFTmp(lt - lc) = Array(1, 1) 'Array(1, 2) - если на выходе нужны текстовые значения Next aBreak(lr, lcc) = Join(aTmp, sDelim) &amp; sDelim aFieldInfo(lcc) = aFTmp Next End If Next Else MsgBox &quot;Данные можно разбить стандартными средствами: Данные -Текст по столбцам&quot;, vbInformation, &quot;www.excel-vba.ru&quot; Exit Sub End If 'Создаем лист Set ws = Worksheets.Add ws.Name = &quot;tmp&quot; 'записываем на временный лист все разбитые на блоки по 100 столбцы ws.Cells(1, 1).Resize(UBound(aBreak, 1), UBound(aBreak, 2)).Value = aBreak 'цикл по каждому столбцу, его копирование на результирующий лист и разбиение по разделителю(Пробел - Space:=True) 'если этот цикл не нужен и планируется вручную назначать столбцам параметры 'удалить все, что между чертой =========== '=============================================================================== Set wsres = Worksheets.Add wsres.Name = &quot;result&quot; For lc = 1 To UBound(aBreak, 2) lcc = wsres.Cells(1, wsres.Columns.Count).End(xlToLeft).Column + 1 aFTmp = aFieldInfo(lc) ws.Columns(lc).Copy wsres.Cells(1, lcc) 'Эта часть разбивает помещенный на листы текст wsres.Columns(lcc).TextToColumns Destination:=wsres.Cells(1, lcc), DataType:=xlDelimited, _ TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _ Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _ :=aFTmp, TrailingMinusNumbers:=True Next Application.DisplayAlerts = False ws.Delete Application.DisplayAlerts = True wsres.Select '=============================================================================== Application.ScreenUpdating = 1 MsgBox &quot;Данные обработаны&quot;, vbInformation, &quot;www.excel-vba.ru&quot; End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">14</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">15</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">16</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">17</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">18</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">19</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">20</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">21</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">22</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">23</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">24</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">25</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">26</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">27</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">28</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">29</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">30</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">31</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">32</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">33</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">34</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">35</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">36</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">37</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">38</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">39</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">40</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">41</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">42</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">43</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">44</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">45</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">46</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">47</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">48</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">49</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">50</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">51</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">52</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">53</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">54</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">55</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">56</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">57</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">58</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">59</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">60</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">61</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">62</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">63</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">64</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">65</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">66</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">67</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">68</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">69</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">70</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">71</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">72</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">73</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">74</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">75</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">76</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">77</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">78</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">79</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">80</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">81</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">82</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">83</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">84</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">85</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">86</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">87</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">88</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">89</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">90</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">91</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">92</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">93</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">94</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">95</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">96</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">97</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">98</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">99</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">100</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">101</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">102</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">103 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce78b11d46477931338-1"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-2"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Author : The_Prist(Щербаков Дмитрий)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-3"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">          Профессиональная разработка приложений для MS Office любой сложности</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-4"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">          Проведение тренингов по MS Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-5"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">          http://www.excel-vba.ru</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-6"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">          WebMoney - R298726502453; Яндекс.Деньги - 41001332272872</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-7"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Purpose: http://www.excel-vba.ru/chto-umeet-excel/oshibka-too-many-line-continuations/</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-8"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-9"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub T2Cols()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Const sDelim As String = &quot; &quot;        'разделитель текста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-11"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Const lLIMIT_DelimCnt As Long = 100 'максимальное кол-во фрагментов в блоке</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-12"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim aFieldInfo                      'массив назначения типов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-13"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim ws As Worksheet, wsres As Worksheet</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-14"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim asSp, iTmpLen As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-15"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim rTxt As Range, arr, aBreak, aTmp, aFTmp</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-16"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim lDelimCnt As Long, lMaxDelimCnt As Long, lMaxBreaks As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-17"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim lr As Long, lt As Long, lc As Long, lcc As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-18"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim s As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-19"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'берем только первый столбец выделенного текста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-20"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Set rTxt = Selection.Columns(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-21"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'отсекаем ячейки в конце столбца, не содержащие данных</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-22"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Set rTxt = Intersect(rTxt.Parent.UsedRange, rTxt)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-23"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   If rTxt Is Nothing Then Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-24"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-25"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Application.ScreenUpdating = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-26"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   arr = rTxt.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-27"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   If Not IsArray(arr) Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-28"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       ReDim arr(1 To 1, 1 To 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-29"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       arr(1, 1) = rTxt.Value</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-30"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-31"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'определяем максимальное кол-во разделителей во всем диапазоне</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-32"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For lr = 1 To UBound(arr, 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-33"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       s = arr(lr, 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-34"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       If Len(s) Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-35"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           lDelimCnt = Len(s) - Len(Replace(s, sDelim, &quot;&quot;))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-36"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           If lMaxDelimCnt &lt; lDelimCnt Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-37"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">               lMaxDelimCnt = lDelimCnt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-38"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-39"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-40"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-41"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'максимальное кол-во блоков текста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-42"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   lMaxBreaks = Application.RoundUp(lMaxDelimCnt / lLIMIT_DelimCnt, 0) + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-43"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'создаем массив блоков текста для дальнейшего разбиения стандартными средствами</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-44"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   If lMaxDelimCnt &gt; lLIMIT_DelimCnt Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-45"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       ReDim aBreak(1 To UBound(arr, 1), 1 To lMaxBreaks)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-46"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       ReDim aFieldInfo(1 To lMaxBreaks)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-47"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       For lr = 1 To UBound(arr, 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-48"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           s = arr(lr, 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-49"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           If Len(s) Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-50"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">               asSp = Split(s, sDelim)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-51"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">               lcc = 0</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-52"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">               For lc = 0 To UBound(asSp) Step lLIMIT_DelimCnt</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-53"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   lcc = lcc + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-54"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   If (UBound(asSp) - (lc)) &lt; lLIMIT_DelimCnt Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-55"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                       iTmpLen = UBound(asSp) - lc</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-56"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-57"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                       iTmpLen = lLIMIT_DelimCnt - 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-58"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-59"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   ReDim aTmp(iTmpLen)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-60"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   ReDim aFTmp(iTmpLen)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-61"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   For lt = lc To lc + iTmpLen</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-62"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                       aTmp(lt - lc) = asSp(lt)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-63"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                       aFTmp(lt - lc) = Array(1, 1) 'Array(1, 2) - если на выходе нужны текстовые значения</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-64"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-65"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   aBreak(lr, lcc) = Join(aTmp, sDelim) &amp; sDelim</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-66"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">                   aFieldInfo(lcc) = aFTmp</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-67"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">               Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-68"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-69"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-70"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-71"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       MsgBox &quot;Данные можно разбить стандартными средствами: Данные -Текст по столбцам&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-72"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Exit Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-73"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   End If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-74"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-75"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'Создаем лист</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-76"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Set ws = Worksheets.Add</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-77"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   ws.Name = &quot;tmp&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-78"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'записываем на временный лист все разбитые на блоки по 100 столбцы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-79"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   ws.Cells(1, 1).Resize(UBound(aBreak, 1), UBound(aBreak, 2)).Value = aBreak</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-80"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'цикл по каждому столбцу, его копирование на результирующий лист и разбиение по разделителю(Пробел - Space:=True)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-81"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'если этот цикл не нужен и планируется вручную назначать столбцам параметры</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-82"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'удалить все, что между чертой ===========</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-83"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   '===============================================================================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-84"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Set wsres = Worksheets.Add</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-85"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   wsres.Name = &quot;result&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-86"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For lc = 1 To UBound(aBreak, 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-87"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       lcc = wsres.Cells(1, wsres.Columns.Count).End(xlToLeft).Column + 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-88"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       aFTmp = aFieldInfo(lc)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-89"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       ws.Columns(lc).Copy wsres.Cells(1, lcc)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-90"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       'Эта часть разбивает помещенный на листы текст</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-91"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       wsres.Columns(lcc).TextToColumns Destination:=wsres.Cells(1, lcc), DataType:=xlDelimited, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-92"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-93"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-94"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           :=aFTmp, TrailingMinusNumbers:=True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-95"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-96"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Application.DisplayAlerts = False</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-97"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   ws.Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-98"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Application.DisplayAlerts = True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-99"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   wsres.Select</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-100"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   '===============================================================================</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-101"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Application.ScreenUpdating = 1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-102"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   MsgBox &quot;Данные обработаны&quot;, vbInformation, &quot;www.excel-vba.ru&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce78b11d46477931338-103"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br />Скачать файл с кодом и примером данных: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image31623.png" /><span style=" font-size:8.25pt;">  </span><a href="http://www.excel-vba.ru/download/191/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Tips_VBE_T2Cols.xls</span></a><span style=" font-size:8.25pt;"> (62,5 KiB, 197 скачиваний)</span></p></body></html>