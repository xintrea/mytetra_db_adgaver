<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div class="post hentry uncustomized-post-template" itemscope="itemscope" itemtype="http://schema.org/BlogPosting"><h3 class="post-title entry-title" itemprop="name">
Урок 12. Динамическое меню.
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-7665896170368884669" itemprop="articleBody">
<div dir="ltr" style="text-align: left;" trbidi="on">
Теперь мы уже почти профессионалы в программировании интерфейсов, и 
можем замахнуться аж на динамическое меню. Динамическое меню, как и 
динамические атрибуты, получает своё содержимое из функции обратного 
вызова. То есть, наша функция должна возвращать некий XML-код, который и
 будет формировать дочерние элементы меню.<br>
<br>
Давайте сделаем ещё одну надстройку-<span style="font-family: &quot;Times New Roman&quot;,serif; font-size: 12.0pt; mso-ansi-language: RU; mso-bidi-language: AR-SA; mso-fareast-font-family: Calibri; mso-fareast-language: EN-US; mso-fareast-theme-font: minor-latin;"></span>демонстратор динамического меню. Создадим третий документ и откроем его в Ribbon XML Editor. Построим в нём следующий код:<br>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;?xml version="1.0" standalone="yes"?&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" xmlns:МПИ="http://customui.blogspot.ru"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    &lt;ribbon startFromScratch="false"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        &lt;tabs&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            &lt;tab idQ="МПИ:Вкладка1" label="Полезные надстройки" insertBeforeMso="TabHome" keytip="Н"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                &lt;group id="ДинамическиеМеню" label="Демонстрация меню"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;menu id="Меню1" label="Обычное меню" itemSize="large"&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            id="Кнопка1" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            label="Пункт 1" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            description="Пункт обычного меню" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            onAction="Сообщение1" /&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            id="Кнопка2" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            label="Пункт 2" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            description="Пункт обычного меню" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            onAction="Сообщение2" /&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        &lt;button </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            id="Кнопка3" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            label="Пункт 3" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            description="Пункт обычного меню" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                            onAction="Сообщение3" /&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;/menu&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                    &lt;dynamicMenu </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        id="ДинамическоеМеню1" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        label="Динкамическое меню" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                        getContent="ВернутьДинамическоеМеню" /&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">                &lt;/group&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">            &lt;/tab&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        &lt;/tabs&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    &lt;/ribbon&gt;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">&lt;/customUI&gt;</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
В этом коде мы создаём на нашей вкладке третью группу, в которой 
размещаем обычное меню с тремя пунктами и динамическое меню, пункты 
которого мы будем получать с помощью функции «ВернутьДинамическоеМеню». 
Сгенерируем шаблоны функций обратного вызова и сохраним их в файле, как 
мы уже делали это ранее.<br>
<br>
Кстати, если вы хотите изменить имя, предлагаемое по умолчанию, под 
которым сохраняются шаблоны функций, зайдите в настройки Ribbon XML 
Editor, и обратите внимание на окно в правом верхнем углу. Этот блок 
текста каждый раз помещается в начало сохраняемого файла, и вы можете 
отредактировать его по вашему усмотрению. В первой строке написано:<br>
<br>
Attribute VB_Name = "RibbonCallbacks"<br>
<br>
Мы можем поменять эту строку на:<br>
<br>
Attribute VB_Name = "CustomUICallbacks" <br>
<br>
и при сохранении файла нам будет предлагаться уже новое имя.<br>
<br>
Итак, запустим документ на выполнение. Обычное меню уже работает, а для 
формирования пунктов динамического меню нам нужно открыть редактор 
Бейсика (<b>Alt+F11</b>) и загрузить в него модуль с сохранёнными нами ранее шаблонами функций обратного вызова. <br>
<br>
Заполним шаблоны функций следующим кодом:<br>
<br>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Кнопка1 (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub Сообщение1(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    MsgBox "Был выбран пункт 1"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Кнопка2 (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub Сообщение2(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    MsgBox "Был выбран пункт 2"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Кнопка3 (компонент: button, атрибут: onAction), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub Сообщение3(control As IRibbonControl)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    MsgBox "Был выбран пункт 3"</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'ДинамическоеМеню1 (компонент: dynamicMenu, атрибут: getContent), 2007</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sub ВернутьДинамическоеМеню(control As IRibbonControl, ByRef content)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim sXML As String</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sXML = "&lt;menu itemSize=""large"" xmlns=""http://schemas.microsoft.com/office/2006/01/customui""&gt;" &amp; vbCrLf</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sXML = sXML &amp; "&lt;button id=""Кнопка1"" label=""Пункт 1"" description=""Пункт динамического меню"" onAction = ""Сообщение1""/&gt;" &amp; vbCrLf</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sXML = sXML &amp; "&lt;button id=""Кнопка2"" label=""Пункт 2"" description=""Пункт динамического меню"" onAction = ""Сообщение2""/&gt;" &amp; vbCrLf</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    sXML = sXML &amp; "&lt;button id=""Кнопка3"" label=""Пункт 3"" description=""Пункт динамического меню"" onAction = ""Сообщение3""/&gt;" &amp; vbCrLf</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    content = sXML &amp; "&lt;/menu&gt;" </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Sub</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<br>
В первых трёх функциях мы просто выводим сообщение о нажатии того или 
иного пункта, а в последней — формируем пункты, которые должны будут 
вернуться из функции во время выполнения документа. Тут требуются 
небольшое пояснение.<br>
<br>
Формируемые пункты возвращаются в динамическое меню не списком, а 
XML-структурой, объединенённой корневым элементом menu, имеющим тип 
CT_MenuRoot. Элемента этого типа нет в иерархии статических элементов. 
Но в справке Ribbon XML Editor среди приложений мы можем найти ссылку 
«Динамическое меню», нажав на которую, мы откроем страничку с описанием 
этого типа и дополнительными сведениями по нему.<br>
<br>
Согласно справке, корневой элемент menu должен содержать атрибут xmlns с
 объявлением пространства имён, используемое нами в основном коде. 
Замечу, что несмотря на то, что ранее мы использовали этот атрибут 
только в корневом элементе customUI, теоретически его можно использовать
 в любом элементе интерфейса, хотя его и не будет среди предлагаемых 
вариантов в автодополнении ввиду редкости такого использования. В данном
 случае мы применяем его в элементе menu.<br>
<br>
В функции «ВернутьДинамическоеМеню» мы присваиваем строковой переменной 
sXML сначала открывающий тег menu с атрибутом размера пунктов меню и 
объявлением пространства имён, затем добавляем туда коды перевода строки
 (vbCrLf), затем теги элементов пунктов меню с желаемыми атрибутами и, в
 завершение, присваиваем возвращаемой переменной содержимое полученной 
строки с добавлением закрывающего тега menu. Внутри строковых переменных
 знак кавычек делается сдвоенным, чтобы не было конфликта с синтаксисом 
Бейсика, использующего тот же знак для обозначения строк.<br>
<br>
Сохраняем код, закрываем редактор Бейсика, потом документ, а затем снова
 открываем его и нажмём на кнопку открытия динамического меню. В момент 
нажатия срабатывает код формирования меню, и оно отображается. Сравните 
его работу с работой рядом расположенного статического меню.</div>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">

<a href="https://www.blogger.com/profile/15132597310126998409" rel="author" title="author profile">
<span itemprop="name">dolbodub</span>
</a>
</span>
</span>
<span class="post-timestamp">
на

<a class="timestamp-link" href="http://fluentui.blogspot.ru/2015/03/12.html?m=1" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2015-03-13T21:27:00+03:00">21:27</abbr></a>
</span>
<span class="post-comment-link">
</span>
</div>
<div class="post-footer-line post-footer-line-2">
<div class="mobile-link-button goog-inline-block" id="mobile-share-button">
<a href="javascript:void(0);">Поделиться</a>
</div>
<div class="goog-inline-block dummy-container"><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none;  font-size: 1px; vertical-align: baseline; display: inline-block; width: 32px; height: 20px;" id="___plusone_0"><iframe ng-non-bindable="" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 32px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" id="I0_1526205966226" name="I0_1526205966226" src="1.png" data-gapiattached="true" title="G+" frameborder="0" width="100%"></iframe></div></div>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>9 комментариев:</h4>
<div class="comments-content">


<div id="comment-holder">

<div id="bc_0_10C" kind="c"><div id="bc_0_10CT"><div id="bc_0_9T" class="comment-thread" kind="r" t="0" u="0"><ol id="bc_0_9TB"><li id="bc_0_1B" class="comment" kind="b"><div class="avatar-image-container"><img src="2.png"></div><div id="c8464660478969771399" class="comment-block"><div id="bc_0_1M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17375557256051165722">Александр Витер</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1428181056033&amp;m=1#c8464660478969771399">04 апреля, 2015 23:57</a></span></div><p id="bc_0_1MC" class="comment-content">Динамическое
 меню получает свой контент не при открытии документа, а при своём 
открытии. Именно с этим связана небольшая задержка при открытии 
насыщенных стандартных меню, вроде галереи стилей, номеров страниц и 
т.п.<br>Очень хороший материал у вас. По-доброму завидую :)</p><span id="bc_0_1MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Ответить</a></span></div><div id="bc_0_1BR" class="comment-replies"><span id="bc_0_1b+seedCGN6D" kind="d"><div id="bc_0_0T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_0TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_0TA" class="thread-arrow"></span><span id="bc_0_0TN" class="thread-count"><a href="javascript:;" target="_self">Ответы</a><div id="bc_0_0TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_0TC" class="thread-chrome thread-expanded"><div><li id="bc_0_0B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c4454894124711291128" class="comment-block"><div id="bc_0_0M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1428181693844&amp;m=1#c4454894124711291128">05 апреля, 2015 00:08</a></span></div><p id="bc_0_0MC" class="comment-content">Спасибо, поправил.<br>Благодарю за положительный отзыв! )</p><span id="bc_0_0MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_0BR" class="comment-replies"></div><div id="bc_0_0B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_0I" class="continue" kind="ci"><a href="javascript:;" target="_self">Ответить</a></div></ol><div id="bc_0_0T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_1B_box" class="comment-replybox-single"></div></li><li id="bc_0_4B" class="comment" kind="b"><div class="avatar-image-container"><img src="4.png"></div><div id="c1547298112486308308" class="comment-block"><div id="bc_0_4M" class="comment-header" kind="m"><cite class="user">Анонимный</cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1428511137599&amp;m=1#c1547298112486308308">08 апреля, 2015 19:38</a></span></div><p id="bc_0_4MC" class="comment-content">Спасибо
 за полезную информацию. Есть у меня такой вопрос. Судя по всему функция
 ВернутьДинамическоеМеню вызывается только один раз при первом 
обращении. Как сделать, чтобы она вызывалась каждый раз, когда открывают
 динамическое меню? Это было бы полезно, когда меню зависит от 
каких-нибудь условий.</p><span id="bc_0_4MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Ответить</a></span></div><div id="bc_0_4BR" class="comment-replies"><span id="bc_0_4b+seedCGN8D" kind="d"><div id="bc_0_2T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_2TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_2TA" class="thread-arrow"></span><span id="bc_0_2TN" class="thread-count"><a href="javascript:;" target="_self">Ответы</a><div id="bc_0_2TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_2TC" class="thread-chrome thread-expanded"><div><li id="bc_0_2B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c6850160896277299745" class="comment-block"><div id="bc_0_2M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1428515565635&amp;m=1#c6850160896277299745">08 апреля, 2015 20:52</a></span></div><p id="bc_0_2MC" class="comment-content">Я
 не знаю... спросите у Александра Витера (предыдущий комментарий), он, 
судя по всему, знает про динамическое меню побольше моего.</p><span id="bc_0_2MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_2BR" class="comment-replies"></div><div id="bc_0_2B_box" class="comment-replybox-single"></div></li><li id="bc_0_3B" class="comment" kind="b"><div class="avatar-image-container"><img src="2.png"></div><div id="c2181559467335243025" class="comment-block"><div id="bc_0_3M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/17375557256051165722">Александр Витер</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1428597158399&amp;m=1#c2181559467335243025">09 апреля, 2015 19:32</a></span></div><p id="bc_0_3MC" class="comment-content">Нужно обновлять ленту методом Invalidate или отдельный элемент управления Invalidate(control.Id)<br>Почитайте мой блог, посвящённый настройке интерфейса. Я как раз подвёл итог работе с динамическими меню: <a href="http://customribbonui.blogspot.com/2015/04/dynamicmenu.html" rel="nofollow">Элемент управления dynamicMenu</a></p><span id="bc_0_3MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_3BR" class="comment-replies"></div><div id="bc_0_3B_box" class="comment-replybox-single"></div></li></div><div id="bc_0_2I" class="continue" kind="ci"><a href="javascript:;" target="_self">Ответить</a></div></ol><div id="bc_0_2T_box" class="comment-replybox-thread"></div></div></span></div><div id="bc_0_4B_box" class="comment-replybox-single"></div></li><li id="bc_0_8B" class="comment" kind="b"><div class="avatar-image-container"><img src="7.png"></div><div id="c5090814522695743825" class="comment-block"><div id="bc_0_8M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13357728351184639665">Алексей Мальков</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1446025557803&amp;m=1#c5090814522695743825">28 октября, 2015 12:45</a></span></div><p id="bc_0_8MC" class="comment-content">Скажите, а как называется и настраивается элемент интерфейса в виде текстового поля с кнопками увеличить и уменьшить значение?<br>Как стандартный элемент для задания интервала между строками, например</p><span id="bc_0_8MN" class="comment-actions secondary-text" kind="m"><a kind="i" href="javascript:;" target="_self" o="r">Ответить</a></span></div><div id="bc_0_8BR" class="comment-replies"><span id="bc_0_8b+seedCGN_D" kind="d"><div id="bc_0_5T" class="comment-thread inline-thread" kind="t" t="0" u="0"><span id="bc_0_5TT" class="thread-toggle thread-expanded" kind="g"><span id="bc_0_5TA" class="thread-arrow"></span><span id="bc_0_5TN" class="thread-count"><a href="javascript:;" target="_self">Ответы</a><div id="bc_0_5TD" class="thread-dropContainer thread-expanded"><span class="thread-drop"></span></div></span></span><ol id="bc_0_5TC" class="thread-chrome thread-expanded"><div><li id="bc_0_5B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c6897901683459993233" class="comment-block"><div id="bc_0_5M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1446032274354&amp;m=1#c6897901683459993233">28 октября, 2015 14:37</a></span></div><p id="bc_0_5MC" class="comment-content">Это
 который на вкладке "разметка страницы? Интересный вопрос... В 
распоряжении пользователя такого элемента нет. Как и, по моему, 
некоторых других составных элементов, имеющихся на стандартных лентах. 
Сами применяют, а нам не дают (((</p><span id="bc_0_5MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_5BR" class="comment-replies"></div><div id="bc_0_5B_box" class="comment-replybox-single"></div></li><li id="bc_0_6B" class="comment" kind="b"><div class="avatar-image-container"><img src="7.png"></div><div id="c8250989998020205534" class="comment-block"><div id="bc_0_6M" class="comment-header" kind="m"><cite class="user"><a rel="nofollow" href="https://www.blogger.com/profile/13357728351184639665">Алексей Мальков</a></cite><span class="icon user"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1446040472553&amp;m=1#c8250989998020205534">28 октября, 2015 16:54</a></span></div><p id="bc_0_6MC" class="comment-content">Нагуглил такое решение проблемы:<br>https://social.msdn.microsoft.com/Forums/office/en-US/04dd2304-26e8-44dc-b2c8-2fc541738e86/how-to-add-a-spinner-spin-box-control-to-a-custom-ribbon-in-excel-2007?forum=exceldev</p><span id="bc_0_6MN" class="comment-actions secondary-text" kind="m"></span></div><div id="bc_0_6BR" class="comment-replies"></div><div id="bc_0_6B_box" class="comment-replybox-single"></div></li><li id="bc_0_7B" class="comment" kind="b"><div class="avatar-image-container"><img src="3.png"></div><div id="c4080415802811226779" class="comment-block"><div id="bc_0_7M" class="comment-header" kind="m"><cite class="user blog-author"><a rel="nofollow" href="https://www.blogger.com/profile/15132597310126998409">dolbodub</a></cite><span class="icon user blog-author"></span><span class="datetime secondary-text"><a rel="nofollow" href="http://fluentui.blogspot.com/2015/03/12.html?showComment=1446043057577&amp;m=1#c4080415802811226779">28 октября, 2015 17:37</a></span></div><p id="bc_0_7MC" class="comment-content">Ну да, только если так - текстовое поле и справа две стандартные кнопки, расположенные горизонтально.<br>Спасибо за ссылку!</p></div></li></div></ol></div></span></div></li></ol></div></div></div></div></div></div>
</body>
</html></p></body></html>