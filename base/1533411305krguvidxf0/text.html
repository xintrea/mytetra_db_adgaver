<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:24pt; font-weight:600;">Как уменьшить размер файла и ускорить его</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">83387 11.11.2012 </span><a href="https://www.planetaexcel.ru/techniques/12/114/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Скачать пример</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Скачать видео</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если в один прекрасный момент вы осознаете, что ваш основной рабочий файл в Excel разбух до нескольких десятков мегабайт и во время открытия файла можно смело успеть налить себе кофе, то попробуйте пробежаться по описанным ниже пунктам - возможно один или несколько из них укоротят вашего &quot;переростка&quot; до вменяемых размеров и разгонят его &quot;тормоза&quot; :) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 1. Используемый диапазон листа больше, чем нужно</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если ваша таблица занимает 5 на 5 ячеек, то это отнюдь не означает, что Excel запоминает при сохранении этого файла только 25 ячеек с данными. Если вы в прошлом использовали какие-либо ячейки на этом листе, то они автоматически включаются в используемый диапазон (так называемый Used Range), который и запоминается при сохранении книги. Проблема в том, что при очистке используемых ячеек Excel далеко не всегда автоматически исключает их из используемого диапазона, т.е. начинает запоминать в файле больше данных, чем реально имеется.  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Проверить это просто – нажмите на клавиатуре сочетание клавиш </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Ctrl+End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и посмотрите куда переместится активная ячейка. Если она прыгнет на фактическую последнюю ячейку с данными на листе – отлично. А если вдруг ускачет сильно правее и/или ниже &quot;в пустоту&quot; – дело плохо: все эти ненужные пустые ячейки Excel тоже запоминает внутри файла. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Лечится это, тем не менее, достаточно легко: </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Выделите первую пустую строку под вашей таблицей</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Нажмите сочетание клавиш </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Ctrl+Shift+стрелка вниз</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> – выделятся все пустые строки до конца листа.</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Удалите их, нажав на клавиатуре </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Ctrl+знак минус</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> или выбрав на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Главная – Удалить – Удалить строки с листа </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Home – Delete – Delete rows)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Повторите то же самое со столбцами.</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Повторите все вышеописанные процедуры на каждом листе, где при нажатии на </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Ctrl+End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> активная ячейка перемещается не на фактическую последнюю ячейку с данными а &quot;в пустоту&quot; ниже и/или правее.</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Сохраните файл (обязательно, иначе изменения не вступят в силу!)</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если в вашей книге очень много таких листов, то проще, наверное, использовать короткий макрос. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 2. Используется старый формат XLS вместо новых XLSX, XLSM и XLSB</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Много лет и версий подряд еще с начала девяностых в Excel был один формат файлов - XLS. Это, конечно, убирало проблемы совместимости, но, сам по себе, этот формат давно устарел и имел много неприятных недостатков (большой размер, непрозрачность внутренней структуры данных, легкую повреждаемость и т.д.) </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Начиная с верии Excel 2007 Microsoft ввела новые форматы сохранения файлов, использование которых заметно облегчает жизнь и - ваши файлы:  </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">XLSX - по сути является зазипованным XML. Размер файлов в таком формате по сравнению с Excel 2003 меньше, в среднем, в 5-7 раз. </span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">XLSM - то же самое, но с поддержкой макросов. </span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">XLSB - двоичный формат, т.е. по сути - что-то вроде скомпилированного XML. Обычно в 1.5-2 раза меньше, чем XLSX. Единственный минус: нет совместимости с другими приложениями кроме Excel, но зато  размер - минимален.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Вывод: всегда и везде, где можно, переходите от старого формата XLS (возможно, доставшегося вам &quot;по наследству&quot; от предыдущих сотрудников) к новым форматам.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 3. Избыточное форматирование</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Сложное многоцветное форматирование, само-собой, негативно отражается на размере вашего файла. А условное форматирование еще и ощутимо замедляет его работу, т.к. заставляет Excel пересчитывать условия и обновлять форматирование при каждом чихе. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Оставьте только самое необходимое, не изощряйтесь. Особенно в тех таблицах, которые кроме вас никто не видит. Для удаления только форматов (без потери содержимого!) выделите ячейки и выберите в выпадающем списке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Очистить - Очистить форматы </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Clear - Clear Formats)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Главная </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Home)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image26229.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Особенно &quot;загружают&quot; файл отформатированные </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline;">целиком</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> строки и столбцы. Т.к. размер листа в последних версиях Excel сильно увеличен (&gt;1 млн. строк и &gt;16 тыс. столбцов), то для запоминания и обрабоки подобного форматирования нужно много ресурсов. В Excel 2013-2016, кстати, появилась надстройка </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Inquire</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, которая содержит инструмент для быстрого избавления от подобных излишеств - кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Удалить избыточное форматирование </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Clean Excess Cell Formatting)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image15176.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Она мгновенно удаляет все излишнее форматирование до конца листа, оставляя его только внутри ваших таблиц и никак не повреждая ваши данные. Причем может это сделать даже для всех листов книги сразу.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если вы не видите у себя в интерфейсе вкладку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Inquire</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, то ее необходимо подключить на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Разработчик - Надстройки COM </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Developer - COM Addins)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 4. Ненужные макросы и формы на VBA</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Большие макросы на Visual Basic и особенно пользовательские формы с внедренной графикой могут весьма заметно утяжелять вашу книгу. Для удаления: </span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">нажмите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Alt+F11</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, чтобы войти в редактор Visual Basic </span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">найдите окно Project Explorer’а (если его не видно, то выберите в меню </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">View - Project Explorer</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">) </span></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">удалите все модули и все формы (правой кнопкой мыши - </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Remove </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">- дальше в окне с вопросом о экспорте перед удалением - </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">No</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">):</span> </li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image537.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Также код может содержаться в модулях листов - проверьте их тоже. Также можно просто сохранить файл в формате XLSX без поддержки макросов - все макросы и формы умрут автоматически. Также можно воспользоваться инструментом </span><a href="http://www.planetaexcel.ru/plex_features.php#45"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">Очистить книгу от макросов</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> из </span><a href="http://www.planetaexcel.ru/plex.php"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">надстройки PLEX</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 5. Именованные диапазоны</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если в вашем файле используются именованные диапазоны (особенно с формулами, динамические или получаемые при фильтрации), то имеет смысл от них отказаться в пользу экономии размера книги. Посмотреть список имеющихся диапазонов можно нажав </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Ctrl+F3</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> или открыв окно </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Диспетчера имен </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Name Manager) </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Формулы </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Formulas)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17529.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Также вычищайте именованные диапазоны с ошибками (их можно быстро отобрать с помощью кнопки </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Фильтр </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">в правом верхнем углу этого окна) - они вам точно не пригодятся.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 6. Фотографии высокого разрешения и невидимые автофигуры</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если речь идет о фотографиях, добавленных в книгу (особенно когда их много, например в каталоге продукции), то они, само-собой, увеличивают размер файла. Советую сжимать их, уменьшая разрешение до 96-150 точек на дюйм. На экране по качеству это совершенно не чувствуется, а размер файла уменьшает в разы. Для сжатия воспользуйтесь кнопкой </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Сжать рисунки </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(Compress pictures)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Формат </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Format)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17618.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Кроме видимых картинок на листе могут содержаться и невидимые изображения (рисунки, фотографии, автофигуры). Чтобы увидеть их, выделите любую картинку и на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Формат </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Format)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> нажмите кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Область выделения </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Selection Pane)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Для удаления вообще всех графических объектов на текущем листе можно использовать простой макрос: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://www.planetaexcel.ru/techniques/12/114/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">?</span></a><span style=" font-size:8.25pt;"> </span></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">1</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">2</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">3</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">4</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">5</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">6</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">7</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">8</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">9</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">10</span><span style=" font-size:8.25pt;"> </span></p></td>
<td style=" padding-left:0; padding-right:0; padding-top:0; padding-bottom:0;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">Sub</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">Delete_All_Pictures()</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">'макрос для удаления всех картинок на текущем листе</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Dim</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">objPic As</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">Shape</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    For</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">Each</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">objPic In</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">ActiveSheet.Shapes</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">        objPic.Delete</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">    Next</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">objPic</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt;">End</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span><span style=" font-family:'Courier New'; font-size:10pt;">Sub</span><span style=" font-size:8.25pt;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 7. Исходные данные сводных таблиц</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">По-умолчанию Excel сохраняет данные для расчета сводной таблицы (pivot cache) внутри файла. Можно отказаться от этой возможности, заметно сократив размер файла, но увеличив время на обновление сводной при следующем открытии книги. Щелкните правой кнопкой мыши по сводной таблице и выберите команду </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Свойства таблицы </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(Pivot Table Properties)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> - вкладка </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Данные </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(Data)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> - снять флажок </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Сохранять исходные данные вместе с файлом </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(Save source data with file):</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2443.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если у вас несколько сводных таблиц на основе одного диапазона данных, то сократить размер файла здорово помогает метод, когда все сводные таблицы после первой строятся на основе уже созданного для первой таблицы кэша. В Excel 2000-2003 это делается выбором переключателя на первом шаге </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Мастера сводных таблиц</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> при построении: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image21892.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В Excel 2007-2016 кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Мастера сводных таблиц</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> нужно добавлять на панель вручную - на ленте такой команды нет. Для этого щелкните по панели быстрого доступа правой кнопкой мыши и выберите </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Настройка панели быстрого доступа </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(Customize Quick Access Toolbar)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и затем найдите в полном списке команд кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Мастер сводных таблиц </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#999999;">(PivotTable and PivotChart Wizard)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image8415.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 8. Журнал изменений (логи) в файле с общим доступом</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Если в вашем файле включен общий доступ на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рецензирование - Доступ к книге </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Review - Share Workbook)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, то внутри вашего файла Excel на специальном скрытом листе начинает сохраняться вся история изменений документа: кто, когда и как менял ячейки всех листов. По умолчанию, такой журнал сохраняет данные изменений за последние 30 дней, т.е. при активной работе с файлом, может запросто занимать несколько мегабайт. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Мораль: не используйте общий доступ без необходимости или сократите количество дней хранения данных журнала, используя вторую вкладку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Подробнее </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Advanced)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> в окне </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Доступ к книге</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. Там можно найти параметр </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Хранить журнал изменений в течение N дней </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Keep change history for N days)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> или совсем отключить его: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image30703.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 9. Много мусорных стилей</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Про эту пакость я уже подробно писал ранее в статье о том, </span><a href="http://www.planetaexcel.ru/techniques/9/211/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">как победить ошибку &quot;Слишком много форматов ячеек&quot;</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. Суть, если кратко, в том, что если вы разворачиваете на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Главная</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> список </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Стили ячеек </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Home - Cell Styles)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и видите там очень много непонятных и ненужных стилей, то это плохо - и для размера вашего файла Excel и для его быстродействия. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image12938.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Удалить ненужные стили можно с помощью макроса или </span><a href="http://www.planetaexcel.ru/plex/features/20/278/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">готовой команды</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> из надстройки PLEX.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:13.5pt; font-weight:600;">Проблема 10. Много примечаний</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Примечания к ячейкам, конечно, не самый вредный момент из всех перечисленных. Но некоторые файлы могут содержать большое количество текста или даже </span><a href="http://www.planetaexcel.ru/techniques/9/128/"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">картинок в примечаниях к ячейкам</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. Если  примечания не содержат полезной для вас информации, то их можно легко удалить с помощью команды на вкладке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Главная </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">- </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Очистить - Очистить примечания </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; color:#cccccc;">(Home - Clear - Clear Comments)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p></body></html>