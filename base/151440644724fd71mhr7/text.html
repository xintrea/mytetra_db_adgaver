<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Элемент управления RefEdit</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image25030.png" /><span style=" font-size:8.25pt;"> сентября 14, 2015 </span><img src="image28437.png" /><span style=" font-size:8.25pt;"> admin </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Кроме стандартных элементов управления в вашем распоряжении — сотни и тысячи элементов управления, встроенных в Windows, в другие продукты или поставляемые отдельно (в том числе третьими фирмами).</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Для того, чтобы можно было разместить их на форме, щелкните правой кнопкой мыши по пустому пространству в </span><span style=" font-size:8.25pt; font-weight:600;">ToolBox</span><span style=" font-size:8.25pt;"> и выберите пункт </span><span style=" font-size:8.25pt; font-weight:600;">Additional Controls</span><span style=" font-size:8.25pt;"> — а далее выберите нужный элемент.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image16005.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Рассмотрим элемент RefEdit</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image27787.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Теперь он расположен на панели </span><span style=" font-size:8.25pt; font-weight:600;">ToolBox</span><span style=" font-size:8.25pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image17960.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Правда, при применении нестандартных элементов управления необходимо помнить, что при переносе программы (файла Office) на другой компьютер вам потребуется обеспечить на нем наличие необходимых библиотек.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Элемент управления RefEdit предоставляет пользователю возможность выделять на рабочем листе диапазон ячеек. После выделения диапазона элемент управления возвращает его адрес в виде строки, содержащей название листа и абсолютные ссылки на ячейки. Элемент управления RefEdit может быть использован только в формах, которые отображаются модально (т.е. свойству ShowModal которых присвоено значение True).<br />Элемент управления RefEdit в окне формы имеет вид кнопки, рядом с которой расположено текстовое поле. Когда пользователь щелкает на этой кнопке, экранная форма сворачивается, после чего можно использовать курсор для выделения диапазона ячеек на рабочем листе. Когда требуемый диапазон будет выделен, необходимо щелкнуть на кнопке, которая отображается в окне свернутой формы. Форма разворачивается до исходного размера, а в текстовом поле отображаются название рабочего листа и адрес ячеек выделенного диапазона. В кодах программы эта строка может быть считана как значение свойства Value элемента управления RefEdit. Если пользователь не выделил диапазон, свойство Value возвращает пустую строку.<br />Применение элемента управления RefEdit рассмотрено на примере демонстрационной программы, показанной ниже. Эта программа отображает форму с элементом управления RefEdit и кнопкой Format. Пользователь должен щелкнуть на элементе управления RefEdit и выделить диапазон ячеек рабочего листа. Если вы возвратитесь к форме и щелкните на кнопке Format, то шрифт выделенных ячеек станет красным, появится окно сообщения с указанием адреса выделенного диапазона, и затем форма закроется.<br />Чтобы создать экранную форму, выполните перечисленные ниже действия.<br />1. Выберите команду Insert&gt;User Form, чтобы добавить в проект новую экранную форму.<br />2. Присвойте свойству Name экранной формы значение RefEditDemo, а свойству Caption — значение RefEdit Demo.<br />3. Добавьте к форме элемент управления RefEdit и оставьте заданные по умолчанию значения свойств этого элемента без изменений.<br />4. Добавьте к форме кнопку CommandButton. Присвойте ее свойству Caption значение Format.<br />5. Дважды щелкните на кнопке, чтобы открыть ее процедуру обработки события Click в окне редактирования кодов.<br />6. В теле процедуры наберите код из листинга</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Листинг Код формы RefEditDemo<br />Private Sub CommandButtonl_Click()</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Dim s As String<br />Dim r As Range</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">s = RefEdit1.Value<br />‘ Проверка, выделен ли диапазон ячеек<br />If s = “” Then<br />MsgBox “Пожалуйста, выделите диапазон”<br />Else<br />‘Форматирование ячеек выделенного диапазона<br />Set r = Range(s)<br />r.Font.Color = RGB(255, 0, 0)<br />‘Отображение адреса диапазона<br />MsgBox “Был отформатирован диапазон ” &amp; s<br />‘Закрытие формы<br />Me.Hide<br />End If</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">End Sub<br />Код экранной формы и является кодом всей программы, поэтому нам остается лишь создать процедуру для отображения этой формы. Создайте новую процедуру в модуле VBA (назовите ее, например, TestRefEditDemo) и наберите в ее теле следующий код:<br />Dim frm As New RefEditDemo<br />frm.Show<br />Чтобы протестировать программу, выполните перечисленные ниже действия.<br />1. Запустите процедуру для отображения формы.<br />2. Щелкните на элементе управления RefEdit, чтобы свернуть форму и выделить диапазон ячеек рабочего листа. Желательно выделить диапазон, в ячейках которого содержатся какие-нибудь данные, чтобы можно было увидеть изменения в их форматировании.<br />3. Щелкните на кнопке, отображаемой в окне свернутой формы, чтобы вернуться к обычному размеру экранной формы.<br />4. Щелкните на кнопке Format, чтобы отформатировать выделенный диапазон и отобразить окно сообщения.<br />5. Закройте окно сообщения, экранная форма будет закрыта автоматически.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Пример можно скачать </span><a href="http://msexcel-vba.ru/wp-content/uploads/2015/09/пример-RefEd.xlsm"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">здесь</span></a><span style=" font-size:8.25pt;"> </span></p></body></html>