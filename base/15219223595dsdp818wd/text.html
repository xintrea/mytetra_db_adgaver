<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div data-grid="col-12 pad-12x"><div data-grid="container" class="main-content-container" ng-class="{'full-width': $root.isIframe}"><header data-grid="col-12"><h1 class="c-heading-3 article-heading ng-binding ng-scope" ng-if="article.details.heading" ng-bind-html="article.details.heading">Как установить фокус на элемент управления, когда форма загружается в Visual Basic .NET или Visual Basic 2005</h1>
            
            
            
            <hr class="c-divider f-pad-bottom-6x f-pad-top-3x">
        </header>
    </div>
</div>

<div data-grid="col-12 pad-12x">
    <div data-grid="container" class="main-content-container" ng-class="{'full-width': $root.isIframe}">

    

    

    <div machine-translation="" ng-if="article.details.isMachineTranslated === true || article.details.isMachineTranslated === 'true'" class="ng-scope ng-isolate-scope"><div class="alert-band ng-scope" ng-if="machineTranslated &amp;&amp; machineTranslated.disclaimer">
    <div class="alert alert-info" role="alert">
        <p class="ng-binding">ВНИМАНИЕ! Перевод данной статьи был 
выполнен не человеком, а с помощью программы машинного перевода, 
разработанной корпорацией Майкрософт. Корпорация Майкрософт предлагает 
вам статьи, переведенные как людьми, так и средствами машинного 
перевода, чтобы у вас была возможность ознакомиться со статьями базы 
знаний KB на родном языке. Однако машинный перевод не всегда идеален. Он
 может содержать смысловые, синтаксические и грамматические ошибки, 
подобно тому как иностранец делает ошибки, пытаясь говорить на вашем 
языке. Корпорация Майкрософт не несет ответственности за неточности, 
ошибки и возможный ущерб, причиненный в результате неправильного 
перевода или его использования. Корпорация Майкрософт также часто 
обновляет средства машинного перевода.</p>
        <p ng-bind-html="machineTranslated.viewOriginal | compassFormat: {article: originalLink}" class="ng-binding">Смотреть исходную статью на английском языке: <a href="https://support.microsoft.com/en-us/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic" target="_self">822493</a></p>
    </div>
    <div debug="machineTranslated" class="ng-isolate-scope"></div>
</div></div>
    

    
    

    

    <div class="content-article">
        <div content-section-list="article.details.body" itemprop="articleBody" class="ng-isolate-scope"><div ng-repeat="section in contentSectionList track by $index" ng-if="!isString &amp;&amp; hasContent()" class="ng-scope">
    <div content-section="section" class="ng-isolate-scope"><section class="section ng-scope" data-grid="col-12" ng-if="typeof(contentSection) !== 'string'" applies-to-saps="" ng-attr-id="{{contentSection.meta.id}}" ng-class="{'internal-content': isInternalSection() }">
    
    
    <div class="section-body ng-scope" ng-if="contentSection.content &amp;&amp; contentSection.content.length &gt; 0">
        <div ng-attr-data-grid="{{getStyleClass()}}" ng-repeat="content in contentSection.content track by $index" class="ng-scope" data-grid="col-12">
            <div compile="content" data-grid="col-12" class="ng-isolate-scope"><div class="kb-notice-section section ng-scope"><h3 class="sbody-h3"><a class="bookmark" id="1"></a>В ЭТОЙ ЗАДАЧЕ</h3><ul class="sbody-free_list"><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#2" target="" bookmark-id="2" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">СВОДКА</a><ul class="sbody-free_list"><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#3" target="" bookmark-id="3" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">Требования</a></li><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#4" target="" bookmark-id="4" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">Свойство Form.ActiveControl</a></li><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#5" target="" bookmark-id="5" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">Метод Control.Select</a></li><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#6" target="" bookmark-id="6" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">Метод Control.Focus</a></li><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#7" target="" bookmark-id="7" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">Разрешение вопросов</a></li></ul></li><li><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#8" target="" bookmark-id="8" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">ССЫЛКИ</a></li></ul><a class="bookmark" id="2"></a></div></div>
            
        </div>
    </div>
</section></div>
</div><div ng-repeat="section in contentSectionList track by $index" ng-if="!isString &amp;&amp; hasContent()" class="ng-scope">
    <div content-section="section" class="ng-isolate-scope"><section class="section ng-scope" data-grid="col-12" ng-if="typeof(contentSection) !== 'string'" applies-to-saps="" ng-attr-id="{{contentSection.meta.id}}" ng-class="{'internal-content': isInternalSection() }">
    
    <div ng-if="contentSection.title" class="ng-scope">
        <h2 class="c-heading-4 f-lean bold ng-binding" ng-bind-html="contentSection.title">Обзор</h2>
        <hr class="c-divider f-pad-bottom-6x f-pad-top-3x">
        
    </div>
    <div class="section-body ng-scope" ng-if="contentSection.content &amp;&amp; contentSection.content.length &gt; 0">
        <div ng-attr-data-grid="{{getStyleClass()}}" ng-repeat="content in contentSection.content track by $index" class="ng-scope" data-grid="col-12">
            <div compile="content" data-grid="col-12" class="ng-isolate-scope"><div class="kb-summary-section section ng-scope">В
 данной статье описывается, как установить фокус на элемент управления 
при загрузке формы. В данной статье описывается, как с помощью свойства <span class="text-base">Form.ActiveControl</span> , как использовать метод <span class="text-base">Control.Focus</span> и как использовать метод <span class="text-base">Control.Select</span> для установки фокуса на элемент управления.<br><br>Свойство <span class="text-base">Form.ActiveControl</span> возвращает активный элемент управления или задает активный элемент управления в форме. При<br> Свойство <span class="text-base">ActiveControl</span> формы устанавливается на элемент управления в форме, фокус перемещается на элемент управления.<br><br>Метод <span class="text-base">Control.Select</span> активизирует заданный элемент управления и устанавливает фокус на элемент управления.<br><br>Метод <span class="text-base">Control.Focus</span> устанавливает фокус ввода на элементе управления. Элемент управления может получать фокус ввода, используя метод <span class="text-base">Control.Focus</span> , если выполняются следующие условия:<br> <ul class="sbody-free_list"><li><strong class="uiterm">ControlStyles.Selectable</strong> бит стиля элемента управления имеет значение<br><strong class="uiterm">Значение true</strong>.</li><li>Элемент
 управления, который будет получать фокус находится в другом элементе 
управления и все родительские элементы управления видимы и включены.</li></ul><span class="text-base">Примечание.</span> Чтобы установить фокус на элемент управления в событии <span class="text-base">Load</span> формы, когда свойство <span class="text-base">Visible</span> формы имеет значение <span class="text-base">True</span>, можно использовать метод <span class="text-base">Control.Focus</span> .<br><br><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><h3 class="sbody-h3"><a class="bookmark" id="3"></a>Требования</h3>Предполагается, что вы знакомы со следующими разделами:<br> <ul class="sbody-free_list"><li>Синтаксис Visual Basic корпорации Майкрософт</li><li>Среда Microsoft Visual Studio .NET и Microsoft Visual Studio 2005</li><li>Элементы управления Microsoft Visual Basic</li></ul><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><h3 class="sbody-h3"><a class="bookmark" id="4"></a>Свойство Form.ActiveControl</h3>Следующий пример описывает, как использовать свойство <span class="text-base">ActiveControl</span> Form2 для установки фокуса на элемент управления <span class="text-base">TextBox</span> без текста:<br> <ol class="sbody-num_list"><li>Запустите Visual Studio 2005 или Visual Studio .NET.</li><li>В меню <strong class="uiterm">файл</strong> укажите на пункт<br><strong class="uiterm">Создать</strong>и выберите команду <strong class="uiterm">проект</strong>.</li><li>В области <strong class="uiterm">Типы проектов</strong>выберите<br><strong class="uiterm">Проекты Visual Basic</strong>.<br><br><span class="text-base">Примечание.</span> В Visual Studio 2005 выберите в списке <strong class="uiterm">Типы проектов</strong> <strong class="uiterm">Visual Basic</strong> .</li><li>В области <strong class="uiterm">Шаблоны</strong>выберите пункт<br><strong class="uiterm">Приложение Windows</strong>, а затем нажмите кнопку <strong class="uiterm">ОК</strong>.<br><br>По умолчанию будет создана форма Form1.</li><li>Добавить<br>Элемент управления <strong class="uiterm">Button</strong> в форму Form1.</li><li>Щелкните правой кнопкой мыши <strong class="uiterm">кнопки Button1</strong>и нажмите кнопку<br><strong class="uiterm">Свойства</strong>.</li><li>В диалоговом окне <strong class="uiterm">Свойства</strong> установите<br>Свойство <strong class="uiterm">Text</strong> , чтобы <strong class="uiterm">Установить фокус</strong>.</li><li>В меню <strong class="uiterm">проект</strong> выберите <strong class="uiterm">Добавить форму Windows</strong>и нажмите кнопку <strong class="uiterm">Открыть</strong>.<br><br>По умолчанию создается Form2.</li><li>Добавьте три<br>Элементы управления <strong class="uiterm">TextBox</strong> Form2.</li><li>Добавьте три элемента управления <strong class="uiterm">Label</strong> на Form2.<br><br><span class="text-base">Примечание.</span> Поместите каждый элемент управления <strong class="uiterm">Label</strong> слева от элемента управления <strong class="uiterm">TextBox</strong> .</li><li>В диалоговом окне <strong class="uiterm">Свойства</strong> установите<br>Свойство <strong class="uiterm">Text</strong> <strong class="uiterm">метки Label1</strong><br><strong class="uiterm">Имя</strong>, значение свойства <strong class="uiterm">Text</strong> <strong class="uiterm">Label2</strong> <strong class="uiterm">компании</strong>, а затем установите свойство <strong class="uiterm">Text</strong> <strong class="uiterm">Label3</strong> на <strong class="uiterm">ContactNo</strong>.</li><li>В диалоговом окне <strong class="uiterm">Свойства</strong> удалите текст в свойстве <strong class="uiterm">Text</strong> <strong class="uiterm">TextBox1</strong>, удалите текст в свойстве <strong class="uiterm">Text</strong> <strong class="uiterm">TextBox2</strong>и удалите текст в свойстве <strong class="uiterm">Text</strong> <strong class="uiterm">TextBox3</strong>.</li><li>Добавьте следующий код для<br>Создание обработчика событий <strong class="uiterm">Button1_Click</strong> в Form1:<div class="sbody-code"><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Create an instance of Form2.Dim MyForm As New Form2()<br>'Set the Text in the TextBoxes on Form2.<br>MyForm.TextBox1.Text = "John"<br>MyForm.TextBox3.Text = "123456"<br>'Display the form.<br>MyForm.Show()<br></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div></li><li>Добавьте следующий код в обработчик событий <strong class="uiterm">Form2_Load</strong>:<div class="sbody-code"><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Dim i As IntegerFor i = 0 To 5<br>  If  Me.Controls(i).Name Is "TextBox1" Or Me.Controls(i).Name Is "TextBox2" Or Me.Controls(i).Name Is "TextBox3" Then<br>      'Find the TextBox for which Text is not set.<br>      If Me.Controls(i).Text = "" Then<br>           'Set the focus on the control without any text.<br>           Me.ActiveControl = Me.Controls(i)<br>      End If<br>  End If<br>Next<br></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div></li><li>В меню <strong class="uiterm">Построение</strong> выберите команду <strong class="uiterm">Построить решение</strong>.</li><li>В меню <strong class="uiterm">Отладка</strong> выберите команду<br>Для <strong class="uiterm">запуска</strong>.</li><li>Нажмите кнопку <strong class="uiterm">Установка фокуса</strong>.<br><br>Фокус установлен на элементе управления <strong class="uiterm">TextBox</strong> без текста.</li></ol><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><h3 class="sbody-h3"><a class="bookmark" id="5"></a>Метод Control.Select</h3>В следующем примере описывается, как найти элемент управления <span class="text-base">TextBox</span> без текста на Form2 и описывается использование метода <span class="text-base">Control.Select</span> для установки фокуса для элемента управления:<br> <ol class="sbody-num_list"><li>Замените следующий оператор в обработчике событий <strong class="uiterm">Form2_Load</strong><div class="sbody-code"><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Me.ActiveControl = Me.Controls(i)</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div>с помощью следующей инструкции:<div class="sbody-code"><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Me.Controls(i).Select()</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div></li><li>В меню <strong class="uiterm">Построение</strong> выберите команду <strong class="uiterm">Построить решение</strong>.</li><li>В меню <strong class="uiterm">Отладка</strong> выберите команду<br>Для <strong class="uiterm">запуска</strong>.</li><li>Нажмите кнопку <strong class="uiterm">Установка фокуса</strong>.<br><br>Фокус установлен на элементе управления <strong class="uiterm">TextBox</strong> без текста.</li></ol><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><h3 class="sbody-h3"><a class="bookmark" id="6"></a>Метод Control.Focus</h3>Приведенный ниже описывается, как найти элемент управления <strong class="uiterm">TextBox</strong> без текста на Form2, описывается значение <span class="text-base">True</span>свойства <span class="text-base">Visible</span> Form2 и затем описывается, как установить фокус на элемент управления с помощью метода <span class="text-base">фокус</span> элемента управления:<br> <ol class="sbody-num_list"><li>Замените существующий код в обработчике событий <strong class="uiterm">Form2_Load</strong>следующий код:<div class="sbody-code"><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">'Set the visible property of the form to true, 'and then set the focus to the control.<br>Me.Visible = True<br>Dim i As Integer<br>For i = 0 To 5<br>  If Me.Controls(i).Name Is "TextBox1" Or Me.Controls(i).Name Is "TextBox2" Or Me.Controls(i).Name Is "TextBox3" Then<br>      'Find the TextBox for which Text is not set.<br>      If Me.Controls(i).Text = "" Then<br>          'Set the focus on the control with no text.<br>          Me.Controls(i).Focus()<br>      End If<br>  End If<br>Next<br></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div></li><li>В меню <strong class="uiterm">Построение</strong> выберите команду <strong class="uiterm">Построить решение</strong>.</li><li>В меню <strong class="uiterm">Отладка</strong> выберите команду<br>Для <strong class="uiterm">запуска</strong>.</li><li>Нажмите кнопку <strong class="uiterm">Установка фокуса</strong>.<br><br>Фокус установлен на элементе управления <span class="text-base">TextBox</span> без текста.</li></ol><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><h3 class="sbody-h3"><a class="bookmark" id="7"></a>Разрешение вопросов</h3><ul class="sbody-free_list"><li>Удалите любой текст в элементах управления <strong class="uiterm">TextBox</strong> на Form2 перед запуском приложения.</li><li>Чтобы установить фокус на элемент управления формы свойства <strong class="uiterm">Visible</strong> присвоено <strong class="uiterm">значение True,</strong>можно использовать метод <strong class="uiterm">Control.Focus</strong> в событии <strong class="uiterm">Load</strong> формы.</li></ul><a managed-link="" href="https://support.microsoft.com/ru-ru/help/822493/how-to-set-the-focus-on-a-control-when-the-form-loads-in-visual-basic#1" target="" bookmark-id="1" tabindex="0" class="managed-link content-anchor-link" data-bi-name="content-anchor-link" aria-live="rude">к началу статьи</a><a class="bookmark" id="8"></a></div></div>
            
        </div>
    </div>
</section></div>
</div><div ng-repeat="section in contentSectionList track by $index" ng-if="!isString &amp;&amp; hasContent()" class="ng-scope">
    <div content-section="section" class="ng-isolate-scope"><section class="section ng-scope" data-grid="col-12" ng-if="typeof(contentSection) !== 'string'" applies-to-saps="" ng-attr-id="{{contentSection.meta.id}}" ng-class="{'internal-content': isInternalSection() }">
    
    <div ng-if="contentSection.title" class="ng-scope">
        <h2 class="c-heading-4 f-lean bold ng-binding" ng-bind-html="contentSection.title">Ссылки</h2>
        <hr class="c-divider f-pad-bottom-6x f-pad-top-3x">
        
    </div>
    <div class="section-body ng-scope" ng-if="contentSection.content &amp;&amp; contentSection.content.length &gt; 0">
        <div ng-attr-data-grid="{{getStyleClass()}}" ng-repeat="content in contentSection.content track by $index" class="ng-scope" data-grid="col-12">
            <div compile="content" data-grid="col-12" class="ng-isolate-scope"><div class="kb-references-section section ng-scope">Для получения дополнительных сведений посетите следующие веб-сайты Microsoft Developer Network (MSDN):<div class="indent">Событие Form.Load<br><a id="kb-link-1" href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.form.load(vs.71).aspx" target="_self">http://msdn2.microsoft.com/en-us/library/system.windows.forms.form.load(vs.71).aspx</a></div><div class="indent">Метод Control.Focus<br><a id="kb-link-2" href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.focus(vs.71).aspx" target="_self">http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.focus(vs.71).aspx</a></div></div></div></div></div></section></div></div></div></div></div></div>
</body>
</html></p></body></html>