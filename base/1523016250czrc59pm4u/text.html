<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://officemacro.wordpress.com/2016/02/05/vba-quotes/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600; text-decoration: underline; color:#0000ff;">Заключаем строку VBA в кавычки</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">										</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						Posted on </span><a href="https://officemacro.wordpress.com/2016/02/05/vba-quotes/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">05.02.2016</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">						by </span><a href="https://officemacro.wordpress.com/author/officemacro/"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">officemacro</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> 										</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Чтобы в строку VBA записать символ кавычек, приходится использовать код символа кавычек </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Chr(34)</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> или дублировать символ кавычек.</span><a name="more-979"></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">В итоге получается громоздкий код вида</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_398853"></a><span style=" font-family:'Courier New,courier'; font-size:11pt;">'</span><span style=" font-family:'Courier New,courier'; font-size:11pt;">запись формулы в ячейку Excel</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">c.FormulaLocal = &quot;=ГИПЕРССЫЛКА(&quot;&quot;[C:\Книга.xls]&quot;&quot;)&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">'или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">c.FormulaLocal=&quot;=ГИПЕРССЫЛКА(&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">&amp; Chr(34) &amp; &quot;[C:\w.xls]&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">&amp; Chr(34) &amp; &quot;)&quot;</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">Для заключения строк в кавычки можно использовать функцию</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:11pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="highlighter_419899"></a><span style=" font-family:'Courier New,courier'; font-size:11pt;">'</span><span style=" font-family:'Courier New,courier'; font-size:11pt;">заключает текст в двойные кавычки (способ 1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">Public</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Function</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Quotes(text As</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">String) As</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">  Quotes = Chr(34) &amp; text &amp; Chr(34)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">End</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">'заключает текст в двойные кавычки (способ 2)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">Public</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Function</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Quotes(text As</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">String) As</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">  Quotes = &quot;&quot;&quot;&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">&amp; text &amp; &quot;&quot;&quot;&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">End</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-size:11pt;">c.FormulaLocal = &quot;=ГИПЕРССЫЛКА(&quot;</span><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> </span><span style=" font-family:'Courier New,courier'; font-size:11pt;">&amp; Quotes(&quot;[C:\Книга.xls]&quot;) &amp; &quot;)&quot;</span></p></td></tr></table></body></html>