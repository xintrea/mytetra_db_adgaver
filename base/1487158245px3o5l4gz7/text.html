<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td width="64"></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Option</span> Explicit<br /><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> OSVer <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> clsOSInfo<br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Form_Load<span style=" color:#000000;">()</span><br />    Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Название ОС: &quot;</span>; OSVer<span style=" color:#000000;">.OSName</span><br />    Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Версия SP: &quot;</span>; OSVer<span style=" color:#000000;">.SPVer</span><br />    Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Язык, отображаемый в диалогах: &quot;</span>; OSVer<span style=" color:#000000;">.LangNonUnicodeCode</span>; <span style=" color:#a52a2a;">&quot; Название: &quot;</span>; OSVer<span style=" color:#000000;">.LangNonUnicodeName</span><br />    OSVer<span style=" color:#000000;">.IsVistaOrLater</span><br />    OSVer<span style=" color:#000000;">.MajorMinor</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Form_Unload<span style=" color:#000000;">(</span>Cancel <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Set</span> OSVer <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">Nothing</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Option</span> Explicit<br /><br /><span style=" font-style:italic; color:#008000;">' Класс OSInfo by Alex Dragokas</span><br /><span style=" font-style:italic; color:#008000;">' ver 1.4.6</span><br /><span style=" font-style:italic; color:#008000;">'</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> Type OSVERSIONINFOEX<br />    dwOSVersionInfoSize <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    dwMajorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    dwMinorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    dwBuildNumber <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    dwPlatformId <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    szCSDVersion<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">255</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span><br />    wServicePackMajor <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br />    wServicePackMinor <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br />    wSuiteMask <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br />    wProductType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span><br />    wReserved <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> Type<br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> Type SID_IDENTIFIER_AUTHORITY<br />    value<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">To</span> <span style=" color:#a52a2a;">5</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> Type<br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> Type SID_AND_ATTRIBUTES<br />    Sid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    Attributes <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> Type<br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> Type TOKEN_GROUPS<br />    GroupCount <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    Groups<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">20</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> SID_AND_ATTRIBUTES<br /><span style=" font-weight:600; color:#0000ff;">End</span> Type<br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetUserDefaultUILanguage <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetSystemDefaultUILanguage <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetSystemDefaultLCID <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetUserDefaultLCID <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> IsWow64Process <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hProc <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, bWow64Process <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetVersionEx <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;GetVersionExW&quot;</span> <span style=" color:#000000;">(</span>lpVersionInformation <span style=" font-weight:600; color:#0000ff;">As</span> OSVERSIONINFOEX<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetSystemMetrics <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;user32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> nIndex <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetProductInfo <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> dwOSMajorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> dwOSMinorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> dwSpMajorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> dwSpMinorVersion <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, pdwReturnedProductType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> CheckTokenMembership <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> SidToCheck <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, IsMember <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> OpenProcessToken <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> ProcessHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> DesiredAccess <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, TokenHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetTokenInformation <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenInformationClass <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, TokenInformation <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenInformationLength <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, ReturnLength <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> OpenThreadToken <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> ThreadHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> DesiredAccess <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> OpenAsSelf <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, TokenHandle <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetCurrentThread <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetCurrentProcess <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> CopyMemory <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;RtlMoveMemory&quot;</span> <span style=" color:#000000;">(</span>Dest <span style=" font-weight:600; color:#0000ff;">As</span> Any, Source <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lSize <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetMem4 <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;msvbvm60.dll&quot;</span> <span style=" color:#000000;">(</span>Src <span style=" font-weight:600; color:#0000ff;">As</span> Any, Dst <span style=" font-weight:600; color:#0000ff;">As</span> Any<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> CloseHandle <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hObject <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> LocalFree <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;kernel32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hMem <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> FreeSid <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> pSid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> AllocateAndInitializeSid <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span>pIdentifierAuthority <span style=" font-weight:600; color:#0000ff;">As</span> Any, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthorityCount <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority0 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority1 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority2 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority3 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority4 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority5 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority6 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority7 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, lpPSid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> IsValidSid <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> pSid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetSidSubAuthority <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> pSid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> nSubAuthority <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetSidSubAuthorityCount <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> pSid <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> EqualSid <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span>pSid1 <span style=" font-weight:600; color:#0000ff;">As</span> Any, pSid2 <span style=" font-weight:600; color:#0000ff;">As</span> Any<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> RegOpenKeyEx <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;RegOpenKeyExW&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpSubKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> ulOptions <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> samDesired <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, phkResult <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> RegCloseKey <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> RegQueryValueExStr <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;RegQueryValueExW&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpValueName <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpReserved <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, lpType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> szData <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, lpcbData <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Declare</span> <span style=" font-weight:600; color:#0000ff;">Function</span> RegQueryValueExLong <span style=" font-weight:600; color:#0000ff;">Lib</span> <span style=" color:#a52a2a;">&quot;advapi32.dll&quot;</span> <span style=" font-weight:600; color:#0000ff;">Alias</span> <span style=" color:#a52a2a;">&quot;RegQueryValueExW&quot;</span> <span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> hKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpValueName <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> lpReserved <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, lpType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, szData <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>, lpcbData <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> SM_SERVERR2               <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">89</span><span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> VER_NT_WORKSTATION        <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> VER_SUITE_STORAGE_SERVER  <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H2000<span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> VER_SUITE_DATACENTER      <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H80<span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> VER_SUITE_PERSONAL        <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H200<span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> VER_SUITE_ENTERPRISE      <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> SM_CLEANBOOT              <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">67</span><span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> LOCALE_SYSTEM_DEFAULT     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H800<span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> LOCALE_USER_DEFAULT       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H400<span style=" color:#000000;">&amp;</span><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Const</span> LOCALE_SENGLANGUAGE       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H1001<span style=" color:#000000;">&amp;</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> osi <span style=" font-weight:600; color:#0000ff;">As</span> OSVERSIONINFOEX<br /><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> OSName_             <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> Family_             <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> Bitness_            <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> Edition_            <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> MajorMinor_         <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Single</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> SPver_              <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Single</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> IsSafeBoot_         <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> IsElevated_         <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> IntegrityLevel_     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> UserType_           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> IsVistaOrLater_     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangSystemName_     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangSystemCode_     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangDisplayName_    <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangDisplayCode_    <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangNonUnicodeName_ <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> LangNonUnicodeCode_ <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> t <span style=" font-style:italic; color:#008000;">' not used</span><br /><br /><br /><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Class_Initialize<span style=" color:#000000;">()</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">Resume</span> <span style=" font-weight:600; color:#0000ff;">Next</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> dec             <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Single</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ProductType     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /> <br />    LangDisplayCode_ <span style=" color:#000000;">=</span> GetUserDefaultUILanguage <span style=" font-weight:600; color:#0000ff;">Mod</span> <span style=" color:#000000;">&amp;</span>H10000<br />    LangDisplayName_ <span style=" color:#000000;">=</span> GetLangNameByCultureCode<span style=" color:#000000;">(</span>LangDisplayCode_<span style=" color:#000000;">)</span><br /> <br />    LangSystemCode_ <span style=" color:#000000;">=</span> GetSystemDefaultUILanguage <span style=" font-weight:600; color:#0000ff;">Mod</span> <span style=" color:#000000;">&amp;</span>H10000<br />    LangSystemName_ <span style=" color:#000000;">=</span> GetLangNameByCultureCode<span style=" color:#000000;">(</span>LangSystemCode_<span style=" color:#000000;">)</span><br /> <br />    LangNonUnicodeCode_ <span style=" color:#000000;">=</span> GetSystemDefaultLCID <span style=" font-weight:600; color:#0000ff;">Mod</span> <span style=" color:#000000;">&amp;</span>H10000<br />    LangNonUnicodeName_ <span style=" color:#000000;">=</span> GetLangNameByCultureCode<span style=" color:#000000;">(</span>LangNonUnicodeCode_<span style=" color:#000000;">)</span><br /> <br />    osi<span style=" color:#000000;">.dwOSVersionInfoSize</span> <span style=" color:#000000;">=</span> Len<span style=" color:#000000;">(</span>osi<span style=" color:#000000;">)</span><br />    GetVersionEx osi<br /> <br />    Family_ <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=IIF+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">IIf</span></a><span style=" color:#000000;">(</span>osi<span style=" color:#000000;">.dwMajorVersion</span> <span style=" color:#000000;">&gt;=</span> <span style=" color:#a52a2a;">6</span>, <span style=" color:#a52a2a;">&quot;Vista&quot;</span>, <span style=" color:#a52a2a;">&quot;NT&quot;</span><span style=" color:#000000;">)</span><br />    IsVistaOrLater_ <span style=" color:#000000;">=</span> <span style=" color:#000000;">(</span>osi<span style=" color:#000000;">.dwMajorVersion</span> <span style=" color:#000000;">&gt;=</span> <span style=" color:#a52a2a;">6</span><span style=" color:#000000;">)</span><br /> <br />    Bitness_ <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=IIF+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">IIf</span></a><span style=" color:#000000;">(</span>IsWin64, <span style=" color:#a52a2a;">&quot;x64&quot;</span>, <span style=" color:#a52a2a;">&quot;x32&quot;</span><span style=" color:#000000;">)</span><br /> <br />    IsSafeBoot_ <span style=" color:#000000;">=</span> <span style=" color:#000000;">(</span>GetSystemMetrics<span style=" color:#000000;">(</span>SM_CLEANBOOT<span style=" color:#000000;">)</span> <span style=" color:#000000;">&gt;</span> <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span> <span style=" font-style:italic; color:#008000;">' 0 - Normal boot, 1 - Fail-safe boot, 2 - Fail-safe with network boot</span><br /> <br />    <span style=" font-style:italic; color:#008000;">' OS Major + Minor</span><br />    dec <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.dwMinorVersion</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> dec <span style=" color:#000000;">&lt;&gt;</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> <span style=" font-weight:600; color:#0000ff;">Do</span>: dec <span style=" color:#000000;">=</span> dec <span style=" color:#000000;">/</span> <span style=" color:#a52a2a;">10</span>: <span style=" font-weight:600; color:#0000ff;">Loop</span> Until dec <span style=" color:#000000;">&lt;</span> <span style=" color:#a52a2a;">1</span><br />    MajorMinor_ <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.dwMajorVersion</span> <span style=" color:#000000;">+</span> dec<br /> <br />    <span style=" font-style:italic; color:#008000;">' Service Pack Major + Minor</span><br />    dec <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.wServicePackMinor</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> dec <span style=" color:#000000;">&lt;&gt;</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> <span style=" font-weight:600; color:#0000ff;">Do</span>: dec <span style=" color:#000000;">=</span> dec <span style=" color:#000000;">/</span> <span style=" color:#a52a2a;">10</span>: <span style=" font-weight:600; color:#0000ff;">Loop</span> Until dec <span style=" color:#000000;">&lt;</span> <span style=" color:#a52a2a;">1</span><br />    SPver_ <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.wServicePackMajor</span> <span style=" color:#000000;">+</span> dec<br />    <br />    <span style=" font-weight:600; color:#0000ff;">Select</span> <span style=" font-weight:600; color:#0000ff;">Case</span> MajorMinor_<br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">10</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 10&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 10 Server&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">6.4</span><br />            OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 10 Technical Preview&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">6.3</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 8.1&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2012 R2&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">6.2</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 8&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2012&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">6.1</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 7&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2008 R2&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">6</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Vista&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2008&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">5.2</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> GetSystemMetrics<span style=" color:#000000;">(</span>SM_SERVERR2<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2003 R2&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">ElseIf</span> osi<span style=" color:#000000;">.wSuiteMask</span> <span style=" font-weight:600; color:#0000ff;">And</span> VER_SUITE_STORAGE_SERVER <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Storage Server 2003&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">ElseIf</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">And</span> Bitness_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;x64&quot;</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows XP&quot;</span><br />                Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2003&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">5.1</span><br />            OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows XP&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wSuiteMask</span> <span style=" color:#000000;">=</span> VER_SUITE_PERSONAL <span style=" font-weight:600; color:#0000ff;">Then</span><br />                Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Home Edition&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#a52a2a;">5</span><br />            OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows 2000&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wProductType</span> <span style=" color:#000000;">=</span> VER_NT_WORKSTATION <span style=" font-weight:600; color:#0000ff;">Then</span><br />                Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional&quot;</span><br />            <span style=" font-weight:600; color:#0000ff;">Else</span><br />                <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.wSuiteMask</span> <span style=" font-weight:600; color:#0000ff;">And</span> VER_SUITE_DATACENTER <span style=" font-weight:600; color:#0000ff;">Then</span><br />                    Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Datacenter Server&quot;</span><br />                <span style=" font-weight:600; color:#0000ff;">ElseIf</span> osi<span style=" color:#000000;">.wSuiteMask</span> <span style=" font-weight:600; color:#0000ff;">And</span> VER_SUITE_ENTERPRISE <span style=" font-weight:600; color:#0000ff;">Then</span><br />                    Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Advanced Server&quot;</span><br />                <span style=" font-weight:600; color:#0000ff;">Else</span><br />                    Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server&quot;</span><br />                <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Else</span><br />            OSName_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Unknown&quot;</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;(ver. &quot;</span> <span style=" color:#000000;">&amp;</span> MajorMinor_ <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;) (&quot;</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;Build: &quot;</span> <span style=" color:#000000;">&amp;</span> osi<span style=" color:#000000;">.dwBuildNumber</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;)&quot;</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot; Registry's data: &quot;</span> <span style=" color:#000000;">&amp;</span> GetWindowsNameFromRegistry<span style=" color:#000000;">()</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Select</span><br /><br />    <span style=" font-style:italic; color:#008000;">'Редакция</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> Edition_ <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;&quot;</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />        <span style=" font-weight:600; color:#0000ff;">If</span> MajorMinor_ <span style=" color:#000000;">&gt;=</span> <span style=" color:#a52a2a;">6</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> GetProductInfo<span style=" color:#000000;">(</span>osi<span style=" color:#000000;">.dwMajorVersion</span>, osi<span style=" color:#000000;">.dwMinorVersion</span>, osi<span style=" color:#000000;">.wServicePackMajor</span>, osi<span style=" color:#000000;">.wServicePackMinor</span>, ProductType<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                Edition_ <span style=" color:#000000;">=</span> GetProductName<span style=" color:#000000;">(</span>ProductType<span style=" color:#000000;">)</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br /> <br />    IsElevated_ <span style=" color:#000000;">=</span> IsProcessElevated<span style=" color:#000000;">()</span><br /> <br />    IntegrityLevel_ <span style=" color:#000000;">=</span> GetIntegrityLevel<span style=" color:#000000;">()</span><br /> <br />    UserType_ <span style=" color:#000000;">=</span> GetUserType<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Function</span> GetWindowsNameFromRegistry<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">GoTo</span> ErrorHandler<br /><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> HKEY_LOCAL_MACHINE    <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H80000002<br />    <span style=" font-weight:600; color:#0000ff;">Const</span> KEY_QUERY_VALUE       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H1<span style=" color:#000000;">&amp;</span><br /><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> OSName <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> hKey <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ordType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> cData <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /><br />    RegOpenKeyEx HKEY_LOCAL_MACHINE, StrPtr<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;</span><span style=" color:#000000;">)</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, KEY_QUERY_VALUE, hKey<br />    RegQueryValueExLong hKey, StrPtr<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;ProductName&quot;</span><span style=" color:#000000;">)</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, ordType, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, cData<br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> cData <span style=" color:#000000;">&gt;</span> <span style=" color:#a52a2a;">1</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />        OSName <span style=" color:#000000;">=</span> <span style=" color:#6a5acd;">String</span>$<span style=" color:#000000;">(</span>cData <span style=" color:#000000;">-</span> <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;)</span><br />        RegQueryValueExStr hKey, StrPtr<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;ProductName&quot;</span><span style=" color:#000000;">)</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, ordType, StrPtr<span style=" color:#000000;">(</span>OSName<span style=" color:#000000;">)</span>, cData<br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> hKey <span style=" color:#000000;">&lt;&gt;</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> RegCloseKey hKey<br /> <br />    GetWindowsNameFromRegistry <span style=" color:#000000;">=</span> OSName<br />ErrorHandler:<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Function</span> IsProcessElevated<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">Optional</span> hProcess <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">GoTo</span> ErrorHandler<br /> <br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TOKEN_QUERY           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H8<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TokenElevation        <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">20</span><span style=" color:#000000;">&amp;</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> hToken           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> dwLengthNeeded   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> dwIsElevated     <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br /> <br />    <span style=" font-style:italic; color:#008000;">' &lt; Win Vista. Устанавливаем true, если пользователь состоит в группе &quot;Администраторы&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.dwMajorVersion</span> <span style=" color:#000000;">&lt;</span> <span style=" color:#a52a2a;">6</span> <span style=" font-weight:600; color:#0000ff;">Then</span> IsProcessElevated <span style=" color:#000000;">=</span> <span style=" color:#000000;">(</span>GetUserType<span style=" color:#000000;">()</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Administrator&quot;</span><span style=" color:#000000;">)</span>: <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br />    <span style=" font-weight:600; color:#0000ff;">If</span> hProcess <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> hProcess <span style=" color:#000000;">=</span> GetCurrentProcess<span style=" color:#000000;">()</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> OpenProcessToken<span style=" color:#000000;">(</span>hProcess, TOKEN_QUERY, hToken<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br /><br />        <span style=" font-weight:600; color:#0000ff;">If</span> <span style=" color:#a52a2a;">0</span> <span style=" color:#000000;">&lt;&gt;</span> GetTokenInformation<span style=" color:#000000;">(</span>hToken, TokenElevation, dwIsElevated, <span style=" color:#a52a2a;">4</span><span style=" color:#000000;">&amp;</span>, dwLengthNeeded<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />            IsProcessElevated <span style=" color:#000000;">=</span> <span style=" color:#000000;">(</span>dwIsElevated <span style=" color:#000000;">&lt;&gt;</span> <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span><br />        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />     <br />        CloseHandle hToken<br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />ErrorHandler:<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Function</span> GetUserType<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">Optional</span> hProcess <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">GoTo</span> ErrorHandler<br /><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TOKEN_QUERY                   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H8<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_NT_AUTHORITY         <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">5</span><span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TokenGroups                   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_BUILTIN_DOMAIN_RID   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H20<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> DOMAIN_ALIAS_RID_ADMINS       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H220<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> DOMAIN_ALIAS_RID_USERS        <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H221<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> DOMAIN_ALIAS_RID_GUESTS       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H222<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> DOMAIN_ALIAS_RID_POWER_USERS  <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H223<span style=" color:#000000;">&amp;</span><br /><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> hProcessToken   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> BufferSize      <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> psidAdmin       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> psidPower       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> psidUser        <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> psidGuest       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> lResult         <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> i               <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> tpTokens        <span style=" font-weight:600; color:#0000ff;">As</span> TOKEN_GROUPS<br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> tpSidAuth       <span style=" font-weight:600; color:#0000ff;">As</span> SID_IDENTIFIER_AUTHORITY<br /> <br />    GetUserType <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Unknown&quot;</span><br />    tpSidAuth<span style=" color:#000000;">.value(</span><span style=" color:#a52a2a;">5</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> SECURITY_NT_AUTHORITY<br /> <br />    <span style=" font-style:italic; color:#008000;">' в идеале, сначала нужно проверять токен, полученный от потока</span><br />    <span style=" font-style:italic; color:#008000;">' If Not OpenThreadToken(GetCurrentThread(), TOKEN_QUERY, True, hProcessToken) Then</span><br />    <span style=" font-style:italic; color:#008000;">' ограничимся токеном процесса, т.к. пока не планируем более 1 потока</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> hProcess <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> hProcess <span style=" color:#000000;">=</span> GetCurrentProcess<span style=" color:#000000;">()</span><br />    <span style=" font-weight:600; color:#0000ff;">If</span> <span style=" color:#a52a2a;">0</span> <span style=" color:#000000;">=</span> OpenProcessToken<span style=" color:#000000;">(</span>hProcess, TOKEN_QUERY, hProcessToken<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span> <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> hProcessToken <span style=" font-weight:600; color:#0000ff;">Then</span><br /><br />        <span style=" font-style:italic; color:#008000;">' Определяем требуемый размер буфера</span><br />        GetTokenInformation hProcessToken, <span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenGroups, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, BufferSize<br />     <br />        <span style=" font-weight:600; color:#0000ff;">If</span> BufferSize <span style=" font-weight:600; color:#0000ff;">Then</span><br />            <span style=" font-weight:600; color:#0000ff;">ReDim</span> InfoBuffer<span style=" color:#000000;">((</span>BufferSize \ <span style=" color:#a52a2a;">4</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">-</span> <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span>  <span style=" font-style:italic; color:#008000;">' Переводим размер byte -&gt; Long</span><br />         <br />            <span style=" font-style:italic; color:#008000;">' Получаем информацию о SID-ах групп, ассоциированных с этим токеном</span><br />            <span style=" font-weight:600; color:#0000ff;">If</span> <span style=" color:#a52a2a;">0</span> <span style=" color:#000000;">&lt;&gt;</span> GetTokenInformation<span style=" color:#000000;">(</span>hProcessToken, <span style=" font-weight:600; color:#0000ff;">ByVal</span> TokenGroups, InfoBuffer<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span>, BufferSize, BufferSize<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />         <br />                <span style=" font-style:italic; color:#008000;">' Заполняем структуру из буфера</span><br />                <span style=" font-weight:600; color:#0000ff;">Call</span> CopyMemory<span style=" color:#000000;">(</span>tpTokens, InfoBuffer<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span>, Len<span style=" color:#000000;">(</span>tpTokens<span style=" color:#000000;">))</span><br />         <br />                <span style=" font-style:italic; color:#008000;">' Получаем SID-ы каждого типа пользователей</span><br />                lResult <span style=" color:#000000;">=</span> AllocateAndInitializeSid<span style=" color:#000000;">(</span>tpSidAuth, <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span>, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, psidAdmin<span style=" color:#000000;">)</span><br />                lResult <span style=" color:#000000;">=</span> AllocateAndInitializeSid<span style=" color:#000000;">(</span>tpSidAuth, <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span>, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_POWER_USERS, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, psidPower<span style=" color:#000000;">)</span><br />                lResult <span style=" color:#000000;">=</span> AllocateAndInitializeSid<span style=" color:#000000;">(</span>tpSidAuth, <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span>, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_USERS, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, psidUser<span style=" color:#000000;">)</span><br />                lResult <span style=" color:#000000;">=</span> AllocateAndInitializeSid<span style=" color:#000000;">(</span>tpSidAuth, <span style=" color:#a52a2a;">2</span><span style=" color:#000000;">&amp;</span>, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_GUESTS, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, psidGuest<span style=" color:#000000;">)</span><br />         <br />                <span style=" font-weight:600; color:#0000ff;">If</span> IsValidSid<span style=" color:#000000;">(</span>psidAdmin<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">And</span> IsValidSid<span style=" color:#000000;">(</span>psidPower<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">And</span> IsValidSid<span style=" color:#000000;">(</span>psidUser<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">And</span> IsValidSid<span style=" color:#000000;">(</span>psidGuest<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />               <br />                    <span style=" font-weight:600; color:#0000ff;">For</span> i <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">To</span> tpTokens<span style=" color:#000000;">.GroupCount</span><br />                        <span style=" font-style:italic; color:#008000;">' Берем SID каждой из ассоциированных групп</span><br />                        <span style=" font-weight:600; color:#0000ff;">If</span> IsValidSid<span style=" color:#000000;">(</span>tpTokens<span style=" color:#000000;">.Groups(</span>i<span style=" color:#000000;">).Sid)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                            <span style=" font-style:italic; color:#008000;">' Проверяем на соответствие</span><br />                            <span style=" font-weight:600; color:#0000ff;">If</span> EqualSid<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> tpTokens<span style=" color:#000000;">.Groups(</span>i<span style=" color:#000000;">).Sid</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> psidAdmin<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                                GetUserType <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Administrator&quot;</span>:  <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">For</span><br />                            <span style=" font-weight:600; color:#0000ff;">ElseIf</span> EqualSid<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> tpTokens<span style=" color:#000000;">.Groups(</span>i<span style=" color:#000000;">).Sid</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> psidPower<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                                GetUserType <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Power User&quot;</span>:     <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">For</span><br />                            <span style=" font-weight:600; color:#0000ff;">ElseIf</span> EqualSid<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> tpTokens<span style=" color:#000000;">.Groups(</span>i<span style=" color:#000000;">).Sid</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> psidUser<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                                GetUserType <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Limited User&quot;</span>:   <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">For</span><br />                            <span style=" font-weight:600; color:#0000ff;">ElseIf</span> EqualSid<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">ByVal</span> tpTokens<span style=" color:#000000;">.Groups(</span>i<span style=" color:#000000;">).Sid</span>, <span style=" font-weight:600; color:#0000ff;">ByVal</span> psidGuest<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />                                GetUserType <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Guest&quot;</span>:          <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">For</span><br />                            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />                        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />                    <span style=" font-weight:600; color:#0000ff;">Next</span><br />                <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />                <span style=" font-weight:600; color:#0000ff;">If</span> psidAdmin <span style=" font-weight:600; color:#0000ff;">Then</span> FreeSid psidAdmin<br />                <span style=" font-weight:600; color:#0000ff;">If</span> psidPower <span style=" font-weight:600; color:#0000ff;">Then</span> FreeSid psidPower<br />                <span style=" font-weight:600; color:#0000ff;">If</span> psidUser <span style=" font-weight:600; color:#0000ff;">Then</span> FreeSid psidUser<br />                <span style=" font-weight:600; color:#0000ff;">If</span> psidGuest <span style=" font-weight:600; color:#0000ff;">Then</span> FreeSid psidGuest<br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        CloseHandle hProcessToken<br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />    <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br />ErrorHandler:<br />    <span style=" font-weight:600; color:#0000ff;">If</span> hProcessToken <span style=" font-weight:600; color:#0000ff;">Then</span> CloseHandle hProcessToken<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Function</span> GetIntegrityLevel<span style=" color:#000000;">(</span><span style=" font-weight:600; color:#0000ff;">Optional</span> hProcess <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span>       <span style=" font-style:italic; color:#008000;">'https://msdn.microsoft.com/en-us/library/bb625966.aspx?f=255</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">GoTo</span> ErrorHandler<br /> <br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_UNTRUSTED_RID          <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_LOW_RID                <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H1000<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_MEDIUM_RID             <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H2000<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_HIGH_RID               <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H3000<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_SYSTEM_RID             <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H4000<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> SECURITY_MANDATORY_PROTECTED_PROCESS_RID  <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H5000<span style=" color:#000000;">&amp;</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TokenIntegrityLevel       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">25</span><span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> TOKEN_QUERY               <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H8<span style=" color:#000000;">&amp;</span><br />    <span style=" font-weight:600; color:#0000ff;">Const</span> ERROR_INSUFFICIENT_BUFFER <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span> <span style=" color:#000000;">=</span> <span style=" color:#000000;">&amp;</span>H7A<span style=" color:#000000;">&amp;</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> hToken           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> dwLengthNeeded   <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> bTIL<span style=" color:#000000;">()</span>           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Byte</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> pSidSub          <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> dwIntegrityLevel <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> pSidAuthCnt      <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> SidAuthCnt       <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> pILSid           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ILevel           <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> osi<span style=" color:#000000;">.dwMajorVersion</span> <span style=" color:#000000;">&lt;</span> <span style=" color:#a52a2a;">6</span> <span style=" font-weight:600; color:#0000ff;">Then</span> GetIntegrityLevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span>: <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">Function</span> <span style=" font-style:italic; color:#008000;">' &lt; Win Vista</span><br /> <br />    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Unknown&quot;</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> hProcess <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">Then</span> hProcess <span style=" color:#000000;">=</span> GetCurrentProcess<span style=" color:#000000;">()</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">If</span> OpenProcessToken<span style=" color:#000000;">(</span>hProcess, TOKEN_QUERY, hToken<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br /> <br />        GetTokenInformation hToken, TokenIntegrityLevel, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">&amp;</span>, dwLengthNeeded<br />     <br />        <span style=" font-weight:600; color:#0000ff;">If</span> ERROR_INSUFFICIENT_BUFFER <span style=" color:#000000;">=</span> Err<span style=" color:#000000;">.LastDllError</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />     <br />            <span style=" font-weight:600; color:#0000ff;">ReDim</span> bTIL<span style=" color:#000000;">(</span>dwLengthNeeded <span style=" color:#000000;">-</span> <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span><br />     <br />            <span style=" font-weight:600; color:#0000ff;">If</span> <span style=" color:#a52a2a;">0</span> <span style=" color:#000000;">&lt;&gt;</span> GetTokenInformation<span style=" color:#000000;">(</span>hToken, TokenIntegrityLevel, bTIL<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span>, dwLengthNeeded, dwLengthNeeded<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />     <br />                GetMem4 bTIL<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span>, pILSid<br />             <br />                <span style=" font-weight:600; color:#0000ff;">If</span> IsValidSid<span style=" color:#000000;">(</span>pILSid<span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br /><br />                    pSidAuthCnt <span style=" color:#000000;">=</span> GetSidSubAuthorityCount<span style=" color:#000000;">(</span>pILSid<span style=" color:#000000;">)</span><br />                 <br />                    <span style=" font-weight:600; color:#0000ff;">If</span> pSidAuthCnt <span style=" font-weight:600; color:#0000ff;">Then</span><br />                 <br />                        GetMem4 <span style=" font-weight:600; color:#0000ff;">ByVal</span> pSidAuthCnt, SidAuthCnt<br />                     <br />                        <span style=" font-weight:600; color:#0000ff;">If</span> SidAuthCnt <span style=" font-weight:600; color:#0000ff;">Then</span><br />                     <br />                            pSidSub <span style=" color:#000000;">=</span> GetSidSubAuthority<span style=" color:#000000;">(</span>pILSid, SidAuthCnt <span style=" color:#000000;">-</span> <span style=" color:#a52a2a;">1</span><span style=" color:#000000;">)</span><br />                 <br />                            <span style=" font-weight:600; color:#0000ff;">If</span> pSidSub <span style=" font-weight:600; color:#0000ff;">Then</span> GetMem4 <span style=" font-weight:600; color:#0000ff;">ByVal</span> pSidSub, dwIntegrityLevel<br />                 <br />                            <span style=" font-weight:600; color:#0000ff;">Select</span> <span style=" font-weight:600; color:#0000ff;">Case</span> dwIntegrityLevel<br />                         <br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_UNTRUSTED_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Unknown&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_LOW_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Untrusted&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_MEDIUM_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Low&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_HIGH_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Medium&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_SYSTEM_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;High&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Is</span> <span style=" color:#000000;">&lt;</span> SECURITY_MANDATORY_PROTECTED_PROCESS_RID<br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;System&quot;</span><br />                                <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Else</span><br />                                    ILevel <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ProtectedProcess&quot;</span><br />                            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Select</span><br />                        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />                    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />                    FreeSid pILSid<br />                <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />            <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />        CloseHandle hToken<br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br />    GetIntegrityLevel <span style=" color:#000000;">=</span> ILevel<br />    <span style=" font-weight:600; color:#0000ff;">Exit</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br />ErrorHandler:<br />    <span style=" font-weight:600; color:#0000ff;">If</span> hToken <span style=" font-weight:600; color:#0000ff;">Then</span> CloseHandle hToken<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Function</span> GetProductName<span style=" color:#000000;">(</span>ProductType <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">Resume</span> <span style=" font-weight:600; color:#0000ff;">Next</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> ProductName <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /> <br />    <span style=" font-weight:600; color:#0000ff;">Select</span> <span style=" font-weight:600; color:#0000ff;">Case</span> ProductType<br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H6<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Business&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H10<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Business N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H12<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;HPC Edition&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Hyper Core V&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H65<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;&quot;</span> <span style=" font-style:italic; color:#008000;">'&quot;Windows 8&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H62<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;N&quot;</span> <span style=" font-style:italic; color:#008000;">' &quot;Windows 8 N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H63<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;China&quot;</span> <span style=" font-style:italic; color:#008000;">' &quot;Windows 8 China&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H64<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Single Language&quot;</span> <span style=" font-style:italic; color:#008000;">' &quot;Windows 8 Single Language&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H50<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Datacenter (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H8<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Datacenter (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Datacenter (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H27<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Datacenter without Hyper-V (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H25<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Datacenter without Hyper-V (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Enterprise&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H46<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H54<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Enterprise N (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1B<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Enterprise N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H48<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HA<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HE<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H29<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise without Hyper-V (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HF<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise for Itanium-based Systems&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H26<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Enterprise without Hyper-V (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3B<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Server Solution Management&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3C<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Server Solution Additional&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3D<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Server Solution Management SVC&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3E<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Server Solution Additional SVC&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Home Basic&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H43<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H5<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Home Basic N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Home Premium&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H44<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1A<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Home Premium N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H22<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Home Server 2011&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H13<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Storage Server 2008 R2 Essentials&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2A<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Microsoft Hyper-V Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1E<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Business Server Management Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H20<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Business Server Messaging Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1F<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Essential Business Server Security Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4C<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows MultiPoint Server Standard (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4D<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows MultiPoint Server Premium (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H30<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H45<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H31<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H67<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Professional with Media Center&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H36<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server For SB Solutions EM&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H33<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server For SB Solutions&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H37<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server For SB Solutions EM&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H18<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2008 for Windows Essential Server Solutions&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H23<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Server 2008 without Hyper-V for Windows Essential Server Solutions&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H21<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Foundation&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H32<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Small Business Server 2011 Essentials&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H9<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows Small Business Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H19<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Small Business Server Premium&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3F<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Small Business Server Premium (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H38<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Windows MultiPoint Server&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4F<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Standard (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H7<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Standard&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HD<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Standard (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H24<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Standard without Hyper-V&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H28<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Standard without Hyper-V (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H34<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Solutions Premium&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H35<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Server Solutions Premium (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HB<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Starter&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2F<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Starter N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H17<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Enterprise&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2E<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Enterprise (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H14<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Express&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2B<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Express (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H60<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Standard (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H15<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Standard&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2C<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Standard (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H5F<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Workgroup (EI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H16<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Workgroup&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2D<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Storage Server Workgroup (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H0<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;An unknown product&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Ultimate&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H47<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Not supported&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1C<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Ultimate N&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H11<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Web Server (FI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1D<span style=" color:#000000;">&amp;</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Web Server (CI)&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Else</span><br />        ProductName <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Unknown Edition&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Select</span><br /><br />    GetProductName <span style=" color:#000000;">=</span> ProductName<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><br /><span style=" font-weight:600; color:#0000ff;">Function</span> GetLangNameByCultureCode<span style=" color:#000000;">(</span>CultureCode <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> Lang$<br />    <span style=" font-weight:600; color:#0000ff;">Select</span> <span style=" font-weight:600; color:#0000ff;">Case</span> CultureCode<br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H419<span style=" color:#000000;">&amp;</span><br />            <span style=" font-style:italic; color:#008000;">'Lang = &quot;ru-RU&quot;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;RU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H409<span style=" color:#000000;">&amp;</span><br />            <span style=" font-style:italic; color:#008000;">'Lang = &quot;en-US&quot;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;EN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H422<span style=" color:#000000;">&amp;</span><br />            <span style=" font-style:italic; color:#008000;">'Lang = &quot;uk-UA&quot;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;UA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H423<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;be-BY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H402<span style=" color:#000000;">&amp;</span><br />            <span style=" font-style:italic; color:#008000;">'Lang = &quot;bg-BG&quot;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;BG&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H436<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;af-ZA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sq-AL&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1401<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-DZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3C01<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-BH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC01<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-EG&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H801<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-IQ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2C01<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-JO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3401<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-KW&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3001<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-LB&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1001<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-LY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1801<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-MA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2001<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-OM&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4001<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-QA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H401<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-SA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2801<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-SY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1C01<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-TN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3801<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-AE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2401<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ar-YE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42B<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;hy-AM&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H82C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Cy-az-AZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Lt-az-AZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42D<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;eu-ES&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H403<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ca-ES&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H804<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-CN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC04<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-HK&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1404<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-MO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1004<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-SG&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H404<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-TW&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-CHS&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H7C04<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;zh-CHT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;hr-HR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H405<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;cs-CZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H406<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;da-DK&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H465<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;div-MV&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H813<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;nl-BE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H413<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;nl-NL&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC09<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-AU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2809<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-BZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1009<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-CA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2409<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-CB&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1809<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-IE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2009<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-JM&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1409<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-NZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3409<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-PH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1C09<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-ZA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2C09<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-TT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H809<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-GB&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3009<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;en-ZW&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H425<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;et-EE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H438<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fo-FO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H429<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fa-IR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40B<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fi-FI&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H80C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-BE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC0C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-CA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-FR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H140C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-LU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H180C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-MC&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H100C<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;fr-CH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H456<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;gl-ES&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H437<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ka-GE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC07<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;de-AT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H407<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;de-DE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1407<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;de-LI&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1007<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;de-LU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H807<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;de-CH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H408<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;el-GR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H447<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;gu-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40D<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;he-IL&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H439<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;hi-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40E<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;hu-HU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H40F<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;is-IS&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H421<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;id-ID&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H410<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;it-IT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H810<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;it-CH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H411<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ja-JP&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H44B<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;kn-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H43F<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;kk-KZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H457<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;kok-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H412<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ko-KR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H440<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ky-KZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H426<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;lv-LV&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H427<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;lt-LT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42F<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;mk-MK&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H83E<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ms-BN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H43E<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ms-MY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H44E<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;mr-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H450<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;mn-MN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H414<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;nb-NO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H814<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;nn-NO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H415<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;pl-PL&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H416<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;pt-BR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H816<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;pt-PT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H446<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;pa-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H418<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ro-RO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H44F<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sa-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC1A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Cy-sr-SP&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H81A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Lt-sr-SP&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41B<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sk-SK&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H424<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sl-SI&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H2C0A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-AR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H400A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-BO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H340A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-CL&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H240A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-CO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H140A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-CR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H1C0A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-DO&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H300A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-EC&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H440A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-SV&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H100A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-GT&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H480A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-HN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H80A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-MX&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H4C0A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-NI&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H180A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-PA&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H3C0A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-PY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H280A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-PE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H500A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-PR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>HC0A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-ES&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H380A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-UY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H200A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;es-VE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H441<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sw-KE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H81D<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sv-FI&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41D<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;sv-SE&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H45A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;syr-SY&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H449<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ta-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H444<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;tt-RU&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H44A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;te-IN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41E<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;th-TH&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H41F<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;tr-TR&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H420<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;ur-PK&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H843<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Cy-uz-UZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H443<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Lt-uz-UZ&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" color:#000000;">&amp;</span>H42A<span style=" color:#000000;">&amp;</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;vi-VN&quot;</span><br />        <span style=" font-weight:600; color:#0000ff;">Case</span> <span style=" font-weight:600; color:#0000ff;">Else</span><br />            Lang <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;unknown&quot;</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Select</span><br />    GetLangNameByCultureCode <span style=" color:#000000;">=</span> Lang<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Function</span> IsWin64<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span>           <span style=" font-style:italic; color:#008000;">' Разрядность ОС</span><br />    <span style=" font-weight:600; color:#0000ff;">On</span> <span style=" font-weight:600; color:#0000ff;">Error</span> <span style=" font-weight:600; color:#0000ff;">Resume</span> <span style=" font-weight:600; color:#0000ff;">Next</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> lIsWin64 <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    IsWow64Process GetCurrentProcess, lIsWin64<br />    IsWin64 <span style=" color:#000000;">=</span> <span style=" color:#cd6a5a;">CBool</span><span style=" color:#000000;">(</span>lIsWin64<span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Family<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    Family <span style=" color:#000000;">=</span> Family_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Bitness<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    Bitness <span style=" color:#000000;">=</span> Bitness_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Major<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    Major <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.dwMajorVersion</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Minor<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    Minor <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.dwMinorVersion</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> MajorMinor<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Single</span><br />    MajorMinor <span style=" color:#000000;">=</span> MajorMinor_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Build<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    Build <span style=" color:#000000;">=</span> osi<span style=" color:#000000;">.dwBuildNumber</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> SPVer<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Single</span><br />    SPVer <span style=" color:#000000;">=</span> SPver_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> OSName<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    OSName <span style=" color:#000000;">=</span> OSName_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> Edition<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    Edition <span style=" color:#000000;">=</span> Edition_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> IsElevated<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br />    IsElevated <span style=" color:#000000;">=</span> IsElevated_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> IntegrityLevel<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    IntegrityLevel <span style=" color:#000000;">=</span> IntegrityLevel_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> UserType<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    UserType <span style=" color:#000000;">=</span> UserType_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> IsSafeBoot<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br />    IsSafeBoot <span style=" color:#000000;">=</span> IsSafeBoot_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangSystemCode<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    LangSystemCode <span style=" color:#000000;">=</span> LangSystemCode_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangSystemName<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    LangSystemName <span style=" color:#000000;">=</span> LangSystemName_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangNonUnicodeCode<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    LangNonUnicodeCode <span style=" color:#000000;">=</span> LangNonUnicodeCode_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangNonUnicodeName<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    LangNonUnicodeName <span style=" color:#000000;">=</span> LangNonUnicodeName_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangDisplayCode<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Long</span><br />    LangDisplayCode <span style=" color:#000000;">=</span> LangDisplayCode_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> LangDisplayName<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br />    LangDisplayName <span style=" color:#000000;">=</span> LangDisplayName_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Public</span> <span style=" font-weight:600; color:#0000ff;">Property</span> <span style=" font-weight:600; color:#0000ff;">Get</span> IsVistaOrLater<span style=" color:#000000;">()</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Boolean</span><br />    IsVistaOrLater <span style=" color:#000000;">=</span> IsVistaOrLater_<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Property</span><br /> </p></body></html>