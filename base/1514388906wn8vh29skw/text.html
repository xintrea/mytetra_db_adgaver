<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.script-coding.com/index.html"><span style=" text-decoration: underline; color:#0000ff;">Перейти на главную страничку сайта (список статей, файлы для скачивания)</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://forum.script-coding.com"><span style=" text-decoration: underline; color:#0000ff;">ФОРУМ (здесь можно обсудить эту статью, а также любые проблемы программирования на различных макроязыках и в скриптовых средах)</span></a> </p>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">Nautilus Scriptilius</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На момент написания этих строк файловым менеджером по умолчанию для популярной среды GNOME является Nautilus. Этот файловый менеджер поддерживает подключение произвольных скриптов (называемых G-Scripts), которые позволяют существенно расширить его функциональные возможности. G-Script - это исполняемый сценарий командного процессора (обычно BASH), который размещён в специальном каталоге файлового менеджера Nautilus. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Такие скрипты вызываются в Nautilus из меню по правой кнопке мыши. Подменю «Сценарии» этого меню позволяет выбрать конкретный скрипт, который необходимо вызвать на выделенных в настоящий момент в Nautilus файлах. Чтобы скрипт появился в меню, должны быть выполнены два условия: он должен быть помещён в каталог сценариев и быть исполняемой программой. Чтобы новый скрипт немедленно появился в меню, достаточно посетить каталог сценариев непосредственно из Nautilus, используя последний пункт в подменю «Сценарии» («Открыть папку сценариев»), или просто перезапустить Nautilus. Подменю «Сценарии» работает не только в открытых папках в окнах Nautilus, но и на Рабочем столе GNOME. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каталог сценариев может находиться примерно в таких местах (это зависит от версии Nautilus, GNOME и т.п.): </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">~/.gnome2/nautilus-scripts</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">~/.gnome/nautilus-scripts</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">~/.nautilus/scripts</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">~/Nautilus/scripts</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подпунктами меню «Сценарии» будут являться папки, вложенные в каталог сценариев, т.е. меню будет отображать иерархию вашего каталога скриптов. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для написания скриптов могут быть использованы разные языки сценариев (не обязательно BASH), например, Perl, Python и т.д. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В момент вызова сценария через подменю «Сценарии» Nautilus всегда устанавливает несколько переменных среды, которые могут использоваться этим сценарием: <br /></p>
<table border="1" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">NAUTILUS_SCRIPT_SELECTED_FILE_PATHS</p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">разделённые переводами строк пути выбранных локальных файлов</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">NAUTILUS_SCRIPT_SELECTED_URIS</p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">разделённые переводами строк URI выбранных файлов</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">NAUTILUS_SCRIPT_CURRENT_URI</p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">текущее местоположение</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">NAUTILUS_SCRIPT_WINDOW_GEOMETRY</p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">позиция и размер текущего окна</p></td></tr></table>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбранные файлы могут быть также получены в скрипте с помощью традиционных переменных BASH «$@» и «$*». </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример обработки переданных путей файлов на BASH внутри вашего G-Script (пути могут содержать пробелы): </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">: &gt; test.txt</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">echo &quot;$NAUTILUS_SCRIPT_SELECTED_FILE_PATHS&quot; | while read line; do</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">    if [ ${#line} -gt 0 ]; then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">        echo &quot;$line&quot; &gt;&gt; test.txt</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">    fi</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">done</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В примере выше переменная $line внутри цикла будет получать очередной путь. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Большое количество готовых полезных скриптов для Nautilus вы можете скачать на сайте проекта G-Scripts: <a href="http://g-scripts.sourceforge.net"><span style=" text-decoration: underline; color:#0000ff;">http://g-scripts.sourceforge.net</span></a>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если необходимо отображать скрипт в контекстном меню Nautilus только для определённого типа файлов, следует настроить меню «Открыть» в свойствах этого файла стандартным способом, назначив этот скрипт как открывающую программу. В этом случае специальные переменные среды Nautilus, описанные в таблице выше, не устанавливаются, но работают обычные переменные «$@», «$*», «$0» и «$1». </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Существует консольная программа zenity (<a href="http://live.gnome.org/Zenity"><span style=" text-decoration: underline; color:#0000ff;">http://live.gnome.org/Zenity</span></a>), которая может отображать различные диалоги, используя библиотеку GTK+ и принимая в качестве аргументов параметры создаваемого диалога. Помимо отображения информации с помощью zenity можно получать ввод пользователя. Такой механизм позволяет создавать графические диалоги даже на столь простом языке, как BASH. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Zenity позволяет создавать следующие типы простых диалоговых окон: календарь, выбор файла, список для выбора, всплывающее окошко уведомления, сообщение (ошибка, информация, вопрос, предупреждение), индикатор прогресса, ввод текста, отображение текстовой информации. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В последних русифицированных версиях GNOME вы можете найти обширное руководство по Zenity на русском языке, используя клавишу F1 на Рабочем столе. Кроме того, в консоли по команде «zenity --help» вы получите исчерпывающую справку, также на русском языке. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Небольшой пример использования Zenity в G-Script: </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">echo &quot;$NAUTILUS_SCRIPT_SELECTED_FILE_PATHS&quot; | while read line; do</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">    if [ ${#line} -gt 0 ]; then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">        zenity --info --text=&quot;$line&quot; --title='Передан файл:'</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">    fi</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">done</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">userdate=`zenity --calendar --text='Укажите дату' --title='Пример'`</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; font-weight:600; color:#000080;">zenity --info --text=$userdate' г.' --title='Выбранная дата:'</span> </pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вышеприведённый скрипт выводит пути переданных ему Nautilus'ом файлов в окнах сообщений, затем предлагает пользователю ввести дату в окне календаря, и наконец демонстрирует эту выбранную дату. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">Людоговский Александр, 17.09.2008г.</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.script-coding.com/index.html"><span style=" text-decoration: underline; color:#0000ff;">Перейти на главную страничку сайта (список статей, файлы для скачивания)</span></a> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:small;">© 2007 </span><a href="http://www.script-coding.com/"><span style=" font-size:small; text-decoration: underline; color:#0000ff;">http://www.script-coding.com</span></a><span style=" font-size:small;"> При любом использовании материалов сайта обязательна </span><span style=" font-size:small; font-weight:600;">ссылка</span><span style=" font-size:small;"> на него как на источник информации, а также сохранение </span><span style=" font-size:small; font-weight:600;">целостности</span><span style=" font-size:small;"> и </span><span style=" font-size:small; font-weight:600;">авторства</span><span style=" font-size:small;"> материалов.</span> </p></body></html>