<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">С приходом в нашу жизнь нового Excel 2007 в неё также пришли не только свыше миллиона строк, почти неограниченное количество условий условного форматирования и еще куча новых возможностей, но и новый стиль. Притом не просто новый, а совершенно переработанный, незнакомый, неузнаваемый и запутывающий. Кто-то годами пользовался 2003 Excel и настолько привык к его интерфейсу, что новый стиль был воспринят не просто в штыки - многие из этих людей до сих пор пользуются 2003 практически только из-за нежелания переходить на новый стиль.<br />Тем, кто боится перейти на новый интерфейс только по этой причине, а так же тем, кого мучает ностальгия по прежнему интерфейсу, могу предложить несложный код, который на вкладке &quot;Надстройки&quot; создает ряд меню, повторяющих старый добрый 2003.<br /></span><img src="image31000.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Сам код: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce8093e449807632407"></a><span style=" font-size:8.25pt;">O</span><span style=" font-size:8.25pt;">ption Explicit '--------------------------------------------------------------------------------------- ' Procedure : MakeMenu2003 ' Purpose : Процедура создания меню в стиле Excel 2003 '--------------------------------------------------------------------------------------- Sub MakeMenu2003() Dim arr, cbArr, cbName As String Dim cbMenu, cbStandart, cbFormat Dim lc As Long 'Удаляем меню, если они уже созданы Call Del_Menu 'создаем массивы для создания меню 'имена cbArr = Array(&quot;Меню 2003&quot;, &quot;Стандартная 2003&quot;, &quot;Форматирование 2003&quot;) 'панель меню cbMenu = Array(&quot;30002|10&quot;, &quot;30003|10&quot;, &quot;30004|10&quot;, &quot;30005|10&quot;, &quot;30006|10&quot;, &quot;30007|10&quot;, &quot;30011|10&quot;, &quot;30009|10&quot;, &quot;30022|10&quot;, &quot;30177|10&quot;, &quot;30010|10&quot;) 'стандартная панель(основные иконки) cbStandart = Array(&quot;2520|1&quot;, &quot;23|1&quot;, &quot;3|1&quot;, &quot;9004|1&quot;, &quot;3738|1&quot;, &quot;2521|1&quot;, &quot;109|1&quot;, &quot;2|1&quot;, &quot;7343|1&quot;, &quot;21|1&quot;, &quot;19|1&quot;, &quot;108|1&quot;, &quot;128|6&quot;, &quot;129|6&quot;, &quot;9071|1&quot;, &quot;1576|1&quot;, &quot;226|13&quot;, &quot;210|1&quot;, &quot;211|1&quot;, &quot;436|1&quot;, &quot;1733|4&quot;, &quot;30253|10&quot;, &quot;984|1&quot;) 'панель форматов cbFormat = Array(&quot;1728|4&quot;, &quot;1731|4&quot;, &quot;113|1&quot;, &quot;114|1&quot;, &quot;115|1&quot;, &quot;120|1&quot;, &quot;122|1&quot;, &quot;121|1&quot;, &quot;402|1&quot;, &quot;1643|1&quot;, &quot;396|1&quot;, &quot;397|1&quot;, &quot;398|1&quot;, &quot;399|1&quot;, &quot;3162|1&quot;, &quot;3161|1&quot;) 'объединяем в один массив для более простого вызова arr = Array(cbMenu, cbStandart, cbFormat) For lc = LBound(cbArr) To UBound(cbArr) CreateMenu (cbArr(lc)), arr(lc) Next lc End Sub Function CreateMenu(cbName As String, arr) Dim vType, vID, lc As Long Dim asSp On Error Resume Next With Application.CommandBars.Add(cbName, , , True).Controls For lc = LBound(arr) To UBound(arr) asSp = Split(arr(lc), &quot;|&quot;) .Add Type:=Val(asSp(1)), ID:=Val(asSp(0)) Next End With 'Делаем меню видимым Application.CommandBars(cbName).Visible = True End Function '--------------------------------------------------------------------------------------- ' Procedure : Del_Menu2003 ' Purpose : Процедура удаления ранее созданного меню Excel 2003 '--------------------------------------------------------------------------------------- Sub Del_Menu() On Error Resume Next Dim x For Each x In Array(&quot;Меню 2003&quot;, &quot;Стандартная 2003&quot;, &quot;Форматирование 2003&quot;) Application.CommandBars(x).Delete Next End Sub </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">12</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">14</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">15</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">16</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">17</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">18</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">19</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">20</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">21</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">22</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">23</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">24</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">25</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">26</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">27</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">28</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">29</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">30</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">31</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">32</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">33</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">34</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">35</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">36</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">37</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">38</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">39</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">40</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">41</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">42</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">43</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">44</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">45</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">46</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">47</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">48</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">49</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">50</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">51 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce8093e449807632407-1"></a><span style=" font-size:8.25pt;">O</span><span style=" font-size:8.25pt;">ption Explicit</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-2"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-3"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Procedure : MakeMenu2003</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-4"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Purpose   : Процедура создания меню в стиле Excel 2003</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-5"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-6"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub MakeMenu2003()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-7"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim arr, cbArr, cbName As String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-8"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim cbMenu, cbStandart, cbFormat</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-9"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim lc As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-10"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-11"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'Удаляем меню, если они уже созданы</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-12"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Call Del_Menu</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-13"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'создаем массивы для создания меню</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-14"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'имена</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-15"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   cbArr = Array(&quot;Меню 2003&quot;, &quot;Стандартная 2003&quot;, &quot;Форматирование 2003&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-16"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'панель меню</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-17"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   cbMenu = Array(&quot;30002|10&quot;, &quot;30003|10&quot;, &quot;30004|10&quot;, &quot;30005|10&quot;, &quot;30006|10&quot;, &quot;30007|10&quot;, &quot;30011|10&quot;, &quot;30009|10&quot;, &quot;30022|10&quot;, &quot;30177|10&quot;, &quot;30010|10&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-18"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'стандартная панель(основные иконки)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-19"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   cbStandart = Array(&quot;2520|1&quot;, &quot;23|1&quot;, &quot;3|1&quot;, &quot;9004|1&quot;, &quot;3738|1&quot;, &quot;2521|1&quot;, &quot;109|1&quot;, &quot;2|1&quot;, &quot;7343|1&quot;, &quot;21|1&quot;, &quot;19|1&quot;, &quot;108|1&quot;, &quot;128|6&quot;, &quot;129|6&quot;, &quot;9071|1&quot;, &quot;1576|1&quot;, &quot;226|13&quot;, &quot;210|1&quot;, &quot;211|1&quot;, &quot;436|1&quot;, &quot;1733|4&quot;, &quot;30253|10&quot;, &quot;984|1&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-20"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'панель форматов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-21"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   cbFormat = Array(&quot;1728|4&quot;, &quot;1731|4&quot;, &quot;113|1&quot;, &quot;114|1&quot;, &quot;115|1&quot;, &quot;120|1&quot;, &quot;122|1&quot;, &quot;121|1&quot;, &quot;402|1&quot;, &quot;1643|1&quot;, &quot;396|1&quot;, &quot;397|1&quot;, &quot;398|1&quot;, &quot;399|1&quot;, &quot;3162|1&quot;, &quot;3161|1&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-22"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   'объединяем в один массив для более простого вызова</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-23"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   arr = Array(cbMenu, cbStandart, cbFormat)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-24"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For lc = LBound(cbArr) To UBound(cbArr)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-25"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       CreateMenu (cbArr(lc)), arr(lc)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-26"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next lc</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-27"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-28"></a><span style=" font-size:8.25pt;">F</span><span style=" font-size:8.25pt;">unction CreateMenu(cbName As String, arr)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-29"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> Dim vType, vID, lc As Long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-30"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> Dim asSp</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-31"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> On Error Resume Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-32"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> With Application.CommandBars.Add(cbName, , , True).Controls</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-33"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       For lc = LBound(arr) To UBound(arr)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-34"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           asSp = Split(arr(lc), &quot;|&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-35"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">           .Add Type:=Val(asSp(1)), ID:=Val(asSp(0))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-36"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-37"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> End With</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-38"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> 'Делаем меню видимым</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-39"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;"> Application.CommandBars(cbName).Visible = True</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-40"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-41"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-42"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Procedure : Del_Menu2003</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-43"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;"> Purpose   : Процедура удаления ранее созданного меню Excel 2003</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-44"></a><span style=" font-size:8.25pt;">'</span><span style=" font-size:8.25pt;">---------------------------------------------------------------------------------------</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-45"></a><span style=" font-size:8.25pt;">S</span><span style=" font-size:8.25pt;">ub Del_Menu()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-46"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   On Error Resume Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-47"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Dim x</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-48"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   For Each x In Array(&quot;Меню 2003&quot;, &quot;Стандартная 2003&quot;, &quot;Форматирование 2003&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-49"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">       Application.CommandBars(x).Delete</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-50"></a><span style=" font-size:8.25pt;"> </span><span style=" font-size:8.25pt;">   Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5a4ce8093e449807632407-51"></a><span style=" font-size:8.25pt;">E</span><span style=" font-size:8.25pt;">nd Sub</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Учитывайте, что созданная панель будет существовать даже после закрытия файла и даже после закрытия Excel.<br />Так же прилагаю файл, в котором можно нажатием кнопок создать меню и удалить. Для тех, кто незнаком с макросами: прежде чем попробовать создать меню с помощью выложенного здесь файла настоятельно рекомендую прочесть эту статью: </span><a href="http://www.excel-vba.ru/chto-umeet-excel/pochemu-ne-rabotaet-makros/"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Почему не работает макрос?</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Конечно, это не лучший вариант и если поискать в сети, то можно найти программы, которые так же воссоздают меню в стиле 2003, но почти все они платные.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Скачать пример: </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image27242.png" /><span style=" font-size:8.25pt;">  </span><a href="http://www.excel-vba.ru/download/64/"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">Tips_All_MakeMenu2003.xls</span></a><span style=" font-size:8.25pt;"> (61,5 KiB, 1 722 скачиваний)</span></p></body></html>