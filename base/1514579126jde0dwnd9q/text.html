<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, работать с csv очень просто:   <br />  <br /><span style=" color:#04056a;">Private Sub CSV_Parser()   <br />   Dim CN As ADODB.Connection, rs As ADODB.Recordset   <br />   Dim strcon As String, strsql As String   <br />   Dim dbfilePath As String, dbfile As String, x   <br />   Dim c(), d(), e(), n&amp;, i&amp;    <br />   Set CN = New ADODB.Connection   <br />   dbfilePath = &quot;C:\;&quot;   <br />   dbfile = &quot;parsed.csv&quot;   <br />   strcon = &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; dbfilePath &amp; &quot;Extended Properties=&quot;&quot;text;HDR=No;FMT=Delimited&quot;&quot;;&quot;   <br />   CN.Open strcon   <br />   strsql = &quot;SELECT TOP 1 * FROM &quot; &amp; dbfile ' здесь в начале находится число строк csv-файла, чтобы не перебирать построчно   <br />   Set rs = New ADODB.Recordset   <br />   rs.CursorType = adOpenForwardOnly   <br />   rs.LockType = adLockReadOnly   <br />   rs.PageSize = 10000   <br />   rs.Open strsql, CN   <br />   i = 1   <br />   n = rs.Fields(0).Value   <br />   ReDim c(1 To n, 1 To 1): ReDim d(1 To n, 1 To 1): ReDim e(1 To n, 1 To 1)   <br />   rs.Close   <br />   strsql = &quot;SELECT * FROM &quot; &amp; dbfile &amp; &quot; WHERE F3 IS NOT NULL Order by Val(F3)&quot;   <br />   rs.Open strsql, CN   <br />   i = 1   <br />   For i = 1 To n   <br />       c(i, 1) = rs.Fields(2).Value   <br />       d(i, 1) = rs.Fields(3).Value   <br />       e(i, 1) = rs.Fields(4).Value   <br />       rs.MoveNext   <br />   Next   <br />   rs.Close   <br />   Set rs = Nothing   <br />   Set CN = Nothing   <br />End Sub   </span><br />  <br />Дальше с массивами работается невероятно просто. 3 млн. строк импортируются за 3 секунды.</p></body></html>