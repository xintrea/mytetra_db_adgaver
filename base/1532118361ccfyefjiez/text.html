<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<div class="col-12" itemscope="" itemtype="http://schema.org/Question"><h1 itemprop="name">Outlook 2013 VBA: сохранить пользовательские настройки</h1><hr></div>
<div class="col-lg-9 col-md-12 col-sm-12">
<div class="row">
<div class="voteInfo col-1 d-none d-lg-block">
<span class="count">2<i class="fa fa-thumbs-up"></i></span>
<span class="count">434<i class="fa fa-eye"></i></span>
<span class="exchange"><i title="Показать оригинал" class="fa fa-language fa-3x"></i></span>
</div>
<div class="col-lg-11 col-md-12">
<div class="post-text" id="text_q8185037" itemprop="text"><p>В настоящее
 время в офисе у нас есть Outlook 2003. Мы перейдем на Outlook 2013.
В Outlook 2003 у нас есть командная строка, которая в качестве примера 
сохраняет почтовый элемент в указанной пользователем папке или 
перемещается пункт в нужную команду.
В пользовательской форме конечный пользователь может установить свои 
настройки в нужную папку или выбрать команду, в которой он сейчас 
находится. В этой форме настроек есть несколько полей ввода, которые 
пользователь может заполнить.
Всякий раз, когда он нажимает кнопку на CommandBar, прогноз проверяет 
свои параметры, чтобы увидеть на какой команде он находится, его 
желательные сохранить папки и т.д.
Это определяемые пользователем настройки хранятся и призвали на это теги
<code class="prettyprint-override prettyprinted" style=""><span class="pun">(</span><span class="typ">Application</span><span class="pun">.</span><span class="typ">ActiveExplorer</span><span class="pun">.</span><span class="typ">CommandBars</span><span class="pun">(</span><span class="str">"Toolbar"</span><span class="pun">).</span><span class="typ">Controls</span><span class="pun">.</span><span class="typ">Item</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">tag</span><span class="pun">)</span></code></p>
<p>As далеко я нашел в Интернете Outlook 2013 не поддерживает командные 
строки. Я могу установить commandBar, но как только вы перезапустите 
Outlook, панель исчезнет, ​​а настройки исчезнут.</p>
<p>Есть ли способ сохранить/сохранить настройки, сделанные конечным 
пользователем в пользовательской форме, чтобы сценарии сохраняли 
почтовый элемент на основе его настроек в правильной папке или команде?</p>
<p>Я попытался найти решение, но еще не нашел его или не знаю, где искать.</p>
<p>Надеюсь, вы можете направить меня в правильном направлении, чтобы найти решение.</p>
<p><em>(примечание:.. Я знаю немного VBA, может читать и писать, но было
 трудно объяснить, как это работает Если я оставил некоторую критическую
 информацию в этом вопросе, пожалуйста, дайте мне знать)</em></p></div>
<div class="post-info">
<div class="post-taglist"> <span class="post-tag">vba</span> <span class="post-tag">outlook</span></div>
<div class="post-meta row"><p class="text-secondary col-lg-6 col-md-6 col-sm-6 col-xs-12"><small><a rel="noopener" target="_blank" href="https://stackoverflow.com/q/29768451">Источник</a></small><small><a class="share-url" target="_blank" href="https://stackoverrun.com/ru/q/8185037">Поделиться</a></small></p><p class="text-secondary createDate col-lg-6 col-md-6 col-sm-6 col-xs-12"><small class="float-right">Создан <span title="2015-04-21 09:41:11">21 апр. 15</span> <a rel="noopener" target="_blank" href="https://stackoverflow.com/users/2754037/">Rob</a></small></p></div></div><div class="comments comments29768451"><div itemprop="comment" class="post-comment"><div class="row"><div class="col-1 d-none d-lg-block"><span class="text-secondary">0</span></div><div class="col-11"><p class="commenttext">я
 не использовал Outlook 2013, но я думаю, вы можете сохранить настройки,
 используя множество различных методов как на любом клиенте Windows, 
например, в реестре, в файле настроек (XML или другом) и т. д. Кроме 
того, новые продукты Office используют ленту вместо командной строки, 
см. «Настройка ленты для Outlook» в MSDN: https: // msdn. microsoft.com)
 /en-us/library/bb398246.aspx – <span class="text-secondary"><small><a rel="noopener" target="_blank" href="https://stackoverflow.com/users/1490783/">Olle Sjögren</a> <span title="2015-04-21 10:04:18">21 апр. 15</span></small></span></p></div></div></div></div></div><div class="col-12 sorting">
<ul class="nav nav-tabs small" role="tablist">
<li class="nav-item col-lg-3 col-md-3 col-sm-4 col-xs-12" id="answerCount"><h5>2 ответа</h5></li>
<li class="nav-item ml-auto" id="sort"><p class="nav-link disabled">Сортировка:</p></li>
<li class="nav-item" id="first"><span id="active" class="nav-link active" data-toggle="tab" role="tab">Активность</span></li>
<li class="nav-item"><span id="oldest" class="nav-link" data-toggle="tab" role="tab">Возраст</span></li>
<li class="nav-item"><span id="votes" class="nav-link" data-toggle="tab" role="tab">Оценка</span></li>
</ul></div><div class="answersList col-12"><div itemscope="" itemtype="http://schema.org/Answer" itemprop="acceptedAnswer" class="answer-block" id="29772308"><div class="row">
<div class="voteInfo col-1 d-none d-lg-block">
<span class="count">1<i class="fa fa-thumbs-up"></i></span>
<i class="fa fa-check fa-3x"></i>
<span class="exchange"><i title="Показать оригинал" class="fa fa-language fa-3x"></i></span>
</div>
<div class="col-lg-11 col-md-12">
<div itemprop="text" id="text_a29772308" class="post-text"><p>Outlook не
 позволяет настраивать интерфейс ленты с помощью VBA. Единственное, что 
вы можете сделать, это назначить макрос кнопке QAT (или добавить 
элементы управления вручную в Outlook).</p>
<p>Вам необходимо разработать надстройку, чтобы иметь возможность 
настраивать интерфейс ленты (например, свободный пользовательский 
интерфейс). См. <a href="https://msdn.microsoft.com/en-us/library/bb386104.aspx?f=255&amp;MSPPError=-2147217396" rel="nofollow">Walkthrough: Creating a Custom Tab by Using the Ribbon Designer</a> для получения дополнительной информации.</p>
<p>Подробнее о Fluent UI в следующей серии статей в MSDN:</p>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/aa338202%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396" rel="nofollow">Customizing the 2007 Office Fluent Ribbon for Developers (Part 1 of 3)</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/aa338199(v=office.12).aspx" rel="nofollow">Customizing the 2007 Office Fluent Ribbon for Developers (Part 2 of 3)</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/aa722523(v=office.12).aspx" rel="nofollow">Customizing the 2007 Office Fluent Ribbon for Developers (Part 3 of 3)</a></li>
</ul>
<blockquote>
<p>Есть ли способ, чтобы сохранить/магазин настройки, сделанные конечным
 пользователем в пользовательской форме, поэтому скрипты сохраняют 
почтовый элемент на основе его настройки gs в правильную папку или 
команду?</p>
</blockquote>
<p>Использование свойства Tag не является наилучшим способом сохранения 
пользовательских настроек. Конечно, вы можете использовать стандартные 
способы хранения настроек на ПК - файлы (XML, текст или собственный 
бинарный формат), реестр Windows и т. Д.</p>
<p>Но объектная модель Outlook предоставляет скрытые элементы для этого. Метод <a href="https://msdn.microsoft.com/en-us/library/office/ff869128.aspx" rel="nofollow">GetStorage</a> класса Folder возвращает объект <a href="https://msdn.microsoft.com/en-us/library/office/ff864182.aspx" rel="nofollow">StorageItem</a> в родительской папке для хранения данных для решения Outlook. См. <a href="https://msdn.microsoft.com/en-us/library/office/ff865327.aspx" rel="nofollow">Storing Data for Solutions</a> для получения дополнительной информации.</p></div>
<div class="post-info">
<div class="post-meta row"><p class="text-secondary col-lg-6 col-md-6 col-sm-6 col-xs-12"><small><a rel="noopener" target="_blank" href="https://stackoverflow.com/q/29772308">Источник</a></small><small><a class="share-url" target="_blank" href="https://stackoverrun.com/ru/q/8185037#29772308">Поделиться</a></small></p><p class="text-secondary createDate col-lg-6 col-md-6 col-sm-6 col-xs-12"><small class="float-right">Создан <span title="2015-04-21 12:31:07">21 апр 15</span> <a rel="noopener" target="_blank" href="https://stackoverflow.com/users/1603351/">Eugene Astafiev</a></small></p></div>
</div><div class="comments"><div itemprop="comment" class="post-comment"><div class="row"><div class="col-1 d-none d-lg-block"><span class="text-secondary">0</span></div><div class="col-11"><p class="commenttext">У
 меня нет Visual Studio, и из-за политик регистр заблокирован. Но метод 
GetStorage, кажется, является ответом для сохранения этих параметров.
Для ленты я думаю, что можно создать XML-файл, сохранить его на сетевом 
ресурсе и, возможно, с загрузочным событием загрузить этот XML-файл. Я 
займусь этим. Если я его заработаю, я отправлю свой код, чтобы другие 
могли его использовать. Спасибо вам за азерсеров. – <span class="text-secondary"><small><a rel="noopener" target="_blank" href="https://stackoverflow.com/users/2754037/">Rob</a> <span title="2015-04-23 07:13:27">23 апр. 15</span></small></span></p></div></div></div></div></div></div><hr></div><div itemscope="" itemtype="http://schema.org/Answer" class="answer-block" id="30305421"><div class="row">
<div class="voteInfo col-1 d-none d-lg-block">
<span class="count">1<i class="fa fa-thumbs-up"></i></span>
<span class="exchange"><i title="Показать оригинал" class="fa fa-language fa-3x"></i></span>
</div>
<div class="col-lg-11 col-md-12">
<div itemprop="text" id="text_a30305421" class="post-text"><p>Как и было
 обещано несколько примеров кода, которые я использовал для хранения и 
получения настроек.
Возможно, это не лучший способ сделать это, но он решил мою проблему, 
чтобы сохранить настройки и, возможно, это могло помочь кому-то другому.</p>
<p>Прежде всего, я сделал небольшую проверку, чтобы проверить, нет ли настроек.</p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="typ">Function</span><span class="pln"> </span><span class="typ">Hidden_Settings_Aanwezig</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oNs </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">Namespace</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oFL </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="pln">folder </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oItem </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">StorageItem</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">On</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="typ">GoTo</span><span class="pln"> OL_Error </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oNs </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Application</span><span class="pun">.</span><span class="typ">GetNamespace</span><span class="pun">(</span><span class="str">"MAPI"</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oFld </span><span class="pun">=</span><span class="pln"> oNs</span><span class="pun">.</span><span class="typ">GetDefaultFolder</span><span class="pun">(</span><span class="pln">olFolderInbox</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oItem </span><span class="pun">=</span><span class="pln"> oFld</span><span class="pun">.</span><span class="typ">GetStorage</span><span class="pun">(</span><span class="str">"Hidden Settings"</span><span class="pun">,</span><span class="pln"> olIdentifyBySubject</span><span class="pun">)</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">If</span><span class="pln"> oItem</span><span class="pun">.</span><span class="typ">Size</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Hidden_Settings_Aanwezig</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Else</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Hidden_Settings_Aanwezig</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OL_Error</span><span class="pun">:</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">MsgBox</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>Если нет, то следующий код создает параметры, основанные на tekstboxes и флажки на UserForm со следующим кодом</p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="typ">Function</span><span class="pln"> </span><span class="typ">Maak_Settings_Hidden</span><span class="pun">()</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oNs </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">Namespace</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oFld </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="pln">folder </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oSItem </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">StorageItem</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">On</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="typ">GoTo</span><span class="pln"> OL_Error </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oFld </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Application</span><span class="pun">.</span><span class="typ">Session</span><span class="pun">.</span><span class="typ">GetDefaultFolder</span><span class="pun">(</span><span class="pln">olFolderInbox</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oSItem </span><span class="pun">=</span><span class="pln"> oFld</span><span class="pun">.</span><span class="typ">GetStorage</span><span class="pun">(</span><span class="str">"Hidden Settings"</span><span class="pun">,</span><span class="pln"> olIdentifyBySubject</span><span class="pun">)</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="str">'repeat the next to lines for every setting you want to store </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">oSItem.UserProperties.Add "Export Folder", olText </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">oSItem.UserProperties("Export Folder").Value = TextBox1.Text </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">oSItem.Save </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Exit Function </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OL_Error: </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">MsgBox (Err.Description) </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Err.Clear </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">End Function </span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>функция выше, называется по следующему коду:</p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="typ">If</span><span class="pln"> </span><span class="typ">Hidden_Settings_Aanwezig</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">Get_Hidden_Settings_Startup</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Else</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Maak_Settings_Hidden</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"> </span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>Чтобы использовать один из параметров, я использую следующий код.
В основном к югу я использую следующую строку:</p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="typ">DestFolder</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Get_Hidden_Settings</span><span class="pun">(</span><span class="str">"Export Folder"</span><span class="pun">)</span><span class="pln"> </span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p>Для вызова на этой функции:</p>
<p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="typ">Function</span><span class="pln"> </span><span class="typ">Get_Hidden_Settings</span><span class="pun">(</span><span class="typ">Setting</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oNs </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">Namespace</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oFL </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="pln">folder </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Dim</span><span class="pln"> oItem </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Outlook</span><span class="pun">.</span><span class="typ">StorageItem</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">On</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="typ">GoTo</span><span class="pln"> OL_Error </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oNs </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Application</span><span class="pun">.</span><span class="typ">GetNamespace</span><span class="pun">(</span><span class="str">"MAPI"</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oFld </span><span class="pun">=</span><span class="pln"> oNs</span><span class="pun">.</span><span class="typ">GetDefaultFolder</span><span class="pun">(</span><span class="pln">olFolderInbox</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Set</span><span class="pln"> oItem </span><span class="pun">=</span><span class="pln"> oFld</span><span class="pun">.</span><span class="typ">GetStorage</span><span class="pun">(</span><span class="str">"Hidden Settings"</span><span class="pun">,</span><span class="pln"> olIdentifyBySubject</span><span class="pun">)</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">If</span><span class="pln"> oItem</span><span class="pun">.</span><span class="typ">Size</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    </span><span class="typ">Get_Hidden_Settings</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> oItem</span><span class="pun">.</span><span class="typ">UserProperties</span><span class="pun">(</span><span class="typ">Setting</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OL_Error</span><span class="pun">:</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">MsgBox</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">)</span><span class="pln"> </p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"> </p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></div></div></div></div></div></div></div>
</body>
</html></p></body></html>