<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h3 id="linked-servers" class="heading-with-anchor"><span data-ttu-id="f7d66-153" translation="Linked servers">Связанные серверы</span><a class="docon docon-link heading-anchor" tabindex="-1" aria-hidden="true" href="https://docs.microsoft.com/ru-ru/sql/relational-databases/import-export/import-data-from-excel-to-sql?view=sql-server-2017#linked-servers"></a></h3>
<p><span data-ttu-id="f7d66-154" translation="You can also configure a persistent connection to the Excel file as a linked server.">Кроме того, можно настроить постоянное подключение к файлу Excel как к <em>связанному серверу</em>.</span> <span data-ttu-id="f7d66-155" translation="The following example imports the data from the Data worksheet on the existing Excel linked server EXCELLINK into a new database table named Data_ls.">В примере ниже данные импортируются из листа Excel <code>Data</code> на существующем связанном сервере Excel <code>EXCELLINK</code> в новую таблицу базы данных с именем <code>Data_ls</code>.</span></p>
<div class="codeHeader" data-bi-name="code-header"><span class="language">SQL</span>
			</div><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">USE</span> ImportFromExcel;</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">GO</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">INTO</span> Data_ls <span class="hljs-keyword">FROM</span> EXCELLINK...[<span class="hljs-keyword">Data</span>$];</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">GO</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p><span data-ttu-id="f7d66-156" translation="You can create a linked server from SQL Server Management Studio, or by running the system stored procedure sp_addlinkedserver, as shown in the following example.">Вы можете создать связанный сервер в SQL Server Management Studio или запустить системную хранимую процедуру <code>sp_addlinkedserver</code>, как показано в примере ниже.</span></p>
<div class="codeHeader" data-bi-name="code-header"><span class="language">SQL</span>
			</div><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @RC <span class="hljs-built_in">int</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @<span class="hljs-keyword">server</span>     <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @srvproduct <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @provider   <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @datasrc    <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">4000</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @location   <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">4000</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @provstr    <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">4000</span>)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">DECLARE</span> @<span class="hljs-keyword">catalog</span>    <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>)</p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-comment">-- Set parameter values</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SET</span> @<span class="hljs-keyword">server</span> =     <span class="hljs-string">'EXCELLINK'</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SET</span> @srvproduct = <span class="hljs-string">'Excel'</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SET</span> @provider =   <span class="hljs-string">'Microsoft.ACE.OLEDB.12.0'</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SET</span> @datasrc =    <span class="hljs-string">'D:\Desktop\Data.xlsx'</span></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span class="hljs-keyword">SET</span> @provstr =    <span class="hljs-string">'Excel 12.0'</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">EXEC @RC = [<span class="hljs-keyword">master</span>].[dbo].[sp_addlinkedserver] @<span class="hljs-keyword">server</span>, @srvproduct, @provider,</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">@datasrc, @location, @provstr, @<span class="hljs-keyword">catalog</span></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p><span data-ttu-id="f7d66-157" translation="For more info about linked servers, see the following topics:">Дополнительные сведения о связанных серверах см. в указанных ниже разделах.</span></p>
<ul>
<li><a href="https://docs.microsoft.com/ru-ru/sql/relational-databases/linked-servers/create-linked-servers-sql-server-database-engine?view=sql-server-2017" data-linktype="relative-path"><span data-ttu-id="f7d66-158" translation="Create Linked Servers">Создание связанных серверов</span></a></li>
<li><a href="https://docs.microsoft.com/ru-ru/sql/t-sql/functions/openquery-transact-sql?view=sql-server-2017" data-linktype="relative-path"><span data-ttu-id="f7d66-159" translation="OPENQUERY">OPENQUERY</span></a></li>
</ul>
<p><span data-ttu-id="f7d66-160" translation="For more examples and info about both linked servers and distributed queries, see the following topics:">Примеры и дополнительные сведения о связанных серверах и распределенных запросах см. указанных ниже разделах.</span></p>
<ul>
<li><a href="https://support.microsoft.com/help/306397/how-to-use-excel-with-sql-server-linked-servers-and-distributed-queries" data-linktype="external"><span data-ttu-id="f7d66-161" translation="How to use Excel with SQL Server linked servers and distributed queries">Использование Excel со связанными серверами SQL Server и распределенными запросами</span></a></li>
<li class=""><a href="https://support.microsoft.com/help/321686/how-to-import-data-from-excel-to-sql-server" data-linktype="external"><span data-ttu-id="f7d66-162" translation="How to import data from Excel to SQL Server">Импорт данных из Excel в SQL Server</span></a></li></ul>
</body>
</html></p></body></html>