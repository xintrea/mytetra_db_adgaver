<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h1><a> 3.9.3 Строковые функции</a></h1>
      <p><em><strong>Строковые функции VBA, Asc(), Chr(), InStr(), Len(), LCase(), U</strong></em><em><strong>Case(), Replace(), Trim() </strong></em></p>
      <p>Это — наиболее часто используемые функции. Требуются они постоянно, и знать их необходимо очень хорошо.</p>
      <ul>
        <li><em>ASC()</em> — эта функция позволяет вернуть числовой код 
для переданного символа. Например, ASC("D") вернет 68. Эту функцию 
удобно использовать для того, чтобы определить следующую или предыдущую 
букву. Обычно она используется вместе с функцией Chr(), которая 
производит обратную операцию — возвращает символ по переданному его 
числовому коду. Например, такой код в Excel позволяет написать в ячейки с
 A1 по A20 последовательно буквы русского алфавита от A до У:</li>
      </ul>
      <p class="style7"> Dim n, nCharCode As Integer</p>
      <p><em> n = 1</em></p>
      <p><em> nCharCode = Asc("А")</em></p>
      <p><em> Do While n &lt;= 20</em></p>
      <p><em> ActiveWorkbook.ActiveSheet.Range("A" &amp; n).Value = Chr(nCharCode)</em></p>
      <p><em> n = n + 1</em></p>
      <p><em> nCharCode = nCharCode + 1</em></p>
      <p><em> Loop</em></p>
      <p>Варианты этой функции  — <em>AscB()</em> и <em> AscW()</em> . AscB() возвращает только первый байт числового кода для символа, а AscW() возвращает код для символа в кодировке Unicode.</p>
      <ul>
        <li><em>Chr()</em> — очень важная функция. Возвращает символ по 
его числовому коду. Помимо того, что используется в паре с функцией 
Asc() (см. пример по этой функции), без нее не обойтись еще в одной 
ситуации: когда нужно вывести служебный символ. Например, нам нужно 
напечатать в Word значение "Газпром" (в кавычках). Кавычка — это 
служебный символ, и попытка использовать строку вида</li>
      </ul>
      <p><em> Selection.Text = ""Газпром"" </em></p>
      <p>сразу приведет к синтаксической ошибке. А вот так все будет в порядке:</p>
      <p><em> Selection.Text = Chr(34) &amp; "Газпром" &amp; Chr(34)</em></p>
      <p>есть варианты этой функции — <em>ChrB()</em> и <em>ChrW()</em>. Работают аналогично таким же вариантам для функции Asc().</p>
      <ul>
        <li><em>InStr()</em> и <em>InStrRev()</em> — одна из самых 
популярных функций. Позволяет обнаружить в теле строковой переменной 
последовательность символов и вернуть ее позицию. Если 
последовательность не обнаружена, то возвращается 0.</li>
        <li><em>Left()</em>, <em>Right()</em>, <em>Mid()</em> — 
возможность взять указанное вами количество символов из существующей 
строковой переменной слева, справа или из середины соответственно.</li>
        <li><em>Len()</em> — возможность получить число символов в строке. Часто используется с циклами, операциями замены и т.п.</li>
        <li><em>LCase()</em> и <em>UCase()</em> — перевести строку в 
нижний и верхний регистры соответственно. Часто используется для 
подготовки значения к сравнению, когда при сравнении регистр не важен 
(фамилии, названия фирм, городов и т.п.).</li>
        <li><em>LSet()</em> и <em>RSet()</em> — возможность заполнить 
одну переменную символами другой без изменения ее длины (соответственно 
слева и справа). Лишние символы обрезаются, на место недостающих 
подставляются пробелы.</li>
        <li><em>LTrim()</em>, <em>RTrim()</em>, <em>Trim()</em> — возможность убрать пробелы соответственно слева, справа или и слева, и справа.</li>
        <li><em>Replace()</em> — возможность заменить в строке одну последовательность символов на другую.</li>
        <li><em>Space()</em> — получить строку из указанного вами 
количества пробелов; String() — получить строку из указанного вами 
количества символов (которые опять-таки указываются вами). Обычно 
используются для форматирования вывода совместно с функцией Len(). Еще 
одна похожая функция — <em>Spc()</em>, которая используется для форматирования вывода на консоль. Она размножает пробелы с учетом ширины командной строки.</li>
        <li><em>StrComp()</em> — возможность сравнить две строки.</li>
        <li><em>StrConv()</em> — возможность преобразовать строку (в 
Unicode и обратно, в верхний и нижний регистр, сделать первую букву слов
 заглавной и т.п.).</li>
        <li><em>StrReverse()</em> — "перевернуть" строку, разместив ее символы в обратном порядке.</li>
        <li><em>Tab()</em> — еще одна функция, которая используется для 
форматирования вывода на консоль. Размножает символы табуляции в том 
количестве, в котором вы укажете. Если никакое количество не указано, 
просто вставляет символ табуляции. Для вставки символа табуляции в 
строковое значение можно также использовать константу vbTab.</li>
      </ul>
</body>
</html></p></body></html>