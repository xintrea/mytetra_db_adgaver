<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Протестировал по скорости варианты для текстового файла «Карты» 1000000 строк, на листе «ФИО» 500000: <br />1. Текстовый, чтение разбиение по vbCrLf, запись значения «ID Клиента» и индекса строки данных в массиве в словарь, чтение в массив «ID Клиента» с листа «ФИО» и поиск по словарю для определения есть карта, нет карты с записью результата в массив и сохранение на лист, заняло 110 секунд. <br />2. Результат на новый лист как ADO-запрос к листу «ФИО» и текстовому файлу «Карты» около 75 секунд. <br />3. Результат на новый лист как ADO-запрос к листу «ФИО» и таблице в базе Access около 68 секунд. Стоит учесть, что загрузка данных из текстового файла «Карты» в таблицу Access требует около 30 секунд. <br />4. Если бы данные с листа «ФИО» были бы тоже таблицей Access, то запись результата на новый лист около 15 секунд. <br />5. Если база и таблица «ФИО» в базе SQLite, то около 7 секунд, правда, загрузка данных в базу около 120 секунд. <br />В общем получается самый выгодный вариант №2. <br />Хотя не совсем понятны такие моменты. Связь листа ФИО всегда предполагается с новыми текстовыми файлами или задача грузить их в базу данных предполагает добавление не существующих в ней данных?</p></body></html>