<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<table id="tblPlaceArt" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td colspan="2" align="center"><span id="lbArtHeader" class="ArtHeader">Программное скрытие/восстановление и сворачивание/разворачивание ленты Ribbon (Access 2010 и выше).</span></td>
									</tr>
									<tr>
										<td colspan="2" align="center">
											<p>
												<span id="lbArtObr" class="ArtObr">(обращений: <b>160</b> с 16.06.2017)</span><br>
												<br>
												<span id="lbIssueListH">Разделы:</span> 
												<span id="lbIssueList"><a href="http://am.rusimport.ru/MsAccess/content.aspx?id=20">Полезные функции</a>, <a href="http://am.rusimport.ru/MsAccess/content.aspx?id=23">ЧаВо (FAQ)</a></span></p>
											<p> </p>
										</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbBody"><p><span class="ArtPartHead">Описание: </span>Из названия всё ясно. Для начинающих.</p><p><span class="ArtPartHead">Автор: </span><a href="mailto:banderlogi@bk.ru">Дмитрий Сонных  (AKA Joss)</a>   </p><p><span class="ArtPartHead">Добавил на сайт: </span> <a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="1.png" width="16" border="0"></a><a href="mailto:banderlogi@bk.ru">Joss</a>  16.06.2017</p>Начиная с версии 2007 в Офисе вместо старого меню появилась так называемая "Лента" (<b>Ribbon</b>). Следовательно появились и новые команды для управления этими "Лентами".<br><b><br>Программно скрыть/восстановить ленту.</b><br>Бывает необходимо, чтобы запретить пользователям "лишние" действия.<br>Скрывается Ribbon командой <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   DoCmd.ShowToolbar <font color="blue">"Ribbon"</font>, acToolbarNo</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> а восстанавливается <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   DoCmd.ShowToolbar <font color="blue">"Ribbon"</font>, acToolbarYes </p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>Команды можно оформить подпрограммами или функциями. <br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Sub</font> HideRibbon()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">DoCmd.ShowToolbar <font color="blue">"Ribbon"</font>, acToolbarNo</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Sub</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Sub</font> ShowRibbon()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">DoCmd.ShowToolbar <font color="blue">"Ribbon"</font>, acToolbarYes</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Sub</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Эти команды работают так же в Access (и Офисе) 2007.<br><br><b>Свернуть/развернуть ленту.</b><br>Делается
 для того, чтобы освободить больше места под полезную информацию. В 
отличии от первого случая, пользователь всегда может свернуть/развернуть
 ленту, нажав на стрелочку, находящуюся рядом со знаком вопроса в правой
 части строки меню.<br>Команда для смены состояния ленты всего одна <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   CommandBars.ExecuteMso <font color="blue">"MinimizeRibbon"</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
 и работает она как триггер, поочерёдно разворачивая и сворачивая ленту.
 Так, что если Вам надо свернуть ленту, то сначала надо проверить её 
состояние. Проверить состояние ленты можно запрашивая её размер. Вот так<br><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   <font color="darkblue">If</font> CommandBars(<font color="blue">"Ribbon"</font>).Height &gt; 100 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      CommandBars.ExecuteMso <font color="blue">"MinimizeRibbon"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">      DoEvents</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Эта команда работает только в Access начиная с версии 2010. В 2007 аксе выдает ошибку <i>Runtime eroor #5</i>. По-этому я и включил упоминания об этой версии в заголовок статьи.<br>Свернуть/развернуть ленту можно нажав на клавиатуре комбинацию клавиш <b>Ctrl + F1</b> или программно эмулировав нажатие командой <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">   SendKeys (<font color="blue">"^{F1}"</font>) <font color="green">' Ctrl + F1</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Но при этом может меняться состояние NumLock, что не хорошо.<br><br><b>Примечание.</b><br>Команда <b>CommandBars.ExecuteMso</b>
 работает только начиная с версии 2010. Но многие до сих пор пользуются 
версией 2003, где эта команда не обрабатывается и выдаётся сообщение об 
ошибке. Обойти это можно использовав операторы условной компиляции. В 
версии 2010 и выше используется VBA7. Так что я доработал код следующим 
образом <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> DbRibbonMinimize()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">#<font color="darkblue">If</font> vba7 <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">If</font> <font color="darkblue">Not</font> RibbonState() <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Application.Echo <font color="darkblue">False</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        CommandBars.ExecuteMso <font color="blue">"MinimizeRibbon"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">        Application.Echo <font color="darkblue">True</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    <font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">#<font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> RibbonState() <font color="darkblue">As</font> <font color="darkblue">Boolean</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="green">'Result: 0=normal, -1=autohide</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"></font>    RibbonState = (CommandBars(<font color="blue">"Ribbon"</font>).Controls(1).Height &lt; 100)</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> Такая программа прекрасно компилируется как в Access 2003, так и в Access 2010.<br><br>Использованы материалы с сайта SQL.RU<br><a href="http://www.sql.ru/forum/1249824/kak-programmno-svernut-razvernut-lentu-access-2007-i-vyshe">http://www.sql.ru/forum/1249824/kak-programmno-svernut-razvernut-lentu-access-2007-i-vyshe</a><br><a href="http://www.sql.ru/forum/862643/programmno-skryt-lentu-menu-ribbon">http://www.sql.ru/forum/862643/programmno-skryt-lentu-menu-ribbon</a><br>а так же<br><a href="http://www.accessribbon.de/en/index.php?FAQ:19">http://www.accessribbon.de/en/index.php?FAQ:19</a><p><a href="javascript:history.back(1)">[Back]</a></p><br></span>
											</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											
<table class="Rating" id="tblPlace" width="100%" cellspacing="0" cellpadding="0" border="0">
	<tbody><tr>
		<td style="WIDTH: 30%" valign="top"><span id="Rating1_lbBar">Текущий рейтинг:<br>0 из 5 (проголосовало:0).<br><img src="2.png"></span></td>
		<td valign="top">
			<table id="Rating1_pnlLogin" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<span id="Rating1_lbNoUser">Здравствуйте!<br>Для участия в рейтинге необходимо залогиниться на сайт.<br>Это
 сделано для того, чтобы более точно производить оценку статей (чтобы 
одному и тому же человеку было труднее голосовать несколько раз, портя 
тем самым статистику.<br>
Эта процедура очень быстрая и, надеюсь, Вас не затруднит :).<br>
Все мысли по поводу работы сайта всегда можно высказать на <a href="http://am.rusimport.ru/MsAccess/f.aspx?type=2">форуме</a>!<br>
</span>
				<a id="Rating1_lnkLogin" href="http://am.rusimport.ru/MsAccess/login.aspx?ReturnURL=topic.aspx?id=805">Вход на сайт</a>
			
	</td></tr></tbody></table>
			</td>
	</tr>
</tbody></table>
</td>
									</tr>
									<tr>
										<td colspan="2" align="left">
											<span id="lbComment"><br><table class="ArtCommentHead" width="100%"><tbody><tr><td><a name="comments" class="ArtCommentHead">Обсуждение статьи:</a>  <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=0&amp;topic=805" target="blank"><img src="3.png" title="Добавить комментарий" width="16" border="0"></a> <a href="javascript:Subscribe(-2,805)"><img src="4.png" title="Подписаться на комментарии к этой теме" <="" a="" width="16" border="0"></a></td></tr></tbody></table></span></td>
									</tr>
									<tr>
										<td colspan="2" align="left"></td>
									</tr>
								</tbody></table>
							

<table id="Table1" width="100%" cellspacing="0" cellpadding="0" bordercolor="#CACACA" border="1">
	<tbody><tr>
		<td>
			<table id="_ctl0_pnlHead" width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>
		
				<table id="tblHead" width="100%" cellspacing="0" cellpadding="0" bordercolor="#000000" border="0">
					<tbody><tr bgcolor="#CACACA">
						<td style="WIDTH: 70%"><a name="68125"></a><a class="ml" href="http://am.rusimport.ru/MsAccess/topic.aspx?id=805"><img src="5.png" width="16" height="16" border="0">Сворачивание ленты без использования условной компиляции</a></td>
						<td align="right"><a href="http://am.rusimport.ru/MsAccess/profile.aspx?id=110"><img alt="Профиль пользователя" src="6.png" width="16" border="0"></a><a class="" href="mailto:banderlogi@bk.ru">Joss</a></td>
						<td style="WIDTH: 15%" align="right"><a href="javascript:MarkAsUnread(68125)"><img src="7.png" title="Пометить сообщение как непрочитанное" width="16" border="0"></a> <a href="http://am.rusimport.ru/MsAccess/postMSG.aspx?type=-2&amp;parent=68125&amp;topic=805" target="blank"><img src="8.png" title="Ответить" width="16" border="0"></a> </td>
					</tr>
				</tbody></table>
			
	</td></tr></tbody></table>
		</td>
	</tr>
	<tr bgcolor="#eeeeee">
		<td>Если Вы не хотите использовать условную компиляцию, то можете воспользоваться предложением пользователя <b>Akina</b> с сайта SQL.RU<br><br><i>Переместите код минимизации в процедуру. Вместо условной компиляции примените обращение к этой процедуре по условию.</i> <p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Function</font> DbRibbonMinimize() <font color="darkblue">As</font> <font color="darkblue">Boolean</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">If</font> Val(SysCmd(acSysCmdAccessVer)) &gt; 12 <font color="darkblue">Then</font> <font color="darkblue">Call</font> PerformMinimize</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; background-color:#eff0f1; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">Private</font> <font color="darkblue">Function</font> PerformMinimize()</p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">If</font> <font color="darkblue">Not</font> RibbonState() <font color="darkblue">Then</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Application.Echo <font color="darkblue">False</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    CommandBars.ExecuteMso <font color="blue">"MinimizeRibbon"</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">    Application.Echo <font color="darkblue">True</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">If</font></p><p style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><font color="darkblue">End</font> <font color="darkblue">Function</font></p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; font-size:10px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p> <i>Компиляция
 процедуры, конечно, выполняется, но вот проверка существования метода 
CommandBars.ExecuteMso выполняется только в момент обращения к 
процедуре. Соответственно если версия Access не знает про этот метод, то
 условие в DbRibbonMinimize не вызывает процедуру, и ошибки не будет.</i><br><br>Взято здесь <a href="http://www.sql.ru/forum/1262455/kompilyaciya-koda-v-zavisimosti-ot-versii-access">http://www.sql.ru/forum/1262455/kompilyaciya-koda-v-zavisimosti-ot-versii-access</a></td>
	</tr>
	
	<tr bgcolor="#eeeeee">
		<td><font size="1">13.06.2017 11:14</font></td></tr></tbody></table>
</body>
</html></p></body></html>