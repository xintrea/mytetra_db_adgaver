<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:xx-large; font-weight:600;">Передача данных из набора записей ADO в Excel средствами автоматизации</span><span style=" font-family:'DejaVu Sans';">                                                </span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> </span>&quot;Примечание. При использовании метода CopyFromRecordset следует иметь в виду, что используемые наборы записей ADO и DAO не могут содержать поля объектов OLE или массивы данных, такие как иерархические наборы записей. Если в наборе записей имеются поля таких типов, при вызове метода CopyFromRecordset произойдет сбой и появится следующее сообщение об ошибке: &quot;   <br />  <br /><a href="http://support.microsoft.com/kb/246335/ru"><span style=" text-decoration: underline; color:#0000ff;">http://support.microsoft.com/kb/246335/ru</span></a>   <span style=" font-family:'DejaVu Sans';">                                                                       </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">            </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:x-large; font-weight:600;">Аннотация </span><span style=" font-family:'DejaVu Sans';">        </span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">            </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Передать содержимое набора записей ADO в лист Microsoft Excel можно средствами автоматизации Excel. Конкретный подход зависит от автоматизируемой версии Excel. В Excel 97, Excel 2000 и Excel 2002 имеется метод CopyFromRecordset, который можно использовать для передачи данных из набора записей в диапазон ячеек. Метод CopyFromRecordset в Excel 2000 и 2002 можно использовать для копирования наборов записей как DAO, так и ADO. Однако метод CopyFromRecordset в Excel 97 поддерживает только наборы записей DAO. Для передачи данных из набора записей ADO в Excel 97 можно создать на основе набора записей массив, а затем заполнить диапазон ячеек содержимым этого массива.<br /><br /> В данной статье описаны оба подхода. Приведенный в статье образец кода иллюстрирует способ передачи данных из набора записей ADO в Excel 97, Excel 2000, Excel 2002, Excel 2003 или Excel 2007.                         </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:x-large; font-weight:600;">Дополнительная информация</span><span style=" font-family:'DejaVu Sans';">        </span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">            </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> В приведенном ниже примере кода показано, как скопировать содержимое набора записей ADO в лист Microsoft Excel средствами автоматизации языка Microsoft Visual Basic. В коде сначала проверяется версия Excel. Если определяется версия Excel 2000 или 2002, используется метод CopyFromRecordset, поскольку он работает эффективно и требует меньшего объема кода. Однако если определяется версия Excel 97 или более ранняя версия, набор записей сначала копируется в массив с помощью метода GetRows объекта набора записей ADO. Этот массив затем транспонируется таким образом, что записи располагаются в его первой размерности (в строках), а поля — во второй (в столбцах). Затем массив копируется в лист Excel путем присвоения массива диапазону ячеек. (Массив копируется за одно действие, а не в цикле по всем ячейкам листа.)<br /><br /> В образце кода используется база данных &quot;Борей&quot; (Northwind), поставляемая с Microsoft Office. Если при установке Microsoft Office была выбрана папка по умолчанию, то эта база данных находится в следующей папке:<br /><br /> \Program Files\Microsoft Office\Office\Samples\Northwind.mdb <br /><br /> Если база данных &quot;Борей&quot; находится в другой папке, необходимо изменить путь к папке в приведенном ниже коде.<br /><br /> Если база данных &quot;Борей&quot; не установлена на компьютере, ее можно установить с помощью функции добавления и удаления компонентов программы установки Microsoft Office. <br /><br />Примечание. База данных &quot;Борей&quot; не устанавливается при установке выпуска 2007 системы Microsoft Office. Чтобы загрузить базу данных &quot;Борей 2007&quot;, перейдите на следующий веб-узел Майкрософт: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-1"></a><a href="http://office.microsoft.com/ru-ru/templates/tc012289971049.aspx"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">h</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">ttp://office.microsoft.com/ru-ru/templates/TC012289971049.aspx</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> (на английском языке) </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:large; font-weight:600;">Действия по созданию примера</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запустите Visual Basic и создайте проект Standard EXE. По умолчанию будет создана форма Form1.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавьте в форму Form1 элемент управления CommandButton.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выберите в меню Project (проект) пункт References (ссылки). Добавьте ссылку на библиотеку объектов Microsoft ActiveX Data Objects 2.1 Library.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставьте в раздел кода формы Form1 приведенный ниже код.</li>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1;">Private Sub Command1_Click()</span><span style=" font-family:'Courier New,Courier,sans-serif';"><br />    Dim cnt As New ADODB.Connection<br />    Dim rst As New ADODB.Recordset<br />    <br />    Dim xlApp As Object<br />    Dim xlWb As Object<br />    Dim xlWs As Object<br /><br />    <br />    Dim recArray As Variant<br />    <br />    Dim strDB As String<br />    Dim fldCount As Integer<br />    Dim recCount As Long<br />    Dim iCol As Integer<br />    Dim iRow As Integer<br />    <br />    ' Присвоить строке путь к базе данных &quot;Борей&quot;<br />    strDB =&quot;c:\program files\Microsoft office\office11\samples\Northwind.mdb&quot;<br />  <br />    ' Открыть подключение к базе данных<br />    cnt.Open &quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot; &amp; _<br />        &quot;Data Source=&quot; &amp; strDB &amp; &quot;;&quot;<br />    <br />    ''При использовании базы данных &quot;Борей&quot; для Access 2007<br />    ''закомментируйте предыдущий код и раскомментируйте приведенный ниже код.<br />    'cnt.Open &quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; &amp; _<br />    '    &quot;Data Source=&quot; &amp; strDB &amp; &quot;;&quot;<br />        <br />    ' Открыть набор записей на основе таблицы Orders (заказы)<br />    rst.Open &quot;Select * From Orders&quot;, cnt<br />    <br />    ' Создать экземпляр Excel и добавить книгу<br />    Set xlApp = CreateObject(&quot;Excel.Application&quot;)<br />    Set xlWb = xlApp.Workbooks.Add<br />    Set xlWs = xlWb.Worksheets(&quot;Sheet1&quot;)<br />  <br />    ' Вывести Excel на экран позволить пользователю управлять временем работы Excel<br />    xlApp.Visible = True<br />    xlApp.UserControl = True<br />    <br />    ' Скопировать имена полей в первую строку листа<br />    fldCount = rst.Fields.Count<br />    For iCol = 1 To fldCount<br />        xlWs.Cells(1, iCol).Value = rst.Fields(iCol - 1).Name<br />    Next<br />        <br />    ' Проверить версию Excel<br />    If Val(Mid(xlApp.Version, 1, InStr(1, xlApp.Version, &quot;.&quot;) - 1)) &gt; 8 Then<br />        'EXCEL 2000,2002,2003 или 2007: используется метод CopyFromRecordset<br />         <br />        ' Скопировать набор записей на лист, начиная с ячейки A2<br />        xlWs.Cells(2, 1).CopyFromRecordset rst<br />        'Примечание. При использовании метода CopyFromRecordset произойдет сбой, если набор записей<br />        'содержит поле объекта OLE или массив данных, таких как<br />        'иерархические наборы записей<br />        <br />    Else<br />        'EXCEL 97 или более ранней версии: Будет использоваться метод GetRows, а затем массив будет скопирован в Excel<br />    <br />        ' Скопировать набор данных в массив<br />        recArray = rst.GetRows<br />        'Примечание. Метод GetRows возвращает массив, индексируемый с 0, первая<br />        'размерность которого содержит поля, а вторая<br />        'содержит записи. Массив будет транспонирован таким образом, чтобы<br />        'первая размерность содержала записи, обеспечивая<br />        'правильное отображение данных при копировании в Excel<br />        <br />        ' Определить количество строк<br /><br />        recCount = UBound(recArray, 2) + 1 '+ 1, поскольку массив индексируется с 0<br />        <br /><br />        ' Проверить массив на наличие недопустимого содержимого при<br />        ' копировании массива в лист Excel<br />        For iCol = 0 To fldCount - 1<br />            For iRow = 0 To recCount - 1<br />                ' Обработка полей Date (дата)<br />                If IsDate(recArray(iCol, iRow)) Then<br />                    recArray(iCol, iRow) = Format(recArray(iCol, iRow))<br />                ' Обработка полей объектов OLE или полей массивов<br />                ElseIf IsArray(recArray(iCol, iRow)) Then<br />                    recArray(iCol, iRow) = &quot;Array Field&quot;<br />                End If<br />            Next iRow 'следующая запись<br />        Next iCol 'следующее поле<br />            <br />        ' Транспонировать и скопировать массив в лист,<br />        ' начиная с ячейки A2<br />        xlWs.Cells(2, 1).Resize(recCount, fldCount).Value = _<br />            TransposeDim(recArray)<br />    End If<br /><br />    ' Автоматически подобрать ширину столбцов и высоту строк<br />    xlApp.Selection.CurrentRegion.Columns.AutoFit<br />    xlApp.Selection.CurrentRegion.Rows.AutoFit<br /><br />    ' Закрыть объекты ADO<br />    rst.Close<br />    cnt.Close<br />    Set rst = Nothing<br />    Set cnt = Nothing<br />    <br />    ' Освободить ссылки на Excel<br />    Set xlWs = Nothing<br />    Set xlWb = Nothing<br /><br />    Set xlApp = Nothing<br /><br />End Sub<br /><br /><br />Function TransposeDim(v As Variant) As Variant<br />' Пользовательская функция для транспонирования массива, индексируемого с 0 (v)<br />    <br />    Dim X As Long, Y As Long, Xupper As Long, Yupper As Long<br />    Dim tempArray As Variant<br />    <br />    Xupper = UBound(v, 2)<br />    Yupper = UBound(v, 1)<br />    <br />    ReDim tempArray(Xupper, Yupper)<br />    For X = 0 To Xupper<br />        For Y = 0 To Yupper<br />            tempArray(X, Y) = v(Y, X)<br />        Next Y<br />    Next X<br />    <br />    TransposeDim = tempArray<br /><br /><br />End Function<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10px;"><br /></p>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для выполнения проекта нажмите клавишу F5. Появится форма Form1.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажмите в форме Form1 кнопку CommandButton и обратите внимание на содержимое таблицы Orders (заказы), появившееся в новой книге Excel.</li></ol>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Использование метода CopyFromRecordset<br /><br /> Рекомендуется использовать метод CopyFromRecordset благодаря его высокой эффективности и производительности. Поскольку метод CopyFromRecordset в Excel 97 поддерживает только наборы записей DAO, при попытке передать методу CopyFromRecordset в Excel 97 набор записей ADO появится следующее сообщение об ошибке: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Run-time error 430: <br /> Class does not support Automation or does not support expected interface (Ошибка времени выполнения 430: класс не поддерживает автоматизацию либо не поддерживает соответствующий интерфейс) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> В данном примере кода этой ошибки можно избежать путем проверки версии Excel, чтобы не использовать метод CopyFromRecordset для версии Excel 97.<br /><br />Примечание. При использовании метода CopyFromRecordset следует иметь в виду, что используемые наборы записей ADO и DAO не могут содержать поля объектов OLE или массивы данных, такие как иерархические наборы записей. Если в наборе записей имеются поля таких типов, при вызове метода CopyFromRecordset произойдет сбой и появится следующее сообщение об ошибке:<br /> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Run-time error -2147467259:<br /> Method CopyFromRecordset of object Range failed (Ошибка времени выполнения -2147467259: сбой метода CopyFromRecordset объекта Range). </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Использование метода GetRows<br /><br /> Если обнаружена версия Excel 97, для копирования набора записей в массив используется метод GetRows набора записей ADO. Если присвоить диапазону ячеек в листе значение массива, возвращенного методом GetRows, данные будут выведены по столбцам, а не по строкам. Например, если набор записей состоит из двух полей и десяти строк, массив будет состоять из двух строк и десяти столбцов. Следовательно, перед присвоением значения массива диапазону ячеек массив необходимо транспонировать с помощью функции TransposeDim(). При присвоении значения массива диапазону ячеек имеется ряд ограничений, которые следует иметь в виду.<br /><br /> Указанные ниже ограничения применяются при присвоении значения массива объекту Range (диапазон) Excel.<br /></span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Массив не может содержать поля объектов OLE или массивы данных, такие как иерархические наборы записей. Обратите внимание на то, что в примере кода это условие проверяется, а в случае обнаружения подобного поля выводится сообщение &quot;Array Field&quot; (поле массива), чтобы уведомить пользователя о невозможности отобразить поле в Excel.<br /><br /></li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Массив не может содержать поля типа Date (дата), в которых установлена дата до 1900 г. (Ссылку на соответствующую статью базы знаний Майкрософт см. в разделе &quot;Ссылки&quot;.) Отметим, что для обхода этой проблемы в данном примере поля типа Date форматируются как строки типа &quot;Variant&quot;.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Перед копированием массива в лист Excel массив транспонируется с помощью функции TransposeDim(). Вместо создания собственной функции для транспонирования массива можно воспользоваться встроенной функцией Excel Transpose, изменив код таким образом, чтобы присвоить массив диапазону ячеек, как показано ниже. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eff0f1;"><span style=" font-family:'Courier New,Courier,sans-serif'; background-color:#eff0f1;">   xlWs.Cells(2, 1).Resize(recCount, fldCount).Value = _</span><span style=" font-family:'Courier New,Courier,sans-serif';"><br />      xlApp.WorksheetFunction.Transpose(recArray)<br /></span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu Sans'; font-size:10px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Если для транспонирования массива вместо функции TransposeDim() будет использоваться метод Excel Transpose, следует учитывать ограничения, накладываемые на метод Transpose. <br /> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu Sans';" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Массив не может содержать элементов, длина которых превышает 255 знаков.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Массив не может содержать пустые (Null) значения.</li>
<li style=" font-family:'DejaVu Sans';" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Количество элементов не может превышать 5461.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Если при копировании массива в лист Excel не принять во внимание приведенные выше ограничения, может возникнуть одна из указанных ниже ошибок времени выполнения. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Ошибка времени выполнения 13: несоответствие типов<br /> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Ошибка времени выполнения 5: недопустимый аргумент или вызов процедуры </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> Ошибка времени выполнения 1004: ошибка, определенная приложением или объектом                         </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">        </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:x-large; font-weight:600;">Ссылки</span><span style=" font-family:'DejaVu Sans';">        </span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">        </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">            </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Дополнительные сведения об ограничениях на передачу массивов в различные версии Excel см. в следующей статье базы знаний Майкрософт:<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-2"></a><a href="https://support.microsoft.com/ru/help/177991"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">1</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">77991 </span><span style=" font-family:'DejaVu Sans';"> XL: Ограничения на передачу массивов в Excel средствами автоматизации (Эта ссылка может указывать на содержимое полностью или частично на английском языке)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';">Для получения дополнительных сведений щелкните приведенные ниже номера статей базы знаний Майкрософт: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-3"></a><a href="https://support.microsoft.com/RU/help/146406"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">1</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">46406 </span><span style=" font-family:'DejaVu Sans';"> XL: Загрузка таблицы из Access в Excel с помощью DAO (Эта ссылка может указывать на содержимое полностью или частично на английском языке)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans';"> (эта ссылка может указывать на содержимое полностью или частично на английском языке)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-4"></a><a href="https://support.microsoft.com/ru/help/215965"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">2</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">15965 </span><span style=" font-family:'DejaVu Sans';"> XL2000: Для дат, предшествующих 1900 г., отображается время 12:00:00 (Эта ссылка может указывать на содержимое полностью или частично на английском языке)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-5"></a><a href="https://support.microsoft.com/ru/help/243394"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">2</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">43394 </span><span style=" font-family:'DejaVu Sans';"> Использование MFC для копирования набора записей DAO в Excel средствами автоматизации (Эта ссылка может указывать на содержимое полностью или частично на английском языке)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-6"></a><a href="https://support.microsoft.com/ru/help/247412"><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">2</span></a><span style=" font-family:'DejaVu Sans'; text-decoration: underline; color:#0000ff;">47412 </span><span style=" font-family:'DejaVu Sans';"> Способы передачи данных из Visual Basic в Excel</span></p></body></html>