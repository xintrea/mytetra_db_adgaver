<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Эх чуток опоздали. Совсем недавно сидел за испытаниями скоростей сортирования. Многомерный массив, где нужно упорядочить список файлов (~100 000) и паралельно со списками дат (создания, изменения, обращения), размеров, контрольных сумм, и первых строк файла. Пузырьковая сортировка давала больше 10 секунд, а выборочная дала около секунды.<br />А вообще такие штучки ,как выбор метода, очень важны. Например если сравниваешь 2 маленьких файла, то алгоритм нужен тот, который быстрее напишешь. А если 2 файла огромные, и нужно создать отчет чего нет в одном файле и чего нет в другом, то метод простого построчного сравния даст результат через... несколько минут, в то время, как более сложный - с исключением уже ненужного и уменьшением востребованного в массиве... результат получаешь в течении секунды.<br />Вот и выбирай - быстро написать алгоритм, или писать долго но быстро получить ответ. Как еще один пример - получить таблицу простых чисел 1 до 100 (результат будет получен &quot;сразу&quot; человек и не заметит), а вот от 1 до 10 миллионов - в зависимости от выбора алгоритма, скорость будет отличаться в десятки тысяч раз, которые решат - ждать &quot;минуту&quot;, или &quot;неделю&quot;<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хотя лично я пользуюсь для малых массивов листбоксом (у него ,правда, ограничено количество строк, но... ) В свойствах контрола ставлю Sorted = True, заполняю его массивом &quot;прошу отсортировать&quot; и считываю с него упорядоченный массив:<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> i <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">Integer</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> a<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">100</span><span style=" color:#000000;">)</span> <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-style:italic; color:#008000;">'a(0)=... , a(1)=... , ... , a(100)=... .</span><br /><br />List1<span style=" color:#000000;">.Sorted</span> <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">True</span> <span style=" font-style:italic; color:#008000;">' ! автосортировку можно установить ТОЛЬКО в свойствах контрола</span><br />List1<span style=" color:#000000;">.Visible</span> <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">False</span> <span style=" font-style:italic; color:#008000;">' если невидимый, то работает намного быстрее (можно установить в свойствах)</span><br /><br /><span style=" font-style:italic; color:#008000;">'(РАБОТА</span><br />List1<span style=" color:#000000;">.Clear</span> <span style=" font-style:italic; color:#008000;">' чистим после предыдущего раза</span><br /><br /><span style=" font-weight:600; color:#0000ff;">For</span> i <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">To</span> <span style=" color:#a52a2a;">100</span> <span style=" font-style:italic; color:#008000;">' обязательно с ноля, ведь с ноля начинается номерация строк</span><br />List1<span style=" color:#000000;">.AddItem</span> <span style=" color:#000000;">(</span>a<span style=" color:#000000;">(</span>i<span style=" color:#000000;">))</span><br /><span style=" font-weight:600; color:#0000ff;">Next</span> i<br /><br />List1<span style=" color:#000000;">.Refresh</span> <span style=" font-style:italic; color:#008000;">' обновляем = даем отсортироваться</span><br />DoEvents<br /><br /><span style=" font-weight:600; color:#0000ff;">For</span> i <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span> <span style=" font-weight:600; color:#0000ff;">To</span> <span style=" color:#a52a2a;">100</span><br />a<span style=" color:#000000;">(</span>i<span style=" color:#000000;">)</span> <span style=" color:#000000;">=</span> List1<span style=" color:#000000;">.List(</span>i<span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Next</span> i<br /><span style=" font-style:italic; color:#008000;">'РАБОТА)</span><br />  </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">  </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Последнее редактирование модератором: 14 сен 2015 </p></body></html>