<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Private</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Function</span><span style=" color:#3366cc;"> Week(dteValue </span><span style=" color:#000000;">As</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Date</span><span style=" color:#3366cc;">) </span><span style=" color:#000000;">As</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Integer</span><span style=" color:#3366cc;"> <br />   </span><span style=" color:#000000;">'Monday is set as first day of week <br /></span><span style=" color:#3366cc;">   </span><span style=" color:#000000;">Dim</span><span style=" color:#3366cc;"> lngDate </span><span style=" color:#000000;">As</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Long</span><span style=" color:#3366cc;"> <br />   </span><span style=" color:#000000;">Dim</span><span style=" color:#3366cc;"> intWeek </span><span style=" color:#000000;">As</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Integer</span><span style=" color:#3366cc;"> <br />    <br />   </span><span style=" color:#000000;">'If january 1. is later then thursday, january 1. is not in week 1 <br /></span><span style=" color:#3366cc;">   </span><span style=" color:#000000;">If</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Not</span><span style=" color:#3366cc;"> Weekday(&quot;01/01/&quot; &amp; Year(dteValue), vbMonday) &gt; 4 </span><span style=" color:#000000;">Then</span><span style=" color:#3366cc;"> <br />      intWeek = 1 <br />   </span><span style=" color:#000000;">Else</span><span style=" color:#3366cc;"> <br />      intWeek = 0 <br />   </span><span style=" color:#000000;">End</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">If</span><span style=" color:#3366cc;"> <br />   </span><span style=" color:#000000;">'Sets long-value for january 1. <br /></span><span style=" color:#3366cc;">   lngDate = </span><span style=" color:#000000;">CLng</span><span style=" color:#3366cc;">(</span><span style=" color:#000000;">CDate</span><span style=" color:#3366cc;">(&quot;01/01/&quot; &amp; Year(dteValue))) <br />    <br />   </span><span style=" color:#000000;">'Finds the first monday of year <br /></span><span style=" color:#3366cc;">   lngDate = lngDate + (8 - Weekday(&quot;01/01/&quot; &amp; Year(dteValue), vbMonday)) <br />   </span><span style=" color:#000000;">'Increases week by week until set date is passed <br /></span><span style=" color:#3366cc;">   </span><span style=" color:#000000;">While</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Not</span><span style=" color:#3366cc;"> lngDate &gt; </span><span style=" color:#000000;">CLng</span><span style=" color:#3366cc;">(</span><span style=" color:#000000;">CDate</span><span style=" color:#3366cc;">(dteValue)) <br />      intWeek = intWeek + 1 <br />      lngDate = lngDate + 7 <br />   </span><span style=" color:#000000;">Wend</span><span style=" color:#3366cc;"> <br />   </span><span style=" color:#000000;">'If the date set is not in week 1, this finds latest week previous year <br /></span><span style=" color:#3366cc;">   </span><span style=" color:#000000;">If</span><span style=" color:#3366cc;"> intWeek = 0 </span><span style=" color:#000000;">Then</span><span style=" color:#3366cc;"> <br />      intWeek = Week(&quot;31/12/&quot; &amp; Year(dteValue) - 1) <br />   </span><span style=" color:#000000;">End</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">If</span><span style=" color:#3366cc;"> <br />   Week = intWeek <br /></span><span style=" color:#000000;">End</span><span style=" color:#3366cc;"> </span><span style=" color:#000000;">Function</span><span style=" color:#3366cc;"> <br /><br />msgbox &quot;Сейчас идёт &quot; &amp; </span><span style=" color:#000000;">CStr</span><span style=" color:#3366cc;">(Week(Now)) &amp; &quot; неделя.&quot; </span></p></body></html>