<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вот нашёл кое-что в запаснике:   <br />===========   <br />Вот текст достаточно универсальной функции для Access, которая загружает данные из таблицы Excel. Работает довольно медленно в силу поячеечного обращения к экселю.   <br />'Процедура ЗагрузкаИзExcel   <br />'Загрузка данных с листа Excel в соответствующую по структуре таблицу с указанием   <br />'номера первой строки, содержащей данные. Загрузка ведется до конца диапозона   <br />'параметры:   <br />'Таблица - имя таблицы в которую будут загружаться данные   <br />'Файл - полное имя файла (с путем) рабочей книги Excel   <br />'Лист - имя листа Excel   <br />'ПервСтрока - номер первой строки, содержащей данные   <br />Function ЗагрузкаИзExcel(Таблица As String, Файл As String, Лист, ПервСтрока As Long)   <br />Dim app, wb, rst As New ADODB.Recordset, i As Long, j As Integer   <br />On Error GoTo ErrorHandler   <br />Set app = CreateObject(&quot;Excel.Application&quot;)   <br />Set wb = app.workbooks.Open(Файл)   <br />rst.Open Таблица, CurrentProject.Connection, adOpenStatic, adLockOptimistic   <br />With wb.Worksheets(Лист)   <br />For i = ПервСтрока To .UsedRange.Rows.Count   <br />rst.AddNew   <br />For j = 1 To rst.Fields.Count 'Форматы таблиц должны совпадать!   <br />rst.Fields(j - 1) = .Cells(i, j)   <br />Next j   <br />Next i   <br />End With   <br />rst.Update   <br />rst.Close   <br />wb.Close   <br />GoTo Done   <br />ErrorHandler:   <br />MsgBox &quot;Ошибка при загрузке. Ряд &quot; &amp; i &amp; &quot; Столбец &quot; &amp; j   <br />Done:   <br />Set rst = Nothing   <br />Set wb = Nothing   <br />Set app = Nothing   <br />End Function   <br />  <br />  <br />mastadon   <br />17.04.2007, 16:05   <br />можно с помощью функции если определить значения, а потом копировать и вставить (как значения) на старое место   <br />  <br />  <br />AlexeyVik   <br />18.04.2007, 13:09   <br />mikle, задача была с точностью наоборот, из Excel'я передать в Access.   <br />  <br />Вот основная часть кода &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot;   <br />.................   <br />Dim Baza As Database, rs As Recordset, rs1 As Recordset   <br />Set Baza = OpenDatabase(ThisWorkbook.Path &amp; &quot;\имя.mdb&quot;, False)' можно указать в кавычках полный путь к базе'   <br />Set rs = Baza.OpenRecordset(&quot;Имя_таблицы&quot;, dbOpenDynaset)   <br />Kod=Sheets(&quot;имя_листа_книги&quot;).Range(&quot;ячейка_содержащая _код&quot;)   <br />QryStr = &quot;SELECT * FROM Имя_таблицы WHERE Имя_таблицы.поле =Kod&quot;   <br />Set QRY1 = Baza.CreateQueryDef(&quot;&quot;)   <br />QRY1.Sql = QryStr   <br />Set rs1 = QRY1.OpenRecordset(dbOpenDynaset)   <br />  <br />Здесь добавить обработку ошибки возникающую при отсутствии такого кода.   <br />Если такой код есть   <br />rs1.Edit   <br />rs1.Fields(&quot;поле&quot;) = Target   <br />rs1.Update   <br />Если - нет   <br />rs.AddNew   <br />rs.Fields(&quot;имя_поля_таблицы&quot;) = Sheets(&quot;имя_листа_книги&quot;).Range(&quot;ячейка_содержащая_код&quot;)   <br />rs.Fields(&quot;имя_поля_таблицы&quot;) = Sheets(&quot;имя_листа_книги&quot;).Range(&quot;ячейка_содержащая_значение&quot;)   <br />rs.Update   <br />конец если   <br />Baza.Close   <br />Set rs = Nothing   <br />Set rs1 = Nothing   <br />...................   <br />  <br />  <br />mikle   <br />18.04.2007, 23:55   <br />задача была с точностью наоборот, из Excel'я передать в Access.Что от чего наоборот? ^_^   <br />  <br />  <br />makody   <br />20.04.2007, 15:06   <br />Делаем в проекте ссылку на MS ADO 2.5. после чего можно использовать следующий код:   <br />  <br />Private Sub Worksheet_Change(ByVal Target As Range)   <br />  <br />Dim CN As ADODB.Connection   <br />Dim RS As ADODB.Recordset   <br />Dim sPath As String   <br />  <br />sPath = &quot;C:\test.mdb&quot;   <br />  <br />Set CN = New ADODB.Connection   <br />CN.ConnectionString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; sPath &amp; &quot;;Persist Security Info=False&quot;   <br />CN.Open   <br />  <br />RS = New ADODB.Recordset   <br />  <br />RS.Open &quot;SELECT * FROM Table1 Where NameCell=&quot; &amp; Trim(Target.Name), CN, adOpenStatic, adLockOptimistic   <br />  <br />If RS.EOF Then   <br />RS.AddNew   <br />RS.Fields(&quot;NameCell&quot;).Value = Trim(Target.Name)   <br />End If   <br />RS.Fields(&quot;ValueCell&quot;).Value = Target.Value   <br />RS.Update   <br />  <br />RS.Close   <br />CN.Close   <br />  <br />End Sub   <br />  <br />и еще одна ссылка   <br />  <br /><a href="http://www.delphikingdom.com/asp/answer.asp?IDAnswer=53209"><span style=" text-decoration: underline; color:#0000ff;">http://www.delphikingdom.com/asp/answer.asp?IDAnswer=53209</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; text-decoration: underline; color:#0000ff;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; text-decoration: underline; color:#0000ff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">есть заявлние в нем заполняются данные в ячейки (Фио,адрес,тел итд не) их нужно экспортировать в Access кнопкой на листе подскажите как сделать{/post}{/quote}   <br />  <br />Вот вам пример   <br />Sub ADD_MDB()   <br />Dim cn As ADODB.Connection   <br />Dim cmd As ADODB.Command   <br />Dim DBFullName As String   <br />DBFullName = ThisWorkbook.Path &amp; &quot;\&quot; &amp; &quot;base.mdb&quot;   <br />Set cn = New ADODB.Connection   <br />cn.ConnectionString = &quot;Provider= Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; DBFullName &amp; &quot;&quot;   <br />cn.Open   <br />  <br />Set cmd = New ADODB.Command   <br />  With cmd   <br />     .ActiveConnection = cn   <br />     .CommandText = &quot;INSERT INTO TBL ( TBLname , TBLcount , TBLvalue ) VALUES (11111, '2222222', '33333333');&quot;   <br />'TBL- Ваша таблица в скобках перечисляются Ваши поля в которые добавляются данные, во втрорых скобках (добавляемые значения)   <br />  End With   <br />cmd.Execute   <br />  cn.Close   <br />  Set cn = Nothing   <br />End Sub</p></body></html>