<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.askit.ru/custom/vba_office/m9/09_04_excel_connection.htm"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">askit.ru</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:24pt; font-weight:600;">Подключение к таблице Excel средствами ADO</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">6-9 минут</span><span style=" font-size:8.25pt;"> </span></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr width="100%"/>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600; font-style:italic;">Подключение к таблице Excel средствами ADO, создание именованного диапазона, создание источника данных ODBC </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Очень часто в практической работе возникает необходимость подключиться к таблице на листе Excel, как к базе данных. Конечно, можно работать и средствами объектной модели Excel (</span><a href="http://www.askit.ru/custom/vba_office/m11/11_01_excel_vba_basics.htm"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">см. раздел 11 &quot;Программирование в Excel&quot;</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">), но использование объектов ADO дает значительные преимущества:</span><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">намного проще и удобнее производить поиск записи, вставку новых записей в таблицу, изменение существующих записей. Объекты ADO изначально проектировались именно для этих целей;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">объектную модель Excel можно использовать только в Excel, а объекты ADO универсальны и могут использоваться для подключения к любым источникам данных. Если вы используете объекты ADO, то вы можете использовать фактически одно и то же приложение как для работы с данными в Excel, так и для работы с информацией в &quot;большой&quot; базе данных — например, SQL Server или Oracle. Ситуация, когда часть информации находится в базе данных, а другая часть — в книге Excel, встречается на практике очень часто.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Подключиться к таблице на листе Excel совсем не сложно, но самостоятельно догадаться до всей последовательности действий бывает трудно. Поэтому ниже приведена пошаговая последовательность действий.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Предположим, что у нас есть книга Excel, которая называется Fact.xls и лежит в корневом каталоге диска C:. На первом листе этой книге есть такая совсем несложная таблица, представленная на рис. 9.7</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image14940.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рис. 9.7</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Таблица в Excel, к которой нужно обратиться средствами ADO</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Нам необходимо подключиться к этой таблице, как к базе данных. Что нам нужно сделать?</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Первый этап — это подготовка. Иногда можно обойтись и без нее (если лист Excel — это одна таблица). На практике же часто бывает так, что на листе у нас несколько таблиц, или таблица с комментариями, или внизу таблицы посчитаны итоги и т.п. Чтобы не смущать Excel, лучше явно указать нашу таблицу. Сделать это очень просто: нужно ее выделить (в нашем случае — выделить диапазон с B3 по D8) и присвоить выделенному диапазону имя. Для этого в Excel в меню Вставка нужно выбрать </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Имя</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> -&gt; </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Присвоить</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и ввести нужное имя. В нашем случае мы присвоим имя </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Volumes</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> (см. рис. 9.8)</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image28747.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рис. 9.8</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Присваиваем имя диапазону</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Обратите внимание, что нужно выбирать диапазон вместе с названиями столбцов.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">После того, как имя присвоено, Excel можно закрывать — он больше нам не нужен.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Дальше по плану нужно было бы создать файл *.UDL и настроить в нем подключение к нашему файлу C:\Fact.xls. Однако напрямую из файла UDL можно работать только с драйверами OLE DB, а нужного драйвера, к сожалению, нет (Microsoft JET 4.0 OLE DB Provider хочет работать только с файлами MDB). Поэтому делаем еще один подготовительный шаг — создаем источник данных ODBC (поскольку драйвер ODBC для подключения к Excel есть). Первое действие — в </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Панели управления</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> открываем </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Administrative Tools (Средства администрирования)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и два раза щелкаем по иконке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Data Sources (ODBC) (Источники данных ODBC)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. Откроется окно, аналогичное представленному на рис. 9.9. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image13164.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рис. 9.9</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Окно управления источниками данных ODBC</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В вашем распоряжении — три типа DSN (Data Source Name, то есть источников данных ODBC):</span><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">User DSN</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> — информация об этих источниках данных хранится в части реестра, специфической для пользователя, поэтому эти источники данных доступны только тому пользователю, который их создал;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">System DSN</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> — информация об этих источниках данных хранится в общей части реестра и доступна для всех пользователей на этом компьютере;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">File DSN</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> — информация об этих источниках данных записывается в файл в файловой системе.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Чаще всего используются System DSN — системные источники данных, поэтому переходим на вкладку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">System DSN</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и нажимаем на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Add (Создать)</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Первое, о чем нас спросят — это о типе драйвера, который мы хотим использовать. Выбираем, конечно, </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Microsoft Excel Driver</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и нажимаем на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Finish</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">. Но создание источника данных на этом далеко не кончилось.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">На следующем экране нам потребуется: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">в поле </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Data Source Name</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> ввести имя источника данных. Можно ввести любое имя — главное, чтобы вы его не забыли. Мы введем имя </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">ExcelVolumes</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">нажать на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Select Workbook</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и выбрать нужную нам рабочую книгу (в нашем случае — C:\Fact.xls);</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">нажать на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Options</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и подумать, будем ли изменять из программы нашу таблицу. Если да, то флажок </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Read Only</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> нужно снять.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В итоге окно может выглядеть так, как представлено на рис. 9.10.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image6125.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рис. 9.10</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Настраиваем источник ODBC для подключения к файлу Excel</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Осталось нажать два раза на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">OK</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, чтобы закрыть окно создания источника данных ODBC.</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">В принципе, в коде программы можно написать значение свойства ConnectionString вручную, воспользовавшись документацией по ADO. Выглядеть соответствующая строка, к примеру, может так:</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">cn.ConnectionString = &quot;Provider=MSDASQL.1;DSN = FactExcel;DBQ=C:\Fact.xls ;&quot; </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Но зачем что-то писать руками, когда можно сгенерировать нужное значение автоматически? А сгенерировать можно очень просто:</span><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">так, как описано в предыдущем разделе, создаем файл UDL (можно воспользоваться уже готовым);</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">щелкаем по нему два раза мышью, переходим на вкладку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Provider</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и выбираем </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Microsoft OLE DB Provider for ODBC Drivers</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">переходим на вкладку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Connection</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> и в списке </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Use Data Source Name</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> выбираем созданный нами источник данных ExcelVolumes. Остальные поля можно не заполнять (см. рис. 9.11). Для проверки можно нажать на кнопку </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Test Connection</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">, а затем — </span><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">OK</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2740.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-weight:600;">Рис. 9.11</span><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> Настраиваем параметры подключения к созданному источнику ODBC</span><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">последнее действие — открываем созданный нами файл UDL в блокноте, копируем из него строку подключения и используем в нашей программе.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Итоговый код процедуры для подключения к Excel может выглядеть так:</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Public Sub ConnectToExcel()</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">Dim cn As New ADODB.Connection</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">cn.ConnectionString = &quot;Provider=MSDASQL.1;Data Source=ExcelVolumes&quot;</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">cn.Open </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">'Про Recordset мы будем говорить </span><a href="http://www.askit.ru/custom/vba_office/m9/09_05_01_recordset_basics.htm"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; text-decoration: underline; color:#0000ff;">в следующем разделе</span></a><span style=" font-family:'Times New Roman,serif'; font-size:12pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">'Этот код помещен для наглядной проверки </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">Dim rs As New ADODB.Recordset</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">rs.Open &quot;Volumes&quot;, cn</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">MsgBox rs.GetString</span><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt; font-style:italic;">End Sub </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Чтобы подключиться к файлу Excel, нам потребовалось:</span><span style=" font-size:8.25pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Создать именованный диапазон в книге Excel;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Создать источник данных ODBC с именем ExcelVolumes;</span> </li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">Написать три строки кода начиная с создания объекта Connection до вызова его метода Open.</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image5037.png" /><span style=" font-family:'Times New Roman,serif'; font-size:12pt;">  </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p></body></html>