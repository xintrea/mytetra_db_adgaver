<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Преобразование байтового массива в строку</span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Function</span> ByteArrayToString<span style=" color:#000000;">(</span>varByteArray<span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> rs: <span style=" font-weight:600; color:#0000ff;">Set</span> rs <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;ADODB.Recordset&quot;</span><span style=" color:#000000;">)</span><br />    rs<span style=" color:#000000;">.Fields.Append</span> <span style=" color:#a52a2a;">&quot;temp&quot;</span>, <span style=" color:#a52a2a;">201</span>, <a href="http://www.google.com/search?q=LENB+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">LenB</span></a><span style=" color:#000000;">(</span>varByteArray<span style=" color:#000000;">)</span> <span style=" font-style:italic; color:#008000;">'adLongVarChar</span><br />    rs<span style=" color:#000000;">.Open</span>: rs<span style=" color:#000000;">.AddNew</span>: rs<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;temp&quot;</span><span style=" color:#000000;">).AppendChunk</span> varByteArray: rs<span style=" color:#000000;">.Update</span><br />    ByteArrayToString <span style=" color:#000000;">=</span> rs<span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;temp&quot;</span><span style=" color:#000000;">)</span>: rs<span style=" color:#000000;">.Close</span>: <span style=" font-weight:600; color:#0000ff;">Set</span> rs <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">Nothing</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600;">Преобразование строки в байтовый массив</span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Function</span> StringToByteArray<span style=" color:#000000;">(</span>sText<span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> BS: <span style=" font-weight:600; color:#0000ff;">Set</span> BS <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;ADODB.Stream&quot;</span><span style=" color:#000000;">)</span><br />    BS<span style=" color:#000000;">.Type</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">1</span> <span style=" font-style:italic; color:#008000;">'adTypeBinary</span><br />    BS<span style=" color:#000000;">.Open</span><br />    <span style=" font-weight:600; color:#0000ff;">Dim</span> TS: <span style=" font-weight:600; color:#0000ff;">Set</span> TS <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;ADODB.Stream&quot;</span><span style=" color:#000000;">)</span><br />    <span style=" font-weight:600; color:#0000ff;">With</span> TS<br />        <span style=" color:#000000;">.Type</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">2</span>: <span style=" color:#000000;">.Open</span>: <span style=" color:#000000;">.Charset</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;windows-1251&quot;</span>: <span style=" color:#000000;">.WriteText</span> sText: <span style=" color:#000000;">.Position</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span>: <span style=" color:#000000;">.CopyTo</span> BS: <span style=" color:#000000;">.Close</span><br />    <span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">With</span><br />    BS<span style=" color:#000000;">.Position</span> <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">0</span>: StringToByteArray <span style=" color:#000000;">=</span> BS<span style=" color:#000000;">.Read()</span><br />    BS<span style=" color:#000000;">.Close</span>: <span style=" font-weight:600; color:#0000ff;">Set</span> BS <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">Nothing</span>: <span style=" font-weight:600; color:#0000ff;">Set</span> TS <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">Nothing</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Function</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600;">Получить номер версии операционной системы</span></p></body></html>