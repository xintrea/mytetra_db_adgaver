<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td></td>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/ParseColumnsStringEx"><span style=" text-decoration: underline; color:#0000ff;">Преобразование списка номеров и названий столбцов в массив значений</span></a> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/strings"><span style=" text-decoration: underline; color:#0000ff;">Текстовые строки</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/string"><span style=" text-decoration: underline; color:#0000ff;">текстовые строки</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/CheckInput"><span style=" text-decoration: underline; color:#0000ff;">Проверка ввода</span></a></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/different"><span style=" text-decoration: underline; color:#0000ff;">Разное</span></a> </li></ul></td></tr></table>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Функция ParseColumnsStringEx предназначена для преобразования введенного пользователем списка столбцов в одномерный массив числовых значений.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Назначение функции:</span> исключить ошибки пользовательского ввода, преобразовать буквенные названия столбцов в числовые значения.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Пример использования:</span></p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Private</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span><span style=" font-family:'monospace';"> ПримерИспользования_ParseColumnsStringEx()</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> txt$, txt1$, txt2$</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' исходная строка с номерами столбцов (c ошибками ввода)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    txt$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;4-4 , -a- C;8,Я-7,-11-9-F, Е --К; 4,21-,6-F&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' получаем массив столбцов</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    arr = ParseColumnsStringEx(txt)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' выводим список столбцов:  4,1,2,3,8,7,11,10,9,8,7,6,5,6,7,8,9,10,11,4,21,6,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(arr) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(arr): Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> arr(i) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">;: </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i: Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' ======================================</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' или, например, такая строка</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    txt$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;4-5,8 -k, 6-5;a,e,3,4, 46-BA&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' получаем массив столбцов (c «промежуточными» значениями)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    arr2 = ParseColumnsStringEx(txt, txt1, txt2)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> txt1    </span><span style=" font-family:'monospace'; color:#008000;">' выводит  4-5;8-K;6-5;A;E;3;4;46-BA</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> txt2    </span><span style=" font-family:'monospace'; color:#008000;">' выводит  4-5,8-11,6-5,1,5,3,4,46-53</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    columnsList$ = Join(arr2, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    Debug.</span><span style=" font-family:'monospace'; color:#000080;">Print</span><span style=" font-family:'monospace';"> columnsList$    </span><span style=" font-family:'monospace'; color:#008000;">' выводит 4,5,8,9,10,11,6,5,1,5,3,4,46,47,48,49,50,51,52,53</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Sub</span></pre>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код функции <span style=" font-weight:600;">ParseColumnsStringEx</span>:</p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> ParseColumnsStringEx(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> txt$, </span><span style=" font-family:'monospace'; color:#000080;">Optional</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">ByRef</span><span style=" font-family:'monospace';"> norm1$, </span><span style=" font-family:'monospace'; color:#000080;">Optional</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">ByRef</span><span style=" font-family:'monospace';"> norm2$) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Variant</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Принимает в качестве параметра строку типа &quot;A-C;8,,11-9, Е-К; 4,21,&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' Возвращает одномерный (горизонтальный) массив в формате Array(1,2,3,8,11,10,9,5,6,7,8,9,10,11,4,21)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' (пустые значения удаляются; диапазоны типа 9-15 и 17-13 раскрываются,</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">'  буквенные диапазоны заменяются на числовые, русские буквы заменяются латинскими)</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#008000;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' устраняем возможные ошибки пользовательского ввода</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Const</span><span style=" font-family:'monospace';"> enARR$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;ABCEHKMOPTX&quot;</span><span style=" font-family:'monospace';">, ruARR$ = </span><span style=" font-family:'monospace'; color:#800000;">&quot;АВСЕНКМОРТХ&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Const</span><span style=" font-family:'monospace';"> cc&amp; = 256      </span><span style=" font-family:'monospace'; color:#008000;">' ограничение на максимальный номер столбца</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> Len(enARR$): txt = Replace(txt, Mid(ruARR$, i, 1), Mid(enARR$, i, 1)): </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot; &quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';">): txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;;&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;:&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';">): txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;.&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): txt = UCase(txt)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = 1 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> Len(txt)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Not</span><span style=" font-family:'monospace';"> Mid(txt, i, 1) </span><span style=" font-family:'monospace'; color:#000080;">Like</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#800000;">&quot;[A-Z0-9,-]&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> Mid(txt, i, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">While</span><span style=" font-family:'monospace';"> InStr(1, txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,,&quot;</span><span style=" font-family:'monospace';">): txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): Wend</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">While</span><span style=" font-family:'monospace';"> InStr(1, txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;--&quot;</span><span style=" font-family:'monospace';">): txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;--&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';">): Wend</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,-&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): txt = Replace(txt, </span><span style=" font-family:'monospace'; color:#800000;">&quot;-,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Left(txt, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Or</span><span style=" font-family:'monospace';"> Left(txt, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> txt = Mid(txt, 2)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Right(txt, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Or</span><span style=" font-family:'monospace';"> Right(txt, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> txt = Left(txt, Len(txt) - 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    norm1$ = Replace(txt$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;;&quot;</span><span style=" font-family:'monospace';">)  </span><span style=" font-family:'monospace'; color:#008000;">' возвращаем «нормализованную» строку для подстановки в поле</span></pre>
<pre style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#008000;"><br /></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    arr = Split(txt$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): </span><span style=" font-family:'monospace'; color:#000080;">Dim</span><span style=" font-family:'monospace';"> n </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Long</span><span style=" font-family:'monospace';">: </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> tmpArr(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> 0)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(arr) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(arr)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        spl = Split(arr(i), </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> j = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(spl) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            cn&amp; = 0: cn&amp; = ColumnNameToColumnNumber(spl(j)): </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> cn&amp; </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> spl(j) = cn&amp;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Not</span><span style=" font-family:'monospace';"> spl(j) </span><span style=" font-family:'monospace'; color:#000080;">Like</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">String</span><span style=" font-family:'monospace';">(Len(spl(j)), </span><span style=" font-family:'monospace'; color:#800000;">&quot;#&quot;</span><span style=" font-family:'monospace';">) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> spl(j) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> j</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Val(spl(0)) &gt; cc&amp; </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> spl(0) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';">: spl(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl)) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Val(spl(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl))) &gt; cc&amp; </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> spl(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl)) = cc&amp;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl) &gt; 1 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> arr(i) = spl(0) &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';"> &amp; spl(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl)) </span><span style=" font-family:'monospace'; color:#000080;">Else</span><span style=" font-family:'monospace';"> arr(i) = Join(spl, </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl) = 1 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> spl(0) = spl(1) </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> arr(i) = spl(0)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl) = 1 </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> spl(0) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> arr(i) = spl(1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    norm2$ = Join(arr, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): norm2$ = Replace(norm2$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,-&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): norm2$ = Replace(norm2$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;-,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">While</span><span style=" font-family:'monospace';"> InStr(1, norm2$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,,&quot;</span><span style=" font-family:'monospace';">): norm2$ = Replace(norm2$, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,,&quot;</span><span style=" font-family:'monospace';">, </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';">): Wend</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Left(norm2$, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> norm2$ = Mid(norm2$, 2)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> Right(norm2$, 1) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;,&quot;</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> norm2$ = Left(norm2$, Len(norm2$) - 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> i = </span><span style=" font-family:'monospace'; color:#000080;">LBound</span><span style=" font-family:'monospace';">(arr) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(arr)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">Select</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">True</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> arr(i) = </span><span style=" font-family:'monospace'; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace';">, Val(arr(i)) &lt; 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> IsNumeric(arr(i))</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                tmpArr(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr)) = arr(i): </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Preserve</span><span style=" font-family:'monospace';"> tmpArr(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr) + 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">            </span><span style=" font-family:'monospace'; color:#000080;">Case</span><span style=" font-family:'monospace';"> arr(i) </span><span style=" font-family:'monospace'; color:#000080;">Like</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#800000;">&quot;*#-#*&quot;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                spl = Split(arr(i), </span><span style=" font-family:'monospace'; color:#800000;">&quot;-&quot;</span><span style=" font-family:'monospace';">)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(spl) = 1 </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> IsNumeric(spl(0)) </span><span style=" font-family:'monospace'; color:#000080;">And</span><span style=" font-family:'monospace';"> IsNumeric(spl(1)) </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> spl(0) &lt;= cc&amp; </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                            </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> spl(1) &gt; cc&amp; </span><span style=" font-family:'monospace'; color:#000080;">Then</span><span style=" font-family:'monospace';"> spl(1) = cc&amp;</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                            </span><span style=" font-family:'monospace'; color:#000080;">For</span><span style=" font-family:'monospace';"> j = Val(spl(0)) </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> Val(spl(1)) </span><span style=" font-family:'monospace'; color:#000080;">Step</span><span style=" font-family:'monospace';"> IIf(Val(spl(0)) &gt; Val(spl(1)), -1, 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                                tmpArr(</span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr)) = j: </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Preserve</span><span style=" font-family:'monospace';"> tmpArr(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr) + 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                            </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> j</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                    </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">                </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Select</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';"> i</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">If</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr) </span><span style=" font-family:'monospace'; color:#000080;">Then</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        </span><span style=" font-family:'monospace'; color:#000080;">ReDim</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Preserve</span><span style=" font-family:'monospace';"> tmpArr(0 </span><span style=" font-family:'monospace'; color:#000080;">To</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">UBound</span><span style=" font-family:'monospace';">(tmpArr) - 1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">        ParseColumnsStringEx = tmpArr</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">If</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';"> </span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">Function</span><span style=" font-family:'monospace';"> ColumnNameToColumnNumber(</span><span style=" font-family:'monospace'; color:#000080;">ByVal</span><span style=" font-family:'monospace';"> txt$) </span><span style=" font-family:'monospace'; color:#000080;">As</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Long</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#000080;">On</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Error</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Resume</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Next</span><span style=" font-family:'monospace';">    </span><span style=" font-family:'monospace'; color:#008000;">' преобразует имя столбца в номер.   в случае ошибки возвращает 0</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace';">    ColumnNameToColumnNumber = Split(Application.ConvertFormula(txt$ &amp; </span><span style=" font-family:'monospace'; color:#800000;">&quot;1&quot;</span><span style=" font-family:'monospace';">, xlA1, xlR1C1, </span><span style=" font-family:'monospace'; color:#000080;">True</span><span style=" font-family:'monospace';">), </span><span style=" font-family:'monospace'; color:#800000;">&quot;C&quot;</span><span style=" font-family:'monospace';">)(1)</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000080;">End</span><span style=" font-family:'monospace';"> </span><span style=" font-family:'monospace'; color:#000080;">Function</span></pre>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4710 просмотров </li></ul></td>
<td></td></tr></table></body></html>