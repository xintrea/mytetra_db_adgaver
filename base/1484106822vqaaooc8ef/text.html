<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта статья на английском языке: <a name="kb-link-1"></a><a href="https://support.microsoft.com/en-us/kb/205439"><span style=" text-decoration: underline; color:#0000ff;">2</span></a><span style=" text-decoration: underline; color:#0000ff;">05439</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта статья помещена в архив. Она предлагается &quot;как есть&quot; и обновляться не будет.</p>
<p style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mt0"></a><span style=" font-size:small; font-weight:600;">С</span><span style=" font-size:small; font-weight:600;">ИМПТОМЫ</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При использовании технологии доступа к данным, например, объекты доступа к данным (DAO) или объектов данных ActiveX (ADO) для открытия файлов, содержащих нестандартный разделитель (например, одинарная кавычка), разделитель отображается в поле данных. Кроме того, текстовые поля, содержащие внедренный разделитель (например, запятую), не анализируются правильно.<br /><br />Например если текстовый файл имеет формат: </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">'Doe, Jane','1 Main St.','Redmond','WA'</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">					</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Данные поля набора записей для первого столбца содержат следующий текст: </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">'Doe</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">					</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">а не &quot;Doe, Jane&quot;, как ожидается. Эта проблема не возникает при использовании двойных кавычек для разделения текстовых полей. </p>
<p style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mt1"></a><span style=" font-size:small; font-weight:600;">П</span><span style=" font-size:small; font-weight:600;">РИЧИНА</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта проблема возникает, так как текстовый обработчик Microsoft Jet Database индексно-последовательного метода доступа (ISAM) или текстовый драйвер ODBC, содержащийся в Odbcjt32.dll, или microsoft.jet.oledb.x.x поставщик OLE DB, ожидает либо двойные кавычки, либо отсутствие текстового разделителя вообще. При использовании двойных кавычек в качестве разделителя текста выше текстового файла анализа проблемы не возникает. Эта проблема возникает только при использовании разделителей нестандартных текста. </p>
<p style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mt2"></a><span style=" font-size:small; font-weight:600;">Р</span><span style=" font-size:small; font-weight:600;">ЕШЕНИЕ</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы устранить эту проблему, воспользуйтесь одним из следующих методов. </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style="" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При использовании нестандартной разделителей в файле Schema.ini необходимо определить разделитель. Например, в файл Schema.ini добавьте следующую строку:</li>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TextDelimiter='</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">						</span></pre>
<li style="" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В программе Блокнот создайте новый файл в том же каталоге, что и текстовый файл, и вставьте следующий текст: </li></ul>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">[MyTextFile.txt]</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">ColNameHeader=False</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">Format=CSVDelimited</span></pre>
<pre style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TextDelimiter='</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">							</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">Примечание: убедитесь, что вы заменяете одинарную кавычку в следующей строке: </p>
<pre style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">TextDelimiter='</span></pre>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><span style=" font-family:'Courier New,courier';">							</span></pre>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;">на разделитель, используемый в текстовом файле. Кроме того, вставьте имя конкретного файла, заключенное в квадратные скобки.</p>
<p style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="mt3"></a><span style=" font-size:small; font-weight:600;">С</span><span style=" font-size:small; font-weight:600;">СЫЛКИ</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для получения дополнительных сведений щелкните номер статьи базы знаний Майкрософт ниже: </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-2"></a><a href="https://support.microsoft.com/EN-US/kb/210073"><span style=" text-decoration: underline; color:#0000ff;">2</span></a><span style=" text-decoration: underline; color:#0000ff;">10073</span> ACC2000: как использовать файл Schema.ini для доступа к данным текстом </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="kb-link-3"></a><a href="https://support.microsoft.com/EN-US/kb/210001"><span style=" text-decoration: underline; color:#0000ff;">2</span></a><span style=" text-decoration: underline; color:#0000ff;">10001</span> ACC2000: как программно создать файл Schema.ini </p></body></html>