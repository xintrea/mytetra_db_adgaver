<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#5900b3;">Введение в объектную модель FSO</span><br /><br />Новая особенность для VB6 - модель объекта ( FSO ) Объектная Файловая Система, которая обеспечивает основанный на объектах инструмент для работы с папками и файлами.<br />Это позволяет Вам использовать знакомый синтаксис object.method с богатым набором свойств, методов, и событий, чтобы обработать папки и файлы, в дополнение к использованию традиционных методов и команд Visual Basic. Объектная модель FSO дает вашим прикладным программам способность создавать, изменять, перемещать, и удалить папки, или выяснять, если специфические папки существуют, и если так, то где. Это также дает возможность Вам получить информацию относительно папок, типа их имен, дат, когда они были созданы или в последний раз изменялись, и т.д.<br /><br />Объектная модель FSO позволяет намного проще проводить обработку файлов. При обработке файлов, ваша основная цель состоит в том, чтобы сохранить данные в области - и ресурсо-эффективном, легко доступном формате. Вы сможете создавать файлы, вставлять и изменять(заменять) и выводить (считывать) данные.<br />Объектная модель FSO, которая содержится в библиотеке типов <span style=" font-weight:600;">Scripting type library (Scrrun.Dll)</span>, поддерживает создание текстового файла и манипулирование им<br />через <span style=" font-weight:600; color:#006400;">объект TextStream</span>. Однако это <span style=" font-weight:600; color:#006400;">не поддерживает создание или манипулирование двоичными файлами.</span> Чтобы управлять двоичными файлами, используется команда <span style=" font-weight:600;">Open</span> с бинарным флагом.<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Объекты Файловой системы</span><br /><br />Объектная модель FSO имеет следующие объекты:<br /><br /><span style=" font-weight:600;">Drive(Дисковод)</span> - Позволяет Вам получить информацию относительно дисководов присоединенных к системе, их типа, количества доступного участка памяти, их обозначения, и т.д. Обратите внимание, что &quot;дисковод&quot; не обязательно жесткий диск. Это может быть дисковод CD-ROM, вертуальный диск, и т.д. Также не обязательно, чтобы дисководы были физически присоединенными к системе; они могут быть также логически подсоединены через локальную сеть.<br /><span style=" font-weight:600;">Folder(Папка)</span> - Позволяет Вам создавать, удалять, или перемещать папки, плюс запрос системы относительно их имен, путей, и так далее.<br /><span style=" font-weight:600;">Files(Файлы)</span> - Позволяет Вам создавать, удалять, или перемещать файлы, плюс запрос системы относительно их имен, путей, и так далее.<br /><span style=" font-weight:600;">FileSystemObject</span> - Основной объект группы, с полными методами, которые позволят Вам создать, удалять, получать информацию обовсем, и вообще, управляет дисководами, папками, и файлами. Многие из методов, связанных с этим объектом дублированы в других объектах.<br /><span style=" font-weight:600;">TextStream</span> - Дает возможность Вам читать и писать текстовые файлы.<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Программирование в Объектной Модели FSO</span><br /><br />Программирование в Объектной Модели FSO включает три основных задачи:<br /><br />1. Использование метода CreateObject или объявления переменной как объект FileSystemObject, для создания объекта FileSystemObject;<br />2. Использование соответствующего метода в недавно созданном объекте;<br />3. Вызов свойств объекта.<br /><br />Объектная Модель FSO содержится в библиотеке типов, называемой Scripting, которая размещена в файле Scrrun.Dll . Если Вы пока не имеете ссылку, то поставьте ее в меню References| Microsoft Scripting Runtime. Вы можете затем использовать Object Browser, чтобы просмотреть объекты, свойства, методы и события, а также константы.<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Создание объекта FileSystemObject</span><br /><br />Первый шаг должен создать объект FileSystemObject, чтобы работать с ним. Вы можете сделать это двумя способами: Объявить переменную, как объект:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используя метод CreateObject создать объект FileSystemObject:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Set</span> fso <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;Scripting.FileSystemObject&quot;</span><span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что первый метод работает только в Visual Basic, в то время, как второй метод работает и в Visual Basic и в VBScript.<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Использование соответствующих методов</span><br /><br />Следующий шаг должен использовать соответствующий метод объекта FileSystemObject.<br />Например, если Вы хотите создавать новый объект, Вы можете использовать или CreateFolder или CreateTextFile. (Модель объекта FSO не поддерживает создание или стирание дисководов.).<br />Если Вы хотите удалить объекты, Вы можете использовать методы DeleteFile или DeleteFolder объекта FileSystemObject, или метод Delete объектов File или Folder.<br />При использовании соответствующих методов, Вы можете также копировать и перемещать файлы и папки.<br /><br />Обратите внимание, что некоторые функциональные возможности в модели объекта FileSystemObject избыточны. Например, Вы можете копировать файл, использующий или <span style=" font-weight:600;">метод CopyFile объекта FileSystemObject</span>, или Вы можете использовать <span style=" font-weight:600;">метод Copy объекта File</span>. Методы работают также. И существуют, чтобы дать Вам максимум гибкости программирования.<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Вызов, существующих Drives (Дисководов) , Files (Файлов) и Folders (Папок)</span><br /><br />Чтобы получить доступ к существующему дисководу, файлу или папке, используется соответствующий метод &quot;Get&quot; объекта FileSystemObject:<br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">GetDrive;</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">GetFolder;</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">GetFile;</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Например:<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fil <span style=" font-weight:600; color:#0000ff;">As</span> File<br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;c:\test.txt&quot;</span><span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Обратите внимание, однако</span>, что Вы не должны использовать методы &quot;Get&quot; для недавно созданных объектов, так как функции &quot;<span style=" font-weight:600;">Get</span>&quot; уже возвращает программе обработки недавно созданный объект.<br />Например, если Вы создаете новую папку, используя метод <span style=" font-weight:600;">CreateFolder</span>, Вы затем не должны использовать метод <span style=" font-weight:600;">GetFolder</span>, чтобы обратиться к свойствам, типа <span style=" font-weight:600;">Name, Path, Size</span> и т.д.<br />Только объявите переменную функции CreateFolder, чтобы получить программу обработки недавно созданной папке, затем обратитесь к свойствам, методам, и событиям:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Create_Folder<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fldr <span style=" font-weight:600; color:#0000ff;">As</span> Folder<br /><span style=" font-weight:600; color:#0000ff;">Set</span> fldr <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.CreateFolder(</span><span style=" color:#a52a2a;">&quot;C:\MyTest&quot;</span><span style=" color:#000000;">)</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Created folder: &quot;</span> <span style=" color:#000000;">&amp;</span> fldr<span style=" color:#000000;">.Name</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#5900b3;">Обращение к Properties (Свойствам) Объекта</span><br /><br />Как только Вы имеете код обработки объекта, Вы можете обращаться к его свойствам.<br />Например, если Вы хотите получить имя специфической папки. Сначала Вы создаете образец объекта, затем Вы получаете код для его обработки соответствующим методом (в этом случае метод <span style=" font-weight:600;">GetFolder</span>, так как папка уже существует):<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Set</span> fldr <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFolder(</span><span style=" color:#a52a2a;">&quot;c:\&quot;</span><span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Теперь, когда Вы имеете код обработки объекта Folder, Вы можете проверить свойство Name:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Folder name is: &quot;</span>; fldr<span style=" color:#000000;">.Name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если Вы хотите выяснять когда в последний раз, файл изменялся, используется следующий синтаксис:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fil <span style=" font-weight:600; color:#0000ff;">As</span> File<br /><span style=" font-style:italic; color:#008000;">'Получаем объект File, чтобы сделать запрос</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile</span> <span style=" color:#000000;">(</span> <span style=" color:#a52a2a;">&quot;C:\detlog.txt&quot;</span> <span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">'Печатаем информацию</span><br />msgbox <span style=" color:#a52a2a;">&quot;File last modified: &quot;</span> <span style=" color:#000000;">&amp;</span> fil<span style=" color:#000000;">.DateLastModified</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#5900b3;">Работа с Drives (Дисководами) и Folders (Папками)</span><br /><br />Объектная модель FSO может программно работать с дисководами и папками, точно так, как Вы с Windows Explorer в интерактивном режиме. Вы можете копировать и перемещать папки, получать информацию относительно дисководов и папок, и т.д.<br />Получение информации относительно Drives (Дисководов) Объект Drive позволяет Вам получать информацию относительно различных дисководов, присоединенных к системе или физически или через сеть.<br /><br />Свойства позволяют Вам получить информацию относительно:<br /><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Полный размера дисковода в байтах (свойство TotalSize);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Количество доступного свободного места на дисководе в байтах (свойства AvailableSpace или FreeSpace);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Буквенного обозначения дисковода (свойство DriveLetter);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Какого типа дисковод, сменный, фиксированный, сетевой, CD-ROM или RAM (свойство DriveType);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Серийный номер дисковода (свойство SerialNumber);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Тип файловой системы использования дисковода FAT, FAT32, NTFS, и т.д (свойство FileSystem);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Является ли дисковод доступен для использования (свойство IsReady);</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Имя общих и/или Имя объемa (свойства ShareName и VolumeName);</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Путь или корневую папку дисковода (свойства Path и RootFolder);</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><br /><span style=" font-weight:600; color:#5900b3;">Пример использования объекта Drive (Дисковода)</span><br /><br />Пример ниже показывается, как использовать объект Drive, чтобы получить полную информацию относительно дисковода.<br />Не забудьте, что в следующем коде Вы не будете видеть ссылку к фактическому объекту Drive, достаточно, что Вы используете метод GetDrive чтобы получить ссылку для существующего объекта Drive (в этом случае - drv):<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Command3_Click<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, drv <span style=" font-weight:600; color:#0000ff;">As</span> Drive, s <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><br /><span style=" font-weight:600; color:#0000ff;">Set</span> drv <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetDrive(</span>fso<span style=" color:#000000;">.GetDriveName(</span><span style=" color:#a52a2a;">&quot;c:&quot;</span><span style=" color:#000000;">))</span><br />s <span style=" color:#000000;">=</span> <span style=" color:#a52a2a;">&quot;Drive &quot;</span> <span style=" color:#000000;">&amp;</span> <a href="http://www.google.com/search?q=UCASE+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">UCase</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;c:&quot;</span><span style=" color:#000000;">)</span> <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot; - &quot;</span><br />s <span style=" color:#000000;">=</span> s <span style=" color:#000000;">&amp;</span> drv<span style=" color:#000000;">.VolumeName</span> <span style=" color:#000000;">&amp;</span> vbCrLf<br />s <span style=" color:#000000;">=</span> s <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;Total Space: &quot;</span> <span style=" color:#000000;">&amp;</span> <a href="http://www.google.com/search?q=FORMATNUMBER+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">FormatNumber</span></a><span style=" color:#000000;">(</span>drv<span style=" color:#000000;">.TotalSize</span> <span style=" color:#000000;">/</span> <span style=" color:#a52a2a;">1024</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span><br />s <span style=" color:#000000;">=</span> s <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot; Kb&quot;</span> <span style=" color:#000000;">&amp;</span> vbCrLf<br />s <span style=" color:#000000;">=</span> s <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot;Free Space: &quot;</span> <span style=" color:#000000;">&amp;</span> <a href="http://www.google.com/search?q=FORMATNUMBER+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">FormatNumber</span></a><span style=" color:#000000;">(</span>drv<span style=" color:#000000;">.FreeSpace</span> <span style=" color:#000000;">/</span> <span style=" color:#a52a2a;">1024</span>, <span style=" color:#a52a2a;">0</span><span style=" color:#000000;">)</span><br />s <span style=" color:#000000;">=</span> s <span style=" color:#000000;">&amp;</span> <span style=" color:#a52a2a;">&quot; Kb&quot;</span> <span style=" color:#000000;">&amp;</span> vbCrLf<br />MsgBox s<br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#5900b3;">Работа с Folders (Папками)</span><br /><br />Этот список показывает общие задачи папки и методы для выполнения их:<br /><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Создать папку - FileSystemObject.CreateFolder</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Удалить папку - Folder.Delete или FileSystemObject.DeleteFolder</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Переместить папку - Folder.Move или FileSystemObject.MoveFolder</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Копировать папку - Folder.Copy или FileSystemObject.CopyFolder</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Возвратить имя папки - Folder.Name</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Выяснить, существует ли папка на дисководе - FileSystemObject.FolderExists</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Получить образец существующего объекта - Folder FileSystemObject.GetFolder</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Выяснить имя папки, родителя папки - FileSystemObject.GetParentFolderName</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Выяснить путь системных папок - FileSystemObject.GetSpecialFolder</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Этот пример показывает использование объектов <span style=" font-weight:600; font-style:italic;">Folder</span> и FileSystemObject, чтобы управлять папками и получать информацию о них:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Private</span> <span style=" font-weight:600; color:#0000ff;">Sub</span> Command10_Click<span style=" color:#000000;">()</span><br /><span style=" font-style:italic; color:#008000;">'Получаем образец</span><br />FileSystemObject <span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fldr <span style=" font-weight:600; color:#0000ff;">As</span> Folder, s <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" color:#6a5acd;">String</span><br /><span style=" font-style:italic; color:#008000;">' Объект</span><br /><span style=" font-weight:600; color:#0000ff;">Get</span> Drive <span style=" font-weight:600; color:#0000ff;">Set</span> fldr <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFolder(</span><span style=" color:#a52a2a;">&quot;c:&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">' Печатаем родительское имя папки</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Parent folder name is: &quot;</span> <span style=" color:#000000;">&amp;</span> fldr<br /><span style=" font-style:italic; color:#008000;">' Печатаем имя дисковода</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Contained on drive &quot;</span> <span style=" color:#000000;">&amp;</span> fldr<span style=" color:#000000;">.Drive</span><br /><span style=" font-style:italic; color:#008000;">' Печатаем имя корневой папки</span><br /><span style=" font-weight:600; color:#0000ff;">If</span> fldr<span style=" color:#000000;">.IsRootFolder</span> <span style=" color:#000000;">=</span> <span style=" font-weight:600; color:#0000ff;">True</span> <span style=" font-weight:600; color:#0000ff;">Then</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;This folder is a root folder.&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">Else</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;This folder isn't a root folder.&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">If</span><br /><span style=" font-style:italic; color:#008000;">' Создаем новую папку объектом FileSystemObject</span><br />fso<span style=" color:#000000;">.CreateFolder</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;c:\Bogus&quot;</span><span style=" color:#000000;">)</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Created folder C:\Bogus&quot;</span><br /><span style=" font-style:italic; color:#008000;">' Печатаем основное имя папки</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Basename = &quot;</span> <span style=" color:#000000;">&amp;</span> fso<span style=" color:#000000;">.GetBaseName(</span><span style=" color:#a52a2a;">&quot;c:\bogus&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">' Удаляем недавно созданную папку</span><br />fso<span style=" color:#000000;">.DeleteFolder</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;c:\Bogus&quot;</span><span style=" color:#000000;">)</span><br />Debug<span style=" color:#000000;">.Print</span> <span style=" color:#a52a2a;">&quot;Deleted folder C:\Bogus&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#5900b3;">Работа с Files (Файлами)</span><br /><br />Вы можете работать с файлами в Visual Basic, используя новые объектно-ориентированные объекты FSO типа Copy, Delete, Move и OpenAsTextStream, так же, как и более старые существующие функции типа Open, Close, FileCopy, GetAttr, и т.д. Обратите внимание, что Вы можете перемещать, копировать или удалять файлы независимо от типа файла. Имеются две главных категории манипулирования файлами:<br />Создание, добавление или удаления данных, или чтение файлов;<br />Перемещение, копирование и удаление файлов;<br /><br /><br /><span style=" font-weight:600; color:#5900b3;">Создание файлов и добавления данных с помощью File System Objects</span><br /><br />Имеются <span style=" font-weight:600;">три способа</span> создать последовательный текстовый файл (иногда упоминаемый как &quot;текстовый поток&quot;). Один путь состоит в том, чтобы использовать метод CreateTextFile. Создаем пустой текстовый файл:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fil <span style=" font-weight:600; color:#0000ff;">As</span> File<br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.CreateTextFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span>, <span style=" font-weight:600; color:#0000ff;">True</span><span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что модель объекта FSO еще не поддерживает создание произвольных (random) или двоичных (binary) файлов.<br /><br />Другой путь состоит в том, чтобы использовать метод OpenTextFile объекта FileSystemObject с установкой флага ForWriting:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, ts <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> TextStream<br /><span style=" font-weight:600; color:#0000ff;">Set</span> ts <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.OpenTextFile(</span><span style=" color:#a52a2a;">&quot;c:\test.txt&quot;</span>, ForWriting<span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Или Вы можете использовать метод OpenAsTextStream с установкой флага ForWriting:<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, fil <span style=" font-weight:600; color:#0000ff;">As</span> File, ts <span style=" font-weight:600; color:#0000ff;">As</span> TextStream<br /><span style=" font-weight:600; color:#0000ff;">Set</span> fso <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;Scripting.FileSystemObject&quot;</span><span style=" color:#000000;">)</span><br />fso<span style=" color:#000000;">.CreateTextFile</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;test1.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;test1.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> ts <span style=" color:#000000;">=</span> fil<span style=" color:#000000;">.OpenAsTextStream(</span>ForWriting<span style=" color:#000000;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#5900b3;">Добавление данных к файлу</span><br /><br />Как только текстовый файл создан, Вы можете добавлять данные. Для этого необходимо:<br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Открыть текстовый файл для записи данных.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Записать данные.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Закрыть файл.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Чтобы открыть файл, Вы можете использовать любой из двух методов:<br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">метод OpenAsTextStream объекта File или</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">метод OpenTextFile объекта FileSystemObject.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600;">Чтобы записать данные</span> в открытый текстовый файл, используйте методы <span style=" font-weight:600;">Write</span> или <span style=" font-weight:600;">WriteLine</span> объекта <span style=" font-weight:600;">TextStream</span>.<br />Единственое различие между Write и WriteLine - то, что WriteLine добавляет символы newline к концу строки. Если Вы хотите добавлять newline к текстовому файлу, используйте метод WriteBlankLines.<br /><br />Чтобы закрыть открытый файл, используйте метод Close объекта TextStream.<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Sub</span> Create_File<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fso, txtfile<br /><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fso <span style=" color:#000000;">=</span> <a href="http://www.google.com/search?q=CREATEOBJECT+site:msdn.microsoft.com"><span style=" text-decoration: underline; color:#000066;">CreateObject</span></a><span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;Scripting.FileSystemObject&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> txtfile <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.CreateTextFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span>, <span style=" font-weight:600; color:#0000ff;">True</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">'Запись линии</span><br />txtfile<span style=" color:#000000;">.Write</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;This is a test. &quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">'Запись линии с символом newline</span><br />txtfile<span style=" color:#000000;">.WriteLine(</span><span style=" color:#a52a2a;">&quot;Testing 1, 2, 3.&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">'Запись трех символов newline в файл</span><br />txtfile<span style=" color:#000000;">.WriteBlankLines(</span><span style=" color:#a52a2a;">3</span><span style=" color:#000000;">)</span><br />txtfile<span style=" color:#000000;">.Close</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#5900b3;">Чтение файлов File System Objects</span><br /><br />Чтобы читать данные из текстового файла, используйте методы<span style=" font-weight:600;"> Read, ReadLine</span> или <span style=" font-weight:600;">ReadAll</span> объекта <span style=" font-weight:600;">TextStream</span>:<br /><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Чтение определенного числа символов из файла - Read</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Чтение всей линии (но не, включая, символ newline) - ReadLine</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Чтение всего содержания текстового файла - ReadAll</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Если Вы используете метод Read или ReadLine, и Вы хотите перейти к специфической части данных.<br />Вы можете использовать метод <span style=" font-weight:600;">Skip</span> или <span style=" font-weight:600;">SkipLine</span>. Полученный в результате использования этих методов текст может быть сохранен в символьной переменной и анализироваться Left, Right и Mid.<br />Обратите внимание, что константа vbNewLine содержит символ или символы (в зависимости от операционной системы) чтобы продвинуть курсор к началу следующей линии (возврат каретки). Знайте, что концы некоторых символьных переменных могут иметь такие непечатаемые символы.<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Sub</span> Read_Files<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, txtfile<br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fil1 <span style=" font-weight:600; color:#0000ff;">As</span> File, ts <span style=" font-weight:600; color:#0000ff;">As</span> TextStream<br /><br /><span style=" font-weight:600; color:#0000ff;">Set</span> txtfile <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.CreateTextFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span>, <span style=" font-weight:600; color:#0000ff;">True</span><span style=" color:#000000;">)</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Writing file&quot;</span><br /><span style=" font-style:italic; color:#008000;">' Запись линии</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil1 <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> ts <span style=" color:#000000;">=</span> fil1<span style=" color:#000000;">.OpenAsTextStream(</span>ForWriting<span style=" color:#000000;">)</span><br />ts<span style=" color:#000000;">.Write</span> <span style=" color:#a52a2a;">&quot;Hello World&quot;</span><br />ts<span style=" color:#000000;">.Close</span><br /><span style=" font-style:italic; color:#008000;">' Чтение содержания файла</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> ts <span style=" color:#000000;">=</span> fil1<span style=" color:#000000;">.OpenAsTextStream(</span>ForReading<span style=" color:#000000;">)</span><br />s <span style=" color:#000000;">=</span> ts<span style=" color:#000000;">.ReadLine</span><br />MsgBox s<br />ts<span style=" color:#000000;">.Close</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /><span style=" font-weight:600; color:#5900b3;">Перемещение, копирование и удаление файлов</span><br /><br />Модель объекта FSO имеет <span style=" font-weight:600;">два метода</span> для перемещения, копирования и удаления файлов:<br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Переместите файл - File.Move or FileSystemObject.MoveFile</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Копируйте файл - File.Copy or FileSystemObject.CopyFile</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Удалите файл - File.Delete or FileSystemObject.DeleteFile</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br />Этот пример:<br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">создает текстовый файл в корневой директории дисковода C,</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">пишет некоторую информацию в нем,</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">перемещает его в каталог, называемый \tmp,</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">делает копию его в каталог, называемый \temp, затем</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">удаляет копии из обоих каталогов.</li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы выполнять этот пример, удостоверитесь, что Вы имеете каталоги, именованные \tmp и \temp в корневой директории дисковода C.<br /><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">Код (vb.net): </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#0000ff;">Sub</span> Manip_Files<span style=" color:#000000;">()</span><br /><span style=" font-weight:600; color:#0000ff;">Dim</span> fso <span style=" font-weight:600; color:#0000ff;">As</span> <span style=" font-weight:600; color:#0000ff;">New</span> FileSystemObject, txtfile, fil1, fil2<br /><br /><span style=" font-weight:600; color:#0000ff;">Set</span> txtfile <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.CreateTextFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span>, <span style=" font-weight:600; color:#0000ff;">True</span><span style=" color:#000000;">)</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Writing file&quot;</span><br />txtfile<span style=" color:#000000;">.Write</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;This is a test.&quot;</span><span style=" color:#000000;">)</span><br />txtfile<span style=" color:#000000;">.Close</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Moving file to c:\tmp&quot;</span><br /><span style=" font-style:italic; color:#008000;">' Код обработки файла в корне C:\</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil1 <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;c:\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">' Перемещаем файл в директорию \tmp</span><br />fil1<span style=" color:#000000;">.Move</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;c:\tmp\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br />MsgBox <span style=" color:#a52a2a;">&quot; Копируем файл в c:\temp&quot;</span><br /><span style=" font-style:italic; color:#008000;">' Копируем файл в \temp</span><br />fil1<span style=" color:#000000;">.Copy</span> <span style=" color:#000000;">(</span><span style=" color:#a52a2a;">&quot;c:\temp\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Удаляем файлы&quot;</span><br /><span style=" font-style:italic; color:#008000;">' Код получения текущих дерикторий файлов</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil1 <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;c:\tmp\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-weight:600; color:#0000ff;">Set</span> fil2 <span style=" color:#000000;">=</span> fso<span style=" color:#000000;">.GetFile(</span><span style=" color:#a52a2a;">&quot;c:\temp\testfile.txt&quot;</span><span style=" color:#000000;">)</span><br /><span style=" font-style:italic; color:#008000;">' Удаляем дайлы fil1.Delete</span><br />fil2<span style=" color:#000000;">.Delete</span><br />MsgBox <span style=" color:#a52a2a;">&quot;Все!&quot;</span><br /><span style=" font-weight:600; color:#0000ff;">End</span> <span style=" font-weight:600; color:#0000ff;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.rusedu.info"><span style=" text-decoration: underline; color:#0000ff;">Источник</span></a> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">  </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://safezone.cc/members/dragokas.6966/"><span style=" text-decoration: underline; color:#0000ff;">Dragokas</span></a>, <a href="https://safezone.cc/threads/fso-tjazhelaja-artillerija-vb6.23117/"><span style=" text-decoration: underline; color:#0000ff;">26 янв 2014 в 18:49</span></a> </p></body></html>