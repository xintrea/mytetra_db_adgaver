<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;"> Диалог  выбора файла Вариант 1 </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  <br />          Пример кода  кнопки для выбора графического файла для объекта картинка   <br />      <br />          Private  Sub  Btn_Path_Click()  <br />     Dim FName As  String  <br />     Dim result As  Integer  <br />     With  Application.FileDialog(1)  <br />        .Title =  &quot;Select picture&quot;  <br />        .InitialFileName  = &quot;C:\&quot; 'default path  Путь по умолчанию   <br />        .AllowMultiSelect  = False  <br />        .Filters.Clear   <br />             .Filters.Add  &quot;Picture files&quot;, &quot;*.bmp; *.jpg&quot;, 1   <br />     result = .Show   <br />      <br />     If result = 0  Then Exit Sub   <br />     FName =  Trim(.SelectedItems.Item(1))  <br />     End  With   <br />      <br />     On error resume  next   <br />     me.imageObj.Picture  = FName 'pic object  Контрол формы   <br />     End  Sub  <br />      <br />    </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;"> Диалог  выбора файла Вариант 2 ( by АлексейЕ  )  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />     Пример выбора  файла Аксесс  <br />      <br />     Public  Sub  test_dialog2()  <br />     Dim strFile As  String, strFilter As String  <br />     strFilter =  &quot;MS Access Database (*.mdb)|*.mdb|Add-ins (*.mda)|*.mda|MDE-Files  (*.mde)|*.mde|All Files (*.*)|*.*||&quot;  <br />     WizHook.Key =  51488399  <br />     WizHook.GetFileName  0, &quot;AppName&quot;, &quot;DlgTitle&quot;, &quot;&quot;, strFile, &quot;c:\&quot;, strFilter, 0, 0, 0, True   <br />     MsgBox strFile   <br />     End  Sub   <br />      <br />      <br />     </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Вариант  3 (WinApi)  </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;"><br />      <br />     '--- модуль  api_filedialog ------------------------   <br />      <br />     Option Compare  Database  <br />     Option  Explicit  <br />     'Немножко  адаптированный способ кедзо  <br />     'оригинал:  http://www.sql.ru/forum/actualthread.aspx?tid=113776&amp;hl=declare+filedialog#874185   <br />     '  Вызов диалога:  <br />     '  strFile = InputFile(&quot;Загрузка документа&quot;, &quot;Текстовые файлы (*.txt)&quot; &amp;  vbNullChar &amp; &quot;*.txt&quot; &amp; vbNullChar &amp; vbNullChar , &quot;\\server\c&quot;)   <br />     ' If  strFile &lt;&gt; &quot;&quot; Then ЗАГРУЖАЙСЯ (strFile)   <br />      <br />      <br />     Private Type  OPENFILENAME   <br />     lStructSize As  Long  <br />     hwndOwner As  Long  <br />     hInstance As  Long  <br />     lpstrFilter As  String  <br />     lpstrCustomFilter  As String  <br />     nMaxCustFilter  As Long  <br />     nFilterIndex  As Long  <br />     lpstrFile As  String  <br />     nMaxFile As  Long  <br />     lpstrFileTitle  As String  <br />     nMaxFileTitle  As Long  <br />     lpstrInitialDir  As String  <br />     lpstrTitle As  String  <br />     flags As Long   <br />     nFileOffset As  Integer  <br />     nFileExtension  As Integer  <br />     lpstrDefExt As  String  <br />     lCustData As  Long  <br />     lpfnHook As  Long  <br />     lpTemplateName  As String   <br />     End  Type  <br />      <br />     Private  Declare Function GetOpenFileName Lib &quot;comdlg32.dll&quot; Alias &quot;GetOpenFileNameA&quot;  (pOpenFilename As OPENFILENAME) As Long  <br />      <br />      <br />     'Ввод имени  файла   <br />     Public Function  InputFile(ByVal strTitle  As String, ByVal strFilter  As String, Optional strInitialDir  As String) As String   <br />     Dim lngReturn  As Long   <br />     Dim intLocNull  As Integer   <br />     Dim strTemp As String   <br />     Dim ofnFileInfo  As OPENFILENAME   <br />     Dim strFileName  As String   <br />      <br />     strFileName =  String(256, 0)   <br />      <br />     With ofnFileInfo   <br />     .lStructSize =  Len(ofnFileInfo)   <br />     .lpstrFile =  strFileName  <br />     .lpstrFileTitle  = String(256, 0)   <br />     .lpstrInitialDir  = strInitialDir  <br />     .hwndOwner =  Application.hWndAccessApp  <br />     .lpstrFilter =  strFilter  <br />     .nFilterIndex  = 1  <br />     .nMaxFile =  Len(strFileName)   <br />     .nMaxFileTitle  = ofnFileInfo.nMaxFile  <br />     .lpstrTitle =  strTitle  <br />     .flags =  &amp;H1000 Or &amp;H800   <br />     .hInstance = 0   <br />     .lpstrCustomFilter  = String(255, 0)   <br />     .nMaxCustFilter  = 255  <br />     .lpfnHook = 0   <br />     End With   <br />      <br />     lngReturn =  GetOpenFileName(ofnFileInfo)  <br />     If lngReturn = 0  Then   <br />     strFileName =  &quot;&quot;  <br />     Else   <br />     strTemp =  Trim(ofnFileInfo.lpstrFile)  <br />     intLocNull =  InStr(strTemp, Chr(0))  <br />     If intLocNull  Then   <br />     strTemp =  Left(strTemp, intLocNull - 1)  <br />     End If   <br />     strFileName =  strTemp  <br />     End If   <br />     InputFile =  strFileName  <br />     End Function   <br />      <br />     '-------------  Конец модуля -------------   <br />      <br />      <br />      <br />     Пример вызова  диалога выбора файла реализован в примере с  </span><a href="http://www.msdatabase.ru?q=datepicker"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;">всплывающим календарем</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;">.   <br />      <br />     Примечания:   <br />     Вариант № 1  не работает если аксесс запущен с опцией /runtime   <br />          Вариант №2  странно ведет себя с сетевым путем если этот путь не был предварительно открыт  из проводника   <br />           <br />      <br />      <br />      <br />      <br />         </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;"> Диалог  выбора папки </span><span style=" font-family:'DejaVu Sans'; font-size:11pt;">  <br />           <br />     Dim WSHShell,  folder  <br />     On Error Resume Next   <br />     Set WSHShell =  CreateObject(&quot;Shell.application&quot;)  <br />     Set folder =  WSHShell.browseforfolder(0, &quot;Выбор папки&quot;, 0, &quot;C:\&quot;)   <br />     If Not Err.Number =  91 Then MsgBox  folder.Title  <br />     Set WSHShell =  Nothing   <br /><br />      </span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:600;">Пример диалога выбора / создания папки</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu Sans'; font-size:11pt;">: <br />   '---------------------------------------------------------------------------------------<br />    ' Procedure : fnGetFolder<br />    ' DateTime : 17.08.2006 16:12<br />    ' Author : DSonnyh<br />    ' Purpose : выбор папки<br />    '---------------------------------------------------------------------------------------<br />    '<br />    Public Function fnGetFolder() As String<br />    <br />    Dim WSHShell As Object, objFolder As Object<br />    Dim P1, P2<br />     'Некоторые значения констант:<br />    ' P1=0 - отображаются Рабочий стол, Мой компьютер, Сеть и &quot;Корзина&quot;<br />    ' P1=1 - &quot;Корзина&quot; не отображается<br />    ' P1=2 - &quot;Корзина&quot; отображается, в &quot;Моем компьютере&quot; выводится дополнительно &quot;Панель    Управления&quot;<br />    ' P2 определяет верхний уровень отображения. Его можно задать как строку    символов<br />    ' Пример - &quot;C:\&quot;. Или числом. Проверено для ХР<br />    ' Р2=0 - Рабочий стол P2=10 - Корзина<br />    ' P2=1 - Интернет Explorer (недопустимо) P2=11 - Главное меню<br />    ' P2=2 - Программы Р2=12 - Рабочий стол<br />    ' P2=3 - Панель управления (недопустимо) Р2=13 - Моя музыка<br />    ' P2=4 - Принтеры и факсы (недопустимо) Р2=14 - Мои видеозаписи<br />    ' P2=5 - Мои Документы Р2=15 - Рабочий стол<br />    ' P2=6 - Избранное Р2=16 - Рабочий стол<br />    ' P2=7 - Автозагрузка Р2=17 - Мой Компьютер<br />    ' P2=8 - недавние Документы Р2=18 - Сетевой окружение<br />    ' P2=9 - SendTo Р2=19 - NetHood<br />    ' Р2=20 - Fonts Р2=21 - Templates<br />    ' Более подробную информацию об объекте можно найти в</span><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/objects/shell/browseforfolder.asp"><span style=" font-family:'DejaVu Sans'; font-size:11pt; text-decoration: underline; color:#0000ff;"> документации</span></a><span style=" font-family:'DejaVu Sans'; font-size:11pt;"> (EN)<br />    <br />    On Error GoTo fnGetFolder_Error<br />    <br />    P1 = 1<br />    P2 = 0<br />    <br />    Set WSHShell = CreateObject(&quot;Shell.application&quot;)<br />    Set objFolder = WSHShell.BrowseForFolder(0, &quot;Выбор папки&quot;, P1, P2)<br />    fnGetFolder = objFolder.self.Path<br />    ' имя папки содержится в objFolders.Title<br />    Set WSHShell = Nothing<br />    Set objFolder = Nothing<br />    <br />    On Error GoTo 0<br />    Exit_fnGetFolder:<br />    Exit Function<br />    <br />    fnGetFolder_Error:<br />    <br />    Set WSHShell = Nothing<br />    Set objFolder = Nothing<br />    Select Case Err.Number<br />    Case 91<br />    fnGetFolder = &quot;&quot;<br />    Resume Exit_fnGetFolder<br />    Case Else<br />    MsgBox &quot;Ошибка &quot; &amp; Err.Number &amp; &quot; (&quot; &amp; Err.Description &amp; &quot;) в процедуре    fnGetFolder&quot;<br />    Resume Exit_fnGetFolder<br />    End Select<br />    <br />    End Function </span></p></body></html>