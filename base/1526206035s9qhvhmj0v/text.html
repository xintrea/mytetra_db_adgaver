<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<html>
<h3 class="post-title entry-title" itemprop="name">
Урок 15. Использование Ribbon XML Editor для создания ленты в Access.
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-3042048558839943634" itemprop="articleBody">
<div dir="ltr" style="text-align: left;" trbidi="on">
<i><b>Внимание!</b> Написанное ниже актуально для Ribbon XML Editor 
версии 6.0 и ниже. В версии 6.1 появилось автодополнение Access и 
справка по его идентификаторам, а начиная с версии 7.0 редактор </i><i><i>Ribbon XML Editor </i>поддерживает прямую работу с базами данных Access! </i><br>
<br>
Написание надстроек для Access не менее актуально, чем для Word, Excel и
 уж тем более Power Point. Однако файл Access в отличие от упомянутых 
приложений имеет совсем иную структуру. Это обычная база данных, и 
интерфейс там хранится не в виде файла в отдельной папке документа, а в 
специальной системной таблице <span class="gbcom"><span id="m_d1462533632">USysRibbons базы данных.</span></span><br>
<span class="gbcom"><span id="m_d1462533632"><br></span></span>
<span class="gbcom"><span id="m_d1462533632">Используемый нами Ribbon 
XML Editor предназначен для работы с файлами папочной структуры (Word, 
Excel, Power Point), однако схема интерфейса Access аналогична схемам 
интерфейса упомянутых приложений, а значит мы можем построить интерфейс и
 для Access, просто разрабатывая его на базе файла Excel.</span></span><br>
<span class="gbcom"><span id="m_d1462533632"><br></span></span>
<span class="gbcom"><span id="m_d1462533632">Единственное неудобство такого способа состоит в том, что в автодополнении и встроенной справке</span></span><span class="gbcom"><span id="m_d1462533632">
 программы отсутствует информация по идентификаторам Access. Но если у 
вас под рукой есть соответствующая шпаргалка, полученная из других 
источников, то последняя проблема перестаёт быть актуальной. </span></span><br>
<br>
<span class="gbcom"><span id="m_d1462533632"><span class="gbcom"><span id="m_d1462533632">Замечу, что если вы хотите использовать в Access </span></span></span></span><span class="gbcom"><span id="m_d1462533632"><span class="gbcom"><span id="m_d1462533632">собственные
 внешние изображения, то внедрять их штатным инструментом RibbonXML 
Edeitor не получится, поскольку они не могут храниться внутри папочной 
структуры файла документа, как это происходит в Word, Excel и 
PowerPoint. Ведь формат документа Access просто не предусматривает такой
 структуры. Но изображения можно положить рядом с файлом базы данных, и 
загружать их с помощью функции, прописанной в параметре loadImage 
корневого элемента customUI. Кроме того, изображения можно поместить 
внутрь самой базы. Тому, как это всё сделать, будет посвящён один из 
следующих уроков.</span></span></span></span><br>
<span class="gbcom"><span id="m_d1462533632"><br></span></span>
<span class="gbcom"><span id="m_d1462533632">Итак, технология создания интерфейса Access выглядит </span></span><span class="gbcom"><span id="m_d1462533632"><span class="gbcom"><span id="m_d1462533632">приблизительно </span></span>так:</span></span><br>
<ol style="text-align: left;">
<li><span class="gbcom"><span id="m_d1462533632">Открываем Excel и создаём в нём новый документ. Сохраняем документ и закрываем Excel. </span></span></li>
<li><span class="gbcom"><span id="m_d1462533632">Открываем сохранённый документ Excel в </span></span><span class="gbcom"><span id="m_d1462533632">Ribbon XML Editor и как обычно создаём структуру кастомной ленты для Access: вкладки, группы, кнопки — всё </span></span><span class="gbcom"><span id="m_d1462533632"><span class="gbcom"><span id="m_d1462533632">это </span></span>будет работать и в Access.</span></span><span class="gbcom"><span id="m_d1462533632"></span></span></li>
<li><span class="gbcom"><span id="m_d1462533632">Обработчики событий нажатия на кнопки (функции обратного вызова) создаём так же, как и в
      Excel. </span></span></li>
<li><span class="gbcom"><span id="m_d1462533632">Открываем Access и 
создаём в базе данных системную таблицу USysRibbons, в которую копируем 
весь созданный в Ribbon XML Editor код. </span></span><span class="gbcom"><span id="m_d1462533632"><span class="gbcom"><span id="m_d1462533632">Замечу, что для отображения содержимого системной таблицы USysRibbons, в</span></span> параметрах навигации по таблицам надо разрешить отображение системных объектов.</span></span></li>
<li><span class="gbcom"><span id="m_d1462533632">Код функций обратного вызова подключаем аналогично Excel. </span></span></li>
</ol>
Всё, интерфейс для Access внедрён. Таким образом, Ribbon XML Editor вполне можно использовать даже для <span class="gbcom"><span id="m_d1462533632">Access. </span></span><br>
<br>
<br>
<div style="text-align: left;">
<b><span class="gbcom"><span id="m_d1462533632">Для справки. Создание системной таблицы </span></span><span class="gbcom"><span id="m_d1462533632">USysRibbons в Access 2016  </span></span></b></div>
<ol style="text-align: left;">
<li>Запускаем Access, создаём новую базу данных или открываем старую.</li>
<li>Проверка настройки № 1. Открываем вкладку «Файл», выбираем 
«Параметры», переходим в «Параметры клиента» и ищем раздел «Общий». 
Убеждаемся, что галочка на пункте «Показывать ошибки интерфейса 
пользователя надстроек» установлена.</li>
<li>Проверка настройки № 2. В левой панели навигации щёлкаем правой 
кнопкой и выбираем пункт «Параметры навигации...». Убеждаемся, что 
галочка на пункте «Показывать системные объекты» установлена.</li>
<li>На ленте открываем вкладку «Создание» и нажимаем кнопку «Конструктор таблиц».</li>
<li>Создаём 3 поля: ID («Счётчик»), RibbonName («Короткий текст» или 
«Текст») и RibbonXML («Длинный текст» или «MEMO»). Щёлкаем по строке 
поля ID и нажимаем на ленте кнопку «Ключевое поле».</li>
<li>Нажимаем «Сохранить» <i>(дискетка на панели быстрого доступа или Ctrl+S)</i>. На запрос имени таблицы вводим <span class="gbcom"><span id="m_d1462533632">USysRibbons. Таблица создана и сохранена.</span></span></li>
<li><span class="gbcom"><span id="m_d1462533632">Открываем таблицу и 
вводим туда данные — имя нашей ленты и её XML-код. Так мы можем ввести в
 таблицу несколько лент, каждую в свою строку таблицы, и впоследствии 
выбирать тот или иной интерфейс в зависимости от показанной на экране 
формы или отчёта <i>(настраивается в окне свойств конструктора формы, вкладка «Другие», параметр «Имя ленты»)</i>.
 Сохраняем данные, закрываем, а затем снова открываем файл базы данных. 
Теперь Access знает о существовании пользовательского варианта 
интерфейса. Осталось его подключить.</span></span></li>
<li>Открываем вкладку «Файл», выбираем 
«Параметры», переходим в пункт «Текущая база данных» и ищем раздел 
«Параметры ленты и панелей инструментов». В комбобоксе «Имя ленты» 
выбираем имя, которое мы присвоили интерфейсу в поле RibbonName. </li>
<li>Закрываем, а затем снова открываем файл базы данных. Если всё 
сделано правильно и в XML-коде нет ошибок, база данных должна открыться с
 пользовательской лентой. Если лента не появилась, попробуйте закрыть и 
открыть приложение Access целиком</li>
</ol>
</div></div>
</body>
</html></p></body></html>