<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Предыстория: меняется база ORACLE (переезд с 7 на 10). Меняются адреса, TNS names, ODBS.<br />Есть порядка 500 Access баз . Перелинковывать таблицы в каждой базе скриптом не очень хочется, а уж тем более вручную.<br /></span><span style=" font-size:8.25pt; font-weight:600;">Задачка: </span><span style=" font-size:8.25pt;"><br />1. Нужно программно пробежаться по заданной директории (включая вложенные) - решаемо.<br />2. Если база Access, то открыть<br />2-1. Пробежаться по коллекции таблиц, если прилинкованная и имя сервера равно искомому, то перелинковать. <br />2-2. Пробежаться по коллекции запросов, если запрос к серверу и имя сервера равно искомому, то перелинковать. <br />2-3. Проверить модули VBA (а так же формы и отчеты ) на зашитость в коде имен серверов, при необходимости поменять и откомпилить.<br />3. По идее базу надо сжать.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#000000;">Option Compare Database <br />Option Explicit <br /><br />Declare Function SQLDataSources Lib &quot;odbc32.dll&quot; (ByVal HENV As Long, _ <br />                                                  ByVal Direction As Long, _ <br />                                                  ByVal DSN As String, _ <br />                                                  ByVal DSNMax As Integer, _ <br />                                                  ByRef DSNLen As Integer, _ <br />                                                  ByVal Description As String, _ <br />                                                  ByVal DescriptionMax As Integer, _ <br />                                                  ByRef DescriptionLen As Integer) As Integer <br /><br />Declare Function SQLAllocEnv Lib &quot;odbc32.dll&quot; (ByRef HENV As Long) As Integer <br /><br />Const SQL_SUCCESS As Long = 0 <br />Const SQL_FETCH_NEXT As Long = 1 <br /><br />' =========================================================================== <br />' Назначение модуля: <br />'           Настройка связанных таблиц между базами данных <br />' Автор:                            Силыч <br />' Организация:                      ************** <br />' Дата начала разработки:           12.12.2006 <br />' Дата последней модификации: <br />' =========================================================================== <br /><br /><br />' =========================================================================== <br />' Назначение процедуры: <br />'           Настройка связанных таблиц на удаленные базы данных <br />' Автор:                            Силыч <br />' Создание:                         12.12.2006 <br />' Последняя модификация: <br />' =========================================================================== <br />Public Function RefreshLinkTables(Optional SolveOrder&amp; = 0) As Boolean <br />Dim rstPath     As ADODB.Recordset <br />Dim spcRS       As DAO.Recordset <br />Dim stf         As DAO.TableDef <br />Dim dtf         As DAO.TableDef <br />Dim sbd         As DAO.Database <br />Dim dbd         As DAO.Database <br />Dim cbd         As DAO.Database <br />Dim strSQL$, strConnect$, sTbNam$, spcID&amp;, spcCurrentID&amp; <br /><br />On Error GoTo ErrRefreshLinkTables <br />    '-- В этой таблице содержится информация о настройках приложения. <br />    '-- Там, где bLink = True указываются пути к файлам баз данных <br />    Set cbd = CurrentDb <br />    If SolveOrder = 0 Then <br />        strSQL = &quot;SELECT * FROM _tuneLinks order by iOrder&quot; <br />    Else <br />        strSQL = &quot;SELECT * FROM _tuneLinks WHERE sOrder=&quot; &amp; SolveOrder &amp; &quot; order by iOrder&quot; <br />    End If <br />    Set rstPath = New ADODB.Recordset <br />    With rstPath <br />        .Open strSQL, CurrentProject.Connection, adOpenKeyset, adLockOptimistic <br />        Do Until .EOF <br />            '-- только для существующих источников и приемников <br />            If (Len(Dir(.Fields(&quot;srcPath&quot;))) &lt;&gt; 0 And _ <br />                 .Fields(&quot;lnkType&quot;) &lt;&gt; 3) Or _ <br />                ((.Fields(&quot;dstPath&quot;) &lt;&gt; &quot;CurrentDB&quot; And _ <br />                UCase(Right(.Fields(&quot;dstPath&quot;), 3)) &lt;&gt; &quot;MDB&quot; And _ <br />                Len(Dir(.Fields(&quot;dstPath&quot;))) &lt;&gt; 0)) Then <br />                 <br />                '-- далее, в зависимости от типа настройки <br />                Select Case .Fields(&quot;lnkType&quot;) <br />'-- Link ODBC---------------------------------------------------------- <br />                Case 3 <br />                    If .Fields(&quot;dstPath&quot;) = &quot;CurrentDB&quot; Then <br />                        Set dbd = cbd <br />                    Else <br />                        Set dbd = DBEngine.Workspaces(0).OpenDatabase(.Fields(&quot;dstPath&quot;)) <br />                    End If <br />                    '-- удалить связь <br />                    On Error Resume Next <br />                    dbd.TableDefs.Delete .Fields(&quot;lnkNam&quot;) <br />                    dbd.TableDefs.Refresh <br />                    On Error GoTo ErrRefreshLinkTables <br />                    '-- создать по новой, если bLink&lt;&gt;0 <br />                    If .Fields(&quot;bLink&quot;) &lt;&gt; 0 And .Fields(&quot;aLink&quot;) &lt;&gt; 0 Then <br />                        Set dtf = dbd.CreateTableDef(.Fields(&quot;lnkNam&quot;)) <br />                        '--&quot;ODBC;DSN=SERVER.XXXYYY;UID=UserID;PWD=PASSWORD;DATABASE=DBNAME;AutoTranslate=No&quot; <br />                        dtf.Connect = .Fields(&quot;srcPath&quot;) <br />                        dtf.SourceTableName = .Fields(&quot;objNam&quot;) <br />                        'добавляем таблицу в семейство TableDefs <br />                        dbd.TableDefs.Append dtf <br />                        dbd.TableDefs.Refresh <br />                    End If <br />'-- Link TXT ---------------------------------------------------------- <br />                Case 2 <br />                    sTbNam = GetShortFileName(.Fields(&quot;srcPath&quot;)) <br />                    Set dbd = DBEngine.Workspaces(0).OpenDatabase(.Fields(&quot;dstPath&quot;)) <br />                 <br />                    '-- разберемся со спецификациями <br />                    spcID = 0 <br />                    Set spcRS = cbd.OpenRecordset(&quot;SELECT * FROM MSysIMEXSpecs &quot; &amp; _ <br />                               &quot;WHERE SpecName='&quot; &amp; Nz(.Fields(&quot;spcNam&quot;), &quot;&quot;) &amp; &quot;'&quot;) <br />                    If Not spcRS.EOF Then spcCurrentID = spcRS.Fields(&quot;SpecID&quot;) <br />                    spcRS.Close <br />                    Set spcRS = dbd.OpenRecordset(&quot;SELECT * FROM MSysIMEXSpecs &quot; &amp; _ <br />                               &quot;WHERE SpecName='&quot; &amp; Nz(.Fields(&quot;spcNam&quot;), &quot;&quot;) &amp; &quot;'&quot;) <br />                    If Not spcRS.EOF Then spcID = spcRS.Fields(&quot;SpecID&quot;) <br />                    If spcID &lt;&gt; 0 Then <br />                        '-- удалим колонки <br />                        dbd.Execute &quot;DELETE * FROM MSysIMEXColumns WHERE SpecID=&quot; &amp; spcID, dbFailOnError <br />                        '-- удалим пецификации <br />                        dbd.Execute &quot;DELETE * FROM MSysIMEXSpecs WHERE SpecID=&quot; &amp; spcID, dbFailOnError <br />                        spcID = 0 <br />                    End If <br />                    '-- залить по новой <br />                    cbd.Execute &quot;INSERT INTO MSysIMEXSpecs (DateDelim,DateFourDigitYear,&quot; &amp; _ <br />                                &quot;DateLeadingZeros,DateOrder,DecimalPoint,FieldSeparator,&quot; &amp; _ <br />                                &quot;FileType,SpecName,SpecType,StartRow,TimeDelim) &quot; &amp; _ <br />                                &quot;IN '&quot; &amp; .Fields(&quot;dstPath&quot;) &amp; &quot;' &quot; &amp; _ <br />                                &quot;SELECT DateDelim,DateFourDigitYear,&quot; &amp; _ <br />                                &quot;DateLeadingZeros,DateOrder,DecimalPoint,FieldSeparator,&quot; &amp; _ <br />                                &quot;FileType,SpecName,SpecType,StartRow,TimeDelim &quot; &amp; _ <br />                                &quot;FROM MSysIMEXSpecs &quot; &amp; _ <br />                                &quot;WHERE SpecName='&quot; &amp; Nz(.Fields(&quot;spcNam&quot;), &quot;&quot;) &amp; &quot;'&quot;, dbFailOnError <br />                    '-- получить новый spcID,если все удачно <br />                    Set spcRS = dbd.OpenRecordset(&quot;SELECT * FROM MSysIMEXSpecs WHERE SpecName='&quot; &amp; Nz(.Fields(&quot;spcNam&quot;), &quot;&quot;) &amp; &quot;'&quot;) <br />                    If Not spcRS.EOF Then spcID = spcRS.Fields(&quot;SpecID&quot;) <br />                    '-- нет такой спецификации или не удалось создать <br />                    If spcID = 0 Then <br />                        MsgBox &quot;Ошибка при обновлении связей таблиц:&quot; &amp; vbCrLf &amp; &quot;Не удалось создать спецификацию&quot; &amp; vbCrLf &amp; _ <br />                               &quot;[&quot; &amp; .Fields(&quot;spcNam&quot;) &amp; &quot;]&quot; &amp; vbCrLf &amp; _ <br />                               &quot;Обратитесь к разработчикам.&quot;, vbExclamation + vbOKOnly, &quot;Обновление связей таблиц&quot; <br />                        GoTo Exit1 <br />                    Else <br />                        cbd.Execute &quot;INSERT INTO MSysIMEXColumns (SpecID,Attributes,&quot; &amp; _ <br />                                    &quot;DataType,FieldName,IndexType,SkipColumn,Start,Width) &quot; &amp; _ <br />                                    &quot;IN '&quot; &amp; .Fields(&quot;dstPath&quot;) &amp; &quot;' &quot; &amp; _ <br />                                    &quot;SELECT &quot; &amp; spcID &amp; &quot; as SpecID,Attributes,&quot; &amp; _ <br />                                    &quot;DataType,FieldName,IndexType,SkipColumn,Start,Width &quot; &amp; _ <br />                                    &quot;FROM MSysIMEXColumns &quot; &amp; _ <br />                                    &quot;WHERE SpecID=&quot; &amp; spcCurrentID, dbFailOnError <br />                    End If <br />                    '-- по любасу удалить связь нах <br />                    '-- имеем полное моральное право написать в данном случае <br />                    On Error Resume Next <br />                    dbd.TableDefs.Delete .Fields(&quot;lnkNam&quot;) <br />                    dbd.TableDefs.Refresh <br />                    On Error GoTo ErrRefreshLinkTables <br />                    '-- создать по новой, если bLink&lt;&gt;0 <br />                    If .Fields(&quot;bLink&quot;) &lt;&gt; 0 And .Fields(&quot;aLink&quot;) &lt;&gt; 0 Then <br />                        Set dtf = dbd.CreateTableDef(.Fields(&quot;lnkNam&quot;)) <br />                        dtf.Connect = &quot;Text;DSN=&quot; &amp; .Fields(&quot;spcNam&quot;) &amp; &quot;;FMT=&quot; &amp; .Fields(&quot;spcFMT&quot;) &amp; _ <br />                                      &quot;;HDR=NO;IMEX=2;CharacterSet=&quot; &amp; .Fields(&quot;spc4set&quot;) &amp; &quot;;&quot; &amp; _ <br />                                      &quot;DATABASE=&quot; &amp; Left(.Fields(&quot;srcPath&quot;), Len(.Fields(&quot;srcPath&quot;)) - Len(sTbNam) - 1) <br />                        dtf.SourceTableName = sTbNam <br />                        'добавляем таблицу в семейство TableDefs <br />                        dbd.TableDefs.Append dtf <br />                        dbd.TableDefs.Refresh <br />                    End If <br />'-- Link Excel ---------------------------------------------------------- <br />                Case 1 <br />                    '-- создать по новой, если bLink&lt;&gt;0 And .Fields(&quot;aLink&quot;) <br />                    If .Fields(&quot;bLink&quot;) &lt;&gt; 0 And .Fields(&quot;aLink&quot;) &lt;&gt; 0 Then <br />                        sTbNam = GetShortFileName(.Fields(&quot;srcPath&quot;)) <br />                        If .Fields(&quot;dstPath&quot;) = &quot;CurrentDB&quot; Then <br />                            Set dbd = cbd <br />                        Else <br />                            Set dbd = DBEngine.Workspaces(0).OpenDatabase(.Fields(&quot;dstPath&quot;)) <br />                        End If <br />                        '-- удалить связь <br />                        On Error Resume Next <br />                        dbd.TableDefs.Delete .Fields(&quot;lnkNam&quot;) <br />                        dbd.TableDefs.Refresh <br />                        On Error GoTo ErrRefreshLinkTables <br />                        '-- создать по новой, если bLink&lt;&gt;0 <br />                        If .Fields(&quot;bLink&quot;) &lt;&gt; 0 And .Fields(&quot;aLink&quot;) &lt;&gt; 0 Then <br />                            Set dtf = dbd.CreateTableDef(.Fields(&quot;lnkNam&quot;)) <br />                            dtf.Connect = &quot;Excel 5.0;DATABASE=&quot; &amp; .Fields(&quot;srcPath&quot;) <br />                            dtf.SourceTableName = Trim(.Fields(&quot;objNam&quot;)) &amp; &quot;$&quot; <br />                            'добавляем таблицу в семейство TableDefs <br />                            dbd.TableDefs.Append dtf <br />                            dbd.TableDefs.Refresh <br />                            'Set sbd = DBEngine.Workspaces(0).OpenDatabase(.Fields(&quot;srcPath&quot;)) <br />                        End If <br />                    End If <br />'-- Link Access ---------------------------------------------------------- <br />                Case 0 <br />                    sTbNam = GetShortFileName(.Fields(&quot;srcPath&quot;)) <br />                    If .Fields(&quot;dstPath&quot;) = &quot;CurrentDB&quot; Then <br />                        Set dbd = cbd <br />                    Else <br />                        Set dbd = DBEngine.Workspaces(0).OpenDatabase(.Fields(&quot;dstPath&quot;)) <br />                    End If <br />                    '-- удалить связь <br />                    On Error Resume Next <br />                    dbd.TableDefs.Delete .Fields(&quot;lnkNam&quot;) <br />                    dbd.TableDefs.Refresh <br />                    On Error GoTo ErrRefreshLinkTables <br />                    '-- создать по новой, если bLink&lt;&gt;0 <br />                    If .Fields(&quot;bLink&quot;) &lt;&gt; 0 And .Fields(&quot;aLink&quot;) &lt;&gt; 0 Then <br />                        Set dtf = dbd.CreateTableDef(.Fields(&quot;lnkNam&quot;)) <br />                        dtf.Connect = &quot;;DATABASE=&quot; &amp; .Fields(&quot;srcPath&quot;) <br />                        dtf.SourceTableName = .Fields(&quot;objNam&quot;) <br />                        'добавляем таблицу в семейство TableDefs <br />                        dbd.TableDefs.Append dtf <br />                        dbd.TableDefs.Refresh <br />                    End If <br />                End Select <br />                Set sbd = Nothing: Set dbd = Nothing <br />            End If <br />            .MoveNext <br />        Loop <br />    End With <br />    RefreshLinkTables = True <br />Exit1: <br />    rstPath.Close: Set rstPath = Nothing <br />    '-- Освобождение объектов <br />    Set stf = Nothing: Set dtf = Nothing <br />    Set sbd = Nothing: Set dbd = Nothing: Set cbd = Nothing <br />    Exit Function <br />'-- Обработка ошибки подключения <br />ErrRefreshLinkTables: <br />    MsgBox &quot;Ошибка при обновлении связей таблиц:&quot; &amp; vbCrLf &amp; Err.Description, _ <br />            vbExclamation + vbOKOnly, &quot;Обновление связей таблиц&quot; <br />    RefreshLinkTables = False <br />    GoTo Exit1 <br />End Function <br /><br />' <br />Function ODBC_GetListDSN() <br />    Dim i As Integer <br />    Dim sDSNItem As String * 1024 <br />    Dim sDRVItem As String * 1024 <br />    Dim sDSN As String <br />    Dim sDRV As String <br />    Dim iDSNLen As Integer <br />    Dim iDRVLen As Integer <br />    Dim lHenv As Long <br /><br />    On Error Resume Next <br />    'получаем DSN's <br />    If SQLAllocEnv(lHenv) &lt;&gt; -1 Then <br />        Do Until i &lt;&gt; SQL_SUCCESS <br />            sDSNItem = Space$(1024) <br />            sDRVItem = Space$(1024) <br />            i = SQLDataSources(lHenv, SQL_FETCH_NEXT, sDSNItem, 1024, _ <br />                iDSNLen, sDRVItem, 1024, iDRVLen) <br />            sDSN = Left$(sDSNItem, iDSNLen) <br />            sDRV = Left$(sDRVItem, iDRVLen) <br />                  <br />            If sDSN &lt;&gt; Space(iDSNLen) Then <br />               Debug.Print sDSN, sDRV <br />            End If <br />        Loop <br />    End If <br />End Function <br /><br /><br />Function Translit_TO_ODBC(Source$) As String <br />Dim i%, R$ <br />For i = 1 To Len(Source) <br />Select Case Mid(Source, i, 1) <br />'------------------------------------------------------------------------------------- <br />Case &quot;А&quot; <br />R = R + &quot;A&quot; <br />Case &quot;Б&quot; <br />R = R + &quot;A&quot; <br />Case &quot;В&quot; <br />R = R + &quot;A&quot; <br />Case &quot;Г&quot; <br />R = R + &quot;A&quot; <br />Case &quot;Д&quot; <br />R = R + &quot;A&quot; <br />Case &quot;Е&quot; <br />R = R + &quot;A&quot; <br />Case &quot;Ж&quot; <br />R = R + &quot;?&quot; <br />Case &quot;З&quot; <br />R = R + &quot;C&quot; <br />Case &quot;И&quot; <br />R = R + &quot;E&quot; <br />Case &quot;Й&quot; <br />R = R + &quot;E&quot; <br />Case &quot;К&quot; <br />R = R + &quot;E&quot; <br />Case &quot;Л&quot; <br />R = R + &quot;E&quot; <br />Case &quot;М&quot; <br />R = R + &quot;I&quot; <br />Case &quot;Н&quot; <br />R = R + &quot;I&quot; <br />Case &quot;О&quot; <br />R = R + &quot;I&quot; <br />Case &quot;П&quot; <br />R = R + &quot;I&quot; <br />Case &quot;Р&quot; <br />R = R + &quot;?&quot; <br />Case &quot;С&quot; <br />R = R + &quot;N&quot; <br />Case &quot;Т&quot; <br />R = R + &quot;O&quot; <br />Case &quot;У&quot; <br />R = R + &quot;O&quot; <br />Case &quot;Ф&quot; <br />R = R + &quot;O&quot; <br />Case &quot;Х&quot; <br />R = R + &quot;O&quot; <br />Case &quot;Ц&quot; <br />R = R + &quot;O&quot; <br />Case &quot;Ч&quot; <br />R = R + &quot;?&quot; <br />Case &quot;Ш&quot; <br />R = R + &quot;O&quot; <br />Case &quot;Щ&quot; <br />R = R + &quot;U&quot; <br />Case &quot;Ъ&quot; <br />R = R + &quot;U&quot; <br />Case &quot;Ы&quot; <br />R = R + &quot;U&quot; <br />Case &quot;Ь&quot; <br />R = R + &quot;U&quot; <br />Case &quot;Э&quot; <br />R = R + &quot;Y&quot; <br />Case &quot;Ю&quot; <br />R = R + &quot;?&quot; <br />Case &quot;Я&quot; <br />R = R + &quot;?&quot; <br />Case &quot;а&quot; <br />R = R + &quot;a&quot; <br />Case &quot;б&quot; <br />R = R + &quot;a&quot; <br />Case &quot;в&quot; <br />R = R + &quot;a&quot; <br />Case &quot;г&quot; <br />R = R + &quot;a&quot; <br />Case &quot;д&quot; <br />R = R + &quot;a&quot; <br />Case &quot;е&quot; <br />R = R + &quot;a&quot; <br />Case &quot;ж&quot; <br />R = R + &quot;?&quot; <br />Case &quot;з&quot; <br />R = R + &quot;c&quot; <br />Case &quot;и&quot; <br />R = R + &quot;e&quot; <br />Case &quot;й&quot; <br />R = R + &quot;e&quot; <br />Case &quot;к&quot; <br />R = R + &quot;e&quot; <br />Case &quot;л&quot; <br />R = R + &quot;e&quot; <br />Case &quot;м&quot; <br />R = R + &quot;i&quot; <br />Case &quot;н&quot; <br />R = R + &quot;i&quot; <br />Case &quot;о&quot; <br />R = R + &quot;i&quot; <br />Case &quot;п&quot; <br />R = R + &quot;i&quot; <br />Case &quot;р&quot; <br />R = R + &quot;?&quot; <br />Case &quot;с&quot; <br />R = R + &quot;n&quot; <br />Case &quot;т&quot; <br />R = R + &quot;o&quot; <br />Case &quot;у&quot; <br />R = R + &quot;o&quot; <br />Case &quot;ф&quot; <br />R = R + &quot;o&quot; <br />Case &quot;х&quot; <br />R = R + &quot;o&quot; <br />Case &quot;ц&quot; <br />R = R + &quot;o&quot; <br />Case &quot;ч&quot; <br />R = R + &quot;?&quot; <br />Case &quot;ш&quot; <br />R = R + &quot;o&quot; <br />Case &quot;щ&quot; <br />R = R + &quot;u&quot; <br />Case &quot;ъ&quot; <br />R = R + &quot;u&quot; <br />Case &quot;ы&quot; <br />R = R + &quot;u&quot; <br />Case &quot;ь&quot; <br />R = R + &quot;u&quot; <br />Case &quot;э&quot; <br />R = R + &quot;y&quot; <br />Case &quot;ю&quot; <br />R = R + &quot;?&quot; <br />Case &quot;я&quot; <br />R = R + &quot;y&quot; <br />Case &quot;І&quot; <br />R = R + &quot;?&quot; <br />Case &quot;і&quot; <br />R = R + &quot;?&quot; <br />Case &quot;Ї&quot; <br />R = R + &quot;?&quot; <br />Case &quot;ї&quot; <br />R = R + &quot;?&quot; <br />Case &quot;є&quot; <br />R = R + &quot;?&quot; <br />Case &quot;Є&quot; <br />R = R + &quot;?&quot; <br />Case &quot;Ё&quot; <br />R = R + &quot;?&quot; <br />Case &quot;ё&quot; <br />R = R + &quot;?&quot; <br />Case Else <br />R = R + Mid(Source$, i%, 1) <br />End Select <br />Next <br />Translit_TO_ODBC = R$ <br />End Function <br /><br />Function Translit_From_ODBC(Source$) As String <br />Dim i%, R$ <br />For i = 1 To Len(Source) <br />Select Case Mid(Source, i, 1) <br /><br />Case &quot;L&quot; <br />R = R + &quot;А&quot; <br />Case &quot;+&quot; <br />R = R + &quot;Б&quot; <br />Case &quot;T&quot; <br />R = R + &quot;В&quot; <br />Case &quot;+&quot; <br />R = R + &quot;Г&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Д&quot; <br />Case &quot;+&quot; <br />R = R + &quot;Е&quot; <br />Case &quot;a&quot; <br />R = R + &quot;Ж&quot; <br />Case &quot;A&quot; <br />R = R + &quot;З&quot; <br />Case &quot;L&quot; <br />R = R + &quot;И&quot; <br />Case &quot;г&quot; <br />R = R + &quot;Й&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;К&quot; <br />Case &quot;T&quot; <br />R = R + &quot;Л&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;М&quot; <br />Case &quot;=&quot; <br />R = R + &quot;Н&quot; <br />Case &quot;+&quot; <br />R = R + &quot;О&quot; <br />Case &quot;¤&quot; <br />R = R + &quot;П&quot; <br />Case &quot;?&quot; <br />R = R + &quot;Р&quot; <br />Case &quot;?&quot; <br />R = R + &quot;С&quot; <br />Case &quot;E&quot; <br />R = R + &quot;Т&quot; <br />Case &quot;E&quot; <br />R = R + &quot;У&quot; <br />Case &quot;E&quot; <br />R = R + &quot;Ф&quot; <br />Case &quot;?&quot; <br />R = R + &quot;Х&quot; <br />Case &quot;I&quot; <br />R = R + &quot;Ц&quot; <br />Case &quot;I&quot; <br />R = R + &quot;Ч&quot; <br />Case &quot;I&quot; <br />R = R + &quot;Ш&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Щ&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Ъ&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Ы&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Ь&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;Э&quot; <br />Case &quot;I&quot; <br />R = R + &quot;Ю&quot; <br />Case &quot;-&quot; <br />R = R + &quot;Я&quot; <br />Case &quot;O&quot; <br />R = R + &quot;а&quot; <br />Case &quot;?&quot; <br />R = R + &quot;б&quot; <br />Case &quot;O&quot; <br />R = R + &quot;в&quot; <br />Case &quot;O&quot; <br />R = R + &quot;г&quot; <br />Case &quot;o&quot; <br />R = R + &quot;д&quot; <br />Case &quot;O&quot; <br />R = R + &quot;е&quot; <br />Case &quot;µ&quot; <br />R = R + &quot;ж&quot; <br />Case &quot;?&quot; <br />R = R + &quot;з&quot; <br />Case &quot;?&quot; <br />R = R + &quot;и&quot; <br />Case &quot;U&quot; <br />R = R + &quot;й&quot; <br />Case &quot;U&quot; <br />R = R + &quot;к&quot; <br />Case &quot;U&quot; <br />R = R + &quot;л&quot; <br />Case &quot;y&quot; <br />R = R + &quot;м&quot; <br />Case &quot;Y&quot; <br />R = R + &quot;н&quot; <br />Case &quot;?&quot; <br />R = R + &quot;о&quot; <br />Case &quot;?&quot; <br />R = R + &quot;п&quot; <br />Case &quot;­&quot; <br />R = R + &quot;р&quot; <br />Case &quot;±&quot; <br />R = R + &quot;с&quot; <br />Case &quot;?&quot; <br />R = R + &quot;т&quot; <br />Case &quot;?&quot; <br />R = R + &quot;у&quot; <br />Case &quot;¶&quot; <br />R = R + &quot;ф&quot; <br />Case &quot;§&quot; <br />R = R + &quot;х&quot; <br />Case &quot;?&quot; <br />R = R + &quot;ц&quot; <br />Case &quot;?&quot; <br />R = R + &quot;ч&quot; <br />Case &quot;°&quot; <br />R = R + &quot;ш&quot; <br />Case &quot;?&quot; <br />R = R + &quot;щ&quot; <br />Case &quot;·&quot; <br />R = R + &quot;ъ&quot; <br />Case &quot;?&quot; <br />R = R + &quot;ы&quot; <br />Case &quot;?&quot; <br />R = R + &quot;ь&quot; <br />Case &quot;?&quot; <br />R = R + &quot;э&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;ю&quot; <br />Case &quot; &quot; <br />R = R + &quot;я&quot; <br />Case &quot;-&quot; <br />R = R + &quot;І&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;і&quot; <br />Case &quot;»&quot; <br />R = R + &quot;Ї&quot; <br />Case &quot;¬&quot; <br />R = R + &quot;ї&quot; <br />Case &quot;¬&quot; <br />R = R + &quot;Є&quot; <br />Case &quot;¦&quot; <br />R = R + &quot;є&quot; <br />Case &quot;?&quot; <br />R = R + &quot;ё&quot; <br />Case &quot;©&quot; <br />R = R + &quot;ё&quot; <br />Case Else <br />R = R + Mid(Source$, i%, 1) <br />End Select <br />Next <br />Translit_From_ODBC = R <br />End Function </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; color:#000000;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier'; color:#000000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">структура таблицы _tuneLinks (см. аттач)<br />пример данных<br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier'; color:#000000;"><br />tpAdm    bLink    aLink    sOrder    iOrder    srcPath    dstPath    objNam    lnkNam    lnkType    spcNam    spcFMT    spc4set <br />SYS    ИСТИНА    ИСТИНА    1    1    C:\OTCH\TXT\#ss-12345.txt    C:\gs200607.mdb        nbu    Файл TXT    spec_NBU    Fixed    866 <br />SYS    ИСТИНА    ИСТИНА    1    2    L:\cort.txt    C:\gs200607.mdb        ocb    Файл TXT    spec_OCB    Delimited    866 <br />SYS    ЛОЖЬ    ЛОЖЬ    4    12    ODBC;DSN=SERVER.XXXYYYY;UID=UserID;PWD=PASSWORD;DATABASE=DBNAME;AutoTranslate=No    CurrentDB    dbo.TableName    srv_TableName    ODBC             <br />SYS    ИСТИНА    ИСТИНА    2    13    M:\ОБЩИЕ\gs200607.mdb    CurrentDB    cmp4    work_cmp4    Таблица Access     </span></p></td></tr></table></body></html>