<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Top"></a><span style=" font-size:8.25pt; font-weight:600;">M</span><span style=" font-size:8.25pt; font-weight:600;">icrosoft Access: Советы для серьезных пользователей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Автор Allen Browne. , март 2007 г.  Последнее обновление: ноябрь 2008 г.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Оригинал </span><a href="http://allenbrowne.com/ser-71.html"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">http://allenbrowne.com/ser-71.html</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Перевел </span><a href="mailto:alx.artamonov@yandex.ru"><span style=" font-size:8.25pt; text-decoration: underline; color:#0000ff;">Александр Артамонов</span></a><span style=" font-size:8.25pt;">, ноябрь 2011 г.</span></p>
<hr />
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Копировать инструкцию SQL из запроса в VBA</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image16452.png" /><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вместо того, чтобы печатать сложный запрос непосредственно в коде VBA, разработчики часто строят запрос графически, переключают в SQL вид, копируют текст и вставляют в редактор VBA.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если вы это делали, вы знаете, как утомительно разбираться с кавычками и концами строк.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Решение: создайте форму, у которую вы <span style=" font-weight:600;">вставите инструкцию SQL</span> и заставите Аксесс сформировать SQL строку.</p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Создание формы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Форме нужны только два текстовых поля и командная кнопка. Инструкции SQL могут быть довольно длинные, так что лучше разместить текстовые поля на разных страницах вкладки.</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создать новую <span style=" font-weight:600;">форму</span> (в режиме конструктора.)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавить элемент <span style=" font-weight:600;">&quot;вкладка&quot;</span>.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На первой странице вкладки, добавьте несвязанное <span style=" font-weight:600;">текстовое поле</span>.<br />Установите свойство Имя на <span style=" font-style:italic;">txtSql</span>.<br />Увеличьте высоту и ширину, так, чтобы видеть много строк сразу.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На второй странице вкладки добавьте еще одно несвязанное <span style=" font-weight:600;">текстовое поле</span>.<br />Назовите его <span style=" font-style:italic;">txtVBA</span> и увеличьте высоту и ширину.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Над вкладкой разместите <span style=" font-weight:600;">командную кнопку</span>. <br />Назовите ее <span style=" font-style:italic;">cmdSql2Vba</span>. <br />Установите ее свойство Нажатие кнопки в <span style=" font-style:italic;">[Процедура события]</span>.<br />Нажмите на кнопку построителя (...) напротив этого свойства.<br />Когда Аксесс откроет окно редактора кода, введите следующий код:</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;"><a name="cmdSql2Vba_Click"></a><span style=" font-family:'Courier New,courier';">P</span><span style=" font-family:'Courier New,courier';">rivate Sub cmdSql2Vba_Click()<br />    Dim strSql As String<br />    'Назначение:   Конвертация инструкции SQL в строковое значение для вставки в код VBA code.<br />    Const strcLineEnd = &quot; &quot;&quot; &amp; vbCrLf &amp; _&quot; &amp; vbCrLf &amp; &quot;&quot;&quot;&quot;<br /><br />    <br />    If IsNull(Me.txtSQL) Then<br />        Beep<br />    Else<br />        strSql = Me.txtSQL<br />        strSql = Replace(strSql, &quot;&quot;&quot;&quot;, &quot;&quot;&quot;&quot;&quot;&quot;)  'Удвойте возможные кавычки.<br />        strSql = Replace(strSql, vbCrLf, strcLineEnd)<br />        strSql = &quot;strSql = &quot;&quot;&quot; &amp; strSql &amp; &quot;&quot;&quot;&quot;<br />        Me.txtVBA = strSql<br />        Me.txtVBA.SetFocus<br />        RunCommand acCmdCopy<br />    End If<br />End Sub</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Использование формы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы пользоваться формой:</p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Откройте запрос в режиме SQL и скопируйте инструкцию SQL в буфер обмена (Ctrl+C.)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставьте содержимое буфера в первое текстовое поле (Ctrl+V.)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Нажмите кнопку.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставьте на новую строку в вашей VBA процедуре (Ctrl+V.)</li></ol>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Совет: Если вам нужны дополнительные разрывы строк в коде VBA, нажмите Enter чтобы создать эти переносы строк в режиме SQL конструктора запросов или в вашей форме.</span></p>
<hr />
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Примечание переводчика: готовый пример такой утилиты, выполненной в виде надстройки Аксесс, чтобы загружать форму из любого приложения mdb - при наличии полной версии Access -  можно скачать </span><a href="http://alx-artamonov.narod.ru/olderfiles/1/sql2vba.zip"><span style=" font-style:italic; text-decoration: underline; color:#0000ff;">здесь</span></a>.<span style=" font-style:italic;"> Можно пользоваться и как самостоятельным приложением, не установленным в виде надстройки меню</span></p></body></html>