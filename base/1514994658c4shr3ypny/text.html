<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Code execution has been interrupted - что за баг? </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Иногда при выполнении вполне рабочего кода может возникнуть ошибка &quot;</span><span style=" font-size:8.25pt; font-weight:600;">Code execution has been interrupted</span><span style=" font-size:8.25pt;">&quot;:<br /></span><img src="image24878.png" /><span style=" font-size:8.25pt;"><br />чаще всего она появляется в циклах (это Do ... Loop, For each, For ... Next). Но может проявится и на отдельных участках кода совершенно независимо от того, что делает тот или иной кусок кода. Сама по себе ошибка не является таковой - при нажатии </span><span style=" font-size:8.25pt; font-weight:600;">Continue</span><span style=" font-size:8.25pt;"> код продолжает работать и может даже дойти до конца уже без ошибок. Но что примечательно - появившись в каком-то коде однажды, эта ошибка начинает преследовать вас и при этом воспроизводится только на том ПК, на котором появилась. На других же ПК код может работать отлично и без всяких казусов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Почему вообще появляется эта ошибка? Точный ответ на этот вопрос я, к сожалению, не дам. Только предположения: VBA тоже хранит всевозможные логи при работе и обращается к разным библиотекам. И скорее всего в какой-то момент этого хлама набирается так много, что VBE начинает &quot;подглючивать&quot; таким вот нестандартным образом, предполагая, что мы пытаемся выполнить параллельно два кода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">И главное: как ошибку Code execution has been interrupted устранить?<br />Я знаю два способа.<br />Способ 1 - разовый<br />Перед выполнением кода поставить строку: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7789a523120922323"></a><span style=" font-size:8.25pt;">A</span><span style=" font-size:8.25pt;">pplication.EnableCancelKey = xlDisabled </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7789a523120922323-1"></a><span style=" font-size:8.25pt;">A</span><span style=" font-size:8.25pt;">pplication.EnableCancelKey = xlDisabled</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">а после выполнения(перед End Sub или в любом месте, где может произойти выход из процедуры) её вернуть: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7789a52d963449206"></a><span style=" font-size:8.25pt;">A</span><span style=" font-size:8.25pt;">pplication.EnableCancelKey = xlEnabled </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-size:8.25pt;">1 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5a4ce7789a52d963449206-1"></a><span style=" font-size:8.25pt;">A</span><span style=" font-size:8.25pt;">pplication.EnableCancelKey = xlEnabled</span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">чем не нравится данный метод мне лично: свойство EnableCancelKey отвечает за возможность обработки нажатия клавиш при выполнении кода. Значение xlDisabled переводит VBA в режим &quot;глухой обороны&quot; - т.е. он не будет реагировать ни на какие нажатия пока не завершится выполнение кода. Догадались, чем это чревато? Правильно: если вдруг попали в бесконечный цикл или захотели прервать выполнение - ничего не получится, т.к. сочетание </span><span style=" font-size:8.25pt; font-weight:600;">Ctrl</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">Break</span><span style=" font-size:8.25pt;"> будет просто проигнорировано.</span></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Способ 2 - пожизненный(почти)<br />После появления ошибки нажмите </span><span style=" font-size:8.25pt; font-weight:600;">Debug</span><span style=" font-size:8.25pt;">, затем </span><span style=" font-size:8.25pt; font-weight:600;">Ctrl</span><span style=" font-size:8.25pt;">+</span><span style=" font-size:8.25pt; font-weight:600;">Break</span><span style=" font-size:8.25pt;">, затем кнопку </span><span style=" font-size:8.25pt; font-weight:600;">Play</span><span style=" font-size:8.25pt;"> на панели редактора VBE (зеленый треугольничек воспроизведения кода) - продолжится выполнение кода. После этого ошибка должна исчезнуть.<br />Главное жать не </span><span style=" font-size:8.25pt; font-weight:600;">F5</span><span style=" font-size:8.25pt;"> для продолжения выполнения, а именно треугольник на панели. Иначе может не сработать.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:8.25pt;"><br /></p>
<hr />
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Если знаете еще способы устранения ошибки - делитель в комментариях - это обязательно поможет кому-то спасти нервы и силы и в карму вам плюсанется :)</span></p></body></html>