<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/FileToVBAFunction"><span style=" text-decoration: underline; color:#0000ff;">Импорт файла в проект VBA - формирование функции VBA, создающей файл</span></a> </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/taxonomy/term/14"><span style=" text-decoration: underline; color:#0000ff;">Макросы VBA Excel</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/processing_files"><span style=" text-decoration: underline; color:#0000ff;">Обработка файлов</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/code/another"><span style=" text-decoration: underline; color:#0000ff;">Разное</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/pictures"><span style=" text-decoration: underline; color:#0000ff;">Изображения (картинки)</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/VBE"><span style=" text-decoration: underline; color:#0000ff;">Проект VBA</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/Windows"><span style=" text-decoration: underline; color:#0000ff;">Средства Windows</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/files"><span style=" text-decoration: underline; color:#0000ff;">Работа с файлами</span></a></li>
<li style=" font-size:8.25pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://excelvba.ru/category/different"><span style=" text-decoration: underline; color:#0000ff;">Разное</span></a> </li></ul></td></tr></table>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Функция FileToVBAFunction предназначена для сохранения произвольного файла в виде VBA кода.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">В любой момент вы можете вызвать сгенерированную функцию - она моментально создаст во временной папке необходимый файл, и вернет путь к созданному файлу.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Основное применение функции - сохранение небольших файлов (в основном, графических - иконок и маленьких картинок) в книге Excel.</span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Для того, чтобы прикрепить большие файлы к книге Excel, или если надо управлять вложенными файлами,<br />воспользуйтесь </span><a href="http://excelvba.ru/tools/Attachments"><span style=" font-size:8.25pt; font-weight:600; text-decoration: underline; color:#0000ff;">универсальным решением на базе модулей класса</span></a></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">При необходимости, такой файл в любой момент можно извлечь, просто вызвав созданную функцию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Примеры использования функции FileToVBAFunction:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> ПримерИспользования_FileToVBAFunction()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' преобразовываем заданный файл в VBA функцию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    txt$ = FileToVBAFunction(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;D:\Distr\аватары\joda.jpg&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;joda&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим созданную функцию в окно Immediate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    Debug.</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Print</span><span style=" font-family:'monospace'; font-size:8.25pt;"> txt$</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"><br /></span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Выбрать_Файл_и_Скопировать_Его_в_Виде_Кода_VBA_в_Буфер_Обмена()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' выводим диалоговое окно выбора файла</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    filename = Application.GetOpenFilename(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Любые файлы небольшого размера (*.*),&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, , _</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">                                           </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Выберите файл для загрузки в проект VBA&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Загрузить&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> VarType(filename) = vbBoolean </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Exit</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' пользователь отказался от выбора файла</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:8.25pt; color:#008000;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' преобразовываем заданный файл в VBA функцию</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    txt$ = FileToVBAFunction(filename, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;MyFile&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#008000;">' копируем полученный код VBA-функции в буфер обмена</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">With</span><span style=" font-family:'monospace'; font-size:8.25pt;"> GetObject(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        .SetText txt$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        .PutInClipboard</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">With</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Sub</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Запустив второй макрос (копирующий код созданной фунции в буфер обмена),<br />и вставив результат из буфера обмена в стандартный модуль VBA,<br />мы получим готовую функцию для создания файла примерно такого вида:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image7255.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Строки, содержащие данные файла, получаются очень длинные (около 1000 символов),<br />но зато количество строк в созданной функции обычно невелико, если мы таким образом прикрепляем к файлу Excel небольшие файлы и картинки.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">Поскольку в одной строке кода VBA мы можем сохранить около 500 байтов информации,<br />функция для создания, к примеру, 20-килобайтного файла, будет содержать около 50 строк кода<br />(около 40 строк с данными + 10 служебных строк, преобразовывающих эти данные в реальный файл)</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt; font-weight:600;">Код функции FileToVBAFunction:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Private</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span><span style=" font-family:'monospace'; font-size:8.25pt;"> FileToVBAFunction(</span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> filename$, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Optional</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">ByVal</span><span style=" font-family:'monospace'; font-size:8.25pt;"> name$ = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;noname&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">) </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">On</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Error</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Resume</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span><span style=" font-family:'monospace'; font-size:8.25pt;">: Err.Clear: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Const</span><span style=" font-family:'monospace'; font-size:8.25pt;"> BYTES_PER_ROW&amp; = 480</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Dim</span><span style=" font-family:'monospace'; font-size:8.25pt;"> F_Content$</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    ff&amp; = FreeFile: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Open</span><span style=" font-family:'monospace'; font-size:8.25pt;"> filename$ </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Binary</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Access Read </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">As</span><span style=" font-family:'monospace'; font-size:8.25pt;"> #ff</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    FS&amp; = LOF(ff): txt$ = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">String</span><span style=" font-family:'monospace'; font-size:8.25pt;">(FS&amp;, Chr(0))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Get</span><span style=" font-family:'monospace'; font-size:8.25pt;"> #ff, , txt$: </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Close</span><span style=" font-family:'monospace'; font-size:8.25pt;"> #ff</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Function GetFile_&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; name$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;() As String&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;' создаёт во временной папке файл, возвращает путь к созданному файлу&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;On Error Resume Next: Dim F_TXT$, buf$, tmp_file$: Const BufLen&amp; = 5000&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">For</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i = 1 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">To</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Len(txt$)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        r&amp; = Asc(Mid(txt, i, 1))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        res$ = res$ &amp; IIf(Len(Hex(r)) = 1, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;0&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">, </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">) &amp; Hex(r)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> i </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Mod</span><span style=" font-family:'monospace'; font-size:8.25pt;"> BYTES_PER_ROW&amp; = 0 </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;F_TXT$ = F_TXT$ &amp; &quot;&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; res$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">            res = </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;">: DoEvents</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">        </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">If</span><span style=" font-family:'monospace'; font-size:8.25pt;"> Len(res) </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Then</span><span style=" font-family:'monospace'; font-size:8.25pt;"> F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;F_TXT$ = F_TXT$ &amp; &quot;&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; res$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;&quot;&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;For i = 1 To Len(F_TXT$) / 2&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;buf$ = buf$ &amp; Chr(Val(&quot;&quot;&amp;H&quot;&quot; &amp; Mid(F_TXT$, 2 * i - 1, 2)))&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;If Len(buf$) &gt; BufLen&amp; Then res$ = res$ &amp; buf$: buf$ = &quot;&quot;&quot;&quot;: DoEvents&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Next: res$ = res$ &amp; buf$&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;tmp_file$ = Environ(&quot;&quot;tmp&quot;&quot;) &amp; &quot;&quot;\file_&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; name$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;&quot;&quot; : Kill tmp_file$&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;ff&amp; = FreeFile: Open tmp_file$ For Binary Access Write As #ff&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Put #ff, , res$&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;Close #ff&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;If FileLen(tmp_file$) = Len(F_TXT$) / 2 Then GetFile_&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; name$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot; = tmp_file$&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    F_Content$ = F_Content$ &amp; </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#800000;">&quot;End Function&quot;</span><span style=" font-family:'monospace'; font-size:8.25pt;"> &amp; vbNewLine</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt;">    FileToVBAFunction = F_Content$</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">End</span><span style=" font-family:'monospace'; font-size:8.25pt;"> </span><span style=" font-family:'monospace'; font-size:8.25pt; color:#000080;">Function</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:8.25pt;">  </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-size:8.25pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">13038 просмотров </li></ul></td>
<td></td></tr></table></body></html>