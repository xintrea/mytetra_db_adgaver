<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="макросы.files/filelist.xml">
<title>Глава 1</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>User</o:Author>
  <o:LastAuthor>User</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2012-02-01T08:43:00Z</o:Created>
  <o:LastSaved>2012-02-01T08:43:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>39679</o:Words>
  <o:Characters>226172</o:Characters>
  <o:Company>atp</o:Company>
  <o:Lines>1884</o:Lines>
  <o:Paragraphs>530</o:Paragraphs>
  <o:CharactersWithSpaces>265321</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HideSpellingErrors/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 5 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;
	mso-font-alt:\BC14\D0D5;
	mso-font-charset:129;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:auto;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\B3CB\C6C0;
	mso-font-charset:129;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\9ED1\4F53;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;
	mso-font-alt:\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134742016 16 0 1048576 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;
	mso-font-alt:\660E\671D;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;
	mso-font-alt:\AD74\B9BC;
	mso-font-charset:129;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 151388160 16 0 524288 0;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;
	mso-font-charset:222;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16777217 0 0 0 65536 0;}
@font-face
	{font-family:Mangal;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:32768 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:1048576 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:16778883 0 512 0 13 0;}
@font-face
	{font-family:Vrinda;
	panose-1:1 1 6 0 1 1 1 1 1 1;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Kartika;
	panose-1:2 2 5 3 3 4 4 6 2 3;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:204;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:513 0 0 0 4 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Обычный;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Обычный;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Обычный;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Обычный;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:26.95pt 28.3pt 35.95pt 45.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Обычная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=RU link=blue vlink=purple style='tab-interval:35.4pt'>

<div class=Section1>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><!--[if supportFields]><span
style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>TOC \o &quot;1-3&quot; \h \z \u <span
style='mso-element:field-separator'></span><![endif]--><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863492">ГЛАВА
1. МАКРОСЫ<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863492 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863493">Запуск
макроса с поиском ячейки<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863493 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863494">Запуск
макроса при открытии книги<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863494 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863495">Запуск
макроса при вводе в ячейку «2»<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863495 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863496">Запуск
макроса при нажатии «Ентер»<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863496 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863497">Добавить
в панель свою вкладку «Надстройки» (Формат ячейки)<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863497 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>7</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863498">ГЛАВА
2. РАБОТА С ФАЙЛАМИ (Т.Е.ОБМЕН ДАННЫМИ С ТХТ, RTF, XLS И Т.Д.)<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863498 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>8</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863499">Проверка
наличия файла по указанному пути_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863499 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>8</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003400390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863500">Проверка
наличия файла по указанному пути_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863500 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>8</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863501">Проверка
наличия файла по указанному пути_3<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863501 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>8</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863502">Поиск
нужного файла_1<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863502 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863503">Поиск<span
style='mso-ansi-language:EN-US'> </span>нужного<span style='mso-ansi-language:
EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:EN-US'>_2</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863503 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863504">Поиск
нужного файла_3<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863504 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863505">Поиск
нужного файла_4<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863505 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863506">Автоматизация
удаления файлов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863506 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863507">Произвольный
текст в строке состояния<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863507 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863508">Восстановление
строки состояния<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863508 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863509">Бегущая<span
style='mso-ansi-language:EN-US'> </span>строка<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>строке<span
style='mso-ansi-language:EN-US'> </span>состояния<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863509 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500300039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863510">Быстрое
изменение заголовка окна<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863510 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863511">Быстрое
изменение заголовка окна_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863511 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863512">Изменение
заголовка окна (со скрытием названия файла)<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863512 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863513">Возврат
к первоначальному заголовку<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863513 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863514">Что
открыто в данный момент<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863514 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863515">Работа
с текстовыми файлами<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863515 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863516">Запись
и чтение текстового файла<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863516 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>11</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863517">Обработка
нескольких текстовых файлов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863517 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>12</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863518">Определение
конца строки текстового файла<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863518 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>13</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863519">Копирование
из текстового файла в эксель<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863519 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>13</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863520">Копирование
содержимого в текстовый файл_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863520 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>13</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863521">Копирование
содержимого в текстовый файл_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863521 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>13</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863522">Экспорт
данных в HТМL<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863522 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>15</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863523">Создание
резервных копий ценных файлов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863523 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863524">Подсчет
количества открытий файла<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863524 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863525">Вывод
пути к файлу в активную ячейку<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863525 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863526">Копирование
содержимого файла RTF в эксель<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863526 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>20</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863527">Копирование<span
style='mso-ansi-language:EN-US'> </span>данных<span style='mso-ansi-language:
EN-US'> </span>из<span style='mso-ansi-language:EN-US'> </span>закрытой<span
style='mso-ansi-language:EN-US'> </span>книги<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863527 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>21</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863528">Извлечение
данных из закрытого файла<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863528 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>21</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863529">Поиск
слова в файлах<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863529 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>21</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500320039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863530">Создание
текстового файла и ввод текста в файл<span style='color:windowtext;display:
none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863530 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863531">Создание
текстового файла и ввод текста (определение конца файла)<span style='color:
windowtext;display:none;mso-hide:screen;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863531 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>22</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863532">Создание
документов Word на основе таблицы Excel<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863532 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>23</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863533">Команды
создания и удаления каталогов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863533 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>24</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863534">Получение<span
style='mso-spacerun:yes'>  </span>текущего каталога<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863534 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>24</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863535">Посмотреть
все файлы в каталоге_1<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863535 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>24</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863536">Посмотреть
все файлы в каталоге_2<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863536 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>25</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863537">Посмотреть<span
style='mso-ansi-language:EN-US'> </span>все<span style='mso-ansi-language:EN-US'>
</span>файлы<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>каталоге<span lang=EN-US
style='mso-ansi-language:EN-US'>_3</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863537 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>26</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863538">ГЛАВА<span
lang=EN-US style='mso-ansi-language:EN-US'> 3. </span>РАБОЧАЯ ОБЛАСТЬ MICROSOFT
EXCEL<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863538 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>28</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863539">Количество
имен рабочей книги<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863539 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>28</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500330039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863540">Защита<span
style='mso-ansi-language:EN-US'> </span>рабочей<span style='mso-ansi-language:
EN-US'> </span>книги<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863540 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>28</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863541">Запрет<span
style='mso-ansi-language:EN-US'> </span>печати<span style='mso-ansi-language:
EN-US'> </span>книги<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863541 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863542">Открытие
книги (или текстовых файлов)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863542 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863543">Открытие
книги и добавление в ячейку А1 текста<span style='color:windowtext;display:
none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863543 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863544">Сколько
книг открыто<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863544 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863545">Закрытие
всех книг<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863545 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863546">Закрытие
рабочей книги только при выполнении условия<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863546 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863547">Сохранение
рабочей книги с именем, представляющим собой текущую дату<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863547 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>29</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863548">Сохранена
ли рабочая книга<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863548 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>30</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863549">Создать
книгу с одним листом<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863549 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>30</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500340039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863550">Удаление
ненужных имен<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863550 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>30</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863551">Быстрое
размножение рабочей книги<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863551 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>30</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863552">Сортировка<span
style='mso-ansi-language:EN-US'> </span>листов<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863552 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>31</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863553">Поиск
максимального значения на всех листах книги<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863553 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>32</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863554">Проверка
наличия защиты рабочего листа<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863554 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>32</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863555">Список
отсортированных листов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863555 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>33</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863556">Создать<span
style='mso-ansi-language:EN-US'> </span>новый<span style='mso-ansi-language:
EN-US'> </span>лист<span lang=EN-US style='mso-ansi-language:EN-US'>_1</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863556 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>34</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863557">Копирование
листа в книге<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863557 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>34</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863558">Копирование
листа в новую книгу (создается)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863558 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>35</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863559">Перемещение
листа в книге<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863559 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>35</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500350039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863560">Перемещение
нескольких листов в новую книгу<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863560 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>35</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863561">Заменить
существующий файл<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863561 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>35</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863562">Вставка
колонтитула с именем книги, листа и текущей датой<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863562 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>35</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863563">Существует<span
style='mso-ansi-language:EN-US'> </span>ли<span style='mso-ansi-language:EN-US'>
</span>лист<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863563 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>36</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863564">Существует<span
style='mso-ansi-language:EN-US'> </span>ли<span style='mso-ansi-language:EN-US'>
</span>лист<span lang=EN-US style='mso-ansi-language:EN-US'>_2</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863564 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>36</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863565">Вывод
количества листов в активной книге<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863565 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>36</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863566">Вывод
количества листов в активной книге в виде гиперссылок<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863566 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>36</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863567">Вывод
имен активных листов по очереди<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863567 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>37</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863568">Вывод
имени и номеров листов текущей книги<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863568 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>37</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863569">Сделать
лист невидимым<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863569 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>37</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500360039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863570">Сколько
страниц на всех листах?<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863570 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>37</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863571">Копирование
строк на другой лист<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863571 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>37</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863572">Копирование
столбцов на другой лист<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863572 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>38</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863573">Подсчет
количества ячеек, содержащих указанные значения_1<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863573 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>38</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863574">Подсчет
количества ячеек в диапазоне, содержащих указанные значения_2<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863574 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>38</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863575">Подсчет
количества видимых ячеек в диапазоне<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863575 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>39</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863576">Определение
количества ячеек в диапазоне и суммы их значений<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863576 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>39</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863577">Подсчет
количества ячеек<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863577 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>39</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863578">Автоматический
пересчет данных таблицы при изменении ее значений<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863578 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>39</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863579">Ввод
данных в ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863579 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>40</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500370039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863580">Ввод
данных с использованием формул<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863580 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>40</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863581">Ввод<span
style='mso-ansi-language:EN-US'> </span>текстоввых<span style='mso-ansi-language:
EN-US'> </span>данных<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>ячейки<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863581 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>41</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863582">Вывод
в ячейки названия книги, листа и количества листов<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863582 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>41</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863583">Удаление<span
style='mso-ansi-language:EN-US'> </span>пустых<span style='mso-ansi-language:
EN-US'> </span>строк<span lang=EN-US style='mso-ansi-language:EN-US'>_1</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863583 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>42</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863584">Удаление<span
style='mso-ansi-language:EN-US'> </span>пустых<span style='mso-ansi-language:
EN-US'> </span>строк<span lang=EN-US style='mso-ansi-language:EN-US'>_2</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863584 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>42</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863585">Удаление
пустых строк_3<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863585 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>42</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863586">Удаление
строки по условию<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863586 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>43</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863587">Удаление
используемых скрытых строк или строк с нулевой высотой<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863587 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>43</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863588">Удаление
дубликатов по маске<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863588 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>43</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863589">Выделение
диапазона над текущей ячейкой<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863589 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>44</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863590">Выделение
диапазона над текущей ячейкой_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863590 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>44</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863591">Выделение
отрицательных значений<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863591 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>45</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863592">Выделение
диапазона и использование абсолютных адресов<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863592 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>45</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863593">Выделение
ячеек через интервал_2<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863593 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>46</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863594">Движение<span
style='mso-ansi-language:EN-US'> </span>по<span style='mso-ansi-language:EN-US'>
</span>ячейкам<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863594 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>46</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863595">Поиск
ближайшей пустой ячейки столбца<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863595 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>47</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863596">Поиск
максимального значения<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863596 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>47</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863597">Поиск
и замена по шаблону<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863597 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>47</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863598">Поиск
значения с отображением результата в отдельном окне<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863598 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>47</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863599">Поиск
с выделением найденных данных_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863599 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>48</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003500390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863600">Поиск
с выделением найденных данных_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863600 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>48</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863601">Поиск
по условию в диапазоне<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863601 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>49</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863602">Поиск
последней непустой ячейки диапазона<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863602 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>49</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863603">Поиск
последней непустой ячейки столбца<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863603 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>50</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863604">Поиск<span
style='mso-ansi-language:EN-US'> </span>последней<span style='mso-ansi-language:
EN-US'> </span>непустой<span style='mso-ansi-language:EN-US'> </span>ячейки<span
style='mso-ansi-language:EN-US'> </span>строки<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863604 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>50</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863605">Поиск<span
style='mso-ansi-language:EN-US'> </span>ячейки<span style='mso-ansi-language:
EN-US'> </span>синего<span style='mso-ansi-language:EN-US'> </span>цвета<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>диапазоне<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863605 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>50</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863606">Поиск
наличия значения в столбце<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863606 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>50</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863607">Поиск
совпадений в диапазоне<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863607 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>50</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863608">Поиск
ячейки в диапазоне_1<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863608 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>51</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863609">Поиск<span
style='mso-spacerun:yes'>  </span>ячейки в диапазоне_2<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863609 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>52</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600300039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863610">Поиск
приближенного значения в диапазоне<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863610 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>52</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863611">Поиск
начала и окончания диапазона, содержащего данные<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863611 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>52</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863612">Автоматическая
замена значений<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863612 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>53</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863613">Быстрое
заполнение диапазона (массив)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863613 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>53</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863614">Заполнение
через интервал(массив)<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863614 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>53</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863615">Заполнение
указанного диапазона(массив)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863615 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>54</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863616">Заполнение
диапазона(массив)<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863616 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>54</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863617">Расчет
суммы первых значений диапазона<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863617 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>55</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863618">Размещение
в ячейке электронных часов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863618 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>55</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863619">«Будильник»<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863619 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>55</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863620">Адрес<span
style='mso-ansi-language:EN-US'> </span>активной<span style='mso-ansi-language:
EN-US'> </span>ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863620 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>56</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863621">Координаты<span
style='mso-ansi-language:EN-US'> </span>активной<span style='mso-ansi-language:
EN-US'> </span>ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863621 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>56</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863622">Формула
активной ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863622 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>56</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863623">Получение
из ячейки формулы<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863623 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>56</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863624">Тип<span
style='mso-ansi-language:EN-US'> </span>данных<span style='mso-ansi-language:
EN-US'> </span>ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863624 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>56</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863625">Вывод<span
style='mso-ansi-language:EN-US'> </span>адреса<span style='mso-ansi-language:
EN-US'> </span>конца<span style='mso-ansi-language:EN-US'> </span>диапазона<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863625 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>57</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863626">Получение
информации о выделенном диапазоне<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863626 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>57</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863627">Создание
изменяемого списка (таблица)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863627 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>59</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863628">Умножение
выделенного диапазона на 2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863628 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>59</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863629">Одновременное
умножение всех данных диапазона<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863629 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>60</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600320039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863630">Деление<span
style='mso-ansi-language:EN-US'> </span>диапазона<span style='mso-ansi-language:
EN-US'> </span>на<span lang=EN-US style='mso-ansi-language:EN-US'> 100</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863630 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>60</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863631">Суммирование
данных только видимых ячеек<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863631 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>60</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863632">Сумма
ячеек с числовыми значениями<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863632 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>60</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863633">При
суммировании — курсор внутри диапазона<span style='color:windowtext;display:
none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863633 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>61</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863634">Начисление
процентов в зависимости от суммы_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863634 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>61</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863635">Начисление
процентов в зависимости от суммы_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863635 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>61</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863636">Начисление
процентов в зависимости от суммы_3<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863636 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>62</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863637">Сводный<span
style='mso-ansi-language:EN-US'> </span>пример<span style='mso-ansi-language:
EN-US'> </span>расчета<span style='mso-ansi-language:EN-US'> </span>комиссионного<span
style='mso-ansi-language:EN-US'> </span>вознаграждения<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863637 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>62</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863638">Движение
по диапазону<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863638 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>63</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863639">Сдвиг
от выделенной ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863639 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>64</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600330039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863640">Создание
заливки диапазона<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863640 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>64</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863641">Подбор
параметра ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863641 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>64</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863642">Разбиение<span
style='mso-ansi-language:EN-US'> </span>диапазона<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863642 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>65</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863643">Объединение
данных диапазона<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863643 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>65</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863644">Объединение
данных диапазона_2<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863644 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>66</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863645">Узнать
максимальную колонку или строку.<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863645 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>66</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863646">Ограничение
возможных значений диапазона<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863646 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>66</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863647">Тестирование
скорости чтения и записи диапазонов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863647 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>67</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863648">Открыть<span
lang=EN-US style='mso-ansi-language:EN-US'> MsgBox </span>при<span
style='mso-ansi-language:EN-US'> </span>выборе<span style='mso-ansi-language:
EN-US'> </span>ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863648 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>68</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863649">Скрытие<span
style='mso-ansi-language:EN-US'> </span>строки<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863649 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>68</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600340039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863650">Скрытие
нескольких строк<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863650 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>68</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863651">Скрытие<span
style='mso-ansi-language:EN-US'> </span>столбца<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863651 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>68</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863652">Скрытие
нескольких столбцов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863652 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>68</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863653">Скрытие
строки по имени ячейки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863653 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863654">Скрытие
нескольких строк по адресам ячеек<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863654 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863655">Скрытие
столбца по имени ячейки<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863655 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863656">Скрытие
нескольких столбцов по адресам ячеек<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863656 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863657">Мигание<span
style='mso-ansi-language:EN-US'> </span>ячейки<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863657 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863658">ГЛАВА<span
lang=EN-US style='mso-ansi-language:EN-US'> 4. </span>РАБОТА С ПРИМЕЧАНИЯМИ<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863658 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863659">Вывод
на экран всех примечаний рабочего листа<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863659 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>69</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600350039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863660">Функция
извлечения комментария<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863660 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>70</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863661">Список
примечаний защищенных листов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863661 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>70</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863662">Перечень
примечаний в отдельном списке_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863662 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>71</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863663">Перечень
примечаний в отдельном списке_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863663 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>71</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863664">Перечень
примечаний в отдельном списке_3<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863664 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>71</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863665">Подсчет
количества примечаний_1<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863665 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>72</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863666">Подсчет<span
style='mso-ansi-language:EN-US'> </span>примечаний<span lang=EN-US
style='mso-ansi-language:EN-US'>_3</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863666 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>73</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863667">Выделение
ячеек с примечаниями<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863667 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>73</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863668">Отображение
всех примечаний<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863668 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>73</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863669">Изменение
цвета примечаний<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863669 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>73</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600360039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863670">Добавление
примечаний<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863670 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>73</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863671">Добавление
примечаний в диапазон по условию<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863671 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>74</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863672">Перенос
комментария в ячейку и обратно<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863672 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>74</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863673">Перенос
значений из ячейки в комментарий_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863673 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>74</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863674">Перенос
значений из ячейки в комментарий_2<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863674 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>75</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863675">ГЛАВА
5<span lang=EN-US style='mso-ansi-language:EN-US'> . </span>ПОЛЬЗОВАТЕЛЬСКИЕ
ВКЛАДКИ НА ЛЕНТЕ<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863675 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>75</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863676">Дополнение
панели инструментов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863676 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>75</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863677">Добавление
кнопки на панель инструментов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863677 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>76</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863678">Панель
с одной кнопкой<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863678 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>76</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863679">Панель<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>двумя<span style='mso-ansi-language:EN-US'> </span>кнопками<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863679 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>76</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600370039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863680">Создание
панели справа<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863680 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>76</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863681">Вызов
предварительного просмотра<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863681 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>77</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863682">Создание
пользовательского меню (вариант 1)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863682 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>77</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863683">Создание
пользовательского меню (вариант 2)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863683 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>77</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863684">Создание
пользовательского меню (вариант 3)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863684 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>78</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863685">Создание
пользовательского меню (вариант 4)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863685 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>78</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863686">Создание
пользовательского меню (вариант 5)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863686 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>78</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863687">Создание
списка пунктов главного меню Excel<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863687 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>82</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863688">Создание
списка пунктов контекстных меню<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863688 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>83</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863689">Отображение
панели инструментов при определенном условии<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863689 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>83</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863690">Скрытие
и отображение панелей инструментов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863690 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>85</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863691">Создать<span
style='mso-ansi-language:EN-US'> </span>подсказку<span style='mso-ansi-language:
EN-US'> </span>к<span style='mso-ansi-language:EN-US'> </span>моим<span
style='mso-ansi-language:EN-US'> </span>кнопкам<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863691 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>85</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863692">Создание
меню на основе данных рабочего листа<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863692 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>86</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863693">Создание
контекстного меню<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863693 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>88</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863694">Блокировка<span
style='mso-ansi-language:EN-US'> </span>контекстного<span style='mso-ansi-language:
EN-US'> </span>меню<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863694 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>89</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863695">Добавление
команды в меню Сервис<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863695 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>90</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863696">Добавление
команды в меню Вид<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863696 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>90</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863697">Создание
панели со списком<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863697 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>92</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863698">Мультфильм
с помощником в главной роли<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863698 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>93</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863699">Дополнение
помощника текстом, заголовком, кнопкой и значком<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863699 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>94</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003600390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863700">Новые
параметры помощника<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863700 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>95</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863701">Использование
помощника для выбора цвета заливки<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863701 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>95</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863702">ГЛАВА
6<span lang=EN-US style='mso-ansi-language:EN-US'>. </span>ДИАЛОГОВЫЕ ОКНА<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863702 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>96</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863703">Функция
INPUTBOX (через ввод значения)<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863703 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>96</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863704">Настройка
ввода данных в диалоговом окне<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863704 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>97</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863705">Открытие
диалогового окна (“Открыть файл”)_1<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863705 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>97</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863706">Вызов
броузера из Экселя<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863706 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>98</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863707">Диалоговое
окно ввода данных<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863707 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>98</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863708">Значения
по умолчанию<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863708 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>98</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863709">ГЛАВА
7.ФОРМАТИРОВАНИЕ ТЕКСТА. ТАБЛИЦЫ. ГРАНИЦЫ И ЗАЛИВКА.<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863709 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>98</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700300039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863710">Вывод
списка доступных шрифтов<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863710 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>98</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863711">Выбор
из текста всех чисел<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863711 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>99</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863712">Прописная
буква только в начале текста<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863712 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>99</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863713">Подсчет
количества повторов искомого текста<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863713 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>99</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863714">Выделение
из текста произвольного элемента<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863714 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>100</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863715">Отображение
текста «задом наперед»<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863715 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>101</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863716">Запуск
таблицы символов из Excel<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'> </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863716 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>101</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863717">ГЛАВА
8 ИНФОРМАЦИЯ О ПОЛЬЗОВАТЕЛЕ, КОМПЬЮТЕРЕ, ПРИНТЕРЕ И Т.Д.<span style='color:
windowtext;display:none;mso-hide:screen;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863717 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>104</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863718">Получить
имя пользователя<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863718 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>104</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863719">Вывод
разрешения монитора<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863719 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>104</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700310039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863720">Получение
информации об используемом принтере<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863720 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>104</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863721">Просмотр
информации о дисках компьютера<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863721 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>105</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863722">ГЛАВА
9. ДИАГРАММЫ<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863722 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>106</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863723">Построение
диаграммы с помощью макроса<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863723 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>106</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863724">Сохранение
диаграммы в отдельном файле<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863724 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>107</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863725">Построение
и удаление диаграммы нажатием одной кнопки<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863725 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>107</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863726">Применение
случайной цветовой палитры<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863726 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>109</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863727">Эффект
прозрачности диаграммы<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863727 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>109</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863728">Построение
диаграммы на основе данных нескольких рабочих листов<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863728 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>110</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863729">Создание
подписей к данным диаграммы<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863729 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>112</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700320039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863730">ГЛАВА<span
style='mso-ansi-language:EN-US'> </span>10<span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>РАЗНЫЕ ПРОГРАММЫ.<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863730 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>112</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863731">Программа
для составления кроссвордов<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863731 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>112</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863732">Игра
«Минное поле»<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863732 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>116</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863733">Игра
«Угадай животное»<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863733 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>118</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863734">Расчет
на основании ячеек определенного цвета<span style='color:windowtext;display:
none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863734 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>120</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863735">ГЛАВА
11. ДРУГИЕ ФУНКЦИИ И МАКРОСЫ<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863735 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>130</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863736">Вызов
функциональных клавиш<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863736 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>130</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863737">Расчет
среднего арифметического значения<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863737 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>130</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863738">Перевод<span
style='mso-ansi-language:EN-US'> </span>чисел<span style='mso-ansi-language:
EN-US'> </span>в<span lang=EN-US style='mso-ansi-language:EN-US'> «</span>деньги<span
lang=EN-US style='mso-ansi-language:EN-US'>»</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863738 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>131</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863739">Поиск
ближайшего понедельника<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863739 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>131</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700330039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863740">Подсчет
количества полных лет<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863740 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>132</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863741">Расчет
средневзвешенного значения<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863741 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>132</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863742">Преобразование
номера месяца в его название<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863742 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>132</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863743">Использование
относительных ссылок<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863743 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>133</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863744">Преобразование
таблицы Excel в HТМL-формат<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863744 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>133</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863745">Генератор<span
style='mso-ansi-language:EN-US'> </span>случайных<span style='mso-ansi-language:
EN-US'> </span>чисел<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863745 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>135</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863746">Случайные
числа — на основании диапазона<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863746 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>135</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863747">Применение
функции без ввода ее в ячейку<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863747 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>136</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863748">Подсчет
именованных объектов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863748 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>136</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863749">Включение
автофильтра с помощью макроса<span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863749 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>137</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700340039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863750">Создание
бегущей строки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863750 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>137</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863751">Создание
бегущей картинки<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863751 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>137</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863752">Вращающиеся<span
style='mso-ansi-language:EN-US'> </span>автофигуры<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863752 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>138</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863753">Вызов
таблицы цветов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863753 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>140</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863754">Создание
калькулятора<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863754 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>140</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863755">Склонение
фамилии, имени и отчества<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc315863755 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>141</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863756">ГЛАВА
12. ДАТА И ВРЕМЯ<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863756 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>144</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863757">Вывод
даты и времени_1<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863757 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>144</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863758">Вывод
даты и времени_2<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863758 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>145</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863759">Получение
системной даты<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863759 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>145</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700350039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863760">Извлечение
даты и часов<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863760 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>145</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700360030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 467.25pt'><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc315863761">Функция
ДатаПолная<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc315863761 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>146</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003300310035003800360033003700360031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><o:p>&nbsp;</o:p></p>

<b><span style='font-size:16.0pt;font-family:Arial;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:16.0pt;mso-ansi-language:RU;mso-fareast-language:
RU;mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span></b>

<h1><a name="_Toc315863492">ГЛАВА 1. МАКРОСЫ</a></h1>

<h2><a name="_Toc315863493">Запуск макроса с поиском ячейки</a></h2>

<p class=MsoNormal>' Sub<span style='mso-spacerun:yes'>  </span>GotoFixedCell: </p>

<p class=MsoNormal>' Делает активной ячейку, содержащую значение vVariant на </p>

<p class=MsoNormal>' рабочем листе sSheetName в активной рабочей книге. </p>

<p class=MsoNormal>' </p>

<p class=MsoNormal>' Note: Содержимое ячеек интерпретируется как 'значение'! </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public Sub
GotoFixedCell(vValue As Variant, sSheetName As String) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Dim c As Range, cStart As Range, cForFind As
Range <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Dim i As Integer <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>On Error GoTo errhandle: <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Set cForFind = Worksheets(sSheetName).Cells<span
style='mso-spacerun:yes'>   </span>' </span>Диапазон<span style='mso-ansi-language:
EN-US'> </span>поиска<span lang=EN-US style='mso-ansi-language:EN-US'> <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>With cForFind <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Set c = .Find(What:=vValue,
After:=ActiveCell, LookIn:=xlValues, _ <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>LookAt:= xl</span>Р<span
lang=EN-US style='mso-ansi-language:EN-US'>art, SearchOrder:=xlByRows,_ <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>SearchDirection:=xlNext,
MatchCase:=False) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Set cStart = c <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>While Not c Is Nothing <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set c = .FindNext(c) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If c.Address = cStart.Address Then <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>           </span>c.Select <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>           </span>Exit Sub <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Wend <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>End With <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Exit Sub <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>err</span>Н<span lang=EN-US style='mso-ansi-language:
EN-US'>andle: <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>MsgBox Err.Descri</span>р<span lang=EN-US
style='mso-ansi-language:EN-US'>tion, vbExclamation, &quot;Error #&quot; &amp;
Err.Number <o:p></o:p></span></p>

<p class=MsoNormal>End Sub </p>

<h2><a name="_Toc315863494">Запуск макроса при открытии книги</a></h2>

<p class=MsoNormal>Sub Auto_Oрen()</p>

<h2><a name="_Toc315863495">Запуск макроса при вводе в ячейку «2»</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Private Sub
Worksheet_Change(ByVal Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim w As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>'On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If Range(&quot;A1&quot;).Value = 2 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>MsgBox &quot;</span>Ох<span lang=EN-US
style='mso-ansi-language:EN-US'>! </span>Значение ячейки стало равным
2-м!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>MsgBox &quot;Я
попробую сейчас открыть модуль с процедурой, которая все это делает!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Application.VBE.MainWindow.SetFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Application.VBE.Windows(1).SetFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>SendKeys &quot;{F7}&quot;, True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863496">Запуск макроса при нажатии «Ентер»</a></h2>

<p class=MsoNormal>в<span style='mso-ansi-language:EN-US'> </span>модуле<span
style='mso-ansi-language:EN-US'> </span>листа<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Private Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.OnKey
&quot;{~}&quot;, &quot;StartEnter&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>в<span style='mso-ansi-language:EN-US'> </span>модуле<span
style='mso-ansi-language:EN-US'> </span>книги<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
StartEnter()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
(&quot;sadfsdfsf&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863497">Добавить в панель свою вкладку «Надстройки» (Формат
ячейки)</a></h2>

<p class=MsoNormal>Код<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>модуле<span style='mso-ansi-language:
EN-US'> </span>рабочего<span style='mso-ansi-language:EN-US'> </span>листа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Change(ByVal Target As Excel.Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Call upd</span>а<span lang=EN-US
style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>Toolbar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Excel.Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Call upd</span>а<span lang=EN-US
style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>Toolbar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.43. </span>Код<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>стандартном<span style='mso-ansi-language:
EN-US'> </span>модуле<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
FastChangeNumberFormat()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim bar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim button As CommandBarButton<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление существующей панели
инструментов (если она есть)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(&quot;</span>Числовой<span
style='mso-ansi-language:EN-US'> </span>формат<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
новой панели</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set bar = CommandBars.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With bar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Name = &quot;</span>Числовой<span
style='mso-ansi-language:EN-US'> </span>формат<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>кнопки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set button = CommandBars(&quot;</span>Числовой<span
style='mso-ansi-language:EN-US'> </span>формат<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).Controls.Add _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With button<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.OnAction =
&quot;ChangeNumFormat&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.TooltipText =
&quot;Щелкните для изменения числового формата&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Style =
msoButtonCaption</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обновление
созданной панели инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call upd</span>а<span lang=EN-US
style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>Toolbar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub upd</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US
style='mso-ansi-language:EN-US'>Toolbar()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Обновление панели инструментов
(если она создана)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>On Error Resume
Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
заголовка кнопки (на название формата выделенной ячейки)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>CommandBars(&quot;</span>Числовой<span
style='mso-ansi-language:EN-US'> </span>формат<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).Controls(1).Caption = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ActiveCell.NumberFormat<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ChangeNumFormat()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение диалогового окна
изменения формата ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.Dialogs(xlDialogFormatNumber).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Call upd</span>а<span lang=EN-US
style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>Toolbar<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc315863498">ГЛАВА 2. РАБОТА С ФАЙЛАМИ (Т.Е.ОБМЕН ДАННЫМИ С ТХТ,
RTF, XLS И Т.Д.)</a></h1>

<h2><a name="_Toc315863499">Проверка наличия файла по указанному пути_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
VerifyFileLocation()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFileName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFileTitle As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>и<span style='mso-ansi-language:EN-US'> </span>путь<span
style='mso-ansi-language:EN-US'> </span>искомого<span style='mso-ansi-language:
EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFileTitle = &quot;primer.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFileName = &quot;C:\</span>Документы<span
lang=EN-US style='mso-ansi-language:EN-US'>\primer.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка наличия файла (функция Dir
возвращает пустую _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>строку, если по
указанному пути файл обнаружить не удалось)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Dir(strFileName) &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Файл<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; strFileTitle &amp; &quot; </span>найден<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Файл<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; strFileTitle &amp; &quot; </span>не<span
style='mso-ansi-language:EN-US'> </span>найден<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863500">Проверка наличия файла по указанному пути_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
VerifyFileLocation1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFileName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>искомого<span style='mso-ansi-language:EN-US'> </span>файла<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFileName = &quot;C:\</span>Документы<span
lang=EN-US style='mso-ansi-language:EN-US'>\primer.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка наличия файла (функция Dir
возвращает пустую _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>строку, если по указанному
пути файл обнаружить не удалось)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Dir(strFileName) &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Файл<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; strFileName &amp; &quot; </span>найден<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Файл<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; strFileName &amp; &quot; </span>не<span
style='mso-ansi-language:EN-US'> </span>найден<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863501">Проверка наличия файла по указанному пути_3</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Check_Disk()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
Dir(&quot;\\192.168.1.200\c\&quot;, vbSystem) &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Err = 52
Then<o:p></o:p></span></p>

<p class=MsoNormal>Err.Clear</p>

<p class=MsoNormal>MsgBox &quot;Диска нет!&quot;, 48, &quot;Ошибка&quot;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Err
&lt;&gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Произошло ошибка!&quot;, 48, &quot;Ошибка&quot;</p>

<p class=MsoNormal>Exit Sub</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Диск<span style='mso-ansi-language:EN-US'> </span>есть<span
lang=EN-US style='mso-ansi-language:EN-US'>!&quot;, 64, &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863502">Поиск нужного файла_1</a></h2>

<p class=MsoNormal>Sub FileSearch()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strFileName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFolder As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strFullPath As String</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Задание имени
папки для поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strFolder = InputBox(&quot;</span>Определите<span
style='mso-ansi-language:EN-US'> </span>папку<span lang=EN-US style='mso-ansi-language:
EN-US'>:&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strFolder = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Задание имени файла для поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strFileName = Application.InputBox(&quot;</span>Введите<span
style='mso-ansi-language:EN-US'> </span>имя<span style='mso-ansi-language:EN-US'>
</span>файла<span lang=EN-US style='mso-ansi-language:EN-US'>:&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>If strFileName = &quot;&quot; Then
Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' При необходимости
дополняем имя папки &quot;\&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Right(strFolder, 1) &lt;&gt; &quot;\&quot;
Then strFolder = strFolder &amp; &quot;\&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Полный<span style='mso-ansi-language:
EN-US'> </span>путь<span style='mso-ansi-language:EN-US'> </span>файла<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFullPath = strFolder &amp; strFileName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод окна с отчетом о поиске
средствами VBA</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Использование команды VBA...&quot; &amp; vbCrLf &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>dhSearchVBA(strFullPath), vbInformation, strFullPath</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод окна с
отчетом о поиске средствами объекта FileSearch</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Использование объекта FileSearch...&quot; &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>vbCrLf &amp; dhSearchFileSearch(strFolder,
strFileName), vbInformation, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>strFullPath</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод окна с
отчетом о поиске средствами объекта _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>FileSystemObject<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Использование<span
style='mso-ansi-language:EN-US'> </span>объекта<span lang=EN-US
style='mso-ansi-language:EN-US'> FileSystemObject...&quot; &amp; vbCrLf &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>vbCrLf &amp;
dhSearchFileSystemObject(strFullPath), vbInformation, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>strFullPath<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863503">Поиск</a><span style='mso-bookmark:_Toc315863503'><span
style='mso-ansi-language:EN-US'> </span>нужного</span><span style='mso-bookmark:
_Toc315863503'><span style='mso-ansi-language:EN-US'> </span>файла</span><span
style='mso-bookmark:_Toc315863503'><span lang=EN-US style='mso-ansi-language:
EN-US'>_2</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSearchVBA(varFullPath As Variant) As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Использование<span
style='mso-ansi-language:EN-US'> </span>команды<span lang=EN-US
style='mso-ansi-language:EN-US'> VBA<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhSearchVBA = Dir(varFullPath) &lt;&gt;
&quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863504">Поиск нужного файла_3</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSearchFileSearch(varFolder As Variant, varFileName _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>As Variant) As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Использование<span
style='mso-ansi-language:EN-US'> </span>объекта<span lang=EN-US
style='mso-ansi-language:EN-US'> FileSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Application.FileSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>нового<span style='mso-ansi-language:EN-US'> </span>поиска<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.NewSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>поиска<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FileName = varFileName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Папка поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.LookIn =
varFolder</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Собственно
поиск</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Execute<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhSearchFileSearch = .FoundFiles.Count
&lt;&gt; 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863505">Поиск нужного файла_4</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSearchFileSystemObject(varFullPath As Variant) As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim objFSObject As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Использование<span
style='mso-ansi-language:EN-US'> </span>объекта<span lang=EN-US
style='mso-ansi-language:EN-US'> FileSystemObject<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set objFSObject = CreateObject(&quot;s</span>с<span
lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US
style='mso-ansi-language:EN-US'>ting.FileSystemObject&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhSearchFileSystemObject =
objFSObject.FileExists(varFullPath)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h2><a name="_Toc315863506">Автоматизация удаления файлов</a></h2>

<p class=MsoNormal>Листинг 3.51. Удаление файла</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteFile()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Kill &quot;C:\</span>Документы<span
lang=EN-US style='mso-ansi-language:EN-US'>\primer.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Листинг 3.52. Удаление группы файлов</p>

<p class=MsoNormal>Sub DeleteFiles()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление всех
файлов с расширением XLS из заданной папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Kill &quot;C:\</span>Документы<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot; &amp; &quot;*.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863507">Произвольный текст в строке состояния</a></h2>

<p class=MsoNormal>Sub ChangeStatusBarText()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Application.StatusBar = &quot;Как надоело работать!!!&quot;</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863508">Восстановление строки состояния</a></h2>

<p class=MsoNormal>Sub ReturnStatusBarText()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.StatusBar = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863509">Бегущая</a><span style='mso-bookmark:_Toc315863509'><span
style='mso-ansi-language:EN-US'> </span>строка</span><span style='mso-bookmark:
_Toc315863509'><span style='mso-ansi-language:EN-US'> </span>в</span><span
style='mso-bookmark:_Toc315863509'><span style='mso-ansi-language:EN-US'> </span>строке</span><span
style='mso-bookmark:_Toc315863509'><span style='mso-ansi-language:EN-US'> </span>состояния</span><span
style='mso-bookmark:_Toc315863509'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
MovingTextInStatusBar()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intSpaces As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
количества пробелов в начале строки (от 20 до 0) - _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>строка бежит
(скорее, ползет) влево</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For intSpaces = 20
To 0 Step -1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Запись текста
в строку состояния</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Application.StatusBar =
Space(intSpaces) &amp; &quot;</span>Как<span style='mso-ansi-language:EN-US'> </span>надоело<span
style='mso-ansi-language:EN-US'> </span>работать<span lang=EN-US
style='mso-ansi-language:EN-US'>!!!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Выдерживаем<span
style='mso-ansi-language:EN-US'> </span>паузу<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Application.Wait Now +
TimeValue(&quot;00:00:01&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Дадим Excel обработать
пользовательский ввод</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>DoEvents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.StatusBar = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863510">Быстрое изменение заголовка окна</a></h2>

<p class=MsoNormal>Sub NewTitle()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Application.Caption
= &quot;Какая хорошая погода&quot;</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863511">Быстрое изменение заголовка окна_2</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
NewTitle()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span>Application.Caption = &quot;</span>Какая<span
style='mso-ansi-language:EN-US'> </span>хорошая<span style='mso-ansi-language:
EN-US'> </span>погода<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ActiveWindow.Caption = &quot;А завтра
будет дождь&quot;</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863512">Изменение заголовка окна (со скрытием названия
файла)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
NewTitle()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.Caption = &quot;</span>Какая<span
style='mso-ansi-language:EN-US'> </span>хорошая<span style='mso-ansi-language:
EN-US'> </span>погода<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ActiveWindow.Caption = &quot;&quot;</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863513">Возврат к первоначальному заголовку</a></h2>

<p class=MsoNormal>Sub ReturnTitle()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Возвращение
заголовка приложения (то есть Excel)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Application.Caption
= Empty</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Указание
правильного названия открытого файла (книги)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ActiveWindow.Caption = ThisWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863514">Что открыто в данный момент</a></h2>

<p class=MsoNormal>Sub WorkBooksList()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim book As Object</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод имени
каждой рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each book In Workbooks<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox (book.Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863515">Работа с текстовыми файлами</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Открываются файлы командой Open, а закрываются - командой
Close. </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863516">Запись и чтение текстового файла</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Print #1, &quot;Этот текст будет
записан в файл&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Input #1, s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>MsgBox s</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Для записи используется оператор Print, а для чтения -
Input. У этих операторов есть свои особенности. </p>

<p class=MsoNormal>Print #1, &quot;Hello , File&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Оператор Input #1 прочитает только Hello и все. Запятая воспринимается
как разделитеть. Чтобы прочитать строку целиком, используется оператор Line
Input. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Print #1, &quot;Hello , File&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Line Input #1, s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>MsgBox s</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863517">Обработка нескольких текстовых файлов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ImportTextFiles()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fsSearch As FileSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFileName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPath As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Задание пути и
возможного имени файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strFileName = ThisWorkbook.path &amp;
&quot;\&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strPath = &quot;text??.txt&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>объекта<span lang=EN-US style='mso-ansi-language:EN-US'>
FileSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set fsSearch = Application.FileSearch<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Настройка объекта для поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With fsSearch</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Маска для
поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.LookIn =
strFileName</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Путь для поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.FileName =
strPath</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Поиск всех
файлов, удовлетворяющих маске</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Execute</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Выход, если
файлы не существуют</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .FoundFiles.Count = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>MsgBox &quot;</span>Файлы<span
style='mso-ansi-language:EN-US'> </span>не<span style='mso-ansi-language:EN-US'>
</span>обнаружены<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>найденных<span style='mso-ansi-language:EN-US'> </span>файлов<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To fsSearch.FoundFiles.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Call
ImportTextFile(fsSearch.FoundFiles(i))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ImportTextFile(FileName As String)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Импорт<span style='mso-ansi-language:
EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Workbooks.OpenText FileName:=FileName, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Origin:=xlWindows, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>StartRow:=1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>DataType:=xlFixedWidth, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>FieldInfo:= _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Array(Array(0, 1), Array(3, 1), Array(12,
1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Ввод формул суммирования</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;D1&quot;).Value = &quot;A&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(&quot;D2&quot;).Value = &quot;B&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;D3&quot;).Value = &quot;C&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;E1:E3&quot;).Formula =
&quot;=COUNTIF(B:B,D1)&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;F1:F3&quot;).Formula =
&quot;=SUMIF(B:B,D1,C:C)&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863518">Определение конца строки текстового файла</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Print #1, &quot;Hello , File&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open &quot;file.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>While Not EOF(1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>Input #1, s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>MsgBox s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Wend<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Close #1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863519">Копирование из текстового файла в эксель</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
TextLine<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>i = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Open
&quot;C:\MyFile.txt&quot; For Input As #1 <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Do While
Not EOF(1) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Line Input
#1, TextLine <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ThisWorkbook.Worksheets(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;).Cells(i, 1).Value =
TextLine <o:p></o:p></span></p>

<p class=MsoNormal>i = i + 1</p>

<p class=MsoNormal>Loop</p>

<p class=MsoNormal>Close #1</p>

<h2><a name="_Toc315863520">Копирование содержимого в текстовый файл_1</a></h2>

<p class=MsoNormal>Sub Range2TXT()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span>MyFile =
&quot;C:\File.txt&quot; 'путь к файлу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Open MyFile For Output As #1 '</span>открыли<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>записи<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>For Each i In Selection '</span>листаем<span
style='mso-ansi-language:EN-US'> </span>ячейки<span style='mso-ansi-language:
EN-US'> </span>выделенного<span style='mso-ansi-language:EN-US'> </span>диапазона<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Print #1, i '</span>пишем<span lang=EN-US
style='mso-ansi-language:EN-US'> (</span>с<span style='mso-ansi-language:EN-US'>
</span>начала<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Close #1 '</span>закрываем<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863521">Копирование содержимого в текстовый файл_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SaveAsText()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Открытие файла для сохранения (имя
файла соответствует имени _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>рабочей книги, но
отличается расширением - TXT)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Open ThisWorkbook.Path &amp; &quot;\&quot;
&amp; ThisWorkbook.Name &amp; &quot;.txt&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>For Output As #1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запись
содержимого заполненных ячеек таблицы в файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In ActiveSheet.UsedRange<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not IsEmpty(cell) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>      </span>Print #1, cell.Address, cell.Formula<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Не забываем
закрывать файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Экспорт данных в txt</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ExportAsText()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRow As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intCol As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Открытие файла
для сохранения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Open &quot;C:\primer.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Запись выделенной части таблицы в
файл (построчно)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For lngRow = 1 To Selection.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Запись содержимого всех столбцов
строки lngRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For intCol = 1 To
Selection.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Write #1, Selection.Cells(lngRow,
intCol).Value;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next intCol</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Начнем новую
строку в файле</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Print #1,
&quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next lngRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Не забываем
закрыть файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ImportText()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strLine As String<span
style='mso-spacerun:yes'>         </span>' </span>Одна<span style='mso-ansi-language:
EN-US'> </span>строка<span style='mso-ansi-language:EN-US'> </span>файла<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCurChar As String * 1<span
style='mso-spacerun:yes'>  </span>' </span>Анализируемый<span style='mso-ansi-language:
EN-US'> </span>символ<span style='mso-ansi-language:EN-US'> </span>строки<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strValue As String<span
style='mso-spacerun:yes'>        </span>' Значение для записи в ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim lngRow As
****<span style='mso-spacerun:yes'>            </span>' Номер текущей строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intCol As Integer<span
style='mso-spacerun:yes'>         </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущего<span style='mso-ansi-language:EN-US'> </span>столбца<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Открытие
импортируемого файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Open &quot;C:\primer.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Считываем все строки файла и
записываем данные, разделенные _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>запятой, в ячейки
таблицы (начиная с текущей ячейки)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Do Until EOF(1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Считываем
строку из файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Line Input #1,
strLine</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Разбираем
считанную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For i = 1 To Len(strLine)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCurChar = Mid(strLine, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If strCurChar = &quot;,&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Найден разделитель
столбцов - запятая. Запишем _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            
</span>сформированное значение в ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>ActiveCell.Offset(lngRow, intCol) = strValue</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intCol = intCol + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strValue = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ElseIf i = Len(strLine) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Конец строки - запишем в
таблицу последнее _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>значение
в строке (перед этим дополним его последним _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>символом
строки, кроме кавычки)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>If
strCurChar &lt;&gt; Chr(34) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strValue = strValue &amp; strCurChar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Запись<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>таблицу<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>ActiveCell.Offset(lngRow, intCol) =
strValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strValue = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>ElseIf strCurChar &lt;&gt;
Chr(34) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Добавление символа в формируемое значение ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
lang=EN-US style='mso-ansi-language:EN-US'>(</span>кавычки<span
style='mso-ansi-language:EN-US'> </span>игнорируются<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strValue = strValue &amp;
strCurChar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'>   </span></span>Next
i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Переход к
новой строке таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intCol = 0</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>lngRow = lngRow
+ 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Loop</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Закрываем файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863522">Экспорт данных в HТМL</a></h2>

<p class=MsoNormal>Sub ExportAsHТМLFile()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strStyle As
String<span style='mso-spacerun:yes'>     </span>' Параметры стиля отображения
ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strAlign As
String<span style='mso-spacerun:yes'>     </span>' Параметры выравнивания
ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strOut As
String<span style='mso-spacerun:yes'>       </span>' Выходная строка с
HТМL-кодом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Object<span
style='mso-spacerun:yes'>         </span>' </span>Обрабатываемая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCellText As String<span
style='mso-spacerun:yes'>  </span>' </span>Текст<span style='mso-ansi-language:
EN-US'> </span>обрабатываемой<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRow As ****<span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>строки<span style='mso-ansi-language:EN-US'> </span>обрабатываемой<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngLastRow As ****<span
style='mso-spacerun:yes'>     </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>строки<span style='mso-ansi-language:EN-US'> </span>предыдущей<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strTemp As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFileName As String<span
style='mso-spacerun:yes'>  </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>файла<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>сохранения<span lang=EN-US
style='mso-ansi-language:EN-US'> H</span>ТМ<span lang=EN-US style='mso-ansi-language:
EN-US'>L-</span>кода<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As ****</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запрос у
пользователя имени файла для сохранения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strFileName = Application.GetSaveAsFilename( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>InitialFileName:=&quot;Primer.htm&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>fileFilter:=&quot;H</span>ТМ<span
lang=EN-US style='mso-ansi-language:EN-US'>L Files(*.htm), *.htm&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка, задал ли пользователь имя
файла (если нет, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>то<span
style='mso-ansi-language:EN-US'> </span>можно<span style='mso-ansi-language:
EN-US'> </span>выходить<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strFileName = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lngLastRow = Selection.Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Просмотр<span style='mso-ansi-language:
EN-US'> </span>всех<span style='mso-ansi-language:EN-US'> </span>выделенных<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>For Each cell In Selection</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Значение
строки для рассматриваемой ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>lngRow =
cell.Row</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Если перешли
на другую строку, то вставляем &lt;tr&gt;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If lngRow &lt;&gt; lngLastRow Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strOut = strOut &amp; vbTab &amp;
&quot;&lt;/tr&gt;&quot; &amp; vbCrLf &amp; vbTab &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span></span>&quot;&lt;tr&gt;&quot; &amp;
vbCrLf</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Переход на
следующую сроку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngLastRow = lngRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Задание<span style='mso-ansi-language:
EN-US'> </span>шрифта<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not IsNull(cell.Font.Size) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strStyle = &quot; style=&quot; &amp;
&quot;font-size: &quot; &amp; Int(100 * _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>cell.Font.Size / 19) &amp;
&quot;%;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Для<span style='mso-ansi-language:
EN-US'> </span>полужирного<span style='mso-ansi-language:EN-US'> </span>шрифта<span
style='mso-ansi-language:EN-US'> </span>вставляем<span lang=EN-US
style='mso-ansi-language:EN-US'> &lt;b&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Font.Bold Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCellText = &quot;&lt;b&gt;&quot;
&amp; strCellText &amp; &quot;&lt;/b&gt;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     </span>' </span>Задание<span
style='mso-ansi-language:EN-US'> </span>выравнивания<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.HorizontalAlignment = xlRight
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>По<span style='mso-ansi-language:
EN-US'> </span>правому<span style='mso-ansi-language:EN-US'> </span>краю<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strAlign = &quot; align=&quot; &amp;
&quot;right&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ElseIf cell.HorizontalAlignment =
xlCenter Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>По<span style='mso-ansi-language:
EN-US'> </span>центру<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strAlign = &quot; align=&quot; &amp;
&quot;center&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' По левому
краю (по умолчанию)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strAlign =
&quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Чтение текста
в ячейке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strCellText =
cell.Text</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Если нужно, то
вертикальный вывод текста (в строку strTemp _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>с последующим
перенесением обратно в strCellText)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If cell.Orientation &lt;&gt;
xlHorizontal Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strTemp = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Печать после каждого символа
специального _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>разделителя<span
lang=EN-US style='mso-ansi-language:EN-US'> - &lt;br&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>For i = 1 To Len(strCellText)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strTemp = strTemp &amp; Mid$(strCellText,
i, 1) &amp; &quot;&lt;br&gt;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCellText = strTemp<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strStyle = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strOut = strOut &amp; vbTab &amp; vbTab
&amp; &quot;&lt;td&quot; &amp; strStyle &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>strAlign &amp; &quot;&gt;&quot;
&amp; strCellText &amp; &quot;&lt;/td&gt;&quot; &amp; vbCrLf</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вставка
&lt;tr&gt; для первой строки и &lt;/tr&gt; - для последней</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strOut = vbTab &amp; &quot;&lt;tr&gt;&quot;
&amp; vbCrLf &amp; strOut &amp; vbTab &amp; &quot;&lt;/tr&gt;&quot; &amp;
vbCrLf<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Вставка<span style='mso-ansi-language:
EN-US'> </span>дескриптора<span lang=EN-US style='mso-ansi-language:EN-US'>
&lt;table&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strOut = &quot;&lt;table border=1
cellpadding=3 cellspacing=1&gt;&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&amp; vbCrLf &amp; strOut &amp; vbCrLf
&amp; &quot;&lt;/table&gt;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Сохранение<span lang=EN-US
style='mso-ansi-language:EN-US'> H</span>ТМ<span lang=EN-US style='mso-ansi-language:
EN-US'>L-</span>кода<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>файл<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Open strFileName For Output As 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Print #1, strOut</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод окна с
информационным сообщением о результатах работы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
Selection.Count &amp; &quot; ячеек экспортировано в файл &quot; &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>strFileName</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Импорт данных, для которых нужно более 256 столбцов</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ImportWideSheet()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgRange As Range<span
style='mso-spacerun:yes'>              </span>' </span>Хранит<span
style='mso-ansi-language:EN-US'> </span>заполняемую<span style='mso-ansi-language:
EN-US'> </span>ячейку<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngRow As ****<span
style='mso-spacerun:yes'>                </span>' Хранит номер текущей строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intCol As
Integer<span style='mso-spacerun:yes'>             </span>' Хранит номер текущего
столбца</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strLine As String<span
style='mso-spacerun:yes'>             </span>' </span>Обрабатываемая<span
style='mso-ansi-language:EN-US'> </span>строка<span lang=EN-US
style='mso-ansi-language:EN-US'> (</span>из<span style='mso-ansi-language:EN-US'>
</span>файла<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCurChar As String * 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCellValue As String<span
style='mso-spacerun:yes'>        </span>' </span>В<span style='mso-ansi-language:
EN-US'> </span>этой<span style='mso-ansi-language:EN-US'> </span>строке<span
style='mso-ansi-language:EN-US'> </span>формируется<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                       </span></span>заполняемой
ячейки таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim
wshtCurrentSheet As Worksheet ' Лист, на котором находится _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                      
</span>заполняемая ячейка</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Отключение
обновления изображения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Application.ScreenUpdating = False</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание книги с
одним листом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Workbooks.Add xlWorksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgRange =
ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Чтение первой строки из файла (по
этой строке определяется _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>ширина<span
style='mso-ansi-language:EN-US'> </span>таблицы<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Open ThisWorkbook.Path &amp;
&quot;\Primer.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Line Input #1, strLine</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обработка первой
строки с добавлением новых листов по мере _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>необходимости<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To Len(strLine)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>strCurChar = Mid(strLine, i, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Проверка -
закончились столбцы или нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If intCol &lt;&gt; 0 And intCol Mod
256 = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'>     </span></span>'
Столбцы текущего листа закончились - добавим новый лист _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>и перейдем к
его первому столбцу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set wshtCurrentSheet =
ActiveWorkbook.Sheets.Add(, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         
</span>ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set rgRange = wshtCurrentSheet.Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>intCol = 0</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Проверка -
закончилось поле или нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If strCurChar =
&quot;,&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Запишем
данные в таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>rgRange.Offset(lngRow, intCol) =
strCellValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intCol = intCol + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>strCellValue = &quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавляем
очередной символ в строку со значением текущей _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCellValue = strCellValue &amp;
Mid(strLine, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Проверка - конец строки или
нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If i =
Len(strLine) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Дошли до
конца строки - запишем значение последней ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>rgRange.Offset(lngRow, intCol) =
strCellValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intCol = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strCellValue = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Чтение остальных строк файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Do Until EOF(1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set rgRange =
ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>lngRow = lngRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intCol = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Line Input #1, strLine<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>считанной<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For i = 1 To Len(strLine)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCurChar = Mid(strLine, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Проверка - закончились
столбцы или нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If intCol &lt;&gt; 0 And intCol Mod
256 = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Столбцы текущего листа
закончились - добавим новый лист _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>и
перейдем к его первому столбцу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set wshtCurrentSheet =
ActiveWorkbook.Sheets.Add(, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            
</span>ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Set rgRange =
wshtCurrentSheet.Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>intCol = 0</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Проверка -
закончилось поле или нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If strCurChar
= &quot;,&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Запишем
данные в таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>rgRange.Offset(lngRow, intCol) =
strCellValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intCol = intCol + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>strCellValue = &quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Добавляем очередной символ в строку со значением текущей _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strCellValue = strCellValue &amp;
Mid(strLine, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Проверка - конец строки
или нет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>If i =
Len(strLine) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>' Дошли
до конца строки - запишем значение последней _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'>       </span>ячейки<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>rgRange.Offset(lngRow, intCol) =
strCellValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>strCellValue = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Loop</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Не забываем
закрыть входной файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Close #1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' и разрешить
обновление изображения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>Application.ScreenUpdating = True</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863523">Создание резервных копий ценных файлов</a></h2>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>Этот макрос сохраняет
текущую книгу в папку C:\TEMP, добавляя к имени книги текущее время и дату.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Backup_Active_Workbook()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim x As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>strPath = &quot;c:\TEMP&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>   </span>On
Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>x = GetAttr(strPath) And 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If Err = 0 Then ' </span>если<span
style='mso-ansi-language:EN-US'> </span>путь<span style='mso-ansi-language:
EN-US'> </span>существует<span lang=EN-US style='mso-ansi-language:EN-US'> - </span>сохраняем<span
style='mso-ansi-language:EN-US'> </span>копию<span style='mso-ansi-language:
EN-US'> </span>книги<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>strDate = Format(Now, &quot;dd/mm/yy
hh-mm&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>FileNameXls = strPath &amp;
&quot;\&quot; &amp; Left(ActiveWorkbook.Name,<span style='mso-spacerun:yes'> 
</span>_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>Len(ActiveWorkbook.Name) - 4)
&amp; &quot; &quot; &amp; strDate &amp; &quot;.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>ActiveWorkbook.SaveCopyAs
Filename:=FileNameXls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Else '</span>если<span style='mso-ansi-language:
EN-US'> </span>путь<span style='mso-ansi-language:EN-US'> </span>не<span
style='mso-ansi-language:EN-US'> </span>существует<span lang=EN-US
style='mso-ansi-language:EN-US'> - </span>выводим<span style='mso-ansi-language:
EN-US'> </span>сообщение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span></span>MsgBox &quot;Папка &quot; &amp;
strPath &amp; &quot; недоступна или не существует!&quot;, vbCritical</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>End If</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>При желании можно заменить первую строку на:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Private Sub
Workbook_BeforeClose(Cancel As Boolean) <o:p></o:p></span></p>

<p class=MsoNormal>и поместить этот макрос не в Module1 как обычно, а в модуль
ЭтаКнига (ThisWorkbook) - тогда автоматическое сохранение резервной копии будет
происходить каждый раз перед закрытием файла.</p>

<h2><a name="_Toc315863524">Подсчет количества открытий файла</a></h2>

<p class=MsoNormal>Количество открытий файла (вариант 1)</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Auto_Open()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Worksheets(1).Cells(1) =
Worksheets(1).Cells(1) + 1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Количество открытий файла (вариант 2)</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Auto_Open()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Worksheets(1).Cells(1, 1) =
Worksheets(1).Cells(1, 1) + 1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Количество открытий файла (вариант 3)</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Auto_Open()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Worksheets(1).Range(&quot;A1&quot;) =
Worksheets(1).Range(&quot;A1&quot;) + 1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863525">Вывод пути к файлу в активную ячейку</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ExcelSearch()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim fname
As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim result
As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
Application.FileDialog(1) ' ?????? : With
Application.FileDialog(msoFileDialogOpen) '<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Title =
&quot;Select Excel file&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.InitialFileName
= &quot;C:\&quot; 'default path'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.AllowMultiSelect
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Filters.Clear<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Filters.Add
&quot;Pack files&quot;, &quot;*.xls&quot;, 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>result =
.Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If result =
0 Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>fname =
Trim(.SelectedItems.Item(1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell
= fname<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863526">Копирование содержимого файла RTF в эксель</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
OpenRtfAndPasteToSheets()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim wd As
Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim ns As
Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'</span>запустим<span
style='mso-ansi-language:EN-US'> </span>Ворд<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set wd =
GetObject(&quot;&quot;, &quot;Word.Application&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
Err.Number &lt;&gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Err.Clear<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set wd =
CreateObject(&quot;Word.Application&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
Err.Number &lt;&gt; 0 Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo BAD<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'</span>получим<span
style='mso-ansi-language:EN-US'> </span>имя<span style='mso-ansi-language:EN-US'>
</span>очередного<span style='mso-ansi-language:EN-US'> </span>файла<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>f =
Application.GetOpenFilename(&quot;</span>Файлы<span lang=EN-US
style='mso-ansi-language:EN-US'> RTF, *.rtf,</span>Все<span style='mso-ansi-language:
EN-US'> </span>файлы<span lang=EN-US style='mso-ansi-language:EN-US'>,
*.*&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
TypeName(f) = &quot;Boolean&quot; Then Exit Do '</span>если<span
style='mso-ansi-language:EN-US'> </span>Отмена<span lang=EN-US
style='mso-ansi-language:EN-US'> - </span>выход<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal>'откроем выбранный очередной файл</p>

<p class=MsoNormal>Set wdd = wd.Documents.Open(f)</p>

<p class=MsoNormal>' wd.Visible = True</p>

<p class=MsoNormal>'скопируем содержимое документа</p>

<p class=MsoNormal>t = wdd.Content.Copy</p>

<p class=MsoNormal>'создадим лист для этого документа</p>

<p class=MsoNormal>Set ns = ActiveWorkbook.Worksheets.Add</p>

<p class=MsoNormal>'вставим скопированное в новый лист</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ns.Paste
Destination:=ns.Cells(1, 1)<o:p></o:p></span></p>

<p class=MsoNormal>'немного выравним вид</p>

<p class=MsoNormal>ns.Cells.WrapText = False</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ns.Columns.AutoFit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ns.Rows.AutoFit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>wdd.Close<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>wd.Quit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set wd =
Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>BAD:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
Err.Des</span>с<span lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span
lang=EN-US style='mso-ansi-language:EN-US'>tion<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>wd.Quit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set wd =
Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863527">Копирование</a><span style='mso-bookmark:_Toc315863527'><span
style='mso-ansi-language:EN-US'> </span>данных</span><span style='mso-bookmark:
_Toc315863527'><span style='mso-ansi-language:EN-US'> </span>из</span><span
style='mso-bookmark:_Toc315863527'><span style='mso-ansi-language:EN-US'> </span>закрытой</span><span
style='mso-bookmark:_Toc315863527'><span style='mso-ansi-language:EN-US'> </span>книги</span><span
style='mso-bookmark:_Toc315863527'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.FormulaR1C1
= &quot;='D:\contacts\zakaz\[zakaz.xls]</span>Лист<span lang=EN-US
style='mso-ansi-language:EN-US'>1'!R1C1&quot;<o:p></o:p></span></p>

<h2><a name="_Toc315863528">Извлечение данных из закрытого файла</a></h2>

<p class=MsoNormal>Sub GetDataFromFile()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(&quot;A1&quot;).Formula =
&quot;='C:\[Example.xls]</span>Лист<span lang=EN-US style='mso-ansi-language:
EN-US'>1'!A1&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863529">Поиск слова в файлах</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Option
Explicit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Поиск<span
lang=EN-US style='mso-ansi-language:EN-US'>_</span>во<span lang=EN-US
style='mso-ansi-language:EN-US'>_</span>всех<span lang=EN-US style='mso-ansi-language:
EN-US'>_</span>файлах<span lang=EN-US style='mso-ansi-language:EN-US'>()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
iShtName$, iPath$, iFileName$, firstAddress$<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iSheet
As Worksheet, iFoundSht As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iTempWB
As Workbook, iBazaWB As Workbook<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
TextToFind As Variant, iFoundRng As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim FD As
FileDialog, iLastRow&amp;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
FoundAny As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>TextToFind = Application.InputBox(&quot;</span>Введите<span
style='mso-ansi-language:EN-US'> </span>текст<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>поиска<span
lang=EN-US style='mso-ansi-language:EN-US'>:&quot;, &quot;</span>Поиск<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If TextToFind = &quot;&quot; Or TextToFind
= False Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>TextToFind = Trim(TextToFind)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set FD =
Application.FileDialog(msoFileDialogFilePicker)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With FD<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.AllowMultiSelect = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.Title = &quot;</span>Укажите<span
style='mso-ansi-language:EN-US'> </span>любой<span style='mso-ansi-language:
EN-US'> </span>файл<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>папке<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.ButtonName = &quot;</span>Выбрать<span
style='mso-ansi-language:EN-US'> </span>папку<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>If .Show = False Then Exit Sub Else
iPath = Mid(.SelectedItems(1), 1, InStrRev(.SelectedItems(1), &quot;\&quot;))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set FD = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Workbooks.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Sheets.Add.Name = &quot;</span>Поиск<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set iFoundSht = ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>iFoundSht.Cells(1, 1) = &quot;</span>Ищем<span
lang=EN-US style='mso-ansi-language:EN-US'>: &quot; &amp; TextToFind<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>iFoundSht.Cells(1, 1).Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With Application<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.Calculation = xlManual<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.StatusBar = &quot;</span>Идёт<span
style='mso-ansi-language:EN-US'> </span>поиск<span lang=EN-US style='mso-ansi-language:
EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.ShowWindowsInTaskbar = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>iFileName = Dir(iPath &amp;
&quot;*.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Do While iFileName$ &lt;&gt;
&quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Set iTempWB =
Workbooks.Open(Filename:=iPath &amp; iFileName, upd</span>а<span lang=EN-US
style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>Links:=False, ReadOnly:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span><span
style='mso-spacerun:yes'>  </span>For Each iSheet In iTempWB.Sheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>If iSheet.FilterMode = True
Then iSheet.ShowAllData<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>Set iFoundRng =
iSheet.Cells.Find(What:=TextToFind, LookIn:=xlFormulas, LookAt:=xlPart)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>If Not iFoundRng Is Nothing
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    </span>FoundAny = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    </span>firstAddress =
iFoundRng.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    </span>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                        </span>With iFoundSht<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span>iLastRow =
.Cells(.Rows.Count, 1).End(xlUp).Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span>If iLastRow = 1
Then iLastRow = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span>If iShtName
&lt;&gt; iSheet.Name Then<span style='mso-spacerun:yes'>    </span>'</span>если<span
style='mso-ansi-language:EN-US'> </span>новый<span style='mso-ansi-language:
EN-US'> </span>файл<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                </span>With
.Cells(iLastRow + 2, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span>.Value =
&quot;</span>Файл<span lang=EN-US style='mso-ansi-language:EN-US'>: &quot;
&amp; iTempWB.Name &amp; &quot;, </span>Лист<span lang=EN-US style='mso-ansi-language:
EN-US'>: &quot; &amp; iSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span>.Font.Bold
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                           
</span>iFoundRng.EntireRow.Copy Destination:=.Cells(.Cells(.Rows.Count,
1).End(xlUp).Row + 1, 1)<span style='mso-spacerun:yes'>    </span>'</span>копируем<span
style='mso-ansi-language:EN-US'> </span>всю<span style='mso-ansi-language:EN-US'>
</span>строку<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span>iShtName =
iSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                        </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                        </span>Set iFoundRng =
iSheet.Cells.FindNext(iFoundRng)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    </span>Loop While
iFoundRng.Address &lt;&gt; firstAddress<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>              </span><span
style='mso-spacerun:yes'>  </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>iTempWB.Close SaveChanges:=False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>iFileName = Dir<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.StatusBar = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.ShowWindowsInTaskbar = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.EnableEvents = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.Calculation = xlCalculationAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If FoundAny = False Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span></span>MsgBox &quot;Текст '&quot; &amp;
TextToFind &amp; &quot;' ни в одном из файлов в папке:&quot; &amp; Chr(10)
&amp; iPath &amp; Chr(10) &amp; &quot; не был найден!&quot;, 48,
&quot;Отчёт&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>iFoundSht.Parent.Close
SaveChanges:=False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>MsgBox &quot;</span>Поиск<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; TextToFind &amp; &quot; </span>завершён<span
lang=EN-US style='mso-ansi-language:EN-US'>!&quot;, 64, &quot;</span>Поиск<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863530">Создание текстового файла и ввод текста в файл</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Open &quot;c:\2.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Print #1, &quot;Hello File&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Open &quot;c:\1.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Input #1, s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>MsgBox s</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>Close #1</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863531">Создание текстового файла и ввод текста
(определение конца файла)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Open
&quot;c:\1.txt&quot; For Output As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Print #1, &quot;Hello , File&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Close #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Open
&quot;c:\1.txt&quot; For Input As #1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>While Not EOF(1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Input #1, s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>MsgBox s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Wend <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Close #1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863532">Создание документов Word на основе таблицы Excel</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ReportToWord()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intReportCount As Integer<span
style='mso-spacerun:yes'>  </span>' </span>Количество<span style='mso-ansi-language:
EN-US'> </span>сообщений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strForWho As String<span
style='mso-spacerun:yes'>        </span>' </span>Получатель<span
style='mso-ansi-language:EN-US'> </span>сообщения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strSum As String<span
style='mso-spacerun:yes'>           </span>' </span>Сумма<span
style='mso-ansi-language:EN-US'> </span>за<span style='mso-ansi-language:EN-US'>
</span>товар<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strProduct As String<span
style='mso-spacerun:yes'>       </span>' </span>Название<span style='mso-ansi-language:
EN-US'> </span>товара<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strOutFileName As String<span
style='mso-spacerun:yes'>   </span>' Имя файла для сохранения сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strMessage As
String<span style='mso-spacerun:yes'>       </span>' Текст дополнительного
сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgData As
Range<span style='mso-spacerun:yes'>            </span>' Обрабатываемые ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim objWord As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>объекта<span lang=EN-US style='mso-ansi-language:EN-US'> Word<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set objWord =
CreateObject(&quot;Word.Application&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Информация с рабочего листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set rgData =
Range(&quot;A1&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
Range(&quot;E6&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр записей
на листе Лист1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intReportCount =
Application.CountA(Range(&quot;A:A&quot;))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>For i = 1 To intReportCount</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Динамические
сообщения в строке состояния</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>Application.StatusBar = &quot;Создание сообщения &quot; &amp; i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Назначение
данных переменным</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strForWho = rgData.Cells(i, 1).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strProduct = rgData.Cells(i, 2).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strSum = Format(rgData.Cells(i, 3).Value,
&quot;#,000&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Имя файла для сохранения отчета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strOutFileName = ThisWorkbook.path
&amp; &quot;\&quot; &amp; strForWho &amp; &quot;.doc&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Передача команд в Word</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With objWord</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Documents.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>With .Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Заголовок<span
style='mso-ansi-language:EN-US'> </span>сообщения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Font.Size = 14<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ParagraphFormat.Alignment = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText Text:=&quot;</span>О<span
style='mso-ansi-language:EN-US'> </span>Т<span style='mso-ansi-language:EN-US'>
</span>Ч<span style='mso-ansi-language:EN-US'> </span>Е<span style='mso-ansi-language:
EN-US'> </span>Т<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Дата<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Font.Size = 12<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ParagraphFormat.Alignment = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Font.Bold = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText Text:=&quot;</span>Дата<span
lang=EN-US style='mso-ansi-language:EN-US'>:&quot; &amp; vbTab &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>Format(Date, &quot;mmmm d,
yyyy&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Получатель<span
style='mso-ansi-language:EN-US'> </span>сообщения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText Text:=&quot;</span>Кому<span
lang=EN-US style='mso-ansi-language:EN-US'>: </span>менеджеру<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; vbTab &amp; strForWho<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Отправитель<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText Text:=&quot;</span>От<span
lang=EN-US style='mso-ansi-language:EN-US'>:&quot; &amp; vbTab &amp;
Application.UserName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Сообщение<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText strMessage<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Название<span
style='mso-ansi-language:EN-US'> </span>товара<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeText Text:=&quot;</span>Продано<span
style='mso-ansi-language:EN-US'> </span>товара<span lang=EN-US
style='mso-ansi-language:EN-US'>:&quot; &amp; vbTab &amp; strProduct<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.TypeParagraph<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Сумма<span
style='mso-ansi-language:EN-US'> </span>за<span style='mso-ansi-language:EN-US'>
</span>товар<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span>.TypeText Text:=&quot;</span>На<span
style='mso-ansi-language:EN-US'> </span>сумму<span lang=EN-US style='mso-ansi-language:
EN-US'>:&quot; &amp; vbTab &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span></span>Format(strSum,
&quot;$#,##0&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Сохранение
документа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.ActiveDocument.SaveAs
FileName:=strOutFileName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление объекта
Word</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>objWord.Quit</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set objWord =
Nothing</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обновление строки
состояния</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Application.StatusBar = False</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод на экран
информационного сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
intReportCount &amp; &quot; заметки создано и сохранено в папке &quot; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&amp;
ThisWorkbook.path</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863533">Команды создания и удаления каталогов</a> </h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MkDir (&quot;c:\test&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>И<span style='mso-ansi-language:EN-US'> </span>удаляем<span
lang=EN-US style='mso-ansi-language:EN-US'>. <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>RmDir (&quot;c:\test&quot;)</p>

<p class=MsoNormal>End Sub</p>

<h3><a name="_Toc315863534">Получение<span style='mso-spacerun:yes'> 
</span>текущего каталога</a> </h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MsgBox (CurDir)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Смена<span style='mso-ansi-language:EN-US'> </span>каталога<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>ChDir (&quot;c:\windows&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>MsgBox (CurDir)</p>

<p class=MsoNormal>End Sub</p>

<h3><a name="_Toc315863535">Посмотреть все файлы в каталоге_1</a></h3>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>s = Dir(&quot;c:\windows\inf\*.*&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Debug.Print s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Do While s &lt;&gt; &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>s = Dir<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Debug.Print s<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h3><a name="_Toc315863536">Посмотреть все файлы в каталоге_2</a></h3>

<p class=MsoNormal>' Объявление API-функции для отображения стандартного окна _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>просмотра<span
style='mso-ansi-language:EN-US'> </span>папок<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function SHBrowseForFolder Lib &quot;shell32.dll&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Alias &quot;SHBrowseForFolderA&quot;
(lpBrowseInfo As BROWSEINFO) As ****<o:p></o:p></span></p>

<p class=MsoNormal>' Объявление API-функции для преобразования данных,
возвращаемых _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>функцией<span
lang=EN-US style='mso-ansi-language:EN-US'> SHBrowseForFolder, </span>в<span
style='mso-ansi-language:EN-US'> </span>строку<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function SHGetPathFromIDList Lib &quot;shell32.dll&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Alias &quot;SHGetPathFromIDListA&quot; (ByVal
pidl As ****, ByVal _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>pszPath As String) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>Структура<span
style='mso-ansi-language:EN-US'> </span>используется<span style='mso-ansi-language:
EN-US'> </span>функцией<span lang=EN-US style='mso-ansi-language:EN-US'>
SHBrowseForFolder<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Type
BROWSEINFO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>hwndOwner As ****<span
style='mso-spacerun:yes'>     </span>' Родительское окно (для диалога)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>pidlRoot As
****<span style='mso-spacerun:yes'>      </span>' Корневая папка для просмотра</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strDisplayName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strTitle As String<span
style='mso-spacerun:yes'>    </span>' </span>Заголовок<span style='mso-ansi-language:
EN-US'> </span>окна<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ulFlags As ****<span
style='mso-spacerun:yes'>       </span>' Флаги для окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Следующие три
параметра в VBA не используются</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lpfn As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lParam As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>iImage As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Type<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
BrowseFolder()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPath As String<span
style='mso-spacerun:yes'>  </span>' </span>Папка<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>список<span style='mso-ansi-language:
EN-US'> </span>файлов<span style='mso-ansi-language:EN-US'> </span>которой<span
style='mso-ansi-language:EN-US'> </span>выводится<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFile As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As ****<span
style='mso-spacerun:yes'>     </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>строка<span style='mso-ansi-language:EN-US'> </span>таблицы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Выбор<span style='mso-ansi-language:
EN-US'> </span>папки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strPath = dhBrowseForFolder()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strPath = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Right(strPath, 1) &lt;&gt; &quot;\&quot;
Then strPath = strPath &amp; &quot;\&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Оформление<span style='mso-ansi-language:
EN-US'> </span>заголовка<span style='mso-ansi-language:EN-US'> </span>отчета<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells.ClearContents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 1) = &quot;</span>Имя<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 2) = &quot;</span>Размер<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 3) = &quot;</span>Дата<span
lang=EN-US style='mso-ansi-language:EN-US'>/</span>время<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>ActiveSheet.Range(&quot;A1:C1&quot;).Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просмотр объектов в папке...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Первый объект
папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strFile =
Dir(strPath, 7)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intRow = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do While strFile &lt;&gt; &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Запись<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>столбец<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;A&quot; </span>имени<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveSheet.Cells(intRow, 1) = strFile<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Запись<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>столбец<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;B&quot; </span>размера<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveSheet.Cells(intRow, 2) =
FileLen(strPath &amp; strFile)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Запись в столбец &quot;C&quot;
времени изменения файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Cells(intRow, 3) =
FileDateTime(strPath &amp; strFile)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>     </span></span>'
Следующий объект папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strFile = Dir</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhBrowseForFolder() As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim biBrowse As BROWSEINFO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPath As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngResult As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intLen As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение полей структуры
BROWSEINFO</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Корневая папка -
Рабочий стол</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.pidlRoot =
0&amp;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заголовок окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.strTitle =
&quot;Выбор папки&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Тип возвращаемой
папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.ulFlags =
&amp;H1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод
стандартного окна просмотра папок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngResult =
SHBrowseForFolder(biBrowse)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обработка
результата работы окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If lngResult Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Получение пути
(по возвращенным данным)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strPath = Space$(512)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If SHGetPathFromIDList(ByVal lngResult,
ByVal strPath) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Строка пути заканчивается
символом Chr(0)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intLen =
InStr(strPath, Chr$(0))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Выделение и
возврат пути</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhBrowseForFolder = Left(strPath,
intLen - 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Не<span style='mso-ansi-language:
EN-US'> </span>удалось<span style='mso-ansi-language:EN-US'> </span>получить<span
style='mso-ansi-language:EN-US'> </span>путь<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhBrowseForFolder = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Пользователь<span
style='mso-ansi-language:EN-US'> </span>нажал<span style='mso-ansi-language:
EN-US'> </span>кнопку<span lang=EN-US style='mso-ansi-language:EN-US'> &quot;</span>Отмена<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhBrowseForFolder = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h3><a name="_Toc315863537">Посмотреть</a><span style='mso-bookmark:_Toc315863537'><span
style='mso-ansi-language:EN-US'> </span>все</span><span style='mso-bookmark:
_Toc315863537'><span style='mso-ansi-language:EN-US'> </span>файлы</span><span
style='mso-bookmark:_Toc315863537'><span style='mso-ansi-language:EN-US'> </span>в</span><span
style='mso-bookmark:_Toc315863537'><span style='mso-ansi-language:EN-US'> </span>каталоге</span><span
style='mso-bookmark:_Toc315863537'><span lang=EN-US style='mso-ansi-language:
EN-US'>_3</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h3>

<p class=MsoNormal>' Объявление API-функции для отображения стандартного окна _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>просмотра<span
style='mso-ansi-language:EN-US'> </span>папок<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function SHBrowseForFolder Lib &quot;shell32.dll&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Alias &quot;SHBrowseForFolderA&quot;
(lpBrowseInfo As BROWSEINFO) As ****<o:p></o:p></span></p>

<p class=MsoNormal>' Объявление API-функции для преобразования данных,
возвращаемых _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>функцией<span
lang=EN-US style='mso-ansi-language:EN-US'> SHBrowseForFolder, </span>в<span
style='mso-ansi-language:EN-US'> </span>строку<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function SHGetPathFromIDList Lib &quot;shell32.dll&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Alias &quot;SHGetPathFromIDListA&quot; (ByVal
pidl As ****, ByVal _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>pszPath As String) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>Структура<span
style='mso-ansi-language:EN-US'> </span>используется<span style='mso-ansi-language:
EN-US'> </span>функцией<span lang=EN-US style='mso-ansi-language:EN-US'>
SHBrowseForFolder<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Type
BROWSEINFO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>hwndOwner As ****<span
style='mso-spacerun:yes'>     </span>' Родительское окно (для диалога)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>pidlRoot As
****<span style='mso-spacerun:yes'>      </span>' Корневая папка для просмотра</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strDisplayName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strTitle As String<span
style='mso-spacerun:yes'>    </span>' </span>Заголовок<span style='mso-ansi-language:
EN-US'> </span>окна<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ulFlags As ****<span
style='mso-spacerun:yes'>       </span>' Флаги для окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Следующие три
параметра в VBA не используются</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lpfn As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lParam As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>iImage As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Type<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
BrowseFolder1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPath As String<span
style='mso-spacerun:yes'>  </span>' </span>Папка<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>список<span style='mso-ansi-language:
EN-US'> </span>файлов<span style='mso-ansi-language:EN-US'> </span>которой<span
style='mso-ansi-language:EN-US'> </span>выводится<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFile As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As ****<span
style='mso-spacerun:yes'>     </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>строка<span style='mso-ansi-language:EN-US'> </span>таблицы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Выбор<span style='mso-ansi-language:
EN-US'> </span>папки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strPath = dhBrowseForFolder()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strPath = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Right(strPath, 1) &lt;&gt; &quot;\&quot;
Then strPath = strPath &amp; &quot;\&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Оформление<span style='mso-ansi-language:
EN-US'> </span>заголовка<span style='mso-ansi-language:EN-US'> </span>отчета<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells.ClearContents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 1) = &quot;</span>Имя<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 2) = &quot;</span>Размер<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.Cells(1, 3) = &quot;</span>Дата<span
lang=EN-US style='mso-ansi-language:EN-US'>/</span>время<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>ActiveSheet.Range(&quot;A1:C1&quot;).Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span></span>'
Просмотр объектов в папке...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Первый объект
папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strFile =
Dir(strPath, 7)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intRow = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do While strFile &lt;&gt; &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Запись<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>столбец<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;A&quot; </span>имени<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveSheet.Cells(intRow, 1) = strPath
&amp; strFile<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Запись<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>столбец<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;B&quot; </span>размера<span
style='mso-ansi-language:EN-US'> </span>файла<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveSheet.Cells(intRow, 2) =
FileLen(strPath &amp; strFile)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Запись в столбец &quot;C&quot;
времени изменения файла</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Cells(intRow, 3) =
FileDateTime(strPath &amp; strFile)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Следующий объект папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strFile = Dir</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhBrowseForFolder() As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim biBrowse As BROWSEINFO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPath As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngResult As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intLen As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение полей структуры
BROWSEINFO</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Корневая папка -
Рабочий стол</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.pidlRoot =
0&amp;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заголовок окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.strTitle =
&quot;Выбор папки&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Тип возвращаемой
папки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>biBrowse.ulFlags =
&amp;H1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выводим
стандартное окно просмотра папок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngResult =
SHBrowseForFolder(biBrowse)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обработка
результата работы окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If lngResult Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Получение пути
(по возвращенным данным)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strPath = Space$(512)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If SHGetPathFromIDList(ByVal lngResult,
ByVal strPath) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Строка пути заканчивается
символом Chr(0)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intLen =
InStr(strPath, Chr$(0))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Выделение и
возврат пути</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhBrowseForFolder = Left(strPath,
intLen - 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Не<span style='mso-ansi-language:
EN-US'> </span>удалось<span style='mso-ansi-language:EN-US'> </span>получить<span
style='mso-ansi-language:EN-US'> </span>путь<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>dhBrowseForFolder =
&quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Пользователь
нажал кнопку &quot;Отмена&quot; в окне</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>   </span><span lang=EN-US style='mso-ansi-language:
EN-US'>dhBrowseForFolder = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h1><a name="_Toc315863538">ГЛАВА</a><span style='mso-bookmark:_Toc315863538'><span
lang=EN-US style='mso-ansi-language:EN-US'> 3. </span>РАБОЧАЯ ОБЛАСТЬ MICROSOFT
EXCEL</span></h1>

<p class=MsoNormal>Рабочая книга</p>

<h2><a name="_Toc315863539">Количество имен рабочей книги</a></h2>

<p class=MsoNormal>Sub CountNames()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intNamesCount
As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получаем и
отображаем количество имен на активном _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>листе<span
style='mso-ansi-language:EN-US'> </span>рабочей<span style='mso-ansi-language:
EN-US'> </span>книги<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intNamesCount = Names.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intNamesCount = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Имен<span
style='mso-ansi-language:EN-US'> </span>нет<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Имен<span lang=EN-US
style='mso-ansi-language:EN-US'>: &quot; &amp; intNamesCount &amp; &quot; </span>шт<span
lang=EN-US style='mso-ansi-language:EN-US'>.&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863540">Защита</a><span style='mso-bookmark:_Toc315863540'><span
style='mso-ansi-language:EN-US'> </span>рабочей</span><span style='mso-bookmark:
_Toc315863540'><span style='mso-ansi-language:EN-US'> </span>книги</span><span
style='mso-bookmark:_Toc315863540'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_BeforeRightClick(ByVal Target As Range, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Target.Address = &quot;$D$2&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Установка защиты рабочей книги
(с паролем &quot;123&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>включенной
защитой структуры книги и защитой расположения _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>окон)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>ThisWorkbook.Protect &quot;123&quot;, True, True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Указание не
обрабатывать нажатие кнопки мыши _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>в<span
style='mso-ansi-language:EN-US'> </span>этой<span style='mso-ansi-language:
EN-US'> </span>ячейке<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf Target.Address = &quot;$E$5&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Снятие защиты с книги
(необходимо указать ранее установленный _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>пароль<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ThisWorkbook.Unprotect &quot;123&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863541">Запрет</a><span style='mso-bookmark:_Toc315863541'><span
style='mso-ansi-language:EN-US'> </span>печати</span><span style='mso-bookmark:
_Toc315863541'><span style='mso-ansi-language:EN-US'> </span>книги</span><span
style='mso-bookmark:_Toc315863541'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Workbook_BeforePrint(Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Установка флага в True заставляет
Exсel игнорировать команду _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>отправки книги на
печать</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cancel = True</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863542">Открытие книги (или текстовых файлов)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Application.Workbooks.Open
(&quot;c:\file_03.txt&quot;)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863543">Открытие книги и добавление в ячейку А1 текста</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim Ex As
New Excel.Application<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Ex.Workbooks.Open
&quot;</span>Путь<span style='mso-ansi-language:EN-US'> </span>к<span
style='mso-ansi-language:EN-US'> </span>Файлу<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Ex.Visible
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'</span>В<span
style='mso-ansi-language:EN-US'> </span>ячейку<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;A2&quot; </span>добавляем<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;Visual Basic&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Ex.ActiveWorkbook.Sheets.Application.Range(&quot;A2&quot;)
= &quot;Visual Basic&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Ex.ActiveWorkbook.Save<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Ex.ActiveWorkbook.Close
<o:p></o:p></span></p>

<h2><a name="_Toc315863544">Сколько книг открыто</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox (Str(Application.Workbooks.Count))<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863545">Закрытие всех книг</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.Workbooks.Item(1).Close<span
style='mso-spacerun:yes'>  </span>‘(</span>е<span lang=EN-US style='mso-ansi-language:
EN-US'>xpr</span>е<span lang=EN-US style='mso-ansi-language:EN-US'>ssion.Close(SaveChanges,
FileName, RouteWorkbook)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863546">Закрытие рабочей книги только при выполнении
условия</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Workbook_BeforeClose(Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Range(&quot;A1&quot;).Value &lt;&gt;
&quot;</span>Можно<span style='mso-ansi-language:EN-US'> </span>закрывать<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Условие закрытия не выполнено.
Укажем Exсel игнорировать _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>команду</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Cancel = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863547">Сохранение рабочей книги с именем, представляющим
собой текущую дату</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SaveAsDate()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strDate As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение текущей даты и
представление ее в формате &quot;ддммгг&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strDate =
Format(Now(), &quot;ddmmyy&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Сохранение книги
в текущую папку под новым именем</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ActiveWorkbook.SaveAs ActiveWorkbook.Path &amp;
&quot;\&quot; &amp; strDate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863548">Сохранена ли рабочая книга</a></h2>

<p class=MsoNormal>Function dhBookIsSaved() As Boolean</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Если путь файла
рабочей книги не задан, то она _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>не сохранена
(ThisWorkbook.path равняется &quot;&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhBookIsSaved =
ThisWorkbook.path &lt;&gt; &quot;&quot;</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863549">Создать книгу с одним листом</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
NewOneSheetBook()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Workbooks.Add xlWBATWorksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Создать<span style='mso-ansi-language:EN-US'> </span>книгу<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Application.Workbooks.Add
(&quot;&Ecirc;&iacute;&egrave;&atilde;&agrave;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863550">Удаление ненужных имен</a></h2>

<p class=MsoNormal>Sub EraseNames()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim nmName As Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка наличия в книге
определенных имен</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If
ThisWorkbook.Names.Count = 0 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' В книге нет
определенных имен</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Имена не определены&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр всей
коллекции определенных имен и удаление тех, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>которые<span
style='mso-ansi-language:EN-US'> </span>пользователю<span style='mso-ansi-language:
EN-US'> </span>не<span style='mso-ansi-language:EN-US'> </span>нужны<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each nmName In ThisWorkbook.Names<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With nmName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Спрашиваем пользователя о
необходимости удалить _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>найденное
имя</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strMessage =
&quot;Удалить имя &quot; &amp; .Name &amp; &quot; ? <span lang=EN-US
style='mso-ansi-language:EN-US'>&quot; &amp; vbCr &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>&quot;</span>относящееся<span
style='mso-ansi-language:EN-US'> </span>к<span lang=EN-US style='mso-ansi-language:
EN-US'> &quot; &amp; .RefersTo<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If MsgBox(strMessage, vbYesNo +
vbQuestion) = vbYes Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>можно<span style='mso-ansi-language:EN-US'> </span>удалить<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863551">Быстрое размножение рабочей книги</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DuplicateBook()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim avarFileNames As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Формирование массива из путей для
копий книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>avarFileNames = Array(&quot;C:\&quot; &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWorkbook.Name, &quot;D:\&quot; &amp;
ActiveWorkbook.Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Сохранение<span style='mso-ansi-language:
EN-US'> </span>книги<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWorkbook.SaveAs avarFileNames<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863552">Сортировка</a><span style='mso-bookmark:_Toc315863552'><span
style='mso-ansi-language:EN-US'> </span>листов</span><span style='mso-bookmark:
_Toc315863552'></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SortSheets()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Dim astrSheetNames() As String '
Массив для хранения имен листов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intSheetCount As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Dim objActiveSheet As Object</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>' Если нет
активной рабочей книги - закрыть процедуру</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveWorkbook Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>' Проверка защищенности структуры
рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>If
ActiveWorkbook.ProtectStructure Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>' Сортировка
листов защищенной рабочей книги невозможна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>MsgBox
&quot;Структура книги &quot; &amp; ActiveWorkbook.Name &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>&quot;
защищена. Сортировка листов невозможна.&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>vbCritical</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>' Сохраняем ссылку
на активный лист книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set objActiveSheet = ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' </span>Отключение<span style='mso-ansi-language:
EN-US'> </span>сочетания<span style='mso-ansi-language:EN-US'> </span>клавиш<span
lang=EN-US style='mso-ansi-language:EN-US'> Ctrl+Pause Break<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.EnableCancelKey = xlDisabled<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' </span>Отключение<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>intSheetCount = ActiveWorkbook.Sheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>' Заполнение массива astrSheetNames
именами листов книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ReDim astrSheetNames(1 To intSheetCount)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>For i = 1 To intSheetCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>astrSheetNames(i) =
ActiveWorkbook.Sheets(i).Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>' Сортировка
массива имен в порядке возрастания</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call Sort(astrSheetNames)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' </span>Перемещение<span style='mso-ansi-language:
EN-US'> </span>листов<span style='mso-ansi-language:EN-US'> </span>книги<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>For i = 1 To intSheetCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       
</span>ActiveWorkbook.Sheets(astrSheetNames(i)).Move _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>ActiveWorkbook.Sheets(i)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>' Переход на
исходный рабочий лист</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>objActiveSheet.Activate</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>' Включение
обновления экрана</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' </span>Включение<span style='mso-ansi-language:
EN-US'> </span>сочетания<span style='mso-ansi-language:EN-US'> </span>клавиш<span
lang=EN-US style='mso-ansi-language:EN-US'> Ctrl+Pause Break<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.EnableCancelKey = xlInterrupt<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Sort(astrNames() As String)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>' Сортировка массива строк по
алфавиту (в порядке возрастания)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim i As Integer, j As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim strBuffer As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim fBuffer As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>For i = LBound(astrNames) To
UBound(astrNames) - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>For j = i + 1 To UBound(astrNames)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If astrNames(i) &gt; astrNames(j)
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span></span>' Меняем i-й и j-й
элементы массива местами</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strBuffer = astrNames(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>astrNames(i) = astrNames(j)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>astrNames(j) = strBuffer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Next j<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Next i</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863553">Поиск максимального значения на всех листах книги</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhMaxInBook(cell As Range) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim sheet As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblMax As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblResult As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fFirst As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>fFirst = True</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет
максимальных значений на всех листах рабочей книги _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>и<span
style='mso-ansi-language:EN-US'> </span>выбор<span style='mso-ansi-language:
EN-US'> </span>наибольшего<span style='mso-ansi-language:EN-US'> </span>из<span
style='mso-ansi-language:EN-US'> </span>них<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each sheet In
cell.Parent.Parent.Worksheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Расчет максимального значения на
листе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dblResult =
Application.WorksheetFunction.Max(sheet.UsedRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>If fFirst Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Найдено
первое значение - его не с чем сравнивать</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dblMax = dblResult<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>fFirst = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Выбираем большее из dblMax и
dbmResult</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If dblResult &gt; dblMax Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dblMax = dblResult<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next sheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Возврат<span style='mso-ansi-language:
EN-US'> </span>результата<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhMaxInBook = dblMax<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>РАБОЧИЙ ЛИСТ</p>

<h2><a name="_Toc315863554">Проверка наличия защиты рабочего листа</a></h2>

<p class=MsoNormal>Sub IsSheetProtected()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка,
установлена ли защита на содержимое листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Worksheets(1).ProtectContents Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Защита<span
style='mso-ansi-language:EN-US'> </span>листа<span style='mso-ansi-language:
EN-US'> </span>включена<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Защита листа не включена&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863555">Список отсортированных листов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SortSheets2()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim astrSheetNames() As String ' </span>Массив<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>хранения<span style='mso-ansi-language:EN-US'> </span>имен<span
style='mso-ansi-language:EN-US'> </span>листов<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intSheetCount As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim objActiveSheet As Object</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Если нет активной
рабочей книги - закрыть процедуру</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveWorkbook Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка защищенности структуры
рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If
ActiveWorkbook.ProtectStructure Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Сортировка
листов защищенной рабочей книги невозможна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Структура книги &quot; &amp; ActiveWorkbook.Name &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>&quot;
защищена. Сортировка листов невозможна.&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>vbCritical</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Сохраняем ссылку
на активный лист книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set objActiveSheet = ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отключение<span style='mso-ansi-language:
EN-US'> </span>сочетания<span style='mso-ansi-language:EN-US'> </span>клавиш<span
lang=EN-US style='mso-ansi-language:EN-US'> Ctrl+Pause Break<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.EnableCancelKey = xlDisabled<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Функция<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
style='mso-ansi-language:EN-US'> </span>отключается<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With ActiveWorkbook<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' C</span>оздаем<span style='mso-ansi-language:
EN-US'> </span>новый<span style='mso-ansi-language:EN-US'> </span>лист<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot; (</span>если<span
style='mso-ansi-language:EN-US'> </span>он<span style='mso-ansi-language:EN-US'>
</span>еще<span style='mso-ansi-language:EN-US'> </span>не<span
style='mso-ansi-language:EN-US'> </span>создан<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If .Sheets(&quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;) Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Sheets.Add.Name = &quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Размещение
данных на листе &quot;Сортировка&quot; (в столбец &quot;A&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intSheetCount = .Sheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For i = 1 To intSheetCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Sheets(&quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Cells(i, 1) =
.Sheets(i).Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Сортировка
данных в ячейках листа &quot;Сортировка&quot; по содержимому _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>столбца<span
lang=EN-US style='mso-ansi-language:EN-US'> A<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Sheets(&quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Range(&quot;A1&quot;).Sort _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Key1:=.Sheets(&quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Range(&quot;A1&quot;), _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'>   </span></span>Order1:=xlAscending</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Заполнение
массива имен отсортированными строками</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ReDim astrSheetNames(1 To
intSheetCount)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For i = 1 To intSheetCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astrSheetNames(i) = .Sheets(&quot;</span>Сортировка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Cells(i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Перемещение<span
style='mso-ansi-language:EN-US'> </span>листов<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For i = 1 To intSheetCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Sheets(astrSheetNames(i)).Move
.Sheets(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Переход на
исходный рабочий лист</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>objActiveSheet.Activate</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Включаем
обновление экрана</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span>' </span>Включение<span
style='mso-ansi-language:EN-US'> </span>сочетания<span style='mso-ansi-language:
EN-US'> </span>клавиш<span lang=EN-US style='mso-ansi-language:EN-US'>
Ctrl+Pause Break<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.EnableCancelKey = xlInterrupt<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863556">Создать</a><span style='mso-bookmark:_Toc315863556'><span
style='mso-ansi-language:EN-US'> </span>новый</span><span style='mso-bookmark:
_Toc315863556'><span style='mso-ansi-language:EN-US'> </span>лист</span><span
style='mso-bookmark:_Toc315863556'><span lang=EN-US style='mso-ansi-language:
EN-US'>_1</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
NewSheet()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Worksheets.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>‘Sub
Tes2t()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>‘With
Application.Workbooks.Item(ActiveWorkbook.Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>‘Sheets.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>‘End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>‘End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>‘Dim ExNew
As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>‘Set ExNew = ActiveWorkbook.Worksheets.Add<o:p></o:p></span></p>

<p class=MsoNormal>‘ExNew.Name = &quot;Имя Листа&quot;</p>

<p class=MsoNormal>Создать новый лист_2</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Worksheets.Add.Name
= &quot;List12345.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal>Удаление листов в зависимости от даты</p>

<p class=MsoNormal>' Function DelSheetByDate </p>

<p class=MsoNormal>' Удаляет рабочий лист sSheetName в активной рабочей книге, </p>

<p class=MsoNormal>' если дата dDelDate уже наступила </p>

<p class=MsoNormal>' В случае успеха возвращает True, иначе - False </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public
Function DelSheetByDate(sSheetName As String, _ <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                               </span>dDelDate As
Date) As Boolean <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo errHandle <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>DelSheetByDate = False <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>' </span>Проверка<span style='mso-ansi-language:
EN-US'> </span>даты<span lang=EN-US style='mso-ansi-language:EN-US'> <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>If dDelDate &lt;= Date Then <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Не выводить подтверждение на
удаление </p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.DisplayAlerts = False <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWorkbook.Worksheets(sSheetName).Delete
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>DelSheetByDate = True <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.DisplayAlerts = True <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End If <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Exit
Function <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>errHandle: <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>MsgBox Err.Des</span>с<span lang=EN-US
style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US style='mso-ansi-language:
EN-US'>tion, vbCritical, &quot;</span>Ошибка<span lang=EN-US style='mso-ansi-language:
EN-US'> №&quot; &amp; Err.Number <o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863557">Копирование листа в книге</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Sheets(&quot;Test&quot;).Copy ,
after:=Sheets(&quot;</span>Лист<span lang=EN-US style='mso-ansi-language:EN-US'>3&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>End With</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863558">Копирование листа в новую книгу (создается)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Sheets(&quot;Test&quot;).Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></h2>

<h2><a name="_Toc315863559">Перемещение листа в книге</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Sheets(&quot;Test&quot;).Move ,
after:=Sheets(&quot;</span>Лист<span lang=EN-US style='mso-ansi-language:EN-US'>3&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>End With</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863560">Перемещение нескольких листов в новую книгу</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(Array(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;, &quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;, &quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>3&quot;)).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>3&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(Array(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;, &quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;, &quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>3&quot;)).Copy<o:p></o:p></span></p>

<h2><a name="_Toc315863561">Заменить существующий файл</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub copy_sheet()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ShName =
ActiveSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(ShName).Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveWorkbook.SaveAs
&quot;c:\&quot; &amp; ShName &amp; &quot;.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Чтобы не вылезало диалоговое окно надо добавить</p>

<p class=MsoNormal>Application.DisplayAlerts = False ' вылючаем все
предупреждения</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveWorkbook.SaveAs
&quot;c:\&quot; &amp; ShName &amp; &quot;.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal>Application.DisplayAlerts = True 'обратно включаем
предупреждения.</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>«</span>Перелистывание<span
lang=EN-US style='mso-ansi-language:EN-US'>» </span>книги<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SheetsOfBook()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim sheet As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение имен всех листов
активной рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each sheet In ActiveWorkbook.Sheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox (sheet.Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863562">Вставка колонтитула с именем книги, листа и текущей
датой</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AddPageHeader()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>With ThisWorkbook</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Вставка
колонтитулов на все листы рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For i = 1 To .Worksheets.Count - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Worksheets(i).PageSetup.LeftHeader =
.FullName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Worksheets(i).PageSetup.CenterHeader
= Worksheets(i).Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Worksheets(i).PageSetup.RightHeader =
Now()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863563">Существует</a><span style='mso-bookmark:_Toc315863563'><span
style='mso-ansi-language:EN-US'> </span>ли</span><span style='mso-bookmark:
_Toc315863563'><span style='mso-ansi-language:EN-US'> </span>лист</span><span
style='mso-bookmark:_Toc315863563'></span><span lang=EN-US style='mso-ansi-language:
EN-US'> <o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSheetExist(strSheetName As String) As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim objSheet As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error GoTo HandleError ' </span>При<span
style='mso-ansi-language:EN-US'> </span>ошибке<span style='mso-ansi-language:
EN-US'> </span>перейти<span style='mso-ansi-language:EN-US'> </span>на<span
lang=EN-US style='mso-ansi-language:EN-US'> HandleError<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Пытаемся получить ссылку на
заданный лист</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>objSheet =
ActiveWorkbook.Sheets(strSheetName)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ошибки не
возникло - лист существует</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhSheetExist = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>HandleError:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' При попытке получить доступ к листу
с заданным именем _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>возникла ошибка,
значит, такого листа не существует</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhSheetExist = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h2><a name="_Toc315863564">Существует</a><span style='mso-bookmark:_Toc315863564'><span
style='mso-ansi-language:EN-US'> </span>ли</span><span style='mso-bookmark:
_Toc315863564'><span style='mso-ansi-language:EN-US'> </span>лист</span><span
style='mso-bookmark:_Toc315863564'><span lang=EN-US style='mso-ansi-language:
EN-US'>_2</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>L = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each
Sheet In Worksheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
Sheet.Name = &quot;List12&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>L = 1<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;List12 совпадает с расчетным листом.
Переименуйте свой List12 на какое нибудь другое имя!&quot;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If L = 0
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Worksheets.Add.Name
= &quot;List12&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(1).Visible
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;List12&quot;).Visible
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;List12&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal>End If</p>

<h2><a name="_Toc315863565">Вывод количества листов в активной книге</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MsgBox
(Str(Application.Workbooks.Item(ActiveWorkbook.Name).Sheets.Count))<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863566">Вывод количества листов в активной книге в виде
гиперссылок</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SheetNamesAsHyperLinks()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim sheet As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With ActiveWorkbook<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Просмотр всех листов книги и
создание гиперссылок на них _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>на<span
style='mso-ansi-language:EN-US'> </span>первом<span style='mso-ansi-language:
EN-US'> </span>листе<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For Each sheet In
ActiveWorkbook.Worksheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set cell = Worksheets(1).Cells(sheet.Index,
1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Worksheets(1).Hyperlinks.Add
Anchor:=cell, Address:=&quot;&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>SubAddress:=&quot;'&quot; &amp;
sheet.Name &amp; &quot;'&quot; &amp; &quot;!A1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Formula = sheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863567">Вывод имен активных листов по очереди</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
Application.Workbooks.Item(ActiveWorkbook.Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For x = 1
To .Sheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MsgBox (Sheets.Item(x).Name)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next x<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863568">Вывод имени и номеров листов текущей книги</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowInfo()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Выводим имя файла рабочей книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>Range(&quot;A1&quot;) = ActiveWorkbook.Name</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выводим имя
текущего листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;B1&quot;) = ActiveSheet.Name</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выводим номера
листов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To ActiveWorkbook.Sheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveSheet.Cells(i, 3) = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863569">Сделать лист невидимым</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>.Sheets.Item(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>5&quot;).Visible = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863570">Сколько страниц на всех листах?</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
GetPrintPagesCount()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim wshtSheet As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intPagesCount As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Суммирование
количества страниц, необходимых для печати всех _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>листов<span
style='mso-ansi-language:EN-US'> </span>книги<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each wshtSheet In Worksheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intPagesCount = intPagesCount +
(wshtSheet.HPageBreaks.Count + 1) * _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>(wshtSheet.VPageBreaks.Count + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Всего<span
style='mso-ansi-language:EN-US'> </span>страниц<span lang=EN-US
style='mso-ansi-language:EN-US'>: &quot; &amp; intPagesCount<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Ячейка и диапазон (столбцы и строки)</p>

<h2><a name="_Toc315863571">Копирование строк на другой лист</a></h2>

<p class=MsoNormal>Sub CopyRows2()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iCells
As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each
iCells In Range(&quot;A2:A5&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(iCells,
iCells.Offset(, 7)).Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Workbooks.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Paste<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveWorkbook.SaveAs
Filename:=&quot;C:\Temp\&quot; &amp; iCells &amp; &quot;.xls&quot;<o:p></o:p></span></p>

<p class=MsoNormal>Next iCells</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863572">Копирование столбцов на другой лист</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>s =
Names(&quot;sourcefilename&quot;).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If s =
&quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>sfile =
&quot;progcall234_56g&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Call
get_file<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>s = sfile<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>s = Mid(s,
3, Len(s) - 3)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If s =
&quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Workbooks.Open
(s)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim snm As
String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>snm =
ActiveWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ncol =
WorksheetFunction.CountA(Range(&quot;1:1&quot;)) '
Range(&quot;a1&quot;).SpecialCells(xlLastCell).Column<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>nrow =
WorksheetFunction.CountA(Range(&quot;a:a&quot;))
'Range(&quot;a1&quot;).SpecialCells(xlLastCell).Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(Cells(1,
1), Cells(nrow, ncol)).Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Workbooks(s1).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(&quot;a1&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Paste<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayAlerts
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Workbooks(snm).Close<o:p></o:p></span></p>

<h2><a name="_Toc315863573">Подсчет количества ячеек, содержащих указанные
значения_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCount(rgn As Range, LowBound As Double, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>UpperBound As Double) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngCount As ****</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проходим по всем
ячейкам диапазона rgn и подсчитываем значения, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>попадающие в
интервал от LowBound до UpperBound</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In rgn<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Value &gt;= LowBound And
cell.Value &lt;= UpperBound Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Значение попадает в заданный
интервал</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngCount = lngCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhCount = lngCount<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863574">Подсчет количества ячеек в диапазоне, содержащих
указанные значения_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCountSomeCells(rgRange As Range, dblMin As Double, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>dblMax As Double) As ****</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет количества
ячеек со значениями от dblMin до dblMax _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>с использованием
стандартной функции CountIf</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
Application.WorksheetFunction</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhCountSomeCells = .CountIf(rgRange,
&quot;&gt;=&quot; &amp; dblMin) - _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>.CountIf(rgRange, &quot;&gt;&quot; &amp;
dblMax)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863575">Подсчет количества видимых ячеек в диапазоне</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCountVisibleCells(rgRange As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngCount As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проходим по всему диапазону и
подсчитываем непустые _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>видимые<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In rgRange<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Проверка, есть ли данные в
ячейке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>     </span><span lang=EN-US style='mso-ansi-language:
EN-US'>If Not IsEmpty(cell) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Проверка<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>видима<span style='mso-ansi-language:
EN-US'> </span>ли<span style='mso-ansi-language:EN-US'> </span>ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If Not cell.EntireRow.Hidden And Not _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>cell.EntireColumn.Hidden Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Еще<span style='mso-ansi-language:
EN-US'> </span>одна<span style='mso-ansi-language:EN-US'> </span>видимая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>lngCount = lngCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhCountVisibleCells = lngCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h2><a name="_Toc315863576">Определение количества ячеек в диапазоне и суммы их
значений</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CalculateSum()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intSum As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет суммы
ячеек столбца &quot;A&quot; (с первой по пятую)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intSum = intSum + Cells(i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Сумма<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'>: &quot; &amp; intSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863577">Подсчет количества ячеек</a></h2>

<p class=MsoNormal>Sub CountOfCells()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox (Range(&quot;A1:A20,
D1:D20&quot;).Count)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863578">Автоматический пересчет данных таблицы при
изменении ее значений</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Change(ByVal Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgData As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblMax As Double, dblMin As Double,
dblAverage As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение контролируемого диапазона
ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set rgData =
Range(&quot;B2:B11&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка, не
входит ли измененная ячейка в контролируемый _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>диапазон<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Not (Application.Intersect(Target,
rgData) Is Nothing) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If
Application.WorksheetFunction.CountA(rgData) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Изменена ячейка из
контролируемого диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Заново рассчитываем
минимальное, максимальное и среднее _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>значения в
контролируемом диапазоне ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>dblMin =
Application.WorksheetFunction.Min(rgData)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dblMax =
Application.WorksheetFunction.Max(rgData)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dblAverage = Application.WorksheetFunction.Average(rgData)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Проверяем каждую ячейку из
контролируемого диапазона _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>и изменяем
цвет шрифта ячеек с минимальным и максимальным _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>значениями,
а также помечаем желтым цветом ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>со
значениями больше среднего</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>For Each cell
In rgData</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>If
cell.Value = dblMax Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Ячейку с максимальным значением выделим красным цветом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>cell.Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>cell.Font.Color = RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span><span
style='mso-spacerun:yes'>  </span></span>ElseIf cell.Value = dblMin Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Ячейку с минимальным значением выделим синим цветом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>cell.Font.Bold = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>cell.Font.Color = RGB(0, 0, 255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>cell.Font.Bold = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>   </span>cell.Font.Color = RGB(0, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If cell.Value &gt; dblAverage Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Значение в ячейке
больше среднего - выделим ее _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>желтым<span
style='mso-ansi-language:EN-US'> </span>цветом<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>cell.Interior.Color = RGB(255,
255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>    </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>cell.Interior.ColorIndex =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>rgData.Interior.ColorIndex = xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863579">Ввод данных в ячейки</a></h2>

<p class=MsoNormal>Sub SetCellData()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение
значениями ячеек А3 и В4</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;A3&quot;) = &quot;Данные для ячейки A3&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;B4&quot;) = &quot;Данные для ячейки B4&quot;</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863580">Ввод данных с использованием формул</a></h2>

<p class=MsoNormal>Sub SetCellFormula()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запись в ячейку
А6 формулы &quot;=A5+B5&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(&quot;A6&quot;) = &quot;=A5+B5&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Последовательный ввод данных</p>

<p class=MsoNormal>Sub StreamInput()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strDate As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strSum As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngRow As ****</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод данных в
цикле (повторяется до тех пор, пока пользователь _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>не введет пустую
строку или не нажмет &quot;Отмена&quot; в окне ввода)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>lngRow = Range(&quot;A65536&quot;).End(xlUp).Row
+ 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Ввод<span style='mso-ansi-language:
EN-US'> </span>даты<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strDate = InputBox(&quot;</span>Вводим<span
style='mso-ansi-language:EN-US'> </span>дату<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If strDate = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Ввод<span style='mso-ansi-language:
EN-US'> </span>выручки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strSum = InputBox(&quot;</span>Вводим<span
style='mso-ansi-language:EN-US'> </span>выручку<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If strSum = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Запись данных в ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Cells(lngRow, 1)
= strDate</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Cells(lngRow, 2) = strSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863581">Ввод</a><span style='mso-bookmark:_Toc315863581'><span
style='mso-ansi-language:EN-US'> </span>текстоввых</span><span
style='mso-bookmark:_Toc315863581'><span style='mso-ansi-language:EN-US'> </span>данных</span><span
style='mso-bookmark:_Toc315863581'><span style='mso-ansi-language:EN-US'> </span>в</span><span
style='mso-bookmark:_Toc315863581'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863581'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub ins</span>е<span
lang=EN-US style='mso-ansi-language:EN-US'>rtCustomText()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение текущей ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ActiveCell =
&quot;Генеральный директор&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Selection.Font.Bold
= True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Фамилия на три
столбца правее должности</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Cells(ActiveCell.Row, ActiveCell.Column +
3).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell.FormulaR1C1 = &quot;</span>А<span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>Б<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Рублев<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Selection.Font.Bold = True</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ячейка с
&quot;Главный бухгалтер&quot; на три столбца левее _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>и на три строки
ниже ячейки с фамилией директора</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Cells(ActiveCell.Row + 3, ActiveCell.Column -
3).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell = &quot;</span>Главный<span
style='mso-ansi-language:EN-US'> </span>бухгалтер<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Фамилия на три столбца правее
должности</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Cells(ActiveCell.Row, ActiveCell.Column +
3).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell = &quot;</span>Т<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>С<span lang=EN-US style='mso-ansi-language:
EN-US'>. </span>Копейкин<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863582">Вывод в ячейки названия книги, листа и количества
листов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim book As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim sheet As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim addr As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>addr = &quot;C&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>book = Application.ActiveWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>sheet = Application.ActiveSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Workbooks(book).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Worksheets(sheet).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Range(&quot;A1&quot;) = book<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Range(&quot;B1&quot;) = sheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim xList As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>xList = Application.Sheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>For x = 1 To xList<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>s = addr + LTrim(Str(x))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(s) = x<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Next x<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863583">Удаление</a><span style='mso-bookmark:_Toc315863583'><span
style='mso-ansi-language:EN-US'> </span>пустых</span><span style='mso-bookmark:
_Toc315863583'><span style='mso-ansi-language:EN-US'> </span>строк</span><span
style='mso-bookmark:_Toc315863583'><span lang=EN-US style='mso-ansi-language:
EN-US'>_1</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.SpecialCells(xlCellTypeBlanks).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.Delete
Shift:=xlUp<o:p></o:p></span></p>

<h2><a name="_Toc315863584">Удаление</a><span style='mso-bookmark:_Toc315863584'><span
style='mso-ansi-language:EN-US'> </span>пустых</span><span style='mso-bookmark:
_Toc315863584'><span style='mso-ansi-language:EN-US'> </span>строк</span><span
style='mso-bookmark:_Toc315863584'><span lang=EN-US style='mso-ansi-language:
EN-US'>_2</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteEmptyStrings()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intLastRow As Integer<span
style='mso-spacerun:yes'>  </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>последней<span style='mso-ansi-language:EN-US'> </span>используемой<span
style='mso-ansi-language:EN-US'> </span>строки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intRow As Integer<span
style='mso-spacerun:yes'>      </span>' Номер проверяемой строки</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение номера
последней используемой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intLastRow =
Worksheets(ActiveSheet.Index).UsedRange.Row + _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   
</span>Worksheets(ActiveSheet.Index).UsedRange.Rows.Count - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Счетчик устанавливается на
используемую первую строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intRow =
Worksheets(ActiveSheet.Index).UsedRange.Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>пустых<span style='mso-ansi-language:EN-US'> </span>строк<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do While intRow &lt;= intLastRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If ActiveSheet.Rows(intRow).Text =
&quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Удаление<span
style='mso-ansi-language:EN-US'> </span>строки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveSheet.Rows(intRow).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Данные сдвинулись вверх,
поэтому номер последней _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>строки
уменьшился, а текущей - не изменился</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intLastRow =
intLastRow - 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Текущая
строка заполнена - переходим к следующей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863585">Удаление пустых строк_3</a></h2>

<p class=MsoNormal>Sub DeleteEmptyStrings1()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intLastRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение номера последней
используемой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intLastRow = ActiveSheet.UsedRange.Row + _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ActiveSheet.UsedRange.Rows.Count - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>пустых<span style='mso-ansi-language:EN-US'> </span>строк<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For intRow = intLastRow To 1 Step -1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If ActiveSheet.Rows(intRow).Text =
&quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveSheet.Rows(intRow).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next intRow</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863586">Удаление строки по условию</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iRange
As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
TextToFindArray As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim i As
****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>TextToFindArray
= Array(&quot;Toyota&quot;, &quot;</span>ВАЗ<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
Application<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.ScreenUpdating
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Calculation
= xlCalculationManual<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For i = 0
To 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
ActiveSheet.Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set iRange
= .Find(What:=TextToFindArray(i), LookIn:=xlFormulas, LookAt:=xlPart)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
iRange Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>iRange.EntireRow.Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set iRange
= .Find(What:=TextToFindArray(i), LookIn:=xlFormulas, LookAt:=xlPart)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Loop While
Not iRange Is Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Calculation
= xlCalculationAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.ScreenUpdating
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Строки<span style='mso-ansi-language:EN-US'> </span>с<span
style='mso-ansi-language:EN-US'> </span>текстом<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot; &amp; TextToFindArray(0) &amp; &quot; </span>и<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot; &amp; TextToFindArray(1)
&amp; &quot; </span>удалены<span lang=EN-US style='mso-ansi-language:EN-US'>!&quot;,
64, &quot;</span>Конец<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Удаление<span style='mso-ansi-language:EN-US'> </span>скрытых<span
style='mso-ansi-language:EN-US'> </span>строк<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
KillHiddenRows()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each x
In ActiveSheet.Rows<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If x.Hidden
Then x.Delete<o:p></o:p></span></p>

<p class=MsoNormal>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863587">Удаление используемых скрытых строк или строк с
нулевой высотой</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
KillUsedHiddenThinRows()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim x<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each x
In ActiveSheet.UsedRange.Rows<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If x.Hidden
Or x.Height = 0 Then x.EntireRow.Delete<o:p></o:p></span></p>

<p class=MsoNormal>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863588">Удаление дубликатов по маске</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
Two2One(Text As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim Polki,
i As Byte, tmp As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.Volatile<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Polki =
Split(Text, &quot;@&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For i = 1
To UBound(Polki)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If InStr(1,
Polki(i), &quot;:&quot;) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Polki(i)
&lt;&gt; Polki(i - 1) Then tmp = tmp &amp; &quot;@&quot; &amp; Polki(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else: tmp =
tmp &amp; &quot;@&quot; &amp; Polki(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Two2One =
Polki(0) &amp; tmp<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863589">Выделение диапазона над текущей ячейкой</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SelectCellRange()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strSelTop As String, strSelBottom As
String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение адресов нижней и верхней
ячеек диапазона для выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strSelBottom = ActiveCell.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strSelTop = Cells(1, ActiveCell.Column).Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Выделяем все ячейки выше текущей
(вместе с текущей ячейкой)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(strSelTop &amp; &quot;:&quot; &amp;
strSelBottom).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863590">Выделение диапазона над текущей ячейкой_2</a></h2>

<p class=MsoNormal>Sub SelectColumnData()</p>

<p class=MsoNormal>' что делать при ошибке</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo errors<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>нижний<span
style='mso-ansi-language:EN-US'> </span>адрес<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim a1 As
String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>верхний<span
style='mso-ansi-language:EN-US'> </span>адрес<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim a2 As
String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>диапазое<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal>Dim ran As Range</p>

<p class=MsoNormal>' если не верхнея ячейка</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
(ActiveCell.Row &lt;&gt; 1) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>пойти<span
style='mso-ansi-language:EN-US'> </span>вверх<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(-1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>взять<span
style='mso-ansi-language:EN-US'> </span>адрес<span style='mso-ansi-language:
EN-US'> </span>ячейки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>a1 =
ActiveCell.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>будем<span
style='mso-ansi-language:EN-US'> </span>подниматься<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For x = 1
To (ActiveCell.Row - 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>на<span
style='mso-ansi-language:EN-US'> </span>одну<span style='mso-ansi-language:
EN-US'> </span>вверх<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(-1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>если<span
style='mso-ansi-language:EN-US'> </span>не<span style='mso-ansi-language:EN-US'>
</span>число<span style='mso-ansi-language:EN-US'> </span>выход<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
IsNumeric(ActiveCell.Value) &lt;&gt; True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>на<span
style='mso-ansi-language:EN-US'> </span>одну<span style='mso-ansi-language:
EN-US'> </span>вниз<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>выход<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>GoTo nexts<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>если<span
style='mso-ansi-language:EN-US'> </span>пустая<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
IsEmpty(ActiveCell.Value) = True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>на<span
style='mso-ansi-language:EN-US'> </span>одну<span style='mso-ansi-language:
EN-US'> </span>вниз<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>выход<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>GoTo nexts<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal>Next x</p>

<p class=MsoNormal>nexts:</p>

<p class=MsoNormal>' получаем адрес вырехней</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>a2 =
ActiveCell.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>строим<span
style='mso-ansi-language:EN-US'> </span>диапазон<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set ran =
Range(a1 + &quot;:&quot; + a2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>выбеляем<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ran.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal>' выходим из процедуры</p>

<p class=MsoNormal>Exit Sub</p>

<p class=MsoNormal>' ошибка зовем на помощь</p>

<p class=MsoNormal>errors:</p>

<p class=MsoNormal>MsgBox &quot;Ошибка сообщите разработчику&quot;</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Выделить ячейку и поместить туда число</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Worksheets(&quot;</span>Лист<span lang=EN-US
style='mso-ansi-language:EN-US'>2&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Range(&quot;A2&quot;) = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Range(&quot;A3&quot;) = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863591">Выделение отрицательных значений</a></h2>

<p class=MsoNormal>Sub NegSelect()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim cell As Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр всех
ячеек выделенного диапазона и пометка тех, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>которые содержат
отрицательные значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For Each cell In
Selection</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If cell.Value &lt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Interior.Color = RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Interior.ColorIndex = xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next cell</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863592">Выделение диапазона и использование абсолютных
адресов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Worksheets(&quot;</span>Лист<span lang=EN-US
style='mso-ansi-language:EN-US'>2&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Dim HelloRange As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span>Set HelloRange =
Range(&quot;D3:D10&quot;) ‘можно через запятую выделять несколько интервалов
или яче</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span lang=EN-US
style='mso-ansi-language:EN-US'>HelloRange.Range(&quot;A1&quot;) = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Выделение<span style='mso-ansi-language:EN-US'> </span>ячеек<span
style='mso-ansi-language:EN-US'> </span>через<span style='mso-ansi-language:
EN-US'> </span>интервал<span lang=EN-US style='mso-ansi-language:EN-US'>_1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
IntervalCellSelect()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intFirstRow As Integer<span
style='mso-spacerun:yes'>  </span>' Первая строка для выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intLastRow As
Integer<span style='mso-spacerun:yes'>   </span>' Последняя строка для
выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgCells As
Range<span style='mso-spacerun:yes'>        </span>' Объединение выделяемых
ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intFirstRow = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intLastRow = 300</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
объединения ячеек в столбце &quot;B&quot; от строки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>intFirstRow до
строки intLastRow с шагом 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intRow = intFirstRow To intLastRow Step 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If rgCells Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Первая<span style='mso-ansi-language:
EN-US'> </span>ячейка<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>объединении<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set rgCells = Cells(intRow, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>    </span>' Добавление очередной ячейки в объединение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set rgCells = Union(rgCells,
Cells(intRow, 1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение всех
ячеек в объединении</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>rgCells.Select</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863593">Выделение ячеек через интервал_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
IntervalCellSelect()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intFirstRow As Integer<span
style='mso-spacerun:yes'>  </span>' </span>Первая<span style='mso-ansi-language:
EN-US'> </span>строка<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>выделения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intLastRow As Integer<span
style='mso-spacerun:yes'>   </span>' Последняя строка для выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgCells As
Range<span style='mso-spacerun:yes'>        </span>' Объединение выделяемых
ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Range<span
style='mso-spacerun:yes'>           </span>' </span>Текущая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span>intFirstRow = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intLastRow = 300</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
объединения ячеек в столбце &quot;B&quot; от строки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>intFirstRow до
строки intLastRow с шагом 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intRow = intFirstRow To intLastRow Step 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Set cell = Cells(intRow, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Set rgCells = Union(cell, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>IIf(intRow = intFirstRow, cell, rgCells))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение всех
ячеек в объединении</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>rgCells.Select</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Выделение нескольких диапазонов</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SelectRange()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;D3:D10, A3:A10 ,
F3&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863594">Движение</a><span style='mso-bookmark:_Toc315863594'><span
style='mso-ansi-language:EN-US'> </span>по</span><span style='mso-bookmark:
_Toc315863594'><span style='mso-ansi-language:EN-US'> </span>ячейкам</span><span
style='mso-bookmark:_Toc315863594'></span><span lang=EN-US style='mso-ansi-language:
EN-US'> <o:p></o:p></span></h2>

<p class=MsoNormal>переменная<span lang=EN-US style='mso-ansi-language:EN-US'>.Offset(RowOffset,
ColumnOffset)<o:p></o:p></span></p>

<p class=MsoNormal>В качестве переменных может выступать как ячейка так и
диапазон (Range) удобно пользоваться этой функцией для смещения относительно
текущей ячейки. </p>

<p class=MsoNormal>Например, смещение ввниз на одну ячейку и выделение ее: </p>

<p class=MsoNormal>ActiveCell.Offset(1, 0).Select</p>

<p class=MsoNormal>Если нужно двигаться вверх, то нужно использовать
отрицательное число: </p>

<p class=MsoNormal>ActiveCell.Offset(-1, 0).Select</p>

<p class=MsoNormal>Функция ниже использует эту возможность для того, чтобы
пробежаться вниз до первой пустой ячейки. </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub beg()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Dim a As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Dim d As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Dim c As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>a = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Set c = Range(ActiveCell.address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>d = c.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>c.Value = d<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>While (a = True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:2'>                        </span>ActiveCell.Offset(1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:2'>                        </span>If
(IsEmpty(ActiveCell.Value) = False) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:3'>                                   </span>Set c =
Range(ActiveCell.address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:3'>                                   </span>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:3'>                                   </span>d = c.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:3'>                                   </span>c.Value = d<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:2'>                        </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:3'>                                   </span>a = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:2'>                        </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Wend<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863595">Поиск ближайшей пустой ячейки столбца</a></h2>

<p class=MsoNormal>Sub FindEmptyCell()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Поиск ближайшей
пустой ячейки в текущем столбце</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Do While Not IsEmpty(ActiveCell.Value)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveCell.Offset(1, 0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863596">Поиск максимального значения</a></h2>

<p class=MsoNormal>Sub FindMaxValue()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>On Error Goto NoCell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Selection.Count &gt; 1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Поиск максимального значения в
выделенных ячейках</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Selection.Find(Application.Max(Selection)).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Поиск
максимального значения во всех ячейках листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Cells.Find(Application.Max(ActiveSheet.Cells)).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>NoCell:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>MsgBox &quot;Максимальное значение не
найдено&quot;</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863597">Поиск и замена по шаблону</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ReplaceCellsData()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просмотр всех ячеек диапазона
G1:K20 и замена искомого текста</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In [G1:K20]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Value Like &quot;*</span>Доход<span
lang=EN-US style='mso-ansi-language:EN-US'>*&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Value = &quot;</span>Выручка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Interior.Color = RGB(255, 255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Interior.Color = RGB(255, 255,
255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863598">Поиск значения с отображением результата в
отдельном окне</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Search()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgResult As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Поиск заданного значения в
диапазоне B1:B20 и вывод результата</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgResult =
Range(&quot;B1:B20&quot;).Find(9999, , xlValues)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If rgResult Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Поиск<span
style='mso-ansi-language:EN-US'> </span>не<span style='mso-ansi-language:EN-US'>
</span>дал<span style='mso-ansi-language:EN-US'> </span>результатов<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox rgResult.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863599">Поиск с выделением найденных данных_1</a></h2>

<p class=MsoNormal>Sub FindAndSelect()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strStartAddr As
String ' Хранит координаты первого найденного _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                               </span>значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgResult As
Range</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Поиск первого
входжения искомого слова</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgResult =
Range(&quot;B1:B10&quot;).Find(&quot;</span>Прибыль<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;, , xlValues)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Not rgResult Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Сохраним адрес найденной ячейки
(чтобы контролировать _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>зацикливание<span
style='mso-ansi-language:EN-US'> </span>поиска<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strStartAddr = rgResult.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do While Not rgResult Is Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Обработка результата поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>rgResult.Interior.Color = RGB(255, 255, 0)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Новый<span
style='mso-ansi-language:EN-US'> </span>поиск<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Set rgResult =
Range(&quot;B1:B10&quot;).FindNext(rgResult)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span><span style='mso-spacerun:yes'> </span>If
rgResult.Address = strStartAddr Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Поиск<span style='mso-ansi-language:
EN-US'> </span>завершен<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Exit Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863600">Поиск с выделением найденных данных_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CustomSearch()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFindData As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgFound As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Ввод строки для поиска</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strFindData =
InputBox(&quot;Введите данные для поиска&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр всех
рабочих листов книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To Worksheets.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With Worksheets(i).Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Поиск на i-м листе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set rgFound = .Find(strFindData,
LookIn:=xlValues)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If Not rgFound Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Ячейка с заданным
значением найдена - выделим ее</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Sheets(i).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>rgFound.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Поиск<span style='mso-ansi-language:
EN-US'> </span>завершен<span lang=EN-US style='mso-ansi-language:EN-US'>. </span>Ячейка
не найдена</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox (&quot;Поиск
не дал результатов&quot;)</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863601">Поиск по условию в диапазоне</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Option
Explicit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Поиск<span
lang=EN-US style='mso-ansi-language:EN-US'>()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
iFoundRng As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim AutoNum
As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
firstAddress As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
LastFoundRng As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>AutoNum = Range(&quot;E5&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>If AutoNum = &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>MsgBox
&quot;Вы не указали номер авто в ячейке Е5!&quot;, 48, &quot;Ошибка&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>LastFoundRng =
ActiveWorkbook.Names(&quot;LastFoundRngName&quot;).RefersToRange.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If LastFoundRng = &quot;&quot; Then
LastFoundRng = &quot;$C$1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With Columns(&quot;C&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Set iFoundRng = .Find(What:=AutoNum,
After:=Range(LastFoundRng), LookIn:=xlFormulas, LookAt:=xlWhole)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>If iFoundRng Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>MsgBox &quot;</span>Авто<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>номером<span lang=EN-US style='mso-ansi-language:EN-US'> &quot; &amp;
AutoNum &amp; &quot; </span>не<span style='mso-ansi-language:EN-US'> </span>найдено<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>столбце<span style='mso-ansi-language:EN-US'> </span>С<span lang=EN-US
style='mso-ansi-language:EN-US'>!&quot;, &quot;48&quot;, &quot;</span>Ошибка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>ActiveWorkbook.Names.Add
Name:=&quot;LastFoundRngName&quot;, RefersTo:=&quot;=&quot; &amp;
ActiveSheet.Name &amp; &quot;!&quot; &amp; iFoundRng.Address, Visible:=False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>[E7] = iFoundRng.Offset(0, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>[F7] = iFoundRng.Offset(0, 2)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863602">Поиск последней непустой ячейки диапазона</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhLastUsedCell(rgRange As Range) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngCell As ****</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Пойдем по
диапазону с конца (тогда первая попавшаяся _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>заполненная ячейка
и будет искомой)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For lngCell = rgRange.Count To 1 Step -1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not IsEmpty(rgRange(lngCell)) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Нашли<span style='mso-ansi-language:
EN-US'> </span>непустую<span style='mso-ansi-language:EN-US'> </span>ячейку<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhLastUsedCell = lngCell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next lngCell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Непустую ячейку не нашли</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhLastUsedCell = 0</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863603">Поиск последней непустой ячейки столбца</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhLastColUsedCell(rgColumn As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод значения последней непустой
ячейки столбца</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhLastColUsedCell =
rgColumn.Parent.Cells(Rows.Count, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>rgColumn.Column).End(xlUp).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h2><a name="_Toc315863604">Поиск</a><span style='mso-bookmark:_Toc315863604'><span
style='mso-ansi-language:EN-US'> </span>последней</span><span style='mso-bookmark:
_Toc315863604'><span style='mso-ansi-language:EN-US'> </span>непустой</span><span
style='mso-bookmark:_Toc315863604'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863604'><span style='mso-ansi-language:EN-US'> </span>строки</span><span
style='mso-bookmark:_Toc315863604'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhLastRowUsedCell(rgRow As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод значения последней непустой
ячейки строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhLastRowUsedCell =
rgRow.Parent.Cells(rgRow.Row, 256). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End(xlToLeft).Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863605">Поиск</a><span style='mso-bookmark:_Toc315863605'><span
style='mso-ansi-language:EN-US'> </span>ячейки</span><span style='mso-bookmark:
_Toc315863605'><span style='mso-ansi-language:EN-US'> </span>синего</span><span
style='mso-bookmark:_Toc315863605'><span style='mso-ansi-language:EN-US'> </span>цвета</span><span
style='mso-bookmark:_Toc315863605'><span style='mso-ansi-language:EN-US'> </span>в</span><span
style='mso-bookmark:_Toc315863605'><span style='mso-ansi-language:EN-US'> </span>диапазоне</span><span
style='mso-bookmark:_Toc315863605'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim myRange
As Range '</span>диапазон<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>поиска<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
FoundRng As Range '</span>найденная<span style='mso-ansi-language:EN-US'> </span>ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iRow As
****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iColumn
As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set myRange
= Range(&quot;B1:B100&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.FindFormat.Interior.ColorIndex
= 5 '</span>будем<span style='mso-ansi-language:EN-US'> </span>искать<span
style='mso-ansi-language:EN-US'> </span>синий<span style='mso-ansi-language:
EN-US'> </span>цвет<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set
FoundRng = myRange.Find(What:=&quot;&quot;, SearchFormat:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
FoundRng Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>iRow =
FoundRng.Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>iColumn =
FoundRng.Column<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Ячейка<span style='mso-ansi-language:EN-US'> </span>найдена<span
style='mso-ansi-language:EN-US'> </span>по<span style='mso-ansi-language:EN-US'>
</span>адресу<span lang=EN-US style='mso-ansi-language:EN-US'>: &quot; &amp;
Chr(13) &amp; &quot;</span>Ряд<span lang=EN-US style='mso-ansi-language:EN-US'>:
&quot; &amp; iRow &amp; Chr(13) &amp; &quot;</span>Столбец<span lang=EN-US
style='mso-ansi-language:EN-US'>: &quot; &amp; iColumn, vbInformation,
&quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Ячейка<span style='mso-ansi-language:EN-US'> </span>не<span
style='mso-ansi-language:EN-US'> </span>найдена<span lang=EN-US
style='mso-ansi-language:EN-US'>!&quot;, vbExclamation, &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End If</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863606">Поиск наличия значения в столбце</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iCell
As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set iCell =
Columns(1).Find(What:=&quot;*&quot;, LookIn:=xlFormulas,
SearchDirection:=xlPrevious)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
iCell Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Номер последней заполненной строки в столбце A:
&quot; &amp; iCell.Row, , &quot;&quot;</p>

<p class=MsoNormal>Else</p>

<p class=MsoNormal>MsgBox &quot;Столбец &quot;&quot;A&quot;&quot; не содержит
данных&quot;, vbExclamation, &quot;&quot;</p>

<p class=MsoNormal>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863607">Поиск совпадений в диапазоне</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Option
Explicit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
compare_areas()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim r As
Range, ar As Range, nm As String, col As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set r =
Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If r.Count
&lt; 2 Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'Dim r_prog
As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'r_prog =
prog<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'prog = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.ScreenUpdating
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>nm =
ActiveSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each ar
In r.Areas<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each col In ar.Columns<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>col.Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>    
</span>ActiveSheet.Paste<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     
</span>ActiveCell.SpecialCells(xlLastCell).Offset(1, 0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(Cells(1,
1), Cells(r.Cells.Count, 2)).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.Sort
Key1:=Range(&quot;A1&quot;), Order1:=xlAscending, Header:=xlGuess, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>OrderCustom:=1, MatchCase:=False,
Orientation:=xlTopToBottom, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>DataOption1:=xlSortTextAsNumbers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Rows(&quot;1:1&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.ins</span>е<span
lang=EN-US style='mso-ansi-language:EN-US'>rt Shift:=xlDown<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Cells(2,
2).FormulaR1C1 = &quot;=IF((RC[-1]=R[-1]C[-1])+(RC[-1]=R[1]C[-1]),1,0)&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(&quot;b2&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.AutoFill
Destination:=Range(Cells(2, 2), Cells(r.Cells.Count + 1, 2)),
Type:=xlFillDefault<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(Cells(2,
2), Cells(r.Cells.Count + 1, 2)).Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Cells(2,
2).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>:=False, Transpose:=False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.CutCopyMode
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each ar
In r.Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If ar.Value &lt;&gt; Empty Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>If WorksheetFunction.VLookup(ar.Value,
Range(Cells(2, 1), Cells(r.Count + 1, 2)), 2, 0) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>ar.Interior.ColorIndex = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayAlerts
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveSheet.Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(nm).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayAlerts
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.ScreenUpdating
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'prog =
r_prog<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
uncolor()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Selection.Interior.ColorIndex = xlNone<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863608">Поиск ячейки в диапазоне_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim r As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
foundCell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set r =
ActiveSheet.Range(&quot;A1:A6&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set
foundCell = r.Find(&quot;Ichiro&quot;, LookIn:=xlValues)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
foundCell Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>foundCell.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>MsgBox &quot;String not found.&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End If</p>

<h2><a name="_Toc315863609">Поиск<span style='mso-spacerun:yes'>  </span>ячейки
в диапазоне_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
findtekst()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim c As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set c =
Range(&quot;c3:c98&quot;).Find(&quot;*</span>ГКИ<span lang=EN-US
style='mso-ansi-language:EN-US'>*&quot;, , , xlWhole)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not c Is
Nothing Then c.Select<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox (c)</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Также для финда по xlWhole вариации:</p>

<p class=MsoNormal>&quot;*a&quot; - заканчивается на a</p>

<p class=MsoNormal>&quot;?a*&quot; - 2-я буква a</p>

<p class=MsoNormal>&quot;??a*&quot; - 3-я буква а</p>

<p class=MsoNormal>&quot;a?&quot; - начинается на a и содержит ещё 1 любую
букву</p>

<p class=MsoNormal>&quot;a?*&quot; - 2+ буквы минимум и начинается на a
(например a1, a10, a12, a55, a55dd56 всё посчитается) </p>

<p class=MsoNormal>&quot;*слово*&quot; - находит слова содержащие
&quot;слово&quot; в любой части строки (включая начало и конец)</p>

<p class=MsoNormal>&quot;слово*&quot; - находит ячейки начинающиеся со
&quot;слово&quot; или просто ячейку &quot;слово&quot; без дополнительных букв</p>

<h2><a name="_Toc315863610">Поиск приближенного значения в диапазоне</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub wwe()</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
foundCell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ActiveWorkbook.Names.Add
Name:=&quot;ev&quot;, RefersToR1C1:= _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>&quot;=INDEX(</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1!R11C2:R34C2,MATCH(MIN(ABS(</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1!R36C2:R234C2-</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1!R28C1)),ABS(</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1!R36C2:R234C2-</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1!R28C1),0))&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set
foundCell = [ev]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Names(&quot;ev&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
foundCell Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>foundCell.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;String not found.&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863611">Поиск начала и окончания диапазона, содержащего
данные</a></h2>

<p class=MsoNormal>Sub FindSheetData()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выводим диапазон
используемых ячеек листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox ActiveSheet.UsedRange.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Поиск начала данных</p>

<p class=MsoNormal>Sub FindStartOfData()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With ActiveSheet</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Заносим текст
в ячейку, являющуюся левой верхней _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>ячейкой
используемого диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>.Cells(.UsedRange.Row, .UsedRange.Column).Value = _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Начало<span
style='mso-ansi-language:EN-US'> </span>данных<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863612">Автоматическая замена значений</a></h2>

<p class=MsoNormal>Sub ReplaceValues()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim cell As Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка каждой
ячейки диапазона на возможность замены _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>значения в ней
(отрицательные значения заменяются на -1, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>положительные<span
lang=EN-US style='mso-ansi-language:EN-US'> - </span>на<span lang=EN-US
style='mso-ansi-language:EN-US'> 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In
Range(&quot;C1:C3&quot;).Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Value &lt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Value = -1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ElseIf cell.Value &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Value = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863613">Быстрое заполнение диапазона (массив)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
FillCells()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intStartVal As Integer<span
style='mso-spacerun:yes'>   </span>' </span>Начальное<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intStep As Integer<span
style='mso-spacerun:yes'>       </span>' Шаг при изменении значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intEndVal As Integer<span
style='mso-spacerun:yes'>     </span>' </span>Конечное<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intVal As Integer<span
style='mso-spacerun:yes'>        </span>' </span>Текущее<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intCellOffset As Integer '
Смещение от начальной ячейки</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Установка
параметров заполнения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intStartVal = 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intStep = 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intEndVal = 100</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение ячеек
текущего столбца значениями от 1 до 100</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intVal = intStartVal To intEndVal Step
intStep<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveCell.Offset(intCellOffset, 0).Value
= intVal<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intCellOffset = intCellOffset + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next intVal</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863614">Заполнение через интервал(массив)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
FillCells()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intStartVal As Integer<span
style='mso-spacerun:yes'>   </span>' </span>Начальное<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intStep As Integer<span
style='mso-spacerun:yes'>       </span>' Шаг при изменении значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intEndVal As Integer<span
style='mso-spacerun:yes'>     </span>' </span>Конечное<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intVal As Integer<span
style='mso-spacerun:yes'>        </span>' </span>Текущее<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intCellOffset As Integer '
Смещение от начальной ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intCellStep As
Integer<span style='mso-spacerun:yes'>   </span>' Шаг при перемещении между _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                 </span>заполняемыми
ячейками</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Установка
параметров заполнения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intStartVal = 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intStep = 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intEndVal = 30</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intCellStep = 3</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение ячеек
текущего столбца значениями от 3 до 30</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intVal = intStartVal To intEndVal Step
intStep<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveCell.Offset(intCellOffset, 0).Value
= intVal<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intCellOffset = intCellOffset +
intCellStep<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next intVal</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863615">Заполнение указанного диапазона(массив)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
FillCellRect()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRows As ****, intCols As Integer ' </span>Количество<span
style='mso-ansi-language:EN-US'> </span>ячеек<span style='mso-ansi-language:
EN-US'> </span>по<span lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                            </span></span>горизонтали<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>вертикали<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRow As ****, intCol As Integer<span
style='mso-spacerun:yes'>   </span>' </span>Координаты<span style='mso-ansi-language:
EN-US'> </span>текущей<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngStep As ****, lngVal As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Установка начального значения и
шага заполнения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngVal = 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngStep = 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод количества
ячеек по горизонтали и вертикали, которое _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>необходимо
заполнить</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngRows =
Val(InputBox(&quot;Количество ячеек в высоту&quot;))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intCols =
Val(InputBox(&quot;Количество ячеек в ширину&quot;))</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Отключение
обновления экрана</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Application.ScreenUpdating = False</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение ячеек
значениями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For lngRow = 1 To
lngRows</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For intCol = 1 To intCols<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveCell.Offset(lngRow,
intCol).Value = lngVal<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>lngVal = lngVal + lngStep<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next intCol<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next lngRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Включение<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863616">Заполнение диапазона(массив)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
FillCellRect1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRows As ****, intCols As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRow As ****, intCol As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngStep As ****, lngVal As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim alngValues() As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgRange As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Установка начального значения и
шага заполнения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngVal = 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngStep = 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод количества
ячеек по горизонтали и вертикали, которое _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>необходимо заполнить</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngRows =
Val(InputBox(&quot;Количество ячеек в высоту&quot;))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intCols =
Val(InputBox(&quot;Количество ячеек в ширину&quot;))</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ReDim alngValues(1 To lngRows, 1 To intCols)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgRange = ActiveCell.Range(Cells(1, 1),
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Cells(lngRows, intCols))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Заполнение<span style='mso-ansi-language:
EN-US'> </span>массива<span lang=EN-US style='mso-ansi-language:EN-US'>
alngValues </span>значениями<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For lngRow = 1 To lngRows<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = 1 To intCols<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>alngValues(lngRow, intCol) = lngVal<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>lngVal = lngVal + lngStep<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next intCol</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next lngRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Перенос значений
из массива в таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>rgRange.Value =
alngValues</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863617">Расчет суммы первых значений диапазона</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.65. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'> dhNSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhNSum(ByVal intCount As Integer, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>rgValues As Range) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblSum As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intCount &gt; rgValues.Count Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Задано количество элементов
большее, чем есть _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>в переданном
диапазоне</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intCount =
rgValues.Count</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет суммы
первых intCount элементов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To intCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dblSum = dblSum + rgValues(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Возврат
результата</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhNSum = dblSum</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863618">Размещение в ячейке электронных часов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub upd</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US
style='mso-ansi-language:EN-US'>Time()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim varNextCall As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Записываем в ячейку текущее время</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells(1, 1).Value =
Now</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Записываем в
varNextCall время, когда вызвать этот макрос _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в следующий раз
(через 1 секунду)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>varNextCall = TimeSerial(Hour(Now),
Minute(Now), Second(Now) + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Уведомляем Excel в необходимости
вызова макроса</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.OnTime varNextCall, &quot;upd</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span lang=EN-US
style='mso-ansi-language:EN-US'>Time&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span><a name="_Toc315863619">«Будильник»</a></h2>

<p class=MsoNormal>Sub Clock()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Уведомляем Excel,
что процедуру Alarm нужно вызвать в 20:55</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.OnTime
TimeValue(&quot;20:55:00&quot;), &quot;Alarm&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Alarm()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Пора<span
style='mso-ansi-language:EN-US'> </span>ужинать<span lang=EN-US
style='mso-ansi-language:EN-US'>!!!&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Оформление верхней и нижней границ диапазона</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
RangeBorder()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgRange As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgRange = Range(&quot;B2:D5&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Оформление<span style='mso-ansi-language:
EN-US'> </span>верхней<span style='mso-ansi-language:EN-US'> </span>границы<span
style='mso-ansi-language:EN-US'> </span>диапазона<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With rgRange.Borders(xlEdgeTop)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThick<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Color = RGB(0, 0, 255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Оформление нижней
границы диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With rgRange.Borders(xlEdgeBottom)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlMedium<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlDash<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Color = RGB(255, 0, 255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863620">Адрес</a><span style='mso-bookmark:_Toc315863620'><span
style='mso-ansi-language:EN-US'> </span>активной</span><span style='mso-bookmark:
_Toc315863620'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863620'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод адреса ячейки в различных
форматах</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox Target.Address() &amp; vbCr &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Target.Address(RowAbsolute:=False) &amp;
vbCr &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Target.Address(ReferenceStyle:=xlR1C1)
&amp; vbCr &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Target.Address(ReferenceStyle:=xlR1C1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>RowAbsolute:=False, ColumnAbsolute:=False,
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>RelativeTo:=Worksheets(1).Cells(2, 2))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863621">Координаты</a><span style='mso-bookmark:_Toc315863621'><span
style='mso-ansi-language:EN-US'> </span>активной</span><span style='mso-bookmark:
_Toc315863621'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863621'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Row
</span>и<span lang=EN-US style='mso-ansi-language:EN-US'> ActiveCell.Column - </span>покажут<span
style='mso-ansi-language:EN-US'> </span>координаты<span style='mso-ansi-language:
EN-US'> </span>активной<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'>.<o:p></o:p></span></p>

<h2><a name="_Toc315863622">Формула активной ячейки</a></h2>

<p class=MsoNormal>s = Range(&quot;A3&quot;).Formula</p>

<h2><a name="_Toc315863623">Получение из ячейки формулы</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Worksheets(&quot;</span>Лист<span lang=EN-US
style='mso-ansi-language:EN-US'>2&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Range(&quot;A2&quot;) = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Range(&quot;A3&quot;) = &quot;=A2+2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>MsgBox Range(&quot;A3&quot;).Formula +
&quot;<span style='mso-spacerun:yes'>  </span>- &quot; +
Str(Range(&quot;A3&quot;).Value)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863624">Тип</a><span style='mso-bookmark:_Toc315863624'><span
style='mso-ansi-language:EN-US'> </span>данных</span><span style='mso-bookmark:
_Toc315863624'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863624'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCellType(rgRange As Range) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Переходим к левой верхней ячейке,
если rgRange - диапазон, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>а<span
style='mso-ansi-language:EN-US'> </span>не<span style='mso-ansi-language:EN-US'>
</span>одна<span style='mso-ansi-language:EN-US'> </span>ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgRange = rgRange.Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определение типа значения в ячейке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Select Case True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case IsEmpty(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Ячейка пуста</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>dhCellType =
&quot;Пусто&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Case Application.IsText(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>В<span style='mso-ansi-language:
EN-US'> </span>ячейке<span style='mso-ansi-language:EN-US'> </span>текст<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhCellType = &quot;</span>Текст<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Application.IsLogical(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' В ячейке логическое значение
(True или False)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhCellType = &quot;</span>Булево<span
style='mso-ansi-language:EN-US'> </span>выражение<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Application.IsErr(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' При вычислении значения в
ячейке произошла ошибка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhCellType = &quot;</span>Ошибка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case IsDate(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' В ячейке дата</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>dhCellType =
&quot;Дата&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Case InStr(1, rgRange.Text,
&quot;:&quot;) &lt;&gt; 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>В<span style='mso-ansi-language:
EN-US'> </span>ячейке<span style='mso-ansi-language:EN-US'> </span>время<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhCellType = &quot;</span>Время<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case IsNumeric(rgRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' В ячейке числовое значение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>dhCellType =
&quot;Число&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863625">Вывод</a><span style='mso-bookmark:_Toc315863625'><span
style='mso-ansi-language:EN-US'> </span>адреса</span><span style='mso-bookmark:
_Toc315863625'><span style='mso-ansi-language:EN-US'> </span>конца</span><span
style='mso-bookmark:_Toc315863625'><span style='mso-ansi-language:EN-US'> </span>диапазона</span><span
style='mso-bookmark:_Toc315863625'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
TestRange()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Dim r As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Set r = Range(&quot;rrrrr&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>MsgBox (r.Columns.End(xlUp).Address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>MsgBox (r.Columns.End(xlDown).Address)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863626">Получение информации о выделенном диапазоне</a></h2>

<p class=MsoNormal>Sub TypeOfSelection()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgSelUnion As
Range<span style='mso-spacerun:yes'>         </span>' Объединение выделенных
областей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strTitle As
String<span style='mso-spacerun:yes'>          </span>' Заголовок сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strMessage As String<span
style='mso-spacerun:yes'>        </span>' </span>Текст<span style='mso-ansi-language:
EN-US'> </span>сообщения<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strSelType As String<span
style='mso-spacerun:yes'>        </span>' Тип выделения (простой или _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                   
</span>множественный)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intBlockCount
As Integer<span style='mso-spacerun:yes'>    </span>' Количество блоков в
выделении</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intCellCount As
****<span style='mso-spacerun:yes'>        </span>' Общее количество выделенных
ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intColCount As
Integer<span style='mso-spacerun:yes'>      </span>' Количество выделенных
столбцов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intRowCount As
****<span style='mso-spacerun:yes'>         </span>' Количество выделенных
строк</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intAreasCount
As Integer<span style='mso-spacerun:yes'>    </span>' Количество выделенных
областей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strCurSelType<span
style='mso-spacerun:yes'>  </span>As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgArea As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Подсчет количества выделенных
областей и определение типа выделения: _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>простое (одна
область) или сложное(несколько областей)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intAreasCount = Selection.Areas.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intAreasCount = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>strTitle = &quot;Простое
выделение&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strTitle =
&quot;Множественное выделение&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение типа
выделения первой области</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strSelType =
dhGetAreaType(Selection.Areas(1))</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание
объединения во избежание повторного учета _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>пересекающихся
участков выделенных диапазонов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set rgSelUnion =
Selection.Areas(1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each rgArea In Selection.Areas<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>strCurSelType =
dhGetAreaType(rgArea)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Изменение
надписи о типе всего выделения, если _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>есть выделения
различного типа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If strCurSelType
&lt;&gt; strSelType Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strSelType =
&quot;Множественный&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Определение
количества блоков перед их добавлением в объединение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If strCurSelType = &quot;Block&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intBlockCount = intBlockCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление в
объединение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set rgSelUnion = Union(rgSelUnion,
rgArea)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next rgArea</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просматриваются
элементы созданного объединения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each rgArea In rgSelUnion.Areas<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Select Case dhGetAreaType(rgArea)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case &quot;</span>Строка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intRowCount = intRowCount +
rgArea.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case &quot;</span>Столбец<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intColCount = intColCount +
rgArea.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case &quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intColCount = intColCount +
rgArea.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intRowCount = intRowCount +
rgArea.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next rgArea</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение
количества неперекрывающихся ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intCellCount =
rgSelUnion.Count</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование и
вывод итогового сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
&quot;Тип выделения:&quot; &amp; vbTab &amp; strSelType &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Количество
областей:<span style='mso-spacerun:yes'>      </span>&quot; &amp; vbTab &amp;
intAreasCount &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Полных
столбцов:<span style='mso-spacerun:yes'>          </span>&quot; &amp; vbTab
&amp; intColCount &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Полных
строк:<span style='mso-spacerun:yes'>             </span>&quot; &amp; vbTab
&amp; intRowCount &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Блоков
ячеек:<span style='mso-spacerun:yes'>             </span>&quot; &amp; vbTab
&amp; intBlockCount &amp; vbCrLf &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span><span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;</span>Всего<span style='mso-ansi-language:EN-US'> </span>ячеек<span
lang=EN-US style='mso-ansi-language:EN-US'>:<span
style='mso-spacerun:yes'>              </span>&quot; &amp; vbTab &amp;
Format(intCellCount, &quot;#,###&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox strMessage, vbInformation, strTitle<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetAreaType(rgRangeArea As Range) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Определение<span style='mso-ansi-language:
EN-US'> </span>типа<span style='mso-ansi-language:EN-US'> </span>диапазона<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If rgRangeArea.Count = Cells.Count Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Все ячейки рабочего листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>dhGetAreaType =
&quot;Лист&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ElseIf rgRangeArea.Cells.Count = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Одна<span style='mso-ansi-language:
EN-US'> </span>ячейка<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhGetAreaType = &quot;</span>Ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf rgRangeArea.Rows.Count =
Cells.Rows.Count Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Весь<span style='mso-ansi-language:
EN-US'> </span>столбец<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhGetAreaType = &quot;</span>Столбец<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf rgRangeArea.Columns.Count =
Cells.Columns.Count Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Вся строка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>dhGetAreaType =
&quot;Строка&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Блок ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>dhGetAreaType =
&quot;Блок&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal>Взять слово с 13 символа в ячейке</p>

<p class=MsoNormal>'берём значение ячейка А4 из Отчёта</p>

<p class=MsoNormal>iMonth = &quot;за период с Июль 2 008 по Июль 2 008 &quot;</p>

<p class=MsoNormal>'берём слово начиная с 13-го символа</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>iMonth =
Evaluate(&quot;MID(TRIM(&quot; &amp; &quot;&quot;&quot;&quot; &amp; iMonth
&amp; &quot;&quot;&quot;&quot; &amp; &quot;),13,(SEARCH(&quot;&quot;
&quot;&quot;,TRIM(&quot; &amp; &quot;&quot;&quot;&quot; &amp; iMonth &amp;
&quot;&quot;&quot;&quot; &amp; &quot;),13)-13))&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>'вставляем это слово в книгу Ведомость</p>

<p class=MsoNormal>AddressSht.Range(&quot;A1&quot;) = iMonth</p>

<h2><a name="_Toc315863627">Создание изменяемого списка (таблица)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>2()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.ListObjects.Add(xlSrcRange,
.Range(&quot;$A$8:$AR$&quot; &amp; .Cells(Rows.Count, 1).End(xlUp).Row), ,
xlYes).Name = _<o:p></o:p></span></p>

<p class=MsoNormal>&quot;Список1&quot;</p>

<p class=MsoNormal>End With</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Проверка на пустое значение</p>

<p class=MsoNormal>IsNull(выражение) - проверка на пустое значение</p>

<p class=MsoNormal>Пересечение<span style='mso-ansi-language:EN-US'> </span>ячеек<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>With ActiveWorkbook<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Worksheets(&quot;</span>Лист<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim Range1 As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set Range1 = Range(&quot;A1:A8 A8:D8&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range1.Value = &quot;test&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863628">Умножение выделенного диапазона на 2</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
cur_range As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Set cur_range = Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>cur_range.Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>For x = 1 To cur_range.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>For y = 1 To cur_range.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span></span>' значению ячейки присвоить значение
умноженно на 2</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cur_range(x, y) = cur_range(x, y).Value * 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Next y<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Next x<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863629">Одновременное умножение всех данных диапазона</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
MultAllCells()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblMult As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim cell As Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод коэффициента
для умножения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dblMult = InputBox(&quot;Введите
коэффициент, на который следует умножать&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Умножение
содержимого на введенный коэффициент</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If IsNumeric(cell.Value) And cell.Value
&lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Умножаются только ячейки,
содержащие числовые данные</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>        </span><span lang=EN-US style='mso-ansi-language:
EN-US'>cell.Value = cell.Value * dblMult<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>MsgBox &quot;В ячейке &quot;
&amp; cell.Address &amp; &quot; нечисловое значение&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863630">Деление</a><span style='mso-bookmark:_Toc315863630'><span
style='mso-ansi-language:EN-US'> </span>диапазона</span><span style='mso-bookmark:
_Toc315863630'><span style='mso-ansi-language:EN-US'> </span>на</span><span
style='mso-bookmark:_Toc315863630'><span lang=EN-US style='mso-ansi-language:
EN-US'> 100</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Test23()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim iRange
As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim kRange
As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>i = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>j = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>m = 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>n = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set iRange
= Range(Cells(i, j), Cells(m, n))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each
kRange In iRange<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>kRange.Value
= kRange.Value / 100<o:p></o:p></span></p>

<p class=MsoNormal>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Возведение каждой ячейки диапазона в квадрат</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<h2><a name="_Toc315863631">Суммирование данных только видимых ячеек</a></h2>

<p class=MsoNormal>Function СуммаВид(Диапазон) As Double</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр всех
ячеек заданного диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For Each Ячейка In
Диапазон</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Анализ только
видимых ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Not </span>Ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'>.EntireRow.Hidden And Not _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>Ячейка.EntireColumn.Hidden Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' При расчете
учитываются только ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>с численными
значениями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If
IsNumeric(Ячейка) = True Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>СуммаВид<span
lang=EN-US style='mso-ansi-language:EN-US'> = </span>СуммаВид<span lang=EN-US
style='mso-ansi-language:EN-US'> + </span>Ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863632">Сумма ячеек с числовыми значениями</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CalculateSum()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intSum As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет суммы
ячеек столбца &quot;A&quot; (с первой по пятую)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If IsNumeric(Cells(i, 1)) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intSum = intSum + Cells(i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Сумма<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'>: &quot; &amp; intSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863633">При суммировании — курсор внутри диапазона</a></h2>

<p class=MsoNormal>Function Сумма(Диапазон, АдресЯчейки) As Double</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр всех
ячеек диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For Each Ячейка In
Диапазон</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Проверка,
чтобы в суммировании не участвовала _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>ячейка с
формулой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If
АдресЯчейки.Address &lt;&gt; Ячейка.Address Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' В суммировании
участвуют только ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>с численными
значениями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If
IsNumeric(Ячейка) = True Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>Сумма<span
lang=EN-US style='mso-ansi-language:EN-US'> = </span>Сумма<span lang=EN-US
style='mso-ansi-language:EN-US'> + </span>Ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863634">Начисление процентов в зависимости от суммы_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculatePercent(lngSum As ****) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Процентные ставки (декларация
констант)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Const dblRate1 As Double = 0.09<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate2 As Double = 0.11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Const dblRate3 As Double = 0.15</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Граничные суммы
вкладов (декларация констант)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Const intSum1 As **** = 5000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const intSum2 As **** = 10000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возвращаем сумму, умноженную на
соответствующую ставку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If lngSum &lt; intSum1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = lngSum * dblRate1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf lngSum &lt; intSum2 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = lngSum * dblRate2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = lngSum * dblRate3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863635">Начисление процентов в зависимости от суммы_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculatePercent(lngSum As ****) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Процентные ставки (декларация
констант)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Const dblRate1 As Double = 0.09<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate2 As Double = 0.11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Const dblRate3 As Double = 0.15</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Граничные суммы
вкладов (декларация констант)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Const intSum1 As **** = 5000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const intSum2 As **** = 10000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возвращаем сумму, умноженную на
соответствующую ставку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Select Case lngSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Is &lt; intSum1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhCalculatePercent = lngSum * dblRate1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Is &lt; intSum2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhCalculatePercent = lngSum * dblRate2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhCalculatePercent = lngSum * dblRate3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End Select</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863636">Начисление процентов в зависимости от суммы_3</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculatePercent(Sales As ****, IsTemporal As Boolean) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Процентные ставки (декларация
констант)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Const dblRate1 As Double = 0.09<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate2 As Double = 0.11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate3 As Double = 0.15<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblAdd As Double = 1.1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Граничные суммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Const lngSum1 As
**** = 5000</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Const lngSum2 As
**** = 10000</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет суммы для
выплаты (как обычно)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Sales &lt; lngSum1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = Sales * dblRate1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf Sales &lt; lngSum2 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = Sales * dblRate2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhCalculatePercent = Sales * dblRate3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>If IsTemporal Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Для сторонних
вкладчиков - надбавка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhCalculatePercent = dblAdd *
dhCalculatePercent<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<h2><a name="_Toc315863637">Сводный</a><span style='mso-bookmark:_Toc315863637'><span
style='mso-ansi-language:EN-US'> </span>пример</span><span style='mso-bookmark:
_Toc315863637'><span style='mso-ansi-language:EN-US'> </span>расчета</span><span
style='mso-bookmark:_Toc315863637'><span style='mso-ansi-language:EN-US'> </span>комиссионного</span><span
style='mso-bookmark:_Toc315863637'><span style='mso-ansi-language:EN-US'> </span>вознаграждения</span><span
style='mso-bookmark:_Toc315863637'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculateCom(dblSales As Double) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate1 = 0.09<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate2 = 0.11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate3 = 0.15<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Расчет комиссионных с продаж (без
выслуги) в зависимости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>от<span
style='mso-ansi-language:EN-US'> </span>суммы<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Select Case dblSales<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 0 To 4999.99: dhCalculateCom =
dblSales * dblRate1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 5000 To 9999.99: dhCalculateCom =
dblSales * dblRate2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Is &gt;= 10000: dhCalculateCom =
dblSales * dblRate3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculateCom2(dblSales As Double, intYears As Double) _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate1 = 0.09<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Const dblRate2 = 0.11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Const dblRate3 = 0.15</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расчет
комиссионных с продаж (без учета выслуги лет) _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в зависимости от
суммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Select Case dblSales</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Case 0 To 4999.99: dhCalculateCom2 =
dblSales * dblRate1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 5000 To 9999.99: dhCalculateCom2 =
dblSales * dblRate2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case Is &gt;= 10000: dhCalculateCom2 =
dblSales * dblRate3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Надбавка<span style='mso-ansi-language:
EN-US'> </span>за<span style='mso-ansi-language:EN-US'> </span>выслугу<span
style='mso-ansi-language:EN-US'> </span>лет<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhCalculateCom2 = dhCalculateCom2 + _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>(dhCalculateCom2 * intYears / 100)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ComCalculator()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblSales As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim </span>ан<span lang=EN-US
style='mso-ansi-language:EN-US'> As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Calc:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение окна для ввода данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dblSales =
Val(InputBox(&quot;Сумма реализации:&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Расчет
комиссионного вознаграждения&quot;))</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
сообщения (с одновременным расчетом _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>вознаграждения)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
&quot;Объем продаж:&quot; &amp; vbTab &amp; Format(dblSales,
&quot;$#,##0&quot;) &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>vbCrLf &amp;
&quot;Сумма вознаграждения:&quot; &amp; vbTab &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>Format(dhCalculateCom(dblSales), &quot;$#,##0&quot;) &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>vbCrLf &amp;
vbCrLf &amp; &quot;Считаем дальше?&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод окна с
сообщением (о рассчитанной сумме и вопросом _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>о продолжении
расчетов)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If
MsgBox(strMessage, vbYesNo, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Расчет
комиссионного вознаграждения&quot;) = vbYes Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Продолжение
расчетов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>GoTo Calc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863638">Движение по диапазону</a></h2>

<p class=MsoNormal>Sub FullShach()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each c
In Range(addressdiap)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If c.Value &gt; yr1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>With Selection.Interior<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>.ColorIndex = 6<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>.Pattern = xlSolid<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Selection.Font.ColorIndex = yrcolor1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>If c.Value &gt; yr2 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Selection.Font.ColorIndex = yrcolor2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If c.Value &gt; yr3 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Selection.Font.ColorIndex =
yrcolor3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End If<o:p></o:p></span></p>

<p class=MsoNormal>Next c</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863639">Сдвиг от выделенной ячейки</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim cur_range As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Set cur_range = Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Set cur_range = cur_range.Offset(1, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Debug.Print cur_range.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Перебор ячеек вниз по колонне</p>

<p class=MsoNormal>Sub beg()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim a As
Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim d As
Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim c As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>a = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set c =
Range(ActiveCell.Address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>d = c.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.Value = d<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>While (a =
False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(1,
0).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
(IsEmpty(ActiveCell.Value) = False) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set c =
Range(ActiveCell.Address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>d = c.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.Value = d<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>a = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Wend<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863640">Создание заливки диапазона</a></h2>

<p class=MsoNormal>Sub FillRange()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заливка диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
Range(&quot;B1:E10&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Задаем узор -
сетчатый</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Interior.Pattern = xlPatternChecker<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Цвет<span style='mso-ansi-language:
EN-US'> </span>узора<span lang=EN-US style='mso-ansi-language:EN-US'> - </span>синий<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Interior.PatternColor = RGB(0, 0, 255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Цвет<span style='mso-ansi-language:
EN-US'> </span>ячейки<span lang=EN-US style='mso-ansi-language:EN-US'> - </span>красный<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Interior.Color = RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863641">Подбор параметра ячейки</a></h2>

<p class=MsoNormal>Sub Макрос1()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>Сочетание<span
style='mso-ansi-language:EN-US'> </span>клавиш<span lang=EN-US
style='mso-ansi-language:EN-US'>: Ctrl+</span>ф<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Range(&quot;G5&quot;).GoalSeek Goal:=4,
ChangingCell:=Range(&quot;G4&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863642">Разбиение</a><span style='mso-bookmark:_Toc315863642'><span
style='mso-ansi-language:EN-US'> </span>диапазона</span><span style='mso-bookmark:
_Toc315863642'></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
ExtractElement(Txt, n, Separator) As String<o:p></o:p></span></p>

<p class=MsoNormal>'<span style='mso-spacerun:yes'>   </span>Функция выдает
n-ый элемент текстовой строки Txt, где</p>

<p class=MsoNormal>'<span style='mso-spacerun:yes'>   </span>символ Separator
используется как разделитель</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim Txt1 As String, TempElement As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Dim ElementCount As Integer, i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Txt1 = Txt</p>

<p class=MsoNormal>'<span style='mso-spacerun:yes'>   </span>Если в качестве
разделителя используется пробел, то убираем лишние</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'>   </span></span>и<span style='mso-ansi-language:EN-US'>
</span>двойные<span style='mso-ansi-language:EN-US'> </span>пробелы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>If Separator = Chr(32) Then Txt1 =
Application.Trim(Txt1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoNormal>'<span style='mso-spacerun:yes'>   </span>Добавляем
разделитель в конец строки (если необходимо)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Right(Txt1, 1) &lt;&gt; Separator Then Txt1
= Txt1 &amp; Separator<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'>   </span></span>Начальные<span style='mso-ansi-language:
EN-US'> </span>значения<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ElementCount = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>TempElement = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'>   </span></span>Извлекаем<span style='mso-ansi-language:
EN-US'> </span>элемент<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>For i = 1 To Len(Txt1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>If Mid(Txt1, i, 1) = Separator Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>ElementCount = ElementCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If ElementCount = n Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'>               </span>Found it, so exit<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>ExtractElement = TempElement<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>TempElement = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>TempElement = TempElement &amp;
Mid(Txt1, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>     </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ExtractElement = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal>Закройте<span style='mso-ansi-language:EN-US'> </span>редактор<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>вернитесь<span style='mso-ansi-language:EN-US'> </span>в<span
lang=EN-US style='mso-ansi-language:EN-US'> Excel </span>командой<span
lang=EN-US style='mso-ansi-language:EN-US'> File - Close and return to
Microsoft Excel. <o:p></o:p></span></p>

<p class=MsoNormal>Теперь в любой ячейке листа Вы можете использовать эту
функцию через меню Вставка - Функция - категория Определенные пользователем,
где в аргументах:</p>

<p class=MsoNormal>•<span style='mso-tab-count:1'>          </span>Txt - ячейка
с текстом, который надо разделить, </p>

<p class=MsoNormal>•<span style='mso-tab-count:1'>          </span>n -
порядковый номер извлекаемого элемента, </p>

<p class=MsoNormal>•<span style='mso-tab-count:1'>          </span>Separator -
символ-разделитель.</p>

<h2><a name="_Toc315863643">Объединение данных диапазона</a></h2>

<p class=MsoNormal>Function Couple(Diapazon)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Объединение
данных, содержащихся в ячейках диапазона _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>Diapazon
(разделитель между значениями - пробел)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' iCell - </span>текущая<span style='mso-ansi-language:
EN-US'> </span>ячейка<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each iCell In Diapazon<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Сцепляются данные только
заполненных ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If
IsEmpty(iCell) &lt;&gt; True Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
значения ячейки в выходную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Couple = &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Couple = iCell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Couple = Couple &amp; &quot; &quot;
&amp; iCell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863644">Объединение данных диапазона_2</a></h2>

<p class=MsoNormal>Function CoupleFormat(Diapazon)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Объединение
текстовых данных, содержащихся в ячейках _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>диапазона Diapazon
(разделитель между значениями - пробел)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' iCell - </span>текущая<span style='mso-ansi-language:
EN-US'> </span>ячейка<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each iCell In Diapazon<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Сцепляются данные только
заполненных ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If
IsEmpty(iCell) &lt;&gt; True Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
текста ячейки в выходную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If CoupleFormat = &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>CoupleFormat = iCell.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>CoupleFormat = CoupleFormat &amp;
&quot; &quot; &amp; iCell.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863645">Узнать максимальную колонку или строку.</a> </h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>With ActiveSheet <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Dim cur_range As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Set cur_range = .UsedRange<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Debug.Print cur_range.Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>End With</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863646">Ограничение возможных значений диапазона</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Change(ByVal Target As Excel.Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgInputRange As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim varResult As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Диапазон, в котором контролируется
ввод</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgInputRange = Range(&quot;A1:E10&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просмотр всех измененных ячеек и
контроль ввода в тех, которые _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>принадлежат<span
style='mso-ansi-language:EN-US'> </span>заданному<span style='mso-ansi-language:
EN-US'> </span>диапазону<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In Target<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Проверка<span style='mso-ansi-language:
EN-US'> </span>принадлежности<span style='mso-ansi-language:EN-US'> </span>диапазону<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Union(cell, rgInputRange).Address =
rgInputRange.Address Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Контроль правильности ввода</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>varResult =
IsCellDataValid(cell)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If varResult = True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Введено<span
style='mso-ansi-language:EN-US'> </span>корректное<span style='mso-ansi-language:
EN-US'> </span>значение<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>'
Формирование и вывод сообщения об ошибке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strMessage = &quot;</span>Ячейка<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot; &amp; cell.Address(False,
False) &amp; &quot;:&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>&amp; vbCrLf &amp; vbCrLf &amp;
varResult<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>MsgBox strMessage, vbCritical, &quot;</span>Неправильное<span
style='mso-ansi-language:EN-US'> </span>значение<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Очистка<span
style='mso-ansi-language:EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Application.EnableEvents = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.ClearContents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Application.EnableEvents = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
IsCellDataValid(cell As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возвращает True, если в ячейку
вводится целое число _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в диапазоне от 1
до 12. В противном случае выдается _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>соответствующее
сообщение</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка,
является ли содержимое ячейки числом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>If Not WorksheetFunction.IsNumber(cell.Value) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>IsCellDataValid = &quot;</span>Нечисловое<span
style='mso-ansi-language:EN-US'> </span>значение<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка, является ли введенное
число целым</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Int(cell.Value) &lt;&gt; cell.Value Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>IsCellDataValid = &quot;</span>Введите<span
style='mso-ansi-language:EN-US'> </span>целое<span style='mso-ansi-language:
EN-US'> </span>число<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка
соответствия числа диапазону</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If cell.Value &lt; 1 Or cell.Value &gt; 12 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>IsCellDataValid = &quot;Значение
должно быть от 1 до 12&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Function</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' В ячейку введено
допустимое значение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>IsCellDataValid =
True</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863647">Тестирование скорости чтения и записи диапазонов</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
TableSpeedTest()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim alngData() As ****<span
style='mso-spacerun:yes'>        </span>' </span>Массив<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>числами<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngCount As ****<span
style='mso-spacerun:yes'>          </span>' Количество элементов в массиве</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim dtStart As
Date<span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>     </span>' Хранит время (и даже дату) начала _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                  </span>тестирования</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strArrayToTable
As String ' Время записи в таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strTableToArray
As String ' Время чтения из таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Подготовка<span style='mso-ansi-language:
EN-US'> </span>диапазона<span style='mso-ansi-language:EN-US'> </span>ячеек<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;A:A&quot;).ClearContents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Ввод размера массива, формирование
массива заданного размера</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lngCount =
InputBox(&quot;Введите количество элементов&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ReDim alngData(1 To
lngCount)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение
массива данными</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To lngCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>alngData(i) = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Перенос массива в
таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dtStart = Timer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To lngCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(i, 1) = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strArrayToTable = Format(Timer - dtStart,
&quot;00:00&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Чтение данных из таблицы обратно в
массив</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dtStart = Timer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To lngCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>alngData(i) = Cells(i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strTableToArray = Format(Timer - dtStart,
&quot;00:00&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод на экран результатов тестирования</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strMessage = &quot;</span>Запись<span
lang=EN-US style='mso-ansi-language:EN-US'>: &quot; &amp; strArrayToTable &amp;
vbCrLf &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&quot;</span>Чтение<span lang=EN-US
style='mso-ansi-language:EN-US'>: &quot; &amp; strTableToArray<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox strMessage, , lngCount &amp; &quot; </span>элементов<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863648">Открыть</a><span style='mso-bookmark:_Toc315863648'><span
lang=EN-US style='mso-ansi-language:EN-US'> MsgBox </span>при</span><span
style='mso-bookmark:_Toc315863648'><span style='mso-ansi-language:EN-US'> </span>выборе</span><span
style='mso-bookmark:_Toc315863648'><span style='mso-ansi-language:EN-US'> </span>ячейки</span><span
style='mso-bookmark:_Toc315863648'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Private Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Target.Address
= &quot;$A$1&quot; Then MsgBox &quot;Hello world&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863649">Скрытие</a><span style='mso-bookmark:_Toc315863649'><span
style='mso-ansi-language:EN-US'> </span>строки</span><span style='mso-bookmark:
_Toc315863649'></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideString()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Rows(2).Hidden = True</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863650">Скрытие нескольких строк</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideStrings()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Rows(&quot;3:5&quot;).Hidden = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863651">Скрытие</a><span style='mso-bookmark:_Toc315863651'><span
style='mso-ansi-language:EN-US'> </span>столбца</span><span style='mso-bookmark:
_Toc315863651'></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideCollumn()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Columns(2).Hidden = True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863652">Скрытие нескольких столбцов</a></h2>

<p class=MsoNormal>Sub HideCollumns()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Columns(&quot;E:F&quot;).Hidden = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863653">Скрытие строки по имени ячейки</a></h2>

<p class=MsoNormal>Sub HideCell()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(&quot;</span>Секрет<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).EntireRow.Hidden = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863654">Скрытие нескольких строк по адресам ячеек</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideCell()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;B3:D4&quot;).EntireRow.Hidden =
True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863655">Скрытие столбца по имени ячейки</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideCell()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;</span>Секрет<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).EntireColumn.Hidden = True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863656">Скрытие нескольких столбцов по адресам ячеек</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
HideCell()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;C2:D5&quot;).EntireColumn.Hidden
= True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863657">Мигание</a><span style='mso-bookmark:_Toc315863657'><span
style='mso-ansi-language:EN-US'> </span>ячейки</span><span style='mso-bookmark:
_Toc315863657'></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
BlinkingCell()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Static intCalls As Integer<span
style='mso-spacerun:yes'>  </span>' </span>Счетчик<span style='mso-ansi-language:
EN-US'> </span>количества<span style='mso-ansi-language:EN-US'> </span>миганий<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Если ячейка мигала менее 10 раз, то
изменим _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в очередной раз ее
цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If intCalls &lt; 10
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intCalls =
intCalls + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Определение, какой
цвет необходимо установить</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If
Range(&quot;A1&quot;).Interior.Color &lt;&gt; RGB(255, 0, 0) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Цвет ячейки не красный, так
что теперь назначим _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>именно<span
style='mso-ansi-language:EN-US'> </span>красный<span style='mso-ansi-language:
EN-US'> </span>цвет<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Range(&quot;A1&quot;).Interior.Color =
RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Назначим
ячейке зеленый цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Range(&quot;A1&quot;).Interior.Color
= RGB(0, 255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Эту процедуру
необходимо вызвать через 5 секунд</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Application.OnTime Now +
TimeValue(&quot;00:00:05&quot;), &quot;BlinkingCell&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Хватит<span style='mso-ansi-language:
EN-US'> </span>мигать<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span>Range(&quot;A1&quot;).Interior.ColorIndex =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intCalls = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc315863658">ГЛАВА</a><span style='mso-bookmark:_Toc315863658'><span
lang=EN-US style='mso-ansi-language:EN-US'> 4. </span>РАБОТА С ПРИМЕЧАНИЯМИ</span></h1>

<h2><a name="_Toc315863659">Вывод на экран всех примечаний рабочего листа</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowComments()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim rgCells As Range</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение всех
ячеек с примечаниями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgCells =
Selection.SpecialCells(xlComments)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If rgCells Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Примечаний<span
style='mso-ansi-language:EN-US'> </span>нет<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проходим по всем
ячейкам диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For Each cell In
rgCells</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Вывод
примечаний в соседнюю ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>cell.Next.Value = cell.Comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863660">Функция извлечения комментария</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
GetCommentText(rCommentCell As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
strGotIt As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>strGotIt =
WorksheetFunction.Clean _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>(rCommentCell.Comment.Text)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>GetCommentText
= strGotIt<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal>вставить в модуль эксель</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863661">Список примечаний защищенных листов</a></h2>

<p class=MsoNormal>Sub ShowComments1()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFirstAddress As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strComments As String</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получаем все
ячейки выделения, в которых есть комментарий</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cell = Selection.Find(&quot;*&quot;,
LookIn:=xlComments)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Not cell Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Сохранение адреса первой
найденной ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>(для
предотвращения зацикливания поиска)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strFirstAddress
= cell.Address</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Do</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
текста примечания в выходную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strComments = strComments &amp;
&quot;</span>Комментарий<span lang=EN-US style='mso-ansi-language:EN-US'>:
&quot; &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>cell.Comment.Text &amp; Chr(13)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Продолжение<span
style='mso-ansi-language:EN-US'> </span>поиска<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set cell = Selection.FindNext(cell)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Loop While Not cell Is Nothing And _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>cell.Address &lt;&gt; strFirstAddress<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strComments &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Отображение окна с текстом
примечаний</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
strComments</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox &quot;В
выделенной ячейке/ячейках комментариев нет&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863662">Перечень примечаний в отдельном списке_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ListOfComments()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgCells As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение всех ячеек с примечаниями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgCells =
Selection.SpecialCells(xlComments)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If rgCells Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Примечаний<span
style='mso-ansi-language:EN-US'> </span>нет<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проходим по всем
ячейкам диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In rgCells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Вывод<span style='mso-ansi-language:
EN-US'> </span>примечаний<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>ячейку<span style='mso-ansi-language:
EN-US'> </span>столбца<span lang=EN-US style='mso-ansi-language:EN-US'>
&quot;C&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 3) = cell.Comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863663">Перечень примечаний в отдельном списке_2</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ListOfComments1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFirstAddress As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение всех ячеек выделения, в
которых есть примечания</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cell = Cells.Find(&quot;*&quot;,
LookIn:=xlComments)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Not cell Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Сохранение адреса первой
найденной ячейки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>(для
предотвращения зацикливания поиска)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strFirstAddress
= cell.Address</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Do</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Вывод
текста в столбец &quot;C&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Cells(intRow, 3) = cell.Comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Продолжение<span
style='mso-ansi-language:EN-US'> </span>поиска<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set cell = Cells.FindNext(cell)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Loop While Not cell Is Nothing And _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>cell.Address &lt;&gt; strFirstAddress<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863664">Перечень примечаний в отдельном списке_3</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub ListOfCommentsToFile()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim rgCells As Range<span
style='mso-spacerun:yes'>            </span>' </span>Ячейки<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>примечаниями<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intDefListCount As Integer<span
style='mso-spacerun:yes'>  </span>' Используется для временного _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>хранения количества листов в книге по умолчанию</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strSheet As String<span
style='mso-spacerun:yes'>          </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>анализируемого<span style='mso-ansi-language:EN-US'> </span>листа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strWorkBook As String<span
style='mso-spacerun:yes'>       </span>' Имя книги с анализируемым листом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение ячеек с примечаниями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>On Error Resume
Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgCells =
ActiveSheet.Cells.SpecialCells(xlComments)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Если примечаний
нет, то можно не продолжать</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If rgCells Is
Nothing Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Текущая рабочая книга не содержит примечаний.&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>vbInformation</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Сохранение имен
анализируемого листа и книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strSheet = ActiveSheet.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strWorkBook = ActiveWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Создание отдельной книги с одним
листом _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>для отображения
результатов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intDefListCount =
Application.SheetsInNewWorkbook</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.SheetsInNewWorkbook = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Workbooks.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.SheetsInNewWorkbook =
intDefListCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWorkbook.Windows(1).Caption =
&quot;Comments for &quot; &amp; strSheet &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>&quot; in &quot; &amp; strWorkBook</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание списка
примечаний</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells(1, 1) =
&quot;Адрес&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells(1, 2) =
&quot;Содержимое&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells(1, 3) =
&quot;Комментарий&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(Cells(1, 1), Cells(1, 3)).Font.Bold =
True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intRow = 2<span
style='mso-spacerun:yes'>  </span>' Данные начинаются со второй строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In rgCells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 1) =
cell.Address(rowabsolute:=False, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>columnabsolute:=False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 2) = &quot; &quot; &amp;
cell.Formula<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 3) = cell.comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863665">Подсчет количества примечаний_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CountOfComments()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCommentCount As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение и отображение количества
примечаний</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intCommentCount = ActiveSheet.Comments.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intCommentCount = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>MsgBox &quot;Текущая рабочая книга
не содержит примечаний.&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>vbInformation</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox &quot;В
текущей рабочей книге содержится &quot; &amp; intCommentCount _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&amp; &quot; </span>комментариев<span
lang=EN-US style='mso-ansi-language:EN-US'>.&quot;, vbInformation<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Подсчет количества примечаний_2</p>

<p class=MsoNormal>' Function IsCommentsPresent </p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>' Возвращает TRUE,
если на активном рабочем листе имеется хотя бы </p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>' одна ячейка с
комментарием, иначе возвращает FALSE </p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Public Function IsCommentsPresent() As Boolean
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>IsCommentsPresent = (
ActiveSheet.Comments.Count &lt;&gt; 0 ) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End Function<o:p></o:p></span></p>

<h2><a name="_Toc315863666">Подсчет</a><span style='mso-bookmark:_Toc315863666'><span
style='mso-ansi-language:EN-US'> </span>примечаний</span><span
style='mso-bookmark:_Toc315863666'><span lang=EN-US style='mso-ansi-language:
EN-US'>_3</span></span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CountOfComment()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCommentCount As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение и отображение количества
примечаний _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>на<span
style='mso-ansi-language:EN-US'> </span>текущем<span style='mso-ansi-language:
EN-US'> </span>листе<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intCommentCount = ActiveSheet.Comments.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intCommentCount = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Примечаний<span
style='mso-ansi-language:EN-US'> </span>нет<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Примечаний<span
lang=EN-US style='mso-ansi-language:EN-US'>: &quot; &amp; intCommentCount &amp;
&quot; </span>шт<span lang=EN-US style='mso-ansi-language:EN-US'>.&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863667">Выделение ячеек с примечаниями</a></h2>

<p class=MsoNormal>Sub SelectComments()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение всех
ячеек с примечаниями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Cells.SpecialCells(xlCellTypeComments).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863668">Отображение всех примечаний</a></h2>

<p class=MsoNormal>Sub ShowComments()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Отображение<span style='mso-ansi-language:
EN-US'> </span>всех<span style='mso-ansi-language:EN-US'> </span>примечаний<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Application.DisplayCommentIndicator =
xlCommentAndIndicator Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Application.DisplayCommentIndicator =
xlCommentIndicatorOnly<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Application.DisplayCommentIndicator =
xlCommentAndIndicator<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863669">Изменение цвета примечаний</a></h2>

<p class=MsoNormal>Sub ChangeCommentColor()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Автоматическое
изменение цвета комментариев</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim comment As comment<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each comment In ActiveSheet.Comments<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Задаем случайные цвета заливки и
шрифта комментариев</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>comment.Shape.Fill.ForeColor.SchemeColor
= Int((80) * Rnd + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     
</span>comment.Shape.TextFrame.Characters.Font.ColorIndex = Int((56 _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>) * Rnd + 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863670">Добавление примечаний</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim r As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim rwIndex
As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For rwIndex
= 1 To 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set r =
Worksheets(&quot;WombatBattingAverages&quot;).Cells(rwIndex, 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With r<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If .Value &gt;= 0.3 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>              </span>.AddComment &quot;All Star!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>  </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next
rwIndex<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863671">Добавление примечаний в диапазон по условию</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CreateComments()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Производим поиск по всем ячейкам
диапазона и добавляем примечания _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>ко всем ячейкам,
содержащим слово &quot;Выручка&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In Range(&quot;B1:B100&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Value Like &quot;*</span>Выручка<span
lang=EN-US style='mso-ansi-language:EN-US'>*&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.ClearComments<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cell.AddComment &quot;</span>Неучтенная<span
style='mso-ansi-language:EN-US'> </span>наличка<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863672">Перенос комментария в ячейку и обратно</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub Комментарий_в_ячейку_в_диапазоне()</p>

<p class=MsoNormal>'переносит комментарий в ячейку</p>

<p class=MsoNormal>Dim i As ****</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim c As
Range, cc As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
iCommment As Comments<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayCommentIndicator
= xlCommentIndicatorOnly<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.ScreenUpdating
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.Calculation
= xlCalculationManual<o:p></o:p></span></p>

<p class=MsoNormal>Set cc = Selection</p>

<p class=MsoNormal>'если выделили 1 ячейку, то выход</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
cc.Rows.Count = 1 And cc.Columns.Count = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Выделено слишком мало ячеек!&quot;, ,
&quot;Ошибка&quot;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set cc =
Selection.SpecialCells(xlCellTypeVisible)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each c
In cc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
c.Comment Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.Value =
c.Comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'c.ClearComments
'</span>если<span style='mso-ansi-language:EN-US'> </span>надо<span
style='mso-ansi-language:EN-US'> </span>удалить<span style='mso-ansi-language:
EN-US'> </span>комментарий<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>i = i + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.Calculation
= xlCalculationAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.ScreenUpdating
= True<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Перенесено &quot; &amp; i &amp; &quot;
комментариев!&quot;</p>

<p class=MsoNormal>Exit Sub</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863673">Перенос значений из ячейки в комментарий_1</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub Добавить_комментарий_в_диапазоне()</p>

<p class=MsoNormal>'копирует значение ячейки в комментарий в видемом диапазоне</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim c As
Range, cc As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim i As
****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
GoTo ErrorHandler<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayCommentIndicator
= xlCommentIndicatorOnly<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set cc =
Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'</span>если<span
style='mso-ansi-language:EN-US'> </span>выделили<span lang=EN-US
style='mso-ansi-language:EN-US'> 1 </span>ячейку<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>то<span style='mso-ansi-language:EN-US'>
</span>выход<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
cc.Rows.Count = 1 And cc.Columns.Count = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Выделено слишком мало ячеек!&quot;, ,
&quot;Ошибка&quot;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set cc =
Selection.SpecialCells(xlCellTypeVisible)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each c
In cc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If c.Value
&lt;&gt; Empty Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>c.AddComment
CStr(c.Value)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>i = i + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Добавлено<span lang=EN-US style='mso-ansi-language:EN-US'> &quot;
&amp; i &amp; &quot; </span>комментарий<span lang=EN-US style='mso-ansi-language:
EN-US'>!&quot;<o:p></o:p></span></p>

<p class=MsoNormal>Exit Sub</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863674">Перенос значений из ячейки в комментарий_2</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Comment_in_Cell()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim c As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim r As
Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
ActiveSheet.Comments.Count = 0 Then MsgBox &quot;</span>Без<span
style='mso-ansi-language:EN-US'> </span>комментариев<span lang=EN-US
style='mso-ansi-language:EN-US'>!&quot;: Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set sh =
ActiveSheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set shnew =
Sheets.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>sh.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Set r =
Range(Cells(1, 1), Cells(Cells.Find(&quot;*&quot;, [A1], xlComments, ,
xlByRows, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>xlPrevious).Row,
Cells.Find(&quot;*&quot;, [A1], xlComments, , xlColumns, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>xlPrevious).Column))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>For Each c
In r<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Not
c.Comment Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>shnew.Range(c.Address)
= c.Comment.Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc315863675">ГЛАВА 5</a><span style='mso-bookmark:_Toc315863675'><span
lang=EN-US style='mso-ansi-language:EN-US'> . </span>ПОЛЬЗОВАТЕЛЬСКИЕ ВКЛАДКИ
НА ЛЕНТЕ</span></h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863676">Дополнение панели инструментов</a></h2>

<p class=MsoNormal>Sub AddCustomCommandBar()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление кнопки
на панель инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Application.CommandBars(3).Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 42<span
style='mso-spacerun:yes'>            </span>' </span>Значок<span lang=EN-US
style='mso-ansi-language:EN-US'> Word<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Кнопка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863677">Добавление кнопки на панель инструментов</a></h2>

<p class=MsoNormal>Sub AddCustomButton()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление кнопки
на панель инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
Application.Toolbars(1).ToolbarButtons.Add(button:=222)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Name = &quot;</span>Кнопка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863678">Панель с одной кнопкой</a></h2>

<p class=MsoNormal>Sub CreateCustomControlBar()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание панели
инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Application.CommandBars.Add(Name:=&quot;</span>Панель<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>и<span style='mso-ansi-language:EN-US'> </span>настройка<span
style='mso-ansi-language:EN-US'> </span>кнопки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With
.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Style = msoButtonIconAndCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 66<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;</span>Просто<span
style='mso-ansi-language:EN-US'> </span>кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Покажем<span style='mso-ansi-language:
EN-US'> </span>панель<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863679">Панель</a><span style='mso-bookmark:_Toc315863679'><span
style='mso-ansi-language:EN-US'> </span>с</span><span style='mso-bookmark:_Toc315863679'><span
style='mso-ansi-language:EN-US'> </span>двумя</span><span style='mso-bookmark:
_Toc315863679'><span style='mso-ansi-language:EN-US'> </span>кнопками</span><span
style='mso-bookmark:_Toc315863679'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>Sub CreateCustomControlBar()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание панели
инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Application.CommandBars.Add(Name:=&quot;</span>Панель<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, Temporary:=True, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Position:=msoBarLeft)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создание и
настройка первой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With
.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Style = msoButtonWrapCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;</span>Просто<span
style='mso-ansi-language:EN-US'> </span>кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создание и
настройка второй кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With .Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Style = msoButtonIconAndWrapCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;</span>Кнопка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 225<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Покажем<span style='mso-ansi-language:
EN-US'> </span>панель<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863680">Создание панели справа</a></h2>

<p class=MsoNormal>Sub CreateCustomControlBar()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание панели
инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Application.CommandBars.Add(Name:=&quot;</span>Правая<span
style='mso-ansi-language:EN-US'> </span>панель<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Temporary:=True)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создание и
настройка кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With
.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Style = msoButtonWrapCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;</span>Кнопка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Задание позиции - справа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Position =
msoBarRight</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Покажем<span
style='mso-ansi-language:EN-US'> </span>панель<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863681">Вызов предварительного просмотра</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Sheets(&quot;Test&quot;).PrintPreview<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863682">Создание пользовательского меню (вариант 1)</a></h2>

<p class=MsoNormal>Sub AddCustomMenu()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Добавление<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With
Application.CommandBars(1).Controls.Add(Type:=msoControlPopup, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Архив<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Добавление и настройка
первого пункта</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With .Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.FaceId = 280<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Caption = &quot;</span>Просмотр<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.OnAction = &quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Добавление<span
style='mso-ansi-language:EN-US'> </span>вложенного<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>With .Add(Type:=msoControlPopup)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>.Caption = &quot;База
данных&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>With
.Controls</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Добавление и настройка первого пункта _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>вложенного<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>With
.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>.FaceId = 1643<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>.Caption = &quot;</span>Поставщики<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>.OnAction = &quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Добавление и настройка второго пункта _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>вложенного<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>With
.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>              </span>.FaceId = 1000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>.Caption = &quot;</span>Покупатели<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>.OnAction = &quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>3&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863683">Создание пользовательского меню (вариант 2)</a></h2>

<p class=MsoNormal>Sub AddCustomMenu1()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление меню с
названием &quot;Архив&quot; в часть меню, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>относящуюся к
рабочей книге</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
MenuBars(&quot;Worksheet&quot;).Menus.Add(Caption:=&quot;Архив&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление
кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.MenuItems.Add
Caption:=&quot;Просмотр&quot;, OnAction:=&quot;Макрос1&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>   </span>' Добавление подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With
.MenuItems.AddMenu(Caption:=&quot;База данных&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
пунктов подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>.MenuItems.Add Caption:=&quot;Поставщики&quot;,
OnAction:=&quot;Макрос2&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.MenuItems.Add Caption:=&quot;</span>Покупатели<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, OnAction:=&quot;</span>Макрос<span
lang=EN-US style='mso-ansi-language:EN-US'>3&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863684">Создание пользовательского меню (вариант 3)</a></h2>

<p class=MsoNormal>Sub AddCustomMenu2()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление меню с
названием &quot;Архив&quot; в часть меню, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>относящуюся к
рабочей книге</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
MenuBars(&quot;Worksheet&quot;).Menus.Add(Caption:=&quot;Архив&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление
кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.MenuItems.Add
Caption:=&quot;Просмотр&quot;, OnAction:=&quot;Макрос1&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление
подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With
.MenuItems.AddMenu(Caption:=&quot;База данных&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
первого пункта подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>With
.MenuItems.Add(Caption:=&quot;Поставщики&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>       </span>' Настройка кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.OnAction
= &quot;Макрос2&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
второго пункта подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With .MenuItems.Add(Caption:=&quot;</span>Покупатели<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Настройка кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.OnAction
= &quot;Макрос3&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863685">Создание пользовательского меню (вариант 4)</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub Workbook_Open()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Задание имени
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strMenuName = &quot;MyCommandBarName&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CreateCustomMenu<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863686">Создание пользовательского меню (вариант 5)</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Workbook_BeforeClose(Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление меню перед закрытием книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>DeleteCustomMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public
strMenuName As String<span style='mso-spacerun:yes'>  </span>' </span>Имя<span
style='mso-ansi-language:EN-US'> </span>строки<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Private
cbrcBar As CommandBarControl<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CreateCustomMenu()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrMenu As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrcMenu As CommandBarControl<span
style='mso-spacerun:yes'>     </span>' </span>Выпадающее<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'> &quot;</span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrcSubMenu As CommandBarControl<span
style='mso-spacerun:yes'>  </span>' </span>Выпадающее<span style='mso-ansi-language:
EN-US'> </span>меню<span style='mso-ansi-language:EN-US'> </span>&quot;Дополнительно&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Если уже есть
пользовательское меню, то оно удаляется</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>DeleteCustomMenu</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание меню
вместо стандартного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span><span lang=EN-US style='mso-ansi-language:
EN-US'>Set cbrMenu = Application.CommandBars.Add(strMenuName, msoBarTop, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>True, True)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание
выпадающего меню с названием &quot;Меню&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrcMenu =
cbrMenu.Controls.Add(msoControlPopup, , , , True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With cbrcMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;&amp;</span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>пункта<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With
cbrcMenu.Controls.Add(Type:=msoControlButton, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;&amp;</span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;CallMenu1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание пункта
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
cbrcMenu.Controls.Add(Type:=msoControlButton, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;CallMenu2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание подменю
первого уровня</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrcSubMenu =
cbrcMenu.Controls.Add(Type:=msoControlPopup, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With cbrcSubMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Подменю<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.BeginGroup = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>пункта<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With
cbrcMenu.Controls.Add(Type:=msoControlButton, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Вкл<span
lang=EN-US style='mso-ansi-language:EN-US'>/</span>Выкл<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;MenuOnOff&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Style = msoButtonIconAndCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 463<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание пункта
меню в подменю первого уровня</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
cbrcSubMenu.Controls.Add(Type:=msoControlButton, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Подменю<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;CallSubMenu1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Style = msoButtonIconAndCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 2950<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.State = msoButtonDown<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Cоздание пункта меню в подменю
первого уровня (его состояние _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>изменяется
посредством пункта &quot;Вкл/Выкл&quot;), для чего сохраним ссылку _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>на созданный пункт
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set cbrcBar =
cbrcSubMenu.Controls.Add(Type:=msoControlButton, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With cbrcBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>Подменю<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.OnAction =
&quot;CallSubMenu2&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Сначала меню
деактивировано</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Enabled = False</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание подменю
второго уровня</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrcSubMenu =
cbrcSubMenu.Controls.Add(Type:=msoControlPopup, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With cbrcSubMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>ПодчПодменю<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.BeginGroup = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Cоздание пункта
меню в подменю второго уровня</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With cbrcSubMenu.Controls.Add(Type:=msoControlButton,
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>ПослМеню<span
lang=EN-US style='mso-ansi-language:EN-US'>1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;CallLastMenu1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Style = msoButtonIconAndCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 71<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.State = msoButtonDown<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Cоздание пункта меню в подменю
второго уровня</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
cbrcSubMenu.Controls.Add(Type:=msoControlButton, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;</span>ПослМеню<span
lang=EN-US style='mso-ansi-language:EN-US'>2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;CallLastMenu2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Style = msoButtonIconAndCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 72<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Enabled = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отображение<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cbrMenu.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set cbrcSubMenu = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set cbrcMenu = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set cbrMenu = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteCustomMenu()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>строки<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.CommandBars(strMenuName).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CallMenu1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>вызова<span style='mso-ansi-language:EN-US'> </span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Приветствует<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'> 1!&quot;, vbInformation, ThisWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CallMenu2()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>вызова<span style='mso-ansi-language:EN-US'> </span>Меню<span
lang=EN-US style='mso-ansi-language:EN-US'>2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Приветствует<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'> 2!&quot;, vbInformation, ThisWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub CallSubMenu1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>вызова<span style='mso-ansi-language:EN-US'> </span>Подменю<span
lang=EN-US style='mso-ansi-language:EN-US'>1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Приветствует<span
style='mso-ansi-language:EN-US'> </span>подменю<span lang=EN-US
style='mso-ansi-language:EN-US'> 1!&quot;, vbInformation, ThisWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CallSubMenu2()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обработка<span style='mso-ansi-language:
EN-US'> </span>вызова<span style='mso-ansi-language:EN-US'> </span>Подменю<span
lang=EN-US style='mso-ansi-language:EN-US'>2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Приветствует<span
style='mso-ansi-language:EN-US'> </span>подменю<span lang=EN-US
style='mso-ansi-language:EN-US'> 2!&quot;, vbInformation, ThisWorkbook.Name<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub CallLastMenu1()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обработка вызова
Последнего меню1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Приветствует последнее меню 1!&quot;, vbInformation, ThisWorkbook.Name</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub CallLastMenu2()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Обработка вызова
Последнего меню2</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Приветствует последнее меню 2!&quot;, vbInformation, ThisWorkbook.Name</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub MenuOnOff()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Активация или
деактивация пункта &quot;Меню-Подменю1-Подменю2&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cbrcBar.Enabled = Not cbrcBar.Enabled<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Создание пользовательского меню (вариант 6)</p>

<p class=MsoNormal>Sub CreateMenu()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cbrMenu As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrcNewMenu As CommandBarControl<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление меню, если оно уже есть</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Call DeleteMenu</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление строки
пользовательского меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrMenu = CommandBars.Add(MenuBar:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With cbrMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Name = &quot;</span>Моя<span
style='mso-ansi-language:EN-US'> </span>строка<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.Visible = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Копирование
стандартного меню <span lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Файл<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(&quot;Worksheet Menu
Bar&quot;).FindControl(ID:=30002).Copy _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>CommandBars(&quot;Моя строка
меню&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление нового
меню - &quot;Дополнительно&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrcNewMenu =
cbrMenu.Controls.Add(msoControlPopup)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>cbrcNewMenu.Caption =
&quot;&amp;Дополнительно&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление
команды в новое меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With cbrcNewMenu.Controls.Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.Caption = &quot;&amp;Восстановить
обычную строку меню&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.OnAction =
&quot;DeleteMenu&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление
команды в новое меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
cbrcNewMenu.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Caption = &quot;&amp;</span>Справка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub DeleteMenu()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Пытаемся удалить
меню (успешно, если оно ранее создано)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(&quot;</span>Моя<span
style='mso-ansi-language:EN-US'> </span>строка<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Список панелей инструментов и контекстных меню</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ListOfMenues()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<span
style='mso-spacerun:yes'>    </span>' </span>Хранит<span style='mso-ansi-language:
EN-US'> </span>текущую<span style='mso-ansi-language:EN-US'> </span>строку<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrBar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Очистка<span style='mso-ansi-language:
EN-US'> </span>всех<span style='mso-ansi-language:EN-US'> </span>ячеек<span
style='mso-ansi-language:EN-US'> </span>текущего<span style='mso-ansi-language:
EN-US'> </span>листа<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Cells.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1<span
style='mso-spacerun:yes'>  </span>' Начинаем запись с первой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просматриваем
список панелей инструментов и меню _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>и записываем
информацию о каждом элементе в таблицу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cbrBar In CommandBars<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Порядковый<span
style='mso-ansi-language:EN-US'> </span>номер<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 1) = cbrBar.Index<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Название<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 2) = cbrBar.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Тип<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Select Case cbrBar.Type<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case msoBarTypeNormal<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Панель<span
style='mso-ansi-language:EN-US'> </span>инструментов<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case msoBarTypeMenuBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Строка<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case msoBarTypePopup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Контекстное<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Встроенный элемент или созданный
пользователем</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Cells(intRow, 4)
= cbrBar.BuiltIn</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Переходим на
следующую строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intRow = intRow
+ 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863687">Создание списка пунктов главного меню Excel</a></h2>

<p class=MsoNormal>Листинг 3.90. Список содержимого главного меню</p>

<p class=MsoNormal>Sub ListOfMenues()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intRow As
Integer<span style='mso-spacerun:yes'>    </span>' Текущая строка, куда идет
запись</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cbrcMenu As CommandBarControl<span
style='mso-spacerun:yes'>        </span>' </span>Главное<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrcSubMenu As CommandBarControl<span
style='mso-spacerun:yes'>     </span>' </span>Подменю<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrcSubSubMenu As CommandBarControl<span
style='mso-spacerun:yes'>  </span>' </span>Подменю<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>подменю<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Очищаем ячейки текущего листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Начинаем запись с
первой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просматриваем все
элементы строки меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<span
style='mso-spacerun:yes'>    </span>' </span>Игнорируем<span style='mso-ansi-language:
EN-US'> </span>ошибки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cbrcMenu In CommandBars(1).Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Просматриваем элементы
выпадающего меню cbrcMenu</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For Each cbrcSubMenu In
cbrcMenu.Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Просматриваем<span
style='mso-ansi-language:EN-US'> </span>элементы<span style='mso-ansi-language:
EN-US'> </span>подменю<span lang=EN-US style='mso-ansi-language:EN-US'>
cbrcSubMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>For Each cbrcSubSubMenu In
cbrcSubMenu.Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Выводим название главного
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>Cells(intRow, 1) = cbrcMenu.Caption</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Выводим
название подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>Cells(intRow, 2) = cbrcSubMenu.Caption</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Выводим
название вложенного подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>Cells(intRow, 3) = cbrcSubSubMenu.Caption</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Переходим на следующую строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>intRow =
intRow + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Next cbrcSubSubMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next cbrcSubMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cbrcMenu<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863688">Создание списка пунктов контекстных меню</a></h2>

<p class=MsoNormal>Листинг 3.91. Список содержимого контекстных меню</p>

<p class=MsoNormal>Sub ListOfContextMenues()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intControl As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrBar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Очистка<span style='mso-ansi-language:
EN-US'> </span>ячеек<span style='mso-ansi-language:EN-US'> </span>активного<span
style='mso-ansi-language:EN-US'> </span>листа<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Cells.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Начинаем вывод с
первой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр списка
контекстных меню и вывод информации о них</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cbrBar In CommandBars<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cbrBar.Type = msoBarTypePopup Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Порядковый<span
style='mso-ansi-language:EN-US'> </span>номер<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Cells(intRow, 1) = cbrBar.Index<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Название<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Cells(intRow, 2) = cbrBar.Name</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Просмотр
всех элементов контекстного меню и вывод _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>названий
этих элементов в ячейки текущей строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For intControl = 1 To
cbrBar.Controls.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, intControl + 2) = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>cbrBar.Controls(intControl).Caption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Next intControl</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Переход на
следующую строку таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cbrBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Делаем ширину ячеек таблицы
оптимальной для просмотра</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Cells.EntireColumn.AutoFit</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863689">Отображение панели инструментов при определенном
условии</a></h2>

<p class=MsoNormal>Листинг 3.92. Код в модуле рабочего листа</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Excel.Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Проверка<span style='mso-ansi-language:
EN-US'> </span>условия<span style='mso-ansi-language:EN-US'> </span>отображения<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Union(Target,
Range(&quot;A1:D5&quot;)).Address = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Range(&quot;A1:D5&quot;).Address
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Условие
выполнено - можно показывать панель</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>CommandBars(&quot;AutoSense&quot;).Visible = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Условие не
выполнено - панель нужно скрыть</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>CommandBars(&quot;AutoSense&quot;).Visible
= False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Листинг 3.93. Код в стандартном модуле</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CreatePanel()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrBar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim button As CommandBarButton<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление одноименной панели (при ее
наличии)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(&quot;AutoSense&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>' Создание панели инструментов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set cbrBar =
CommandBars.Add</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание кнопок и
их настройка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To 4<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Set button =
cbrBar.Controls.Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With button<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction = &quot;Butt</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>nclick&quot; &amp; i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = i + 37<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cbrBar.Name = &quot;AutoSense&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Butt</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>nclick3()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Перемещение<span style='mso-ansi-language:
EN-US'> </span>вниз<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell.Offset(1, 0).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Butt</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>nclick1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Перемещение<span style='mso-ansi-language:
EN-US'> </span>вверх<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell.Offset(-1, 0).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Butt</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>nclick2()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Перемещение<span style='mso-ansi-language:
EN-US'> </span>вправо<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell.Offset(0, 1).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Butt</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>nclick4()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Перемещение<span style='mso-ansi-language:
EN-US'> </span>влево<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ActiveCell.Offset(0, -1).Activate</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863690">Скрытие и отображение панелей инструментов</a></h2>

<p class=MsoNormal>Листинг 3.94. Управление отображением панелей инструментов</p>

<p class=MsoNormal>Sub HidePanels()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cbrBar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущей<span style='mso-ansi-language:EN-US'> </span>строки<span
style='mso-ansi-language:EN-US'> </span>листа<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отключение<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Подготовка к сохранению</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells.Clear</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Скрытие видимых
панелей и сохранение их названий</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1<span
style='mso-spacerun:yes'>       </span>' Запись имен с первой строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cbrBar In CommandBars<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cbrBar.Type = msoBarTypeNormal Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>    </span>If cbrBar.Visible Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>cbrBar.Visible = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 1) = cbrBar.Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Включение<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowPanels()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<span
style='mso-spacerun:yes'>       </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>ячейка<span style='mso-ansi-language:EN-US'> </span>листа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отключение<span style='mso-ansi-language:
EN-US'> </span>обновления<span style='mso-ansi-language:EN-US'> </span>экрана<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.ScreenUpdating = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отображение<span style='mso-ansi-language:
EN-US'> </span>скрытых<span style='mso-ansi-language:EN-US'> </span>панелей<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In
Range(&quot;A:A&quot;).SpecialCells( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>xlCellTypeConstants)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>CommandBars(cell.Value).Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next cell</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Включение
обновления экрана</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.ScreenUpdating = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863691">Создать</a><span style='mso-bookmark:_Toc315863691'><span
style='mso-ansi-language:EN-US'> </span>подсказку</span><span style='mso-bookmark:
_Toc315863691'><span style='mso-ansi-language:EN-US'> </span>к</span><span
style='mso-bookmark:_Toc315863691'><span style='mso-ansi-language:EN-US'> </span>моим</span><span
style='mso-bookmark:_Toc315863691'><span style='mso-ansi-language:EN-US'> </span>кнопкам</span><span
style='mso-bookmark:_Toc315863691'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' C</span>оздаем<span
style='mso-ansi-language:EN-US'> </span>тулбар<span lang=EN-US
style='mso-ansi-language:EN-US'> <o:p></o:p></span></p>

<p class=MsoNormal>Р<span lang=EN-US style='mso-ansi-language:EN-US'>ublic Sub
InitToolBar() <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
cmdbarSM As CommandBar <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
ctlNewBtn As CommandBarButton <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Set cmdbarSM =
CommandBars.Add(Name:=&quot;MyToolBar&quot;, <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                
</span>Position:=msoBarFloating, _ <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                
</span>temporary:=True) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>With cmdbarSM <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' 1) </span>Добавляем<span
style='mso-ansi-language:EN-US'> </span>кнопку<span lang=EN-US
style='mso-ansi-language:EN-US'> <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set ctlNewBtn =
.Controls.Add(Type:=msoControlButton) <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With ctlNewBtn <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>. FaceId = 26 <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;OnButton1_Click&quot; <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>.TooltipText = &quot;My tooltip
message!&quot; <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>' 2) </span>Добавляем<span
style='mso-ansi-language:EN-US'> </span>ещё<span style='mso-ansi-language:EN-US'>
</span>кнопку<span lang=EN-US style='mso-ansi-language:EN-US'> <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Set ctlNewBtn = .Controls.Add(Type:=msoControlButton)
<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>With ctlNewBtn <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.FaceId = 44 <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.OnAction = &quot;OnButton2_Click&quot; <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span>.TooltipText = &quot;Another tooltip
message!&quot; <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>End With <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>.Visible = True <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>End With <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863692">Создание меню на основе данных рабочего листа</a></h2>

<p class=MsoNormal>Листинг 3.95. Код в модуле ЭтаКнига</p>

<p class=MsoNormal>Sub Workbook_Open()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Call CreateCustomMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Workbook_BeforeClose(Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление меню перед закрытием книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call DeleteCustomMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
3.96. </span>Код в стандартном модуле</p>

<p class=MsoNormal>Sub CreateMenu()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim sheet As
Worksheet<span style='mso-spacerun:yes'>          </span>' Лист с описанием
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intRow As
Integer<span style='mso-spacerun:yes'>           </span>' Считываемая строка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim cbrpBar As
CommandBarPopup<span style='mso-spacerun:yes'>  </span>' Выпадающее меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim objNewItem As Object<span
style='mso-spacerun:yes'>        </span>' </span>Элемент<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'> cbrpBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim objNewSubItem As Object<span
style='mso-spacerun:yes'>     </span>' </span>Элемент<span style='mso-ansi-language:
EN-US'> </span>подменю<span lang=EN-US style='mso-ansi-language:EN-US'>
objNewItem<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intMenuLevel As Integer<span
style='mso-spacerun:yes'>     </span>' </span>Уровень<span style='mso-ansi-language:
EN-US'> </span>вложенности<span style='mso-ansi-language:EN-US'> </span>пункта<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCaption As String<span
style='mso-spacerun:yes'>        </span>' </span>Название<span
style='mso-ansi-language:EN-US'> </span>пункта<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strAction As String<span
style='mso-spacerun:yes'>         </span>' </span>Макрос<span style='mso-ansi-language:
EN-US'> </span>пункта<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fIsDevider As Boolean<span
style='mso-spacerun:yes'>       </span>' </span>Нужен<span style='mso-ansi-language:
EN-US'> </span>разделитель<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intNextLevel As Integer<span
style='mso-spacerun:yes'>     </span>' Уровень вложенности следующего _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                    </span>пункта меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strFaceID As
String<span style='mso-spacerun:yes'>         </span>' Номер значка пункта меню</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Расположение
данных для меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Set sheet =
ThisWorkbook.Sheets(&quot;ЛистМеню&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление
одноименного меню (при его наличии)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Call DeleteMenu</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Данные считываем
со второй строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intRow = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Добавление<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do Until IsEmpty(sheet.Cells(intRow, 1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Считываем информацию о пункте
меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With sheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Уровень<span
style='mso-ansi-language:EN-US'> </span>вложенности<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intMenuLevel = .Cells(intRow, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Название<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCaption = .Cells(intRow, 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Название макроса для меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strAction =
.Cells(intRow, 3)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Нужен ли
разделитель перед меню?</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>fIsDevider =
.Cells(intRow, 4)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Номер
стандартного значка (если значок нужен)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strFaceID =
.Cells(intRow, 5)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Уровень
вложенности следующего меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intNextLevel
= .Cells(intRow + 1, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>    </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создаем меню в
зависимости от уровня его вложенности</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Select Case intMenuLevel<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Создаем<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Set cbrpBar =
Application.CommandBars(1). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            
</span>Controls.Add(Type:=msoControlPopup, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>           
</span>Before:=strAction, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>Temporary:=True)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>cbrpBar.Caption = strCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Создаем<span
style='mso-ansi-language:EN-US'> </span>элемент<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If intNextLevel = 3 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Следующий элемент
вложен в создаваемый, то есть _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>создаем раскрывающееся подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>Set
objNewItem = _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span><span
lang=EN-US style='mso-ansi-language:EN-US'>cbrpBar.Controls.Add(Type:=msoControlPopup)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>' </span>Создаем<span
style='mso-ansi-language:EN-US'> </span>команду<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Set objNewItem = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>cbrpBar.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>objNewItem.OnAction = strAction<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Установка<span
style='mso-ansi-language:EN-US'> </span>названия<span style='mso-ansi-language:
EN-US'> </span>нового<span style='mso-ansi-language:EN-US'> </span>пункта<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>objNewItem.Caption = strCaption<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Установка<span
style='mso-ansi-language:EN-US'> </span>значка<span style='mso-ansi-language:
EN-US'> </span>нового<span style='mso-ansi-language:EN-US'> </span>пункта<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'> (</span>если<span style='mso-ansi-language:EN-US'> </span>нужно<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If strFaceID &lt;&gt; &quot;&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>objNewItem.FaceId = strFaceID<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Если
нужно, то добавим разделитель</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If fIsDevider Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>objNewItem.BeginGroup = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>   </span>Case 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Создание
элемента подменю</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set objNewSubItem = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            
</span>objNewItem.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Установка его названия</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>objNewSubItem.Caption = strCaption</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Назначение макроса (или команды)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>objNewSubItem.OnAction = strAction</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Установка значка (если нужно)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If strFaceID &lt;&gt; &quot;&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>              </span>objNewSubItem.FaceId = strFaceID<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Если
нужно, то добавим разделитель</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If fIsDevider Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>objNewSubItem.BeginGroup = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Переход на
следующую строку таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteMenu()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim sheet As Worksheet<span
style='mso-spacerun:yes'>    </span>' </span>Лист<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>описанием<span
style='mso-ansi-language:EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<span
style='mso-spacerun:yes'>     </span>' </span>Считываемая<span
style='mso-ansi-language:EN-US'> </span>строка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCaption As String<span
style='mso-spacerun:yes'>  </span>' </span>Название<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set sheet = ThisWorkbook.Sheets(&quot;</span>ЛистМеню<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Данные начинаются со второй строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 2</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Считываем данные,
пока есть значения в столбце &quot;A&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>и удаляем
созданные ранее меню (с уровнем вложенности 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do Until IsEmpty(sheet.Cells(intRow, 1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If sheet.Cells(intRow, 1) = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCaption = sheet.Cells(intRow, 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Application.CommandBars(1).Controls(strCaption).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863693">Создание контекстного меню</a></h2>

<p class=MsoNormal>Листинг 3.97. Код<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>модуле<span style='mso-ansi-language:
EN-US'> </span>рабочего<span style='mso-ansi-language:EN-US'> </span>листа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_BeforeRightClick(ByVal Target As Excel.Range, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>Cancel As Boolean)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка,
попадает ли выделенная ячейка в диапазон</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Union(Target.Range(&quot;A1&quot;),
Range(&quot;A2:D5&quot;)).Address = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Range(&quot;A2:D5&quot;).Address
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Показываем
свое контекстное меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>CommandBars(&quot;MyContextMenu&quot;).ShowPopup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Листинг 3.98. Код в модуле ЭтаКнига</p>

<p class=MsoNormal>Sub Workbook_Open()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание
контекстного меню при открытии книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call CreateCustomContextMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Workbook_BeforeClose(Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление меню при закрытии книги</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call DeleteCustomContextMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Код<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>стандартном<span style='mso-ansi-language:
EN-US'> </span>модуле<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CreateCustomContextMenu()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>одноименного<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Call DeleteCustomContextMenu<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With
CommandBars.Add(&quot;MyContextMenu&quot;, msoBarPopup, , True).Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>    </span></span>'
Создание и настройка кнопок меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Кнопка
&quot;Числовой формат&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With
.Add(msoControlButton)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Caption = &quot;&amp;</span>Числовой<span
style='mso-ansi-language:EN-US'> </span>формат<span lang=EN-US
style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ShowFormatNumber&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 1554<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>Выравнивание<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Выравнивание<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ShowFormatAlignment&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 217<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>Шрифт<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Шрифт<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction = &quot;ShowFormatFont&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 291<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>Границы<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Границы<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ShowFormatBorder&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 149<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.BeginGroup = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>Узор<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Узор<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ShowFormatPatterns&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 1550<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>Защита<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Add(msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Защита<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ShowFormatProtection&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.FaceId = 2654<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863694">Блокировка</a><span style='mso-bookmark:_Toc315863694'><span
style='mso-ansi-language:EN-US'> </span>контекстного</span><span
style='mso-bookmark:_Toc315863694'><span style='mso-ansi-language:EN-US'> </span>меню</span><span
style='mso-bookmark:_Toc315863694'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Static intCount As Integer<span
style='mso-spacerun:yes'>     </span>' </span>Счетчик<span style='mso-ansi-language:
EN-US'> </span>нажатий<span style='mso-ansi-language:EN-US'> </span>кнопки<span
style='mso-ansi-language:EN-US'> </span>мыши<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim x As Integer, y As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Блокировать обработку щелчка правой
кнопкой мыши</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cancel = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Отображение
текстового поля с количеством щелчков правой _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>кнопкой<span
style='mso-ansi-language:EN-US'> </span>мыши<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>x = Target.Left<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>y = Target.Top<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intCount = intCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>x, y, 35, 20).TextFrame.Characters.Text =
intCount<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863695">Добавление команды в меню Сервис</a><span
style='mso-bookmark:_Toc315863695'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AddMenuItem()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrpMenu As CommandBarPopup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление аналогичной команды (при
ее наличии)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Call DeleteMenuItem</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение доступа
к меню <span lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Сервис<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set cbrpMenu =
CommandBars(1).FindControl(ID:=30007)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>If cbrpMenu Is Nothing Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Не удалось
получить доступ</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Невозможно добавить элемент.&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление
новой команды в меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With
cbrpMenu.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Название команды</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.Caption =
&quot;Очистить в&amp;се, кроме формул&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Значок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.FaceId = 348</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Сочетание
клавиш (только надпись на кнопке)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.ShortcutText
= &quot;Ctrl+Shift+C&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>'
Сопоставленный макрос</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.OnAction =
&quot;ExecuteCommand&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
разделителя перед командой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.BeginGroup = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Сопоставление с макросом сочетания
клавиш Ctrl+Shift+C</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.MacroOptions _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Macro:=&quot;ExecuteCommand&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>HasShortcutKey:=True, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>ShortcutKey:=&quot;C&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ExecuteCommand()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Очистка содержимого всех ячеек
(кроме формул)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells.SpecialCells(xlCellTypeConstants,
23).ClearContents<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub DeleteMenuItem()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление команды
из меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(1).FindControl(ID:=30007). </span>_</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>Controls(&quot;Очистить в&amp;се, кроме формул&quot;).Delete</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863696">Добавление команды в меню Вид</a></h2>

<p class=MsoNormal>Листинг 3.110. Код в стандартном модуле</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
AppObject As New Class1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AddCommand()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim cbrpBar As CommandBarPopup</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление
аналогичной команды (при ее наличии)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Call DeleteCommand</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение доступа
к меню <span lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Вид<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set cbrpBar =
CommandBars(1).FindControl(ID:=30004)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>If cbrpBar Is Nothing Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Не удалось
получить доступ к меню</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Невозможно добавить элемент меню.&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Добавление
команды</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With cbrpBar.Controls.Add(Type:=msoControlButton)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Caption = &quot;&amp;</span>Линии<span
style='mso-ansi-language:EN-US'> </span>сетки<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction =
&quot;GhangeGridlinesState&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Даем<span style='mso-ansi-language:
EN-US'> </span>объекту<span lang=EN-US style='mso-ansi-language:EN-US'>
AppObject </span>обрабатывать<span style='mso-ansi-language:EN-US'> </span>события<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set AppObject.AppEvents = Application<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub DeleteCommand()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление каманды
из меню (если она там есть)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>CommandBars(1).FindControl(ID:=30004). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Controls(&quot;&amp;</span>Линии<span
style='mso-ansi-language:EN-US'> </span>сетки<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub GhangeGridlinesState()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
состояния отображения линий сетки _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>на противоположное
(если нет - покажем, если есть - скроем)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If TypeName(ActiveSheet) =
&quot;Worksheet&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveWindow.DisplayGridlines = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Not ActiveWindow.DisplayGridlines<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Установка<span style='mso-ansi-language:
EN-US'> </span>или<span style='mso-ansi-language:EN-US'> </span>снятие<span
style='mso-ansi-language:EN-US'> </span>флажка<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>меню<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Call CheckGridlines<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CheckGridlines()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim button As CommandBarButton<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error Resume Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Поиск команды
&quot;Линии сетки&quot; в меню <span lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Вид<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set button =
CommandBars(1).FindControl(ID:=30004). </span>_</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>Controls(&quot;&amp;Линии сетки&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
состояния флажка на противоположное</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveWindow.DisplayGridlines Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Установка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>button.State = msoButtonDown<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Снятие<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>button.State = msoButtonUp<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863697">Создание панели со списком</a></h2>

<p class=MsoNormal>Sub DeleteCustomContextMenu()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>меню<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>CommandBars(&quot;MyContextMenu&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatNumber()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Число<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>Application.Dialogs(xlDialogFormatNumber).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatAlignment()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Выравнивание<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.Dialogs(xlDialogAlignment).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatFont()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Шрифт<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.Dialogs(xlDialogFormatFont).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatBorder()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Граница<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.Dialogs(xlDialogBorder).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatPatterns()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Вид<span lang=EN-US
style='mso-ansi-language:EN-US'> (</span>Узор<span lang=EN-US style='mso-ansi-language:
EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Application.Dialogs(xlDialogPatterns).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowFormatProtection()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Защита<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>Application.Dialogs(xlDialogCellProtection).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CreatePanel()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error Resume Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление
одноименной панели (если есть)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>CommandBars(&quot;</span>Список<span
style='mso-ansi-language:EN-US'> </span>месяцев<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Создание панели &quot;Список
месяцев&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With CommandBars.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Name = &quot;</span>Список<span
style='mso-ansi-language:EN-US'> </span>месяцев<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Создание<span style='mso-ansi-language:
EN-US'> </span>списка<span style='mso-ansi-language:EN-US'> </span>месяцев<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With
.Controls.Add(Type:=msoControlDropdown)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Настройка (имя, макрос, стиль)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Caption = &quot;DateDD&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.OnAction = &quot;SetMonth&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Style = msoButtonAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Добавление в список названий
месяцев</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For i = 1 To 12<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.AddItem Format(DateSerial(1, i,
1), &quot;mmmm&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Next i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Выделение
первого месяца</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.ListIndex =
1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Показываем
созданную панель</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub SetMonth()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Перенос названия
выделенного месяца в ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With CommandBars(&quot;</span>Список<span
style='mso-ansi-language:EN-US'> </span>месяцев<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;).Controls(&quot;DateDD&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ActiveCell.Value = .List(.ListIndex)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863698">Мультфильм с помощником в главной роли</a></h2>

<p class=MsoNormal>Листинг 4.1. «Танцующий» помощник</p>

<p class=MsoNormal>Sub RunAssistantDance()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Static intAction As
Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заставляем
помощника выполнять действие (всего 16)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>DoAssistantAction intAction<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intAction = intAction + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intAction &lt; 16 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Следующее<span style='mso-ansi-language:
EN-US'> </span>действие<span style='mso-ansi-language:EN-US'> </span>через<span
lang=EN-US style='mso-ansi-language:EN-US'> 3 </span>секунды<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Application.OnTime Time +
TimeValue(&quot;00:00:3&quot;), _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>&quot;RunAssistantDance&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DoAssistantAction(intAction As Integer)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim astAssistant As Assistant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set astAssistant = Application.Assistant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Помещаем помощника в центр
активного окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>astAssistant.Top = Application.ActiveWindow.Top
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>+ Application.ActiveWindow.Height / 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>astAssistant.Left =
Application.ActiveWindow.Left _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>+ Application.ActiveWindow.Width / 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Показываем<span style='mso-ansi-language:
EN-US'> </span>помощника<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>astAssistant.On = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>astAssistant.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Показываем заданное параметром
intAction действие</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Select Case intAction<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationAppear<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationCheckingSomething<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationBeginSpeaking<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationCharacterSuccessMajor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 4<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationEmptyTrash<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGestureDown<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGestureLeft<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 6<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGestureRight<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGestureUp<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 8<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGetArtsy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 9<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGetAttentionMajor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 10<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGetAttentionMinor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 11<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGetTechy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 12<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGetWizardy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 13<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGoodbye<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 14<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationGreeting<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 15<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>astAssistant.Animation =
msoAnimationDisappear<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863699">Дополнение помощника текстом, заголовком, кнопкой и
значком</a></h2>

<p class=MsoNormal>Листинг 4.2. Настройка помощника</p>

<p class=MsoNormal>Sub AssistantMessage()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strTitle As String<span
style='mso-spacerun:yes'>    </span>' </span>Заголовок<span style='mso-ansi-language:
EN-US'> </span>сообщения<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<span
style='mso-spacerun:yes'>  </span>' </span>Текст<span style='mso-ansi-language:
EN-US'> </span>сообщения<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Содержимое заголовка и текста в
окне помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strTitle = &quot;Спрашивайте
- ответим&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
&quot;{cf 249}{ul 1} Руки мыли{ul 0}?&quot; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&amp; vbCr &amp;
&quot;{cf 6} Не забыть обновить антивирус!&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Настраиваем
помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
Application.Assistant</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Включаем и
показываем помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.On = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Создаем<span style='mso-ansi-language:
EN-US'> </span>окно<span style='mso-ansi-language:EN-US'> </span>сообщения<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .NewBalloon<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.BalloonType = msoBalloonTypeButtons<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Кнопка<span lang=EN-US
style='mso-ansi-language:EN-US'> &quot;</span>ОК<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot; </span>в<span style='mso-ansi-language:
EN-US'> </span>окне<span style='mso-ansi-language:EN-US'> </span>помощника<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>.button = msoButtonSetOK</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Значок в
окне помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.Icon =
msoIconAlert</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'> </span>' Заголовок в окне помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.Heading =
strTitle</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Текст в
окне помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Text = strMessage<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Отображение<span
style='mso-ansi-language:EN-US'> </span>окна<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863700">Новые параметры помощника</a></h2>

<p class=MsoNormal>Листинг 4.3. Новые параметры помощника</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AssistantCheckboxes()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Assistant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Включение и отображение
помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.On = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Visible = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создание окна
сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With .NewBalloon</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Настройка
окна...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Тип окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.BalloonType
= msoBalloonTypeButtons</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Заголовок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.Heading =
&quot;Выберите страну&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Добавление
флажков</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>.CheckBoxes(1).Text = &quot;Россия&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.CheckBoxes(2).Text = &quot;</span>США<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.CheckBoxes(3).Text = &quot;</span>Южная<span
style='mso-ansi-language:EN-US'> </span>Африка<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.button = msoButtonSetOkCancel<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Отображение<span
style='mso-ansi-language:EN-US'> </span>окна<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If .Show = msoBalloonButtonOK Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Вывод информационного окна
в зависимости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>от
установленных флажков</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>For i = 1
To 3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .CheckBoxes(i).Checked Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>strMessage = strMessage &amp;
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>.CheckBoxes(i).Text &amp;
vbCr<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Отображение окна сообщения (имеется в виду _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'>    </span>стандартное<span style='mso-ansi-language:
EN-US'> </span>окно<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If Len(strMessage) = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>MsgBox &quot;No choice.&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>MsgBox strMessage<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863701">Использование помощника для выбора цвета заливки</a></h2>

<p class=MsoNormal>Листинг 4.4. Выбор цвета заливки рабочего листа</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AssistantChooseColor()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intChoise As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>With Assistant</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Включение и
отображение помощника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.On = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .NewBalloon<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Настройка<span
style='mso-ansi-language:EN-US'> </span>окна<span lang=EN-US style='mso-ansi-language:
EN-US'>...<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Тип<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.BalloonType = msoBalloonTypeButtons<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Заголовок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.Heading =
&quot;Какой нужен цвет?&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Первый цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>.Labels(1).Text = &quot;Красный&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Второй цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>.Labels(2).Text = &quot;Желтый&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>   </span>' Третий цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>.Labels(3).Text = &quot;Зеленый&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Тип кнопок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>.button =
msoButtonSetNone</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Оображение
окна</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intChoise =
.Show</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>'
Информационное сообщение о выбранном цвете</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>MsgBox &quot;</span>Выбран<span
lang=EN-US style='mso-ansi-language:EN-US'>: &quot; &amp; .Labels(intChoise).Text<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Настройка цветов
ячеек (присвоение выбранного цвета)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Select Case intChoise<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Красный<span
style='mso-ansi-language:EN-US'> </span>цвет<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveSheet.Cells.Interior.Color =
RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Желтый<span style='mso-ansi-language:
EN-US'> </span>цвет<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveSheet.Cells.Interior.Color =
RGB(255, 255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Case 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Зеленый<span
style='mso-ansi-language:EN-US'> </span>цвет<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ActiveSheet.Cells.Interior.Color =
RGB(0, 255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc315863702">ГЛАВА 6</a><span style='mso-bookmark:_Toc315863702'><span
lang=EN-US style='mso-ansi-language:EN-US'>. </span>ДИАЛОГОВЫЕ ОКНА</span></h1>

<h2><a name="_Toc315863703">Функция INPUTBOX (через ввод значения)</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public Sub </span>ИнпутБокс<span
lang=EN-US style='mso-ansi-language:EN-US'>()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim </span>текст<span
lang=EN-US style='mso-ansi-language:EN-US'> As Variant<o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Если в InputBox нажать Отмена, в ячейке будут
удалены все данные&quot;</p>

<p class=MsoNormal>текст = InputBox(&quot;Введите текст&quot;, &quot;Окно ввода
текста&quot;, &quot;222&quot;)</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox </span>текст<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If </span>текст<span
lang=EN-US style='mso-ansi-language:EN-US'> &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Range(&quot;H7&quot;)
= </span>текст<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal>MsgBox &quot;Как сделать так, чтобы при выборе пользователем
в InputBox - Отмена он закрывался и прекращалось выполнение процедуры?&quot;</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Вызов предварительного просмотра</p>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
Application.Workbooks.Item(&quot;Test.xls&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Sheets(&quot;Test&quot;).PrintPreview<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863704">Настройка ввода данных в диалоговом окне</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DialogInputData()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intMin As Integer, intMax As Integer ' </span>Диапазон<span
style='mso-ansi-language:EN-US'> </span>значений<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strInput As String<span
style='mso-spacerun:yes'>                   </span>' Введенная пользователем
строка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intValue As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intMin = 1<span
style='mso-spacerun:yes'>    </span>' Минимальное значение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intMax = 50<span
style='mso-spacerun:yes'>   </span>' Максимальное значение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
&quot;Введите значение от &quot; &amp; intMin &amp; &quot; до &quot; &amp;
intMax</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод значения
(цикл завершается, когда пользователь вводит _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>значение из
заданного диапазона или отменяет ввод)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strInput = InputBox(strMessage)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If strInput = &quot;&quot; Then Exit
Sub<span style='mso-spacerun:yes'>   </span>' </span>Отмена<span
style='mso-ansi-language:EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Проверка, содержит ли введенная
пользователем строка число</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If IsNumeric(strInput) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intValue = CInt(strInput)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Проверка, удовлетворяет ли
значение диапазону</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If intValue &gt;= intMin And
intValue &lt;= intMax Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Все условия выполнены</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>Exit Do</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Формирование
сообщения с текстом ошибки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span>strMessage = &quot;Вы ввели некорректное
значение.&quot; &amp; vbNewLine &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>&quot;Введите
число от &quot; &amp; intMin &amp; &quot; до &quot; &amp; intMax</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Loop</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Внесение данных в
ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ActiveSheet.Range(&quot;A1&quot;).Value =
strInput<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863705">Открытие диалогового окна (“Открыть файл”)_1</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>Application.Dialogs(xlDialogOpen).Show
&quot;*.dbf&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Открытие диалогового окна (“Открыть файл”)_2</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>fileToOpen
= Application.GetOpenFilename(&quot;Text Files (*.txt), *.txt&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
fileToOpen &lt;&gt; False Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span>MsgBox &quot;Open &quot; &amp; fileToOpen<o:p></o:p></span></p>

<p class=MsoNormal>End If</p>

<p class=MsoNormal>Открытие диалогового окна (“Печать”)</p>

<p class=MsoNormal>Application.Dialogs(xlDialogPrint).Show</p>

<p class=MsoNormal>Другие диалоговые окна</p>

<p class=MsoNormal>xlDialogClear - очистка ячейки или диапазона</p>

<p class=MsoNormal>xlDialogDisplay - параметры отображения ячеек</p>

<p class=MsoNormal>xlDialogFileDelete - удаление файла</p>

<p class=MsoNormal>xlDialogSaveWorkbook - сохранить книгу</p>

<p class=MsoNormal>xlDialogSearch - поиск в документе</p>

<p class=MsoNormal>xlDialogWorkbookName - переименование листа</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863706">Вызов броузера из Экселя</a></h2>

<p class=MsoNormal>Надо создать кнопку которой добавить код:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Button1_Click()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Call ShellExecute(GetDesktopWindow,
&quot;Open&quot;, &quot;www.armentel.com/avb&quot;, &quot;&quot;,
&quot;c:\&quot;, SW_SHOWNORMAL)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>И<span style='mso-ansi-language:EN-US'> </span>функция<span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Private Declare Function
ShellExecute&amp; Lib &quot;shell32.dll&quot; Alias &quot;ShellExecuteA&quot;
(ByVal hwnd As ****, ByVal _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>lpOperation As String, ByVal lpFile
As String, ByVal lpParameters As String, ByVal lpDirectory As String, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>ByVal nShowCmd As ****)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span>Private Declare Function
GetDesktopWindow Lib &quot;user32&quot; () As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'>            </span></span>Const SW_SHOWNORMAL = 1</p>

<h2><a name="_Toc315863707">Диалоговое окно ввода данных</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
InputDialog()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strInput As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вызов стандартного диалогового окна
ввода данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strInput = InputBox(&quot;Введите
данные&quot;, &quot;Ввод данных&quot;)</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Диалоговое окно настройки шрифта</p>

<p class=MsoNormal>Sub ShowFontDialog()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вызов
стандартного окна настройки шрифта текущей ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.Dialogs(xlDialogActiveCellFont).Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863708">Значения по умолчанию</a></h2>

<p class=MsoNormal>Sub NewInputDialog()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strInput As
String</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вызов
стандартного диалогового окна ввода со значением _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>по умолчанию</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strInput =
InputBox(&quot;Введите данные&quot;, &quot;Ввод данных&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Значение по
умолчанию&quot;, 200, 200)</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc315863709">ГЛАВА 7.ФОРМАТИРОВАНИЕ ТЕКСТА. ТАБЛИЦЫ. ГРАНИЦЫ И
ЗАЛИВКА.</a></h1>

<h2><a name="_Toc315863710">Вывод списка доступных шрифтов</a></h2>

<p class=MsoNormal>Листинг 3.104. Список шрифтов</p>

<p class=MsoNormal>Sub ListOfFonts()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cbrcFonts As CommandBarControl<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cbrBar As CommandBar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение доступа
к списку шрифтов (элемент управления в виде _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>раскрывающегося
списка на панели инструментов &quot;Форматирование&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cbrcFonts =
Application.CommandBars(&quot;Formatting&quot;). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>FindControl(ID:=1728)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If cbrcFonts Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Панель
&quot;Форматирование&quot; не открыта - откроем ее</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set cbrBar =
Application.CommandBars.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Set cbrcFonts =
cbrBar.Controls.Add(ID:=1728)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Подготовка к
выводу шрифтов (очистка ячеек)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;A:A&quot;).ClearContents</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод списка
шрифтов в столбец &quot;A&quot; текущего листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 0 To cbrcFonts.ListCount - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(i + 1, 1) = cbrcFonts.List(i + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Закрытие панели
инструментов &quot;Форматирование&quot;, если мы были _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>вынуждены<span
style='mso-ansi-language:EN-US'> </span>ее<span style='mso-ansi-language:EN-US'>
</span>открывать<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cbrBar.Delete<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863711">Выбор из текста всех чисел</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.48. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
ExtractNumeric<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
ExtractNumeric(iCell)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Анализируется каждый символ входной
строки iCell</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For iCount = 1 To Len(iCell)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Проверка, является ли
анализируемый символ числом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If IsNumeric(Mid(iCell, iCount, 1))
= True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span><span style='mso-spacerun:yes'>    </span></span>'
Число добавляется в выходную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ExtractNumeric = ExtractNumeric
&amp; Mid(iCell, iCount, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863712">Прописная буква только в начале текста</a></h2>

<p class=MsoNormal>Листинг 2.49. Функция ПрописнНач</p>

<p class=MsoNormal>Function ПрописнНач(Текст)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Пустой текст
функция не обрабатывает</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If </span>Текст<span lang=EN-US
style='mso-ansi-language:EN-US'> = &quot;&quot; Then </span>ПрописнНач<span
lang=EN-US style='mso-ansi-language:EN-US'> = &quot;&lt;&gt;&quot;: Exit
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Выделение первого символа и перевод
его в верхний регистр</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ПервыйСимвол =
UCase(Left(Текст, 1))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение
остальной части строки и перевод _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>ее в нижний регистр</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Обрубок =
LCase(Mid(Текст, 2))</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Соединение частей
строки и возврат значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ПрописнНач =
ПервыйСимвол &amp; Обрубок</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863713">Подсчет количества повторов искомого текста</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.51. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
CoincideCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
CoincideCount(Text, Search)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span></span>'
Проверка правильности входных данных _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>(</span>аргумента<span lang=EN-US
style='mso-ansi-language:EN-US'> Search)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If IsArray(Search) = True Then Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If IsError(Search) = True Then Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If IsEmpty(Search) = True Then Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просмотр заданного в параметре Text
диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For Each iCell In
Text</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Анализируются
только ячейки, содержащие _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>корректные<span
style='mso-ansi-language:EN-US'> </span>значения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not IsError(iCell) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' iText - строка для просмотра
(в нижнем регистре)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>iText =
LCase(iCell)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' iSearch -
искомое значение (в нижнем регистре)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>iSearch = LCase(Search)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Длина<span style='mso-ansi-language:
EN-US'> </span>искомой<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>iLen = Len(Search)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Первый поиск строки iSearch в
строке iText _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>(этот и
последующий поиски производятся без _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>учета<span
style='mso-ansi-language:EN-US'> </span>регистра<span style='mso-ansi-language:
EN-US'> </span>символов<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>iNumber = InStr(iText, iSearch)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>While iNumber &gt; 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Поиск<span
style='mso-ansi-language:EN-US'> </span>следующего<span style='mso-ansi-language:
EN-US'> </span>вхождения<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>iNumber = InStr(iNumber + iLen,
iText, iSearch)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Подсчет<span
style='mso-ansi-language:EN-US'> </span>количества<span style='mso-ansi-language:
EN-US'> </span>вхождений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>CoincideCount = CoincideCount +
vbNull<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Wend<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863714">Выделение из текста произвольного элемента</a></h2>

<p class=MsoNormal>Листинг 2.76. Выделение<span style='mso-ansi-language:EN-US'>
</span>элемента<span style='mso-ansi-language:EN-US'> </span>текста<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetTextItem(ByVal strTextIn As String, intItem As _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Integer, strSeparator As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intStart As Integer ' Позиция
начала текущего элемента</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intEnd As
Integer<span style='mso-spacerun:yes'>   </span>' Позиция конца текущего
элемента</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim i As
Integer<span style='mso-spacerun:yes'>        </span>' Номер текущего элемента</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка
корректности номера элемента</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If intItem &lt; 1
Then Exit Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Убираются лишние
пробелы, если разделитель - пробел</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If strSeparator = &quot; &quot; Then strTextIn
= Application.Trim(strTextIn)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Разделитель добавляется в конец
строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Right(strTextIn, Len(strTextIn)) &lt;&gt;
strSeparator Then _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span><span style='mso-spacerun:yes'> </span></span>strTextIn
= strTextIn &amp; strSeparator</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Поиск всех
элементов в строке до нужного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>For i = 1 To
intItem</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Начало
элемента (перемещение вперед по строке)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intStart = intEnd + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Конец<span style='mso-ansi-language:
EN-US'> </span>элемента<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intEnd = InStr(intStart, strTextIn,
strSeparator)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>If (intEnd = 0) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Дошли до
конца строки, но элемент не нашли</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Выделение текста из входной строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhGetTextItem = Mid(strTextIn, intStart, intEnd
- intStart)<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863715">Отображение текста «задом наперед»</a></h2>

<p class=MsoNormal>Листинг 2.71. Преобразование текста в обратном порядке</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhReverseText(strText As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Переписываем
символы из входной строки в выходную <span lang=EN-US style='mso-ansi-language:
EN-US'>_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>в<span style='mso-ansi-language:
EN-US'> </span>обратном<span style='mso-ansi-language:EN-US'> </span>порядке<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = Len(strText) To 1 Step -1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhReverseText = dhReverseText &amp;
Mid(strText, i, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ReverseText()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strText As String</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Ввод строки
посредством стандартного окна ввода</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strText =
InputBox(&quot;Введите текст:&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Реверсия строки и
вывод результата</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox dhReverseText(strText), , strText<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Англоязычный текст — заглавными буквами</p>

<p class=MsoNormal>Листинг 2.70. Английский<span style='mso-ansi-language:EN-US'>
</span>текст<span lang=EN-US style='mso-ansi-language:EN-US'> — </span>в<span
style='mso-ansi-language:EN-US'> </span>верхнем<span style='mso-ansi-language:
EN-US'> </span>регистре<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhFormatEnglish(strText As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCurChar As String * 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Анализируется каждый символ строки
strText. Каждый символ _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>латинского
алфавита преобразуется в верхний регистр</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To Len(strText)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>strCurChar = Mid(strText, i, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Код латинских
строчных символов лежит в пределах _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>от<span
lang=EN-US style='mso-ansi-language:EN-US'> 97 </span>до<span lang=EN-US
style='mso-ansi-language:EN-US'> 122<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Asc(strCurChar) &gt;= 97 And
Asc(strCurChar) &lt;= 122 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Переводим символ в верхний
регистр</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>dhFormatEnglish = dhFormatEnglish &amp; UCase(strCurChar)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Просто
добавляем символ в выходную строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhFormatEnglish = dhFormatEnglish
&amp; strCurChar<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863716">Запуск таблицы символов из Excel</a></h2>

<p class=MsoNormal>Листинг 3.106. Вызов таблицы символов</p>

<p class=MsoNormal>Sub ShowSymbolTable()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Запуск<span lang=EN-US
style='mso-ansi-language:EN-US'> Charmap.exe - </span>таблицы<span
style='mso-ansi-language:EN-US'> </span>символов<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Shell &quot;Charmap.exe&quot;, vbNormalFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Err &lt;&gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>MsgBox &quot;Невозможно запустить
таблицу символов.&quot;, vbCritical</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
3.107. </span>Таблица символов</p>

<p class=MsoNormal>' Декларация API-функций:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>для<span
style='mso-ansi-language:EN-US'> </span>открытия<span style='mso-ansi-language:
EN-US'> </span>процесса<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function OpenProcess Lib &quot;kernel32&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>(ByVal dwDesiredAccess As ****, ByVal
bInheritHandle As ****, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>ByVal dwProcessId As ****) As ****</p>

<p class=MsoNormal>' для получения кода завершения процесса</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function GetExitCodeProcess Lib &quot;kernel32&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>(ByVal hProcess As ****, lpExitCode As ****)
As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>' </span>для<span
style='mso-ansi-language:EN-US'> </span>закрытия<span style='mso-ansi-language:
EN-US'> </span>процесса<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function CloseHandle Lib &quot;kernel32&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>(hProcess) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowSymbolTable1()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lProcessID As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim hProcess As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lExitCode As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Запуск<span style='mso-ansi-language:
EN-US'> </span>таблицы<span style='mso-ansi-language:EN-US'> </span>символов<span
lang=EN-US style='mso-ansi-language:EN-US'> (Charman.exe). </span>Функция
возвращает _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>идентификатор
созданного процесса</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>lProcessID =
Shell(&quot;Charmap.exe&quot;, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If Err &lt;&gt; 0
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Нельзя запустить Charman.exe&quot;, vbCritical, &quot;Ошибка&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Exit Sub</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Открытие процесса
по идентификатору (lProcessID). Функция _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>возвращает
дескриптор процесса (handle)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>hProcess = OpenProcess(&amp;H400, False,
lProcessID)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Ждем, пока процесс завершится, для
этого периодически _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>получаем код
завершения процесса (пока Charman.exe исполняется, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>функция<span
lang=EN-US style='mso-ansi-language:EN-US'> GetExitCodeProcess </span>возвращает<span
lang=EN-US style='mso-ansi-language:EN-US'> &amp;H103)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>GetExitCodeProcess hProcess, lExitCode<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>DoEvents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop While lExitCode = &amp;H103<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Закрытие<span style='mso-ansi-language:
EN-US'> </span>процесса<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>CloseHandle (hProcess)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод на экран
информационного сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Charmap.exe завершает свою работу&quot;</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Листинг 3.64. Формат «два знака после запятой»</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ChangeNumberFormat()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.NumberFormat = &quot;0.00&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг 3.65. Использование разделителя по разрядам</p>

<p class=MsoNormal>Sub ThreeNullSepatator()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Selection.NumberFormat = &quot;#,##&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
3.66. </span>Изменение<span style='mso-ansi-language:EN-US'> </span>формата<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ChangeNumerFormatEx()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.NumberFormat =
&quot;#,##0.00&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Листинг 3.67. Помещение последнего символа над строкой</p>

<p class=MsoNormal>Sub LastCharUp()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
расположения последнего символа ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With
ActiveCell.Characters(Start:=Len(Selection), Length:=1).Font<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Supers</span>с<span lang=EN-US
style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US style='mso-ansi-language:
EN-US'>t = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг 3.68. Нестандартная рамка</p>

<p class=MsoNormal>Sub ChangeSelGrid()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Оформление границ
выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Левая граница</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Selection.Borders(xlEdgeLeft)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Правая<span style='mso-ansi-language:
EN-US'> </span>граница<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeRight)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Верхняя<span style='mso-ansi-language:
EN-US'> </span>граница<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeTop)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Нижняя<span style='mso-ansi-language:
EN-US'> </span>граница<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeBottom)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение сетки
внутри выделения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Вертикальные<span style='mso-ansi-language:
EN-US'> </span>линии<span style='mso-ansi-language:EN-US'> </span>сетки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlInsideVertical)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlHairline<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Горизонтальные
линии сетки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Selection.Borders(xlInsideHorizontal)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlHairline<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc315863717">ГЛАВА 8 ИНФОРМАЦИЯ О ПОЛЬЗОВАТЕЛЕ, КОМПЬЮТЕРЕ,
ПРИНТЕРЕ И Т.Д.</a></h1>

<h2><a name="_Toc315863718">Получить имя пользователя</a></h2>

<p class=MsoNormal>Логин юзера получить просто:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Dim
UserName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>UserName =
CreateObject(&quot;Ws</span>с<span lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span
lang=EN-US style='mso-ansi-language:EN-US'>t.Network&quot;).UserName<o:p></o:p></span></p>

<p class=MsoNormal>А как отслеживать - вариатнов много.</p>

<p class=MsoNormal>Я, например, просто не выполняю макрос, если логин не тот:</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If ThisWorkbook.Sheets(&quot;Rules&quot;).Range(&quot;Admin&quot;).Find(CreateObject(&quot;Ws</span>с<span
lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US
style='mso-ansi-language:EN-US'>t.Network&quot;).UserName, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>LookAt:=xlWhole,
LookIn:=xlValues) Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>MsgBox
&quot;</span>Имя<span style='mso-ansi-language:EN-US'> </span>пользователя<span
lang=EN-US style='mso-ansi-language:EN-US'> : &quot; &amp;
CreateObject(&quot;Ws</span>с<span lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span
lang=EN-US style='mso-ansi-language:EN-US'>t.Network&quot;).UserNam<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>CreateObject(&quot;Ws</span>с<span
lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US
style='mso-ansi-language:EN-US'>t.Network&quot;).UserName </span>вместо<span
lang=EN-US style='mso-ansi-language:EN-US'> Application.UserName<o:p></o:p></span></p>

<h2><a name="_Toc315863719">Вывод разрешения монитора</a></h2>

<p class=MsoNormal>Листинг 3.73. Разрешение монитора</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>'</span>Объявление<span
lang=EN-US style='mso-ansi-language:EN-US'> API-</span>функции<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function GetSystemMetrics Lib &quot;user32&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span></span>(ByVal nIndex As ****) As ****</p>

<p class=MsoNormal>' Константы, которые передаются в функцию для определения _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>горизонтального и
вертикального размеров изображения</p>

<p class=MsoNormal>Const SM_CXSCREEN = 0</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
SM_CYSCREEN = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
GetMonitorResolution()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngHorzRes As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngVertRes As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение ширины и высоты
изображения на мониторе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngHorzRes = GetSystemMetrics(SM_CXSCREEN)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lngVertRes = GetSystemMetrics(SM_CYSCREEN)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox
&quot;Текущее разрешение: &quot; &amp; lngHorzRes &amp; &quot;x&quot; &amp;
lngVertRes</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863720">Получение информации об используемом принтере</a></h2>

<p class=MsoNormal>Информация о принтере</p>

<p class=MsoNormal>' Объявление API-функции</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Declare
Function GetProfileStringA Lib &quot;kernel32&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>(ByVal lpAppName As String, ByVal lpKeyName As
String, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>ByVal lpDefault As String, ByVal
lpReturnedString As _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>String, ByVal nSize As ****) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub </span>Принтер<span
lang=EN-US style='mso-ansi-language:EN-US'>()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFullInfo As String * 255<span
style='mso-spacerun:yes'>  </span>' </span>Буфер<span style='mso-ansi-language:
EN-US'> </span>для<span lang=EN-US style='mso-ansi-language:EN-US'> API-</span>функции<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strInfo As String<span
style='mso-spacerun:yes'>            </span>' Строка с полной информацией</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strPrinter As String<span
style='mso-spacerun:yes'>         </span>' </span>Название<span
style='mso-ansi-language:EN-US'> </span>принтера<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strDriver As String<span
style='mso-spacerun:yes'>          </span>' </span>Драйвер<span
style='mso-ansi-language:EN-US'> </span>принтера<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strPort As String<span
style='mso-spacerun:yes'>            </span>' </span>Порт<span
style='mso-ansi-language:EN-US'> </span>принтера<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intPrinterEndPos As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intDriverEndPos As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Заполнение<span style='mso-ansi-language:
EN-US'> </span>буфера<span style='mso-ansi-language:EN-US'> </span>пробелами<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFullInfo = Space(255)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Получение полной информации о
принтере</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Call GetProfileStringA(&quot;Windows&quot;,
&quot;Device&quot;, &quot;&quot;, strFullInfo, 254)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление лишних символов из конца
возвращенной строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Строка strInfo
имеет формат &lt;имя_принтера&gt;,&lt;драйвер&gt;,&lt;порт&gt;:</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strInfo =
Trim(strFullInfo)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Поиск запятых в
строке (окончаний названий принтера и драйвера)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intPrinterEndPos =
Application.Find(&quot;,&quot;, strInfo, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intDriverEndPos =
Application.Find(&quot;,&quot;, strInfo, intPrinterEndPos + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определение названия принтера</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strPrinter =
Left(strInfo, intPrinterEndPos - 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение
драйвера</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strDriver = Mid(strInfo, intPrinterEndPos + 1,
intDriverEndPos _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>- intPrinterEndPos - 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение порта
(его название заканчивается символом &quot;:&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strPort = Mid(strInfo, intDriverEndPos + 1,
InStr(1, strInfo, &quot;:&quot;) _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>- intDriverEndPos - 1)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
информационного сообщения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strMessage =
&quot;Принтер:&quot; &amp; Chr(9) &amp; strPrinter &amp; Chr(13)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strMessage = strMessage &amp; &quot;</span>Драйвер<span
lang=EN-US style='mso-ansi-language:EN-US'>:&quot; &amp; strDriver &amp;
Chr(13)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strMessage = strMessage &amp;
&quot;strPort:&quot; &amp; Chr(9) &amp; strPort<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Вывод<span style='mso-ansi-language:
EN-US'> </span>информационного<span style='mso-ansi-language:EN-US'> </span>сообщения<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox strMessage, vbInformation, &quot;</span>Сведения<span
style='mso-ansi-language:EN-US'> </span>о<span style='mso-ansi-language:EN-US'>
</span>принтере<span style='mso-ansi-language:EN-US'> </span>по<span
style='mso-ansi-language:EN-US'> </span>умолчанию<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863721">Просмотр информации о дисках компьютера</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DrivesInfo()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim objFileSysObject As Object<span
style='mso-spacerun:yes'>  </span>' </span>Объект<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>работы<span
lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span></span>с
файловой системой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim objDrive As
Object<span style='mso-spacerun:yes'>          </span>' Анализируемый диск</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intRow As
Integer<span style='mso-spacerun:yes'>           </span>' Заполняемая строка
листа</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание объекта
для работы с файловой системой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set objFileSysObject = CreateObject(&quot;s</span>с<span
lang=EN-US style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US
style='mso-ansi-language:EN-US'>ting.FileSystemObject&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Очистка листа</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Cells.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запись с первой
строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запись на лист
информации о дисках компьютера</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each objDrive In objFileSysObject.Drives<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Буква<span style='mso-ansi-language:
EN-US'> </span>диска<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 1) = objDrive.DriveLetter<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Готовность<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 2) = objDrive.IsReady<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Тип<span style='mso-ansi-language:
EN-US'> </span>диска<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Select Case objDrive.DriveType<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Неизвестно<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Съемный<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Жесткий<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;</span>Сетевой<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 4<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) =
&quot;CD-ROM&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, 3) = &quot;RAM&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Метка<span style='mso-ansi-language:
EN-US'> </span>диска<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 4) = objDrive.VolumeName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Общий<span style='mso-ansi-language:
EN-US'> </span>размер<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 5) = objDrive.TotalSize<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Свободное<span style='mso-ansi-language:
EN-US'> </span>место<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cells(intRow, 6) =
objDrive.AvailableSpace<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intRow = intRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc315863722">ГЛАВА 9. ДИАГРАММЫ</a></h1>

<h2><a name="_Toc315863723">Построение диаграммы с помощью макроса</a></h2>

<p class=MsoNormal>Листинг 5.1. Макрос построения диаграммы</p>

<p class=MsoNormal>Sub CreateChart()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание и
настройка диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With Charts.Add</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Данные<span
style='mso-ansi-language:EN-US'> </span>из<span style='mso-ansi-language:EN-US'>
</span>первого<span style='mso-ansi-language:EN-US'> </span>листа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.SetSourceData
Source:=Worksheets(1).Range(&quot;A1:E4&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Заголовок</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.HasTitle = True</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.ChartTitle.Text
= &quot;Выручка по магазинам&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Активизируем<span
style='mso-ansi-language:EN-US'> </span>диаграмму<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Листинг 5.2. Построение внедренной диаграммы</p>

<p class=MsoNormal>Sub CreateеmbеddedChart()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание и
настройка внедренной диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Worksheets(1).ChartObjects.Add(100, 60,
250, 200)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Объемная<span style='mso-ansi-language:
EN-US'> </span>диаграмма<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.Chart.ChartType = xl3DArea</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Источник
данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Chart.SetSourceData
Source:=Worksheets(1).Range(&quot;A1:E4&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
5.3. </span>Создание диаграммы на основе выделенных данных</p>

<p class=MsoNormal>Sub CreateCharOnSelection()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание
диаграммы (с заданием положения на листе)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With ActiveSheet.ChartObjects.Add( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Selection.Left + Selection.Width, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Selection.Top + Selection.Height, 300,
200).Chart<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Тип<span style='mso-ansi-language:
EN-US'> </span>диаграммы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.ChartType = xlColumnClustered</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Источник
данных - выделение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.SetSourceData Source:=Selection,
PlotBy:=xlColumns<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Без<span style='mso-ansi-language:
EN-US'> </span>легенды<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.HasLegend = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Без<span style='mso-ansi-language:
EN-US'> </span>заголовка<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.HasTitle = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>.ChartTitle.Characters.Text =
&quot;Выручка за период&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Выделение
диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Parent.Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863724">Сохранение диаграммы в отдельном файле</a></h2>

<p class=MsoNormal>Листинг 5.4. Сохранение диаграммы</p>

<p class=MsoNormal>Sub SaveChart()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Сохранение
выделенной диаграммы в файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveChart Is Nothing Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Нет<span style='mso-ansi-language:
EN-US'> </span>выделенных<span style='mso-ansi-language:EN-US'> </span>диаграмм<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>MsgBox &quot;Выделите
диаграмму&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Сохранение...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveChart.Export
ActiveWorkbook.path &amp; &quot;\</span>Диаграмма<span lang=EN-US
style='mso-ansi-language:EN-US'>.gif&quot;, &quot;GIF&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
5.5. </span>Сохранение диаграммы под указанным именем</p>

<p class=MsoNormal>Sub InteractiveSaveChart()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strFileName As String<span
style='mso-spacerun:yes'>  </span>' </span>Имя<span style='mso-ansi-language:
EN-US'> </span>файла<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>сохранения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка, выделена ли диаграмма</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If ActiveChart Is
Nothing Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Нет выделенных
диаграмм</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Выделите диаграмму&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Выбор файла
для сохранения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strFileName = Application.GetSaveAsFilename(
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>ActiveChart.Name &amp; &quot;.gif&quot;,
&quot;</span>Файлы<span lang=EN-US style='mso-ansi-language:EN-US'> GIF
(*.gif), *.gif&quot;, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>&quot;Сохранить диаграмму в
формате GIF&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Проверка,
выбран ли файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If strFileName
&lt;&gt; &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Сохранение
выделенной диаграммы в файл</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveChart.Export strFileName,
&quot;GIF&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863725">Построение и удаление диаграммы нажатием одной
кнопки</a></h2>

<p class=MsoNormal>Листинг 5.6. Быстрое построение и удаление диаграммы</p>

<p class=MsoNormal>Sub CreateChart()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Создание
диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Charts.Add</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Параметры
диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Тип<span style='mso-ansi-language:
EN-US'> </span>диаграммы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveChart.ChartType = xlLineMarkers<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Заголовок<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveChart.SetSourceData
Range(&quot;B1:E2&quot;), xlRows<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveChart.Location xlLocationAsObject,
Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Остальные<span style='mso-ansi-language:
EN-US'> </span>параметры<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With ActiveChart<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Заголовок<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.HasTitle = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ChartTitle.Characters.Text = Name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Заголовок<span style='mso-ansi-language:
EN-US'> </span>оси<span style='mso-ansi-language:EN-US'> </span>категорий<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Axes(xlCategory, xlPrimary).HasTitle =
True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Axes(xlCategory,
xlPrimary).AxisTitle.Characters.Text _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>=
Sheets(Name).Range(&quot;A1&quot;).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Заголовок<span style='mso-ansi-language:
EN-US'> </span>оси<span style='mso-ansi-language:EN-US'> </span>значений<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Axes(xlValue, xlPrimary).HasTitle = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Axes(xlValue,
xlPrimary).AxisTitle.Characters.Text _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>=
Sheets(Name).Range(&quot;A2&quot;).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Отображение<span
style='mso-ansi-language:EN-US'> </span>легенды<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.HasLegend = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.HasDataTable = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.DataTable.ShowLegendKey = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Настройка отображения сетки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>With
.Axes(xlCategory)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.HasMajorGridlines = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.HasMinorGridlines = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With .Axes(xlValue)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.HasMajorGridlines = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.HasMinorGridlines = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteChart()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>диаграммы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.ChartObjects.Delete<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Вывод списка диаграмм в отдельном окне</p>

<p class=MsoNormal>Листинг 5.7. Внедренные диаграммы</p>

<p class=MsoNormal>Sub ShowSheetCharts()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strMessage As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>  </span>Dim i
As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Формирование<span style='mso-ansi-language:
EN-US'> </span>списка<span style='mso-ansi-language:EN-US'> </span>диаграмм<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To ActiveSheet.ChartObjects.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strMessage = strMessage &amp;
ActiveSheet.ChartObjects(i).Name _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>&amp; vbNewLine</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next i</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Отображение
списка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox strMessage<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
5.8. </span>Перечень рабочих листов, содержащих обычные диаграммы</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowBookCharts()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim crt As chart<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim strMessage As String</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование
списка диаграмм</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each crt In ActiveWorkbook.Charts<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strMessage = strMessage &amp; crt.Name
&amp; vbNewLine<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение списка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox strMessage</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863726">Применение случайной цветовой палитры</a></h2>

<p class=MsoNormal>Листинг 5.9. Случайная цветовая палитра</p>

<p class=MsoNormal>Sub RandomChartColors()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intGradientStyle As Integer,
intGradientVariant As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim i As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка,
выделена ли диаграмма</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveChart Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Изменение<span style='mso-ansi-language:
EN-US'> </span>оформления<span style='mso-ansi-language:EN-US'> </span>всех<span
style='mso-ansi-language:EN-US'> </span>категорий<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 1 To
ActiveChart.SeriesCollection.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>With ActiveChart.SeriesCollection(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Вид<span style='mso-ansi-language:
EN-US'> </span>градиентной<span style='mso-ansi-language:EN-US'> </span>заливки<span
lang=EN-US style='mso-ansi-language:EN-US'> (</span>случайный<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intGradientStyle = Int(Rnd * 7) + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If intGradientStyle = 6 Then
intGradientStyle = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If intGradientStyle = 7 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intGradientVariant = Int(Rnd * 2) +
1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>intGradientVariant = Int(Rnd * 4) +
1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Применение<span
style='mso-ansi-language:EN-US'> </span>градиента<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Fill.TwoColorGradient
Style:=intGradientStyle, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span></span>Variant:=intGradientVariant</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Установка
случайных цветов фона и обводки (используются _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>для<span
style='mso-ansi-language:EN-US'> </span>градиента<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Fill.ForeColor.SchemeColor = Int(Rnd
* 57) + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Fill.BackColor.SchemeColor = Int(Rnd
* 57) + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863727">Эффект прозрачности диаграммы</a></h2>

<p class=MsoNormal>Листинг 5.10. Эффект прозрачности диаграммы</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
TransparentChart()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim shpShape As Shape<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span>Dim
dblColor As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim srSerie As Series<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intBorderLineStyle As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intBorderColorIndex As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intBorderWeight As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка, есть ли
выделенная диаграмма</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If ActiveChart Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Изменение<span style='mso-ansi-language:
EN-US'> </span>отображения<span style='mso-ansi-language:EN-US'> </span>каждой<span
style='mso-ansi-language:EN-US'> </span>категории<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each srSerie In
ActiveChart.SeriesCollection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If (srSerie.ChartType = xlColumnClustered
Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>srSerie.ChartType = xlColumnStacked Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>srSerie.ChartType = xlColumnStacked100
Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>srSerie.ChartType = xlBarClustered Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>srSerie.ChartType = xlBarStacked Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>srSerie.ChartType =
xlBarStacked100) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Сохранение
прежнего цвета категории</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>dblColor =
srSerie.Interior.Color</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Сохранение
стиля линий</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intBorderLineStyle =
srSerie.Border.LineStyle<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Цвет<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intBorderColorIndex =
srSerie.Border.ColorIndex<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Толщина<span
style='mso-ansi-language:EN-US'> </span>линий<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intBorderWeight =
srSerie.Border.Weight<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Создание<span
style='mso-ansi-language:EN-US'> </span>автофигуры<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set shpShape =
ActiveSheet.shapes.AddShape _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>(msoShapeRectangle, 1, 1, 100, 100)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>With shpShape<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Закрашиваем<span
style='mso-ansi-language:EN-US'> </span>нужным<span style='mso-ansi-language:
EN-US'> </span>цветом<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Fill.ForeColor.RGB = dblColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Делаем<span
style='mso-ansi-language:EN-US'> </span>прозрачной<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Fill.Transparency = 0.4<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Убираем<span
style='mso-ansi-language:EN-US'> </span>линии<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Line.Visible = msoFalse<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Копируем
автофигуру в буфер обмена</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>shpShape.CopyPicture
Appearance:=xlScreen, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>Format:=xlPicture<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Вставляем автофигуру в
изображения столбцов _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>категории и
настраиваем</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>With srSerie</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Собственно вставка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.Paste</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Возвращаем на место толщину линий</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Border.Weight = intBorderWeight<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Стиль<span
style='mso-ansi-language:EN-US'> </span>линий<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Border.LineStyle =
intBorderLineStyle<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Цвет<span
style='mso-ansi-language:EN-US'> </span>границы<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Border.ColorIndex =
intBorderColorIndex<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Автофигура<span
style='mso-ansi-language:EN-US'> </span>больше<span style='mso-ansi-language:
EN-US'> </span>не<span style='mso-ansi-language:EN-US'> </span>нужна<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>shpShape.Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next srSerie<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863728">Построение диаграммы на основе данных нескольких
рабочих листов</a></h2>

<p class=MsoNormal>Листинг 5.11. Одновременное создание нескольких диаграмм</p>

<p class=MsoNormal>Sub ManyCharts()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intTop As ****, intLeft As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intHeight As ****, intWidth As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim sheet As Worksheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngFirstRow As ****<span
style='mso-spacerun:yes'>    </span><span style='mso-spacerun:yes'>  </span>' </span>Первая<span
style='mso-ansi-language:EN-US'> </span>строка<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>данными<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intSerie As Integer<span
style='mso-spacerun:yes'>      </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>категория<span style='mso-ansi-language:EN-US'> </span>диаграммы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strErrorSheets As String ' </span>Список<span
style='mso-ansi-language:EN-US'> </span>листов<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>для<span style='mso-ansi-language:
EN-US'> </span>которых<span lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                 </span></span>не
удалось построить диаграммы</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intTop = 1<span
style='mso-spacerun:yes'>       </span>' Верхняя точка первой диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intLeft = 1<span
style='mso-spacerun:yes'>      </span>' Левая точка каждой диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intHeight =
180<span style='mso-spacerun:yes'>  </span>' Высота каждой диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intWidth = 300<span
style='mso-spacerun:yes'>   </span>' Ширина каждой диаграммы</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Постоение
диаграммы для каждого листа, кроме текущего</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each sheet In ActiveWorkbook.Worksheets<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If sheet.Name &lt;&gt; ActiveSheet.Name
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Первый заполненный ряд</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>lngFirstRow =
3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Первая<span
style='mso-ansi-language:EN-US'> </span>категория<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intSerie = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>On Error GoTo DiagrammError<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Добавление и настройка
диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>With
ActiveSheet.ChartObjects.Add _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span><span
lang=EN-US style='mso-ansi-language:EN-US'>(intLeft, intTop, intWidth,
intHeight).Chart<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Do Until
IsEmpty(sheet.Cells(lngFirstRow + intSerie, 1))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Создание ряда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>              
</span>.SeriesCollection.NewSeries</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Значения для ряда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.SeriesCollection(intSerie).Values =
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               
</span>sheet.Range(sheet.Cells(lngFirstRow + intSerie, 2), _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>sheet.Cells(lngFirstRow +
intSerie, 4))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>' </span>Диапазон<span
style='mso-ansi-language:EN-US'> </span>данных<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>подписей<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>.SeriesCollection(intSerie).XValues
= _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>sheet.Range(&quot;B3:D3&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Название ряда (берется
из столбца &quot;A&quot; таблицы с данными)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.SeriesCollection(intSerie).Name =
sheet.Cells( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>lngFirstRow + intSerie, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>             
</span>intSerie = intSerie + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Настройка<span
style='mso-ansi-language:EN-US'> </span>внешнего<span style='mso-ansi-language:
EN-US'> </span>вида<span style='mso-ansi-language:EN-US'> </span>диаграммы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ChartType = xl3DColumnClustered<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ChartGroups(1).GapWidth = 20<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.PlotArea.Interior.ColorIndex =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ChartArea.Font.Size = 9<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Диаграмма<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>легендой<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.HasLegend = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Заголовок<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.HasTitle = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.ChartTitle.Characters.Text =
sheet.Range(&quot;A1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Задание диапазона значений
на осях</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>      </span><span lang=EN-US style='mso-ansi-language:
EN-US'>.Axes(xlValue).MinimumScale = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Axes(xlValue).MaximumScale =
120000<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Стиль линий сетки
(прерывистый)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Axes(xlValue).MajorGridlines.Border.
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>LineStyle = xlDot<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>On Error GoTo 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Сдвиг верхней точки следующей
диаграммы на высоту _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>текущей<span
style='mso-ansi-language:EN-US'> </span>диаграммы<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intTop = intTop + intHeight<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>AfterError:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next sheet<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If strErrorSheets &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Отобразим список листов, для
которых не построили диаграммы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox &quot;Не
удалось построить диаграммы для листов:&quot; &amp; Chr(13) _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&amp; strErrorSheets, vbExclamation<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal>DiagrammError:</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление в
список имени листа, для которого не смогли _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>построить
диаграмму (ошибка в данных для диаграммы)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strErrorSheets = strErrorSheets &amp;
sheet.Name &amp; Chr(13)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Удаление пустой диаграммы на
текущем листе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ActiveSheet.ChartObjects(ActiveSheet.ChartObjects.Count).Delete<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Продолжаем работу с другими листами</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Resume AfterError</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863729">Создание подписей к данным диаграммы</a></h2>

<p class=MsoNormal>Листинг 5.12. Подписи к данным диаграммы</p>

<p class=MsoNormal>Sub ShowLabels()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim rgLabels As Range<span
style='mso-spacerun:yes'>    </span>' </span>Диапазон<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>подписями<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim chrChart As Chart<span
style='mso-spacerun:yes'>    </span>' </span>Диаграмма<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intPoint As Integer<span
style='mso-spacerun:yes'>  </span>' Точка, для которой добавляется подпись</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>' </span>Определение<span style='mso-ansi-language:
EN-US'> </span>диаграммы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set chrChart =
ActiveSheet.ChartObjects(1).Chart<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Запрос на ввод диапазона с
исходными данными</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgLabels = Application.InputBox _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>(prompt:=&quot;Укажите диапазон с
подписями&quot;, Type:=8)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If rgLabels Is Nothing Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Добавление
подписей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>chrChart.SeriesCollection(1).ApplyDataLabels _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Type:=xlDataLabelsShowValue, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>AutoText:=True, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>LegendKey:=False</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр
диапазона и назначение подписей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intPoint = 1 To
chrChart.SeriesCollection(1).Points.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>chrChart.SeriesCollection(1). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Points(intPoint).DataLabel.Text =
rgLabels(intPoint)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next intPoint<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DeleteLabels()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Удаление<span style='mso-ansi-language:
EN-US'> </span>подписей<span style='mso-ansi-language:EN-US'> </span>диаграммы<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveSheet.ChartObjects(1).Chart.SeriesCollection(1).
_<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>HasDataLabels = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h1><a name="_Toc315863730">ГЛАВА</a><span style='mso-bookmark:_Toc315863730'><span
style='mso-ansi-language:EN-US'> </span>10</span><span style='mso-bookmark:
_Toc315863730'><span lang=EN-US style='mso-ansi-language:EN-US'>. </span>РАЗНЫЕ
ПРОГРАММЫ.</span></h1>

<h2><a name="_Toc315863731">Программа для составления кроссвордов</a></h2>

<p class=MsoNormal>Листинг 6.1. Программа для составления кроссворда</p>

<p class=MsoNormal>Const dhcMinCol = 1<span style='mso-spacerun:yes'>  
</span>' Номер первого столбца кроссворда</p>

<p class=MsoNormal>Const dhcMaxCol = 35<span style='mso-spacerun:yes'> 
</span>' Номер последнего столбца кроссворда</p>

<p class=MsoNormal>Const dhcMinRow = 1<span style='mso-spacerun:yes'>  
</span>' Номер первой строки кроссворда</p>

<p class=MsoNormal>Const dhcMaxRow = 35<span style='mso-spacerun:yes'> 
</span>' Номер последней строки кроссворда</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub Clear()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение и
очистка всех используемых для кроссворда ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(Cells(dhcMinRow, dhcMinCol), _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Cells(dhcMaxRow, dhcMaxCol)).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Selection.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление сетки
всего кроссворда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ClearGrid<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;A1&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub ClearGrid()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление сетки
кроссворда (в выделенных ячейках)...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Возврат прежнего
цвета ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Selection.Interior.ColorIndex = xlNone</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Задание
начертания границ ячеек по умолчанию</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Selection.Borders(xlDiagonalDown).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlDiagonalUp).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlEdgeLeft).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlEdgeTop).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlEdgeBottom).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlEdgeRight).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  
</span>Selection.Borders(xlInsideVertical).LineStyle = xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlInsideHorizontal).LineStyle
= xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DrowCrosswordGrid()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Процедура<span style='mso-ansi-language:
EN-US'> </span>начертания<span style='mso-ansi-language:EN-US'> </span>сетки<span
style='mso-ansi-language:EN-US'> </span>кроссворда<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Задание цвета всех ячеек кроссворда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Selection.Interior.ColorIndex = 35</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Линии по
диагонали не нужны</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Selection.Borders(xlDiagonalDown).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.Borders(xlDiagonalUp).LineStyle =
xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Задание начертания границ всех
диапазонов, входящих _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в выделение, а
также границ между соседними ячейками _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>всех<span
style='mso-ansi-language:EN-US'> </span>диапазонов<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Левые<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeLeft)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Правые<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeRight)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Верхние<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeTop)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Нижние<span style='mso-ansi-language:
EN-US'> </span>границы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlEdgeBottom)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вертикальные
границы между ячейками</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>With Selection.Borders(xlInsideVertical)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-spacerun:yes'>    
</span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Горизонтальные<span
style='mso-ansi-language:EN-US'> </span>границы<span style='mso-ansi-language:
EN-US'> </span>между<span style='mso-ansi-language:EN-US'> </span>ячейками<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With Selection.Borders(xlInsideHorizontal)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.LineStyle = xlContinuous<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Weight = xlThin<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.ColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
DisplayGrid()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Включение<span style='mso-ansi-language:
EN-US'> </span>сетки<span style='mso-ansi-language:EN-US'> </span>на<span
style='mso-ansi-language:EN-US'> </span>листе<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWindow.DisplayGridlines = True<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub HideGrid()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выключение сетки
на листе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>ActiveWindow.DisplayGridlines = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
AutoNumber()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Нумерация клеток, являющихся
началом слов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer<span
style='mso-spacerun:yes'>    </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>строка<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCol As Integer<span
style='mso-spacerun:yes'>    </span>' </span>Текущий<span style='mso-ansi-language:
EN-US'> </span>ряд<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<span
style='mso-spacerun:yes'>        </span>' </span>Текущая<span style='mso-ansi-language:
EN-US'> </span>ячейка<span lang=EN-US style='mso-ansi-language:EN-US'> (</span>с<span
style='mso-ansi-language:EN-US'> </span>координатами<span lang=EN-US
style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                             </span>(intRow, intCol))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fTop As Boolean<span
style='mso-spacerun:yes'>      </span>' = True, </span>если<span lang=EN-US
style='mso-ansi-language:EN-US'> cell </span>имеет<span style='mso-ansi-language:
EN-US'> </span>соседей<span style='mso-ansi-language:EN-US'> </span>сверху<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fBottom As Boolean<span
style='mso-spacerun:yes'>   </span>' = True, </span>если<span lang=EN-US
style='mso-ansi-language:EN-US'> cell </span>имеет<span style='mso-ansi-language:
EN-US'> </span>соседей<span style='mso-ansi-language:EN-US'> </span>снизу<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fLeft As Boolean<span
style='mso-spacerun:yes'>     </span>' = True, </span>если<span lang=EN-US
style='mso-ansi-language:EN-US'> cell </span>имеет<span style='mso-ansi-language:
EN-US'> </span>соседей<span style='mso-ansi-language:EN-US'> </span>слева<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fRight As Boolean<span
style='mso-spacerun:yes'>    </span>' = True, </span>если<span lang=EN-US
style='mso-ansi-language:EN-US'> cell </span>имеет<span style='mso-ansi-language:
EN-US'> </span>соседей<span style='mso-ansi-language:EN-US'> </span>справа<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intDigit As Integer<span
style='mso-spacerun:yes'>  </span>' </span>Текущий<span style='mso-ansi-language:
EN-US'> </span>номер<span style='mso-ansi-language:EN-US'> </span>слова<span
style='mso-ansi-language:EN-US'> </span>в<span style='mso-ansi-language:EN-US'>
</span>кроссворде<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intDigit = 1<span
style='mso-spacerun:yes'>             </span>' Нумерация слов с 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проходим по всем
клеткам диапазона, используемого _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>для кроссворда,
сверху вниз слева направо и анализируем _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>каждую угловую и
крайнюю (левую и верхнюю) ячейки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For intRow = dhcMinRow To dhcMaxRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = dhcMinCol To dhcMaxCol<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Текущая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Set cell = Cells(intRow, intCol)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Проверка, входит ли ячейка в
кроссворд (по ее цвету)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If cell.Interior.ColorIndex = 35
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fLeft = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fRight = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fTop = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fBottom = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>On Error Resume Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Определение наличия соседей у ячейки...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>сверху<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fTop = cell.Offset(-1,
0).Interior.ColorIndex = 35<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>снизу<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fBottom = cell.Offset(1,
0).Interior.ColorIndex = 35<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>слева<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fLeft = cell.Offset(0,
-1).Interior.ColorIndex = 35<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>справа<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>fRight = cell.Offset(0,
1).Interior.ColorIndex = 35<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Анализ
положения ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If (Not fTop And Not fLeft) Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>(Not fBottom And Not fLeft And
fRight) Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>(Not fLeft And fRight) Or _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span></span>(Not fTop And fBottom) Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>        </span>' Ячейка подходит для начала слова</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>SetDigit intDigit, cell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intDigit = intDigit + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next intCol<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next intRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SetDigit(intDigit As Integer, cell As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вставка цифры intDigit в ячейку,
заданную параметром cell</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>cell.Value =
intDigit</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
настроек шрифта так, чтобы было похоже _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>на настоящий
кроссворд</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Маленький размер
шрифта</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>cell.Font.Size = 6</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выравнивание
текста по левому верхнему углу ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cell.HorizontalAlignment = xlLeft<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cell.VerticalAlignment = xlTop<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sub ToPrint()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление цветовой
подсветки кроссворда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Cells.Interior.ColorIndex = xlNone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub ToNumber()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Закрытие первой
формы и переход ко второй</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>UserForm1.Hide<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>UserForm2.Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Создать обложку DVD</p>

<p class=MsoNormal>Sub Обложка_DVD()</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>On Error
Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sheets(&quot;</span>Обложка<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If Err &gt;
0 Then GoTo 10 Else MsgBox (&quot;</span>Такой<span style='mso-ansi-language:
EN-US'> </span>лист<span style='mso-ansi-language:EN-US'> </span>уже<span
style='mso-ansi-language:EN-US'> </span>присутствует<span style='mso-ansi-language:
EN-US'> </span>в<span style='mso-ansi-language:EN-US'> </span>книге<span
lang=EN-US style='mso-ansi-language:EN-US'>...&quot;): Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal>10:</p>

<p class=MsoNormal>Sheets.Add.Name = &quot;Обложка&quot; ' создаем новый лист в
текущей книге с именем &quot;Обложка&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Sheets(&quot;Обложка&quot;).Range(&quot;A1&quot;).Select '
становимся в ячейку А1</p>

<p class=MsoNormal>Application.Dialogs(xlDialoginsеrtPicture).Show 'вызываем
диологовое окно &quot;Вставка рисунка из файла&quot;</p>

<p class=MsoNormal>Selection.ShapeRange.LockAspectRatio = msoFalse '</p>

<p class=MsoNormal>' Selection.ShapeRange.Height = 530.25 ' подгоняем размеры
под размеры коробки</p>

<p class=MsoNormal>' Selection.ShapeRange.Width = 726# '</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Selection.ShapeRange.Height = 530.2 ' подгоняем размеры под
размеры коробки</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.ShapeRange.Width
= 724# '<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.ShapeRange.Rotation
= 0# '<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Selection.Locked
= False '<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>With
ActiveSheet.PageSetup ' </span>разносим<span style='mso-ansi-language:EN-US'> </span>поля<span
style='mso-ansi-language:EN-US'> </span>листа<span style='mso-ansi-language:
EN-US'> </span>на<span style='mso-ansi-language:EN-US'> </span>максимальные<span
style='mso-ansi-language:EN-US'> </span>расстояния<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.LeftMargin
= Application.InchesToPoints(0.17)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.RightMargin
= Application.InchesToPoints(0.17)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.TopMargin
= Application.InchesToPoints(0.27)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.BottomMargin
= Application.InchesToPoints(0.27)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.HeaderMargin
= Application.InchesToPoints(0.17)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.FooterMargin
= Application.InchesToPoints(0.17)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Zoom = 100<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.FitToPagesWide
= 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.FitToPagesTall
= 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>.Orientation
= xlLandscape ' </span>придаем<span style='mso-ansi-language:EN-US'> </span>листу<span
style='mso-ansi-language:EN-US'> </span>горизантальное<span style='mso-ansi-language:
EN-US'> </span>положение<span lang=EN-US style='mso-ansi-language:EN-US'> (</span>АЛЬБОМНЫЙ<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>If
MsgBox(&quot;</span>Печать<span style='mso-ansi-language:EN-US'> </span>текущего<span
style='mso-ansi-language:EN-US'> </span>изображения<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;, vbYesNo, &quot;</span>Вывод<span
style='mso-ansi-language:EN-US'> </span>на<span style='mso-ansi-language:EN-US'>
</span>печать<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;) = vbYes
Then Sheets(&quot;</span>Обложка<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;).PrintOut
Copies:=1, Collate:=True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Application.DisplayAlerts
= False ' </span>Выключили<span style='mso-ansi-language:EN-US'> </span>системные<span
style='mso-ansi-language:EN-US'> </span>сообщения<span lang=EN-US
style='mso-ansi-language:EN-US'>...<o:p></o:p></span></p>

<p class=MsoNormal>If MsgBox(&quot;Удалить лист ОБЛОЖКА&quot;, vbYesNo,
&quot;Удаление листа...&quot;) <span lang=EN-US style='mso-ansi-language:EN-US'>=
vbYes Then Sheets(&quot;</span>Обложка<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;).Delete Else Application.CommandBars(&quot;Picture&quot;).Visible
= True<o:p></o:p></span></p>

<p class=MsoNormal>Application.DisplayAlerts = True 'Включили системные
сообщения...</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863732">Игра «Минное поле»</a></h2>

<p class=MsoNormal>Листинг 6.2. Код в модуле рабочего листа</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
Worksheet_Selecti</span>о<span lang=EN-US style='mso-ansi-language:EN-US'>nchange(ByVal
Target As Range)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCol As Integer, intRow As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intMinesAround As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fInGameField As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определим, попадает ли в игровое
поле выделенная ячейка</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>fInGameField = (Target.Row &gt;= 2) And (Target.Row &lt;= 7) _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>And (Target.Column &gt;= 2) And
(Target.Column &lt;= 7)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Обрабатываем<span style='mso-ansi-language:
EN-US'> </span>выделение<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Target.Value = &quot;*&quot; And
fInGameField Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Пользователь выделил ячейку с
миной - покажем мину</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>    </span><span lang=EN-US style='mso-ansi-language:
EN-US'>Target.Font.Color = RGB(0, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Target.Interior.Color = RGB(255, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Пользователь<span
style='mso-ansi-language:EN-US'> </span>проиграл<span lang=EN-US
style='mso-ansi-language:EN-US'>!<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>EndGame<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf fInGameField Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Пользователь выделил пустую
ячейку. Оформим эту ячейку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>Target.Interior.Color = RGB(0, 0, 255)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Target.Font.Color = RGB(0, 255, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Target.Font.Size = 16<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Подсчитаем количество мин рядом
с ячейкой (вокруг ячейки)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For intCol = Target.Column - 1 To
Target.Column + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>For intRow = Target.Row - 1 To
Target.Row + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If Target.Worksheet.Cells(intRow,
intCol).Value = &quot;*&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span>Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>' </span>Нашли<span
style='mso-ansi-language:EN-US'> </span>очередную<span style='mso-ansi-language:
EN-US'> </span>мину<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intMinesAround = intMinesAround
+ 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Отображение
количества мин</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>    </span><span lang=EN-US style='mso-ansi-language:
EN-US'>Target.Value = intMinesAround<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Листинг 6.3. Код в стандартном модуле</p>

<p class=MsoNormal>Sub NewGame()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Начало новой игры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Подготовим поле
для игры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>InitGame<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer, intCol As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intMinesCount As Integer<span
style='mso-spacerun:yes'>    </span>' </span>Количество<span style='mso-ansi-language:
EN-US'> </span>мин<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Расставляем мины (то есть в
случайные ячейки помещаем _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>значения
&quot;*&quot; и делаем цвет шрифта таким же, как цвет _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>фона<span
style='mso-ansi-language:EN-US'> </span>этих<span style='mso-ansi-language:
EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For intMinesCount = 1 To 10<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Строка для мины (от 2 до 7)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intRow = Int((6
* Rnd) + 1) + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Столбец для
мины (от 2 до 7)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>intCol = Int((6
* Rnd) + 1) + 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Ставим мину,
если ячейка пустая</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Cells(intRow, intCol) &lt;&gt;
&quot;*&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Cells(intRow, intCol).Font.Color = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>Cells(intRow, intCol).Interior.Color<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>     </span>Cells(intRow, intCol).Value =
&quot;*&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' В данной
ячейке мина есть - продолжим поиск ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intMinesCount
= intMinesCount - 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод информации
о количестве мин в строку состояния</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Application.StatusBar = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>мин<span lang=EN-US style='mso-ansi-language:
EN-US'> &quot; &amp; intMinesCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal>Sub InitGame()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Раскраска
(оформление) листа перед началом игры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer, intCol As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Цвет<span style='mso-ansi-language:
EN-US'> </span>фона<span style='mso-ansi-language:EN-US'> </span>всех<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells.Interior.Color = RGB(0, 200, 75)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Цвет<span style='mso-ansi-language:
EN-US'> </span>шрифта<span style='mso-ansi-language:EN-US'> </span>всех<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells.Font.Color = RGB(0, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Размер<span style='mso-ansi-language:
EN-US'> </span>шрифта<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells.Font.Size = 18<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Все<span style='mso-ansi-language:
EN-US'> </span>надписи<span lang=EN-US style='mso-ansi-language:EN-US'> - </span>по<span
style='mso-ansi-language:EN-US'> </span>центру<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells.HorizontalAlignment = xlCenter<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Всем ячейкам игрового поля назначим
особый цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intRow = 2 To 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = 2 To 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>   </span>Cells(intRow, intCol).Interior.Color =
RGB(200, 200, 200)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Cells(intRow, intCol).Value =
&quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>Sub EndGame()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Завершение игры
(поражение)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer, intCol As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Покажем все мины. Для этого сделаем
цвет шрифта всех ячеек _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>черным (ведь во
всех ячейках с минами &quot;*&quot; цвет шрифта и цвет _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>заливки<span
style='mso-ansi-language:EN-US'> </span>одинаковы<span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For intRow = 2 To 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = 2 To 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If Cells(intRow, intCol).Value =
&quot;*&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Cells(intRow, intCol).Font.Color =
RGB(0, 0, 0)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>Проигрыш<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863733">Игра «Угадай животное»</a></h2>

<p class=MsoNormal>Листинг 6.4. Игра «Угадай животное»</p>

<p class=MsoNormal>Sub StartGame()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intLastRow As
Integer<span style='mso-spacerun:yes'>    </span>' Номер строки для вставки
записей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim intRow As Integer<span
style='mso-spacerun:yes'>        </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущей<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intYesRow As Integer<span
style='mso-spacerun:yes'>     </span>' Номер строки, из которой брать _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                 </span>данные при
утвердительном ответе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intNoRow As
Integer<span style='mso-spacerun:yes'>      </span>' Номер строки, из которой
брать _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span><span style='mso-spacerun:yes'>         </span>данные при отрицательном
ответе</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strText As
String<span style='mso-spacerun:yes'>        </span>' Строка с вопросом или
названием _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                 </span>животного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strNewName As
String<span style='mso-spacerun:yes'>     </span>' Строка с названием нового
животного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strNewQuestion As String ' </span>Строка<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>новым<span style='mso-ansi-language:EN-US'> </span>вопросом<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRes As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Начало игры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox &quot;Начнем
игру. Задумайте животное.&quot;, vbOKOnly, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;Задумайте
животное&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение
номера ряда для вставки записей. _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>intLastRow-1 -
номер последнего ряда, содержащего данные</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intLastRow =
Worksheets(&quot;Data&quot;).Range(&quot;D1&quot;).Value + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Данные в таблице идут с первого
ряда</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intRow = 1</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Do While intRow
&lt; intLastRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Текст вопроса
или название животного из столбца &quot;A&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strText =
Worksheets(&quot;Data&quot;).Cells(intRow, 1).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Номер ряда, из которого брать
данные при утвердительном _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>ответе, берем
из столбца &quot;B&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intYesRow =
Worksheets(&quot;Data&quot;).Cells(intRow, 2).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Номер ряда, из которого брать
данные при отрицательном _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>ответе, берем
из столбца &quot;C&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intNoRow =
Worksheets(&quot;Data&quot;).Cells(intRow, 3).Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>If intYesRow &gt; 0 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' В строке
strText содержится вопрос. Зададим его</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intRes =
MsgBox(strText, vbYesNo, &quot;Вопрос&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If intRes =
vbYes Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>' Переходим по утвердительному
ответу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>intRow =
intYesRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Переходим по отрицательному ответу</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intRow = intNoRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Альтернативы<span
style='mso-ansi-language:EN-US'> </span>закончились<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>В строке strText - название _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>животного.
Спросим, его ли загадали</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>intRes =
MsgBox(&quot;Это &quot; &amp; strText &amp; &quot;?&quot;, vbYesNo,
&quot;Вопрос&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If intRes = vbYes Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Животное<span
style='mso-ansi-language:EN-US'> </span>угадано<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>MsgBox &quot;Угадано!
Спасибо за игру!&quot;, vbOKOnly, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>     </span>&quot;Игра завершена&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>Exit Do</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Животное
не угадали, но данные уже занкончились. _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>Нужно
пополнить наши данные, чтобы отличать животное _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>с
названием strText от загаданного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Ввод названия
нового животного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>strNewName
= InputBox(&quot;Сдаюсь. Кто это?&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            
</span>&quot;Напечатайте название животного&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>If
strNewName &lt;&gt; &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>' Ввод
вопроса, по которому отличать животных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>              
</span>strNewQuestion = InputBox(&quot;Задайте вопрос, по &quot; &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&quot;которому можно отличить '&quot; &amp; strNewName &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&quot;' от '&quot; &amp; strText &amp; &quot;'&quot;, &quot;Напечатайте
вопрос&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>If
strNewQuestion &lt;&gt; &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span>'
Определение, какое из животных соответствует _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>утвердительному ответу на вопрос</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                 
</span>intRes = MsgBox(&quot;Правильный ответ на ваш &quot; &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>&quot;вопрос - &quot; &amp; strNewName &amp; &quot;'&quot;, vbYesNo, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>&quot;Какой ответ на вопрос?&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>     </span>' Добавление в таблицу названия нового
животного</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;Data&quot;).Cells(intLastRow,
1). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>Value = strNewName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span></span>' Перемещения названия
животного, которое было _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>ранее<span lang=EN-US style='mso-ansi-language:EN-US'>, </span>в<span
style='mso-ansi-language:EN-US'> </span>конец<span style='mso-ansi-language:
EN-US'> </span>таблицы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                 
</span>Worksheets(&quot;Data&quot;).Cells(intLastRow + 1, 1). </span>_</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>Value = strText</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span>'
Замена названия этого животного вопросом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;Data&quot;).Cells(intRow,
1). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>Value = strNewQuestion<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span></span>' Корректировка
номеров строк для перехода _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   </span>в
зависимости от того, какое животное является _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  
</span>правильным ответом на введенный пользователем вопрос</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span>If
intRes = vbYes Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>                    </span>' Новое животное -
правильный ответ</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                     </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;Data&quot;).Cells(intRow,
2). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>Value = intLastRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    
</span>Worksheets(&quot;Data&quot;).Cells(intRow, 3). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>Value = intLastRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                     </span>'
Бывшее ранее животное - правильный ответ</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                     </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;Data&quot;).Cells(intRow,
2). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>Value = intLastRow + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                    
</span>Worksheets(&quot;Data&quot;).Cells(intRow, 3). _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>Value = intLastRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span></span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span>'
Сохраним номер строки для добавления записей</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                  </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Worksheets(&quot;Data&quot;).Range(&quot;D1&quot;).Value
= _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>intLastRow + 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Игра<span
style='mso-ansi-language:EN-US'> </span>завершена<span lang=EN-US
style='mso-ansi-language:EN-US'>. </span>Таблица дополнена</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>MsgBox
&quot;Спасибо за игру!&quot;, vbOKOnly, &quot;Игра завершена&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Exit Do<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Loop</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863734">Расчет на основании ячеек определенного цвета</a></h2>

<p class=MsoNormal>Листинг 6.5. Код в стандартном модуле</p>

<p class=MsoNormal>Const dhcSum As Integer = 0</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcAvg As Integer = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcMax As Integer = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcMin As Integer = 3<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcCount As Integer = 4<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcSumPlus As Integer = 5<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcSumMinus As Integer = 6<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcCountFull As Integer = 7<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcCountNotNull As Integer = 8<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcCountPlus As Integer = 9<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Const
dhcCountMinus As Integer = 10<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CalcColors()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Отображение<span style='mso-ansi-language:
EN-US'> </span>формы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Load frmColorCalc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>frmColorCalc.Show<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public
Function ColorCalc(strRange As String, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lngColor As ****, fBackBolor As Boolean, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intMode As Integer, Optional fAbsence As
Boolean) As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Операции над ячейками с
установленным цветом шрифта _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>или заливки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgData As
Range<span style='mso-spacerun:yes'>     </span>' Диапазон ячеек для расчетов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim Values() As Variant ' </span>Массив<span
style='mso-ansi-language:EN-US'> </span>со<span style='mso-ansi-language:EN-US'>
</span>значениями<span style='mso-ansi-language:EN-US'> </span>для<span
style='mso-ansi-language:EN-US'> </span>расчета<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intCount As Integer ' Количество
значений в массиве</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim varOut As Variant<span
style='mso-spacerun:yes'>   </span>' </span>В<span style='mso-ansi-language:
EN-US'> </span>этой<span style='mso-ansi-language:EN-US'> </span>переменной<span
style='mso-ansi-language:EN-US'> </span>хранятся<span lang=EN-US
style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                            </span></span>результаты
промежуточных подсчетов _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>и окончательный результат</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgData = Range(strRange)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ReDim Values(1 To rgData.Count)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просматриваются все ячейки входного
диапазона. Значения тех из них, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>цвет которых
удовлетворяет условию, записываются в массив Values</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each cell In rgData.Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Если нужно суммировать по
заливке:</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If fBackBolor =
True Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Включение
ячейки в сумму в зависимости от цвета _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>заливки<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>фильтра<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If fAbsence Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Если ячейка имеет заданный
цвет, то она не включается _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>в<span
style='mso-ansi-language:EN-US'> </span>вычисления<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If cell.Interior.Color &lt;&gt;
lngColor Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intCount = intCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Values(intCount) = cell.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>' Если ячейка имеет заданный цвет, то
она включается _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span>в<span
style='mso-ansi-language:EN-US'> </span>вычисления<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If cell.Interior.Color = lngColor
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intCount = intCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Values(intCount) = cell.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' В противном
случае - суммируется по шрифту</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Включение
ячейки в сумму в зависимости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>от ее цвета
и фильтра</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>If fAbsence
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Если
ячейка имеет заданный цвет, то она не включается _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>      </span>в<span style='mso-ansi-language:EN-US'> </span>вычисления<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If cell.Font.Color &lt;&gt;
lngColor Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intCount = intCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Values(intCount) = cell.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Если
ячейка имеет заданный цвет, то она включается _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>        </span>в<span style='mso-ansi-language:EN-US'>
</span>вычисления<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If cell.Font.Color = lngColor Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>intCount = intCount + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Values(intCount) = cell.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next cell</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выполнение над
собранными значениями операции, заданной в intMode</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To intCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Select Case intMode<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcSum, dhcAvg</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
суммы значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>varOut = varOut + Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Case dhcSumPlus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Подсчет<span
style='mso-ansi-language:EN-US'> </span>суммы<span style='mso-ansi-language:
EN-US'> </span>положительных<span style='mso-ansi-language:EN-US'> </span>значений<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If Values(i) &gt; 0 Then varOut =
varOut + Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcSumMinus</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Посчет
суммы отрицательных значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Values(i) &lt; 0 Then varOut =
varOut + Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcMax</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Нахождение максимального значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Values(i) &gt; varOut Then varOut
= Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcMin</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>'
Нахождение минимального значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If i = LBound(Values) Then varOut =
Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If Values(i) &lt; varOut Then
varOut = Values(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcCount</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
количества значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>varOut =
varOut + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Case
dhcCountFull</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
количества заполненных ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Not IsEmpty(Values(i)) Then
varOut = varOut + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcCountNotNull</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
количества пустых ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Not IsEmpty(Values(i)) And
Values(i) &lt;&gt; 0 Then _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span></span>varOut = varOut + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Case
dhcCountPlus</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
количества положительных значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Values(i) &gt; 0 Then varOut =
varOut + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Case dhcCountMinus</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Подсчет
количества отрицательных значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If Values(i) &lt; 0 Then varOut =
varOut + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Окончательные
операции для некоторых видов расчета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If intMode = dhcAvg
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Вычисление
среднего значения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ColorCalc = varOut / intCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ColorCalc = varOut<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
6.6. </span>Код в модуле формы</p>

<p class=MsoNormal>Dim lngCurColor As **** ' Выбранный цвет, по которому _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>                     </span>идентифицировать
(отбирать) ячейки</p>

<p class=MsoNormal>Dim intMode As Integer<span style='mso-spacerun:yes'> 
</span>' Номер типа вычисления в списке</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
cmbApplyColor_Click()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If cboOtherColor.Value &gt;= 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Вычисление с использованием
выбранного в списке цвета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngCurColor = cboOtherColor.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
cmbColor1_Click()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вычисление с использованием цвета
нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor1.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor2_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor2.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor3_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor3.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor4_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с использованием
цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor4.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor5_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor5.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor6_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span>' Вычисление с использованием цвета нажатой
кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor6.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor7_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor7.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor8_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor8.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor9_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor9.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor10_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor10.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor11_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor11.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cmbColor12_Click()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием цвета нажатой кнопки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngCurColor = cmbColor12.BackColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>SetColorSum<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub SetColorSum()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление с
использованием заданного цвета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strFormula As
String</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка
правильности введенных диапазонов и номеров ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If txtResCell.Value
= &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите адрес ячейки вставки функции&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>vbCritical, &quot;</span>Внимание<span
lang=EN-US style='mso-ansi-language:EN-US'>!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>txtResCell.SetFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf txtRange.Value = &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Введите<span
style='mso-ansi-language:EN-US'> </span>адрес<span style='mso-ansi-language:
EN-US'> </span>диапазона<span style='mso-ansi-language:EN-US'> </span>суммирования<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>vbCritical, &quot;</span>Внимание<span
lang=EN-US style='mso-ansi-language:EN-US'>!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>txtRange.SetFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Формирование<span style='mso-ansi-language:
EN-US'> </span>формулы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFormula = &quot;=ColorCalc(&quot; &amp;
&quot;&quot;&quot;&quot; &amp; txtRange.Value &amp; &quot;&quot;&quot;&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&amp; &quot;,&quot; &amp; lngCurColor &amp;
&quot;,&quot; &amp; CInt(tglType.Value) &amp; &quot;,&quot; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&amp; intMode &amp; &quot;,&quot; &amp;
CInt(chkVarify.Value) &amp; &quot;)&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Запись<span style='mso-ansi-language:
EN-US'> </span>формулы<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>ячейку<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(txtResCell.Value).Formula = strFormula<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
cmbExit_Click()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Закрытие<span style='mso-ansi-language:
EN-US'> </span>формы<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Unload Me<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cboCalcTypes_Afterupdаtе()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение режима
вычисления - сохраним в переменной _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>номер<span
style='mso-ansi-language:EN-US'> </span>вычисления<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intMode = cboCalcTypes.ListIndex<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Sub cboOtherColor_Change()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Изменение
выделенного цвета в списке &quot;Другой&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If
cboOtherColor.Text &lt;&gt; &quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Сохранение
выбранного цвета в переменной</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngCurColor =
Val(cboOtherColor.Value)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
tglType_Click()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Изменение типа идентификации ячеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If tglType.Value =
-1 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Идентификация
по цвету заливки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>tglType.Caption
= &quot;Заливка&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Идентификация
по цвету шрифта</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>tglType.Caption = &quot;</span>Шрифт<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>GetColors<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
txtRange_Afterupd</span>а<span lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span
lang=EN-US style='mso-ansi-language:EN-US'>()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Изменение диапазона с исходными
данными - покажем _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>кнопки с цветами,
представленными в новом диапазоне</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>GetColors<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
txtRange_Beforeupd</span>а<span lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span
lang=EN-US style='mso-ansi-language:EN-US'>(ByVal Cancel As
MSForms.ReturnBoolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка корректности данных,
введенных в поле _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>диапазона исходных
данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgData As Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim cell As Range</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка, введен
ли диапазон данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If txtRange.Text =
&quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите адрес диапазона суммирования!&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>vbCritical, &quot;</span>Ошибка<span
style='mso-ansi-language:EN-US'> </span>выполнения<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If txtResCell.Text = &quot;&quot; Then Exit
Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo Err1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка отсутствия
циклических ссылок (чтобы одна _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>из входных ячеек
не была одновременно и выходной)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgData = Range(txtRange.Text)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In rgData.Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Address(False, False) = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Range(txtResCell.Text).Address(False,
False) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Нашли циклическую ссылку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>MsgBox
&quot;Введите другой адрес во избежание &quot; &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         
</span>&quot;появления циклических ссылок&quot;, vbCritical, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         
</span>&quot;Внимание!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Err1:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Обработка ошибок при работе с
ячейками</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If Err.Number =
1004 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите корректный адрес ячейки&quot;, vbCritical, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Ошибка<span
style='mso-ansi-language:EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox Err.Des</span>с<span lang=EN-US
style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US style='mso-ansi-language:
EN-US'>tion, vbCritical, &quot;</span>Ошибка<span style='mso-ansi-language:
EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
txtResCell_Beforeupd</span>а<span lang=EN-US style='mso-ansi-language:EN-US'>t</span>е<span
lang=EN-US style='mso-ansi-language:EN-US'>(ByVal Cancel As
MSForms.ReturnBoolean)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Проверка корректности данных,
введенных в поле _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>адреса выходной
ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgData As Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim cell As Range</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка, введен
ли диапазон данных</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If txtRange.Text =
&quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите адрес диапазона суммирования!&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>vbCritical, &quot;</span>Ошибка<span
style='mso-ansi-language:EN-US'> </span>выполнения<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If txtResCell.Text = &quot;&quot; Then Exit
Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo Err1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>  </span>' Проверка отсутствия циклических ссылок
(чтобы одна _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>из входных ячеек
не была одновременно и выходной)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set rgData = Range(txtRange.Text)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In rgData.Cells<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Address(False, False) = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span>Range(txtResCell.Text).Address(False,
False) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Нашли циклическую ссылку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>MsgBox
&quot;Введите другой адрес во избежание &quot; &amp; _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         
</span>&quot;появления циклических ссылок&quot;, vbCritical, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         
</span>&quot;Внимание!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next cell<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Err1:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Обработка ошибок при работе с
ячейками</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If Err.Number =
1004 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите корректный адрес ячейки&quot;, vbCritical, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>Ошибка<span
style='mso-ansi-language:EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox Err.Des</span>с<span lang=EN-US
style='mso-ansi-language:EN-US'>ri</span>р<span lang=EN-US style='mso-ansi-language:
EN-US'>tion, vbCritical, &quot;</span>Ошибка<span style='mso-ansi-language:
EN-US'> </span>ввода<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Cancel = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
UserForm_Activate()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Инициализация формы при активации</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intFunc As
Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strFunc As
String</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполение списка
доступных операций</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cboCalcTypes.AddItem &quot;0&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(0, 1) = &quot;</span>Сумма<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;1&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(1, 1) = &quot;</span>Среднее<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;2&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(2, 1) = &quot;</span>Максимум<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;3&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(3, 1) = &quot;</span>Минимум<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;4&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(4, 1) = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;5&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(5, 1) = &quot;</span>Сумма<span
style='mso-ansi-language:EN-US'> </span>положительных<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;6&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(6, 1) = &quot;</span>Сумма<span
style='mso-ansi-language:EN-US'> </span>отрицательных<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;7&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(7, 1) = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>непустых<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;8&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(8, 1) = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>непустых<span style='mso-ansi-language:
EN-US'> </span>ненулевых<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;9&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(9, 1) = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>положительных<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.AddItem &quot;10&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboCalcTypes.List(10, 1) = &quot;</span>Количество<span
style='mso-ansi-language:EN-US'> </span>отрицательных<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение списка дополнительных
цветов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>cboOtherColor.AddItem &quot;255&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cboOtherColor.List(0, 1) = &quot;</span>Красный<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;52479&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(1, 1) = &quot;</span>Оранжевый<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;65535&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(2, 1) = &quot;</span>Желтый<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;32768&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(3, 1) = &quot;</span>Зеленый<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;16776960&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(4, 1) = &quot;</span>Голубой<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;16711680&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(5, 1) = &quot;</span>Синий<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;16711935&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(6, 1) = &quot;</span>Фиолетовый<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;16777215&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(7, 1) = &quot;</span>Белый<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.AddItem &quot;0&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cboOtherColor.List(8, 1) = &quot;</span>Черный<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If Selection.Cells.Count = 1 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' На листе есть выделенная ячейка.
Определим, есть ли в этой _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>ячейке<span
style='mso-ansi-language:EN-US'> </span>формула<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>функцией<span
lang=EN-US style='mso-ansi-language:EN-US'> ColorCalc<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intFunc = InStr(Selection.Formula,
&quot;ColorCalc(&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>If intFunc &gt; 0 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Формула
есть, заполним поля формы для вычислений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>' </span>Адрес<span
style='mso-ansi-language:EN-US'> </span>ячейки<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>результатом<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>txtResCell.Text =
Selection.Address(False, False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Выделяем аргументы функции...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Номера
ячеек с исходными данными</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strFunc = Mid(Selection.Formula,
intFunc + 11)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intFunc = InStr(strFunc,
&quot;&quot;&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>txtRange.Text = Left(strFunc, intFunc
- 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Тип идентификации ячеек (по
шрифту или цвету)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strFunc = Mid(strFunc, intFunc + 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intFunc = InStr(strFunc,
&quot;,&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strFunc = Mid(strFunc, intFunc + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intFunc = InStr(strFunc,
&quot;,&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>tglType.Value = Left(strFunc, intFunc
- 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Режим<span style='mso-ansi-language:
EN-US'> </span>вычислений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strFunc = Mid(strFunc, intFunc + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strFunc = Left(strFunc, Len(strFunc) -
1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intFunc = InStr(strFunc,
&quot;,&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>cboCalcTypes.Text =
cboCalcTypes.List(Val(Left$( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>strFunc, intFunc - 1)), 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strFunc = Mid(strFunc, intFunc + 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>chkVarify.SetFocus<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>chkVarify.Value = CBool(strFunc)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>lblChoose.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>GetColors<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Будем<span style='mso-ansi-language:
EN-US'> </span>применять<span style='mso-ansi-language:EN-US'> </span>формулу<span
style='mso-ansi-language:EN-US'> </span>для<span style='mso-ansi-language:EN-US'>
</span>выделенной<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>txtRange.Value =
Selection.Address(False, False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' В выделенной ячейке
конкретная функция не задана. _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>Выберем
первую функцию в списке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        
</span>cboCalcTypes.Text = &quot;Сумма&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Будем
применять формулу для выделенной ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>txtRange.Value =
Selection.Address(False, False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' В выделенной ячейке конкретная
функция не задана. _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>Выберем первую
функцию в списке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>cboCalcTypes.Text = &quot;Сумма&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
GetColors()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Отображение кнопок выбора цвета
окрашенными в цвета, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>встречающиеся
среди ячеек заданного диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim rgCells As
Range</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intColorNumber As Integer<span
style='mso-spacerun:yes'>   </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>следующей<span style='mso-ansi-language:EN-US'> </span>кнопки<span
lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span></span>выбора
цвета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim lngCurColor As
****<span style='mso-spacerun:yes'>         </span>' Анализируемый цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim fColorPresented As Boolean<span
style='mso-spacerun:yes'>  </span>' </span>Кнопка<span style='mso-ansi-language:
EN-US'> </span>с<span style='mso-ansi-language:EN-US'> </span>цветом<span
lang=EN-US style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span>lngCurColor
</span>уже<span style='mso-ansi-language:EN-US'> </span>существует<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim ctrl As Control<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCtrl As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fBackColor As Boolean<span
style='mso-spacerun:yes'>       </span>' = True, </span>если<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'> _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                    </span></span>идентифицируются
по цвету фона, _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                    </span>= False -
по цвету шрифта</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>fBackColor = tglType.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Скрытие всех кнопок выбора цвета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For Each ctrl In Me.Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Left(ctrl.Name, 8) =
&quot;cmbColor&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>ctrl.Visible = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next ctrl<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>On Error GoTo ErrRange<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set rgCells = Range(txtRange.Text)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>On Error GoTo 0</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение цвета
первой ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If fBackColor = False Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>lngCurColor = rgCells.Cells(i).Font.Color<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>lngCurColor =
rgCells.Cells(i).Interior.Color<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Назначения цвета
первой ячейки первой кнопке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>cmbColor1.BackColor = lngCurColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>cmbColor1.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Просмотр остальных ячеек и при
нахождении новых цветов _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>отображение
кнопок, окрашенных в эти цвета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intColorNumber = 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For i = 2 To rgCells.Cells.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>fColorPresented = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Получение<span style='mso-ansi-language:
EN-US'> </span>цвета<span lang=EN-US style='mso-ansi-language:EN-US'> i-</span>й<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fBackColor = False Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>lngCurColor =
rgCells.Cells(i).Font.Color<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>lngCurColor =
rgCells.Cells(i).Interior.Color<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Проверка,
отображается ли уже кнопка с таким цветом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For Each ctrl In Me.Controls<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If Left(ctrl.Name, 8) =
&quot;cmbColor&quot; And _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>ctrl.Visible = True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>If lngCurColor = ctrl.BackColor
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Кнопка с цветом i-й ячейки
уже отображается</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>fColorPresented = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Exit For<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next ctrl<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not fColorPresented Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Кнопки с цветом lngCurColor
еще нет - покажем ее</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>intColorNumber = intColorNumber + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCtrl = &quot;cmbColor&quot; &amp;
intColorNumber<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Me.Controls(strCtrl).BackColor =
lngCurColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Me.Controls(strCtrl).Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>ErrRange:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Обработка ошибок при работе с
диапазоном</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If txtRange.Text =
&quot;&quot; Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введите адрес диапазона суммирования&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>vbCritical,
&quot;Внимание!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>MsgBox
&quot;Введен некорректный адрес диапазона суммирования&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>vbCritical,
&quot;Ошибка!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Установка курсора
в поле ввода диапазона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>txtRange.SetFocus</p>

<p class=MsoNormal>End Sub</p>

<h1><a name="_Toc315863735">ГЛАВА 11. ДРУГИЕ ФУНКЦИИ И МАКРОСЫ</a></h1>

<h2><a name="_Toc315863736">Вызов функциональных клавиш</a></h2>

<p class=MsoNormal>Sub Test()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>SendKeys
(&quot;{F1}&quot;)</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863737">Расчет среднего арифметического значения</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
CalculateAverage()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFistCell As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strLastCell As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strFormula As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Условия закрытия процедуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If ActiveCell.Row =
1 Then Exit Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Определение
положения первой и последней ячеек для расчета</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strFistCell = ActiveCell.Offset(-1,
0).End(xlUp).Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strLastCell = ActiveCell.Offset(-1,
0).Address<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Формула<span style='mso-ansi-language:
EN-US'> </span>для<span style='mso-ansi-language:EN-US'> </span>расчета<span
style='mso-ansi-language:EN-US'> </span>среднего<span style='mso-ansi-language:
EN-US'> </span>значения<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strFormula = &quot;=AVERAGE(&quot; &amp;
strFistCell &amp; &quot;:&quot; &amp; strLastCell &amp; &quot;)&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Ввод<span style='mso-ansi-language:
EN-US'> </span>формулы<span style='mso-ansi-language:EN-US'> </span>в<span
style='mso-ansi-language:EN-US'> </span>текущую<span style='mso-ansi-language:
EN-US'> </span>ячейку<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveCell.Formula = strFormula<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863738">Перевод</a><span style='mso-bookmark:_Toc315863738'><span
style='mso-ansi-language:EN-US'> </span>чисел</span><span style='mso-bookmark:
_Toc315863738'><span style='mso-ansi-language:EN-US'> </span>в</span><span
style='mso-bookmark:_Toc315863738'><span lang=EN-US style='mso-ansi-language:
EN-US'> «</span>деньги</span><span style='mso-bookmark:_Toc315863738'><span
lang=EN-US style='mso-ansi-language:EN-US'>»</span></span><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.50. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'> RubKop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
RubKop(</span>Число<span lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Пустые ячейки и ячейки, содержащие
текст, функция _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>не<span
style='mso-ansi-language:EN-US'> </span>обрабатывает<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If IsNumeric(</span>Число<span lang=EN-US
style='mso-ansi-language:EN-US'>) = False Or </span>Число<span lang=EN-US
style='mso-ansi-language:EN-US'> = &quot;&quot; Then RubKop = _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&quot;&lt;&gt;&quot;: Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Из числа целой части - рубли</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ДлинаЧисла =
Len(Число)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ЦелаяЧасть =
Fix(Число)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ДлинаЦелой =
Len(ЦелаяЧасть)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление длины
дробной части</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ДлинаДроби =
ДлинаЧисла - ДлинаЦелой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If ДлинаДроби
&lt;&gt; 0 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>ДлинаДроби =
ДлинаЧисла - ДлинаЦелой - 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Формирование количества
копеек в зависимости от длины _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>дробной части</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If ДлинаДроби = 0
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Ноль копеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Копейки =
&quot;00&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ElseIf ДлинаДроби =
1 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Дробная часть
состоит из одного числа - это _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>десятки копеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Копейки =
Right(Число, ДлинаДроби) &amp; &quot;0&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>ElseIf ДлинаДроби =
2 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Дробная часть
полностью соответствует количеству копеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Копейки =
Right(Число, ДлинаДроби)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Длина дробной
части больше двух - округлим _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>дробную часть</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Копейки = Right(Число,
ДлинаДроби)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If Mid(Копейки,
3, 1) &gt; 4 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Копейки =
Left(Копейки, 2) + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>Копейки<span lang=EN-US
style='mso-ansi-language:EN-US'> = Left(</span>Копейки<span lang=EN-US
style='mso-ansi-language:EN-US'>, 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Составление
полной надписи из количества рублей и копеек</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Рубли = ЦелаяЧасть</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>RubKop = Рубли
&amp; &quot; &quot; &amp; &quot;руб.&quot; &amp; &quot; &quot; &amp; Копейки
&amp; &quot; &quot; &amp; &quot;коп.&quot;</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863739">Поиск ближайшего понедельника</a></h2>

<p class=MsoNormal>Листинг 2.60. Ближайший день недели по отношению к дате</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetNextMonday(datDate As Date) As Date<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определение даты следующего
понедельника (функция Weekday _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>возвращает номер
дня недели, считая от понедельника, если _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>в качестве второго
аргумента задавать vbMonday)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If Weekday(datDate,
vbMonday) = 1 Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Заданная дата
и есть понедельник</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>dhGetNextMonday
= datDate</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Расчет даты
следующего понедельника</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhGetNextMonday = datDate + 8 -
Weekday(datDate, vbMonday)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863740">Подсчет количества полных лет</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.61. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
dhCalculateAge<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhCalculateAge(datDate As Date) As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim lngAge As ****</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Находим разность
между текущей датой и указанной (лет)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>lngAge = DateDiff(&quot;yyyy&quot;, datDate,
Date)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If DateSerial(Year(datDate) + lngAge,
Month(datDate), _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>Day(datDate)) &gt; Date Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' В этом году
день рождения еще не наступил</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngAge = lngAge - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhCalculateAge = lngAge<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863741">Расчет средневзвешенного значения</a></h2>

<p class=MsoNormal>Листинг 2.63. Расчет<span style='mso-ansi-language:EN-US'> </span>средневзвешенного<span
style='mso-ansi-language:EN-US'> </span>значения<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhAverageWithWeight(rgWeights As Range, rgValues As Range) _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>As Double<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If (rgWeights.Count &lt;&gt; rgValues.Count)
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Количество весов не
соответствует количеству аргументов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhAverageWithWeight = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Exit Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim dblSum As Double<span
style='mso-spacerun:yes'>        </span>' </span>Сумма<span style='mso-ansi-language:
EN-US'> </span>значений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim dblSumWeight As Double<span
style='mso-spacerun:yes'>  </span>' Взвешенная сумма значений</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вычисление...</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To rgWeights.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Взвешенной<span
style='mso-ansi-language:EN-US'> </span>суммы<span style='mso-ansi-language:
EN-US'> </span>значений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dblSumWeight = dblSumWeight +
rgWeights(i) * rgValues(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Суммы<span style='mso-ansi-language:
EN-US'> </span>значений<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dblSum = dblSum + rgWeights(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Возвращение<span style='mso-ansi-language:
EN-US'> </span>средневзвешенного<span style='mso-ansi-language:EN-US'> </span>значения<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhAverageWithWeight = dblSumWeight / dblSum<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863742">Преобразование номера месяца в его название</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.64. </span>Название<span style='mso-ansi-language:EN-US'> </span>месяца<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhMonthName(intMonth As Integer) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возвращение имени месяца по его
номеру (intMonth _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>является номером
элемента в массиве с названиями месяцев)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhMonthName = Choose(intMonth, &quot;</span>Январь<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>Февраль<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>Март<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>&quot;Апрель&quot;, &quot;Май&quot;,
&quot;Июнь&quot;, &quot;Июль&quot;, &quot;Август&quot;, &quot;Сентябрь&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   
</span>&quot;Октябрь&quot;, &quot;Ноябрь&quot;, &quot;Декабрь&quot;)</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863743">Использование относительных ссылок</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.73. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
dhSheetOffset<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSheetOffset(offset As Integer, cell As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возврат корректного значения ячейки
cell листа, смещение _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>которого
относительно текущего задано переменной offset</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>dhSheetOffset =
Sheets(Application.Caller.Parent.Index _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>+ offset).Range(cell.Address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.74. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
dhSheetOffset2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhSheetOffset2(offset As Integer, cell As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Корректировка смещения (чтобы
ссылка была на рабочий лист)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Do While TypeName(Sheets(cell.Parent.Index +
offset)) _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>&lt;&gt; &quot;Worksheet&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>If offset &gt; 0
Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Пропускаем
лист и проходим вперед по книге</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>offset =
offset + 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Пропускаем
лист и проходим назад по книге</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>offset =
offset - 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Loop</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Возврат
корректного значения ячейки cell листа, смещение _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>которого
относительно текущего задано переменной offset _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>с пропуском листов
с диаграммами</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhSheetOffset2 =
Sheets(cell.Parent.Index _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>+ offset).Range(cell.Address)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2><a name="_Toc315863744">Преобразование таблицы Excel в HТМL-формат</a></h2>

<p class=MsoNormal>Листинг 3.60. Преобразование таблицы в HТМL-формат</p>

<p class=MsoNormal>Sub ExportAsHТМL()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strStyle As
String<span style='mso-spacerun:yes'>     </span>' Параметры стиля отображения
ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strAlign As
String<span style='mso-spacerun:yes'>     </span>' Параметры выравнивания
ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim strOut As
String<span style='mso-spacerun:yes'>       </span>' Выходная строка с
HТМL-кодом</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Object<span
style='mso-spacerun:yes'>         </span>' </span>Обрабатываемая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strCellText As String<span
style='mso-spacerun:yes'>  </span>' </span>Текст<span style='mso-ansi-language:
EN-US'> </span>обрабатываемой<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngRow As ****<span
style='mso-spacerun:yes'>         </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>строки<span style='mso-ansi-language:EN-US'> </span>обрабатываемой<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim lngLastRow As ****<span
style='mso-spacerun:yes'>     </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>строки<span style='mso-ansi-language:EN-US'> </span>предыдущей<span
style='mso-ansi-language:EN-US'> </span>ячейки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strTemp As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim objWordApp As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As ****<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>lngLastRow = Selection.Row<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Просмотр<span style='mso-ansi-language:
EN-US'> </span>всех<span style='mso-ansi-language:EN-US'> </span>выделенных<span
style='mso-ansi-language:EN-US'> </span>ячеек<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>  </span>For
Each cell In Selection<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Значение строки для
рассматриваемой ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>lngRow =
cell.Row</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Если перешли
на другую строку, то вставляем &lt;tr&gt;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If lngRow &lt;&gt; lngLastRow Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strOut = strOut &amp; vbTab &amp;
&quot;&lt;/tr&gt;&quot; &amp; vbCrLf &amp; vbTab &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span></span>&quot;&lt;tr&gt;&quot; &amp;
vbCrLf</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Переход на
следующую строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>lngLastRow = lngRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Задание<span style='mso-ansi-language:
EN-US'> </span>шрифта<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If Not IsNull(cell.Font.Size) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strStyle = &quot; style=&quot; &amp;
&quot;font-size: &quot; &amp; Int(100 * _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>cell.Font.Size / 19) &amp;
&quot;%;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Для<span style='mso-ansi-language:
EN-US'> </span>полужирного<span style='mso-ansi-language:EN-US'> </span>шрифта<span
style='mso-ansi-language:EN-US'> </span>вставляем<span lang=EN-US
style='mso-ansi-language:EN-US'> &lt;b&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.Font.Bold Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCellText = &quot;&lt;b&gt;&quot;
&amp; strCellText &amp; &quot;&lt;/b&gt;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Задание<span style='mso-ansi-language:
EN-US'> </span>выравнивания<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If cell.HorizontalAlignment = xlRight
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>По<span style='mso-ansi-language:
EN-US'> </span>правому<span style='mso-ansi-language:EN-US'> </span>краю<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strAlign = &quot; align=&quot; &amp;
&quot;right&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>ElseIf cell.HorizontalAlignment =
xlCenter Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>По<span style='mso-ansi-language:
EN-US'> </span>центру<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strAlign = &quot; align=&quot; &amp;
&quot;center&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' По левому
краю (по умолчанию)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>strAlign =
&quot;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Чтение текста
в ячейке</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>strCellText =
cell.Text</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Если нужно, то
вертикальный вывод текста (в строку strTemp _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>с последующим
перенесением обратно в strCellText)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If cell.Orientation &lt;&gt;
xlHorizontal Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>   </span>strTemp = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Печать после каждого символа
специального _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>разделителя<span
lang=EN-US style='mso-ansi-language:EN-US'> - &lt;br&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>For i = 1 To Len(strCellText)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>strTemp = strTemp &amp;
Mid$(strCellText, i, 1) &amp; &quot;&lt;br&gt;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Next i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>strCellText = strTemp<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>    </span>strStyle = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strOut = strOut &amp; vbTab &amp; vbTab
&amp; &quot;&lt;td&quot; &amp; strStyle &amp; strAlign _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span></span>&amp; &quot;&gt;&quot; &amp;
strCellText &amp; &quot;&lt;/td&gt;&quot; &amp; vbCrLf</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вставка
&lt;tr&gt; для первой строки и &lt;/tr&gt; - для последней</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strOut = vbTab &amp; &quot;&lt;tr&gt;&quot;
&amp; vbCrLf &amp; strOut &amp; vbTab &amp; &quot;&lt;/tr&gt;&quot; &amp;
vbCrLf<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Вставка<span style='mso-ansi-language:
EN-US'> </span>дескриптора<span lang=EN-US style='mso-ansi-language:EN-US'>
&lt;table&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strOut = &quot;&lt;table border=1
cellpadding=3 cellspacing=1&gt;&quot; &amp; vbCrLf &amp; _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>strOut &amp; vbCrLf &amp;
&quot;&lt;/table&gt;&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Запускаем Word и
показываем в нем сформированный HТМL-код</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set objWordApp = CreateObject(&quot;Word.Application&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>objWordApp.documents.Add<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>objWordApp.Selection = strOut<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>objWordApp.Selection.Copy<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>objWordApp.Visible = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set objWordApp = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863745">Генератор</a><span style='mso-bookmark:_Toc315863745'><span
style='mso-ansi-language:EN-US'> </span>случайных</span><span style='mso-bookmark:
_Toc315863745'><span style='mso-ansi-language:EN-US'> </span>чисел</span><span
style='mso-bookmark:_Toc315863745'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.77. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
dhGetRandomValues<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetRandomValues() As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущей<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCol As Integer<span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущего<span style='mso-ansi-language:EN-US'> </span>столбца<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim aintOut() As Integer<span
style='mso-spacerun:yes'>    </span>' Выходной массив (двумерный)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim aintValues() As
Integer ' Массив с возможными значениями</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intMax As
Integer<span style='mso-spacerun:yes'>       </span>' Последний доступный
элемент массива _</p>

<p class=MsoNormal><span
style='mso-spacerun:yes'>                                </span><span
lang=EN-US style='mso-ansi-language:EN-US'>aintValues<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ReDim aintOut(1 To
Application.Caller.Rows.Count, 1 To _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.Caller.Columns.Count)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Всего<span style='mso-ansi-language:
EN-US'> </span>нужно<span style='mso-ansi-language:EN-US'> </span>чисел<span
lang=EN-US style='mso-ansi-language:EN-US'>...<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intMax = Application.Caller.Rows.Count * _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.Caller.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ReDim aintValues(1 To intMax)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение массива aintValues
значениями от 1 до intMax</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For i = 1 To intMax<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>aintValues(i) = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next i</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Занесение
значений в выходной массив aintOut, в произвольном _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>порядке выбирая их
из aintValues</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Randomize</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intRow = 1 To Application.Caller.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = 1 To
Application.Caller.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Определение номера элемента
из aintValues</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>i = Rnd * intMax<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If i = 0 Then i = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Занесение этого элемента в
выходной массив</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>aintOut(intRow, intCol) =
aintValues(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Уменьшение массива aintValues
(то есть еще один его _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>элемент
выбран) - замена выбранного элемента последним _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span>в<span
style='mso-ansi-language:EN-US'> </span>массиве<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>aintValues(i) = aintValues(intMax)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intMax = intMax - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next intCol<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next intRow<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Возвращение массива значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhGetRandomValues =
aintOut</p>

<p class=MsoNormal>End Function</p>

<h2><a name="_Toc315863746">Случайные числа — на основании диапазона</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
2.78. </span>Функция<span lang=EN-US style='mso-ansi-language:EN-US'>
dhGetRandomValues1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetRandomValues1(rgSource As Range) As Variant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRow As Integer<span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущей<span style='mso-ansi-language:EN-US'> </span>строки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intCol As Integer<span
style='mso-spacerun:yes'>       </span>' </span>Номер<span style='mso-ansi-language:
EN-US'> </span>текущего<span style='mso-ansi-language:EN-US'> </span>столбца<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim avarOut() As Variant<span
style='mso-spacerun:yes'>    </span>' </span>Выходной<span style='mso-ansi-language:
EN-US'> </span>массив<span lang=EN-US style='mso-ansi-language:EN-US'> (</span>двумерный<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim avarValues() As Variant ' </span>Массив<span
style='mso-ansi-language:EN-US'> </span>с<span style='mso-ansi-language:EN-US'>
</span>возможными<span style='mso-ansi-language:EN-US'> </span>значениями<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intValCount As Integer<span
style='mso-spacerun:yes'>  </span>' Количество возможных значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim cell As Range<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ReDim avarOut(1 To Application.Caller.Rows.Count,
1 To _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Application.Caller.Columns.Count)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Всего<span style='mso-ansi-language:
EN-US'> </span>нужно<span style='mso-ansi-language:EN-US'> </span>чисел<span
lang=EN-US style='mso-ansi-language:EN-US'>...<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intValCount = rgSource.Rows.Count *
rgSource.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>ReDim avarValues(1 To intValCount)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Заполнение
массива avarValues значениями из указанного _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>диапазона<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For Each cell In rgSource<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>i = i + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>avarValues(i) = cell.Value<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next cell</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Занесение
значений в выходной массив avarOut, в произвольном _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>порядке выбирая их
из avarValues</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Randomize</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intRow = 1 To Application.Caller.Rows.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>For intCol = 1 To
Application.Caller.Columns.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Определение номера элемента
из avarValues</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>i = Rnd * intValCount<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>If i = 0 Then i = 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Занесение этого элемента в
выходной массив</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>avarOut(intRow, intCol) =
avarValues(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next intCol</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Next intRow</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Возвращение
массива значений</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>dhGetRandomValues1
= avarOut</p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863747">Применение функции без ввода ее в ячейку</a></h2>

<p class=MsoNormal>Листинг 3.14. Применение функции без ввода в ячейку</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Func()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'> </span>[A1] =
Application.Sum([B5:B10])<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863748">Подсчет именованных объектов</a></h2>

<p class=MsoNormal>Листинг 3.29. Количество именованных объектов</p>

<p class=MsoNormal>Sub CountNames()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim intNamesCount
As Integer</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получаем и
отображаем количество имен в активной _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>рабочей<span
style='mso-ansi-language:EN-US'> </span>книге<span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intNamesCount = ActiveWorkbook.Names.Count<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intNamesCount = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Имен<span
style='mso-ansi-language:EN-US'> </span>нет<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>MsgBox &quot;</span>Имен<span lang=EN-US
style='mso-ansi-language:EN-US'>: &quot; &amp; intNamesCount &amp; &quot; </span>шт<span
lang=EN-US style='mso-ansi-language:EN-US'>.&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863749">Включение автофильтра с помощью макроса</a></h2>

<p class=MsoNormal>Листинг 3.63. Включение автофильтра</p>

<p class=MsoNormal>Sub EnableAutoFilter()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>On Error Resume Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Selection.AutoFilter<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863750">Создание бегущей строки</a></h2>

<p class=MsoNormal>Листинг 3.76. Создание бегущей строки</p>

<p class=MsoNormal>Dim intSpacesLeft As Integer<span style='mso-spacerun:yes'> 
</span>' Количество пробелов в начале строки</p>

<p class=MsoNormal>Sub Start()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Установка
начального количества пробелов</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>intSpacesLeft = 10</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Первый вызов
функции бегущей строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MovingString<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
MovingString()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intSpacesLeft &gt;= 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Отображение<span
style='mso-ansi-language:EN-US'> </span>строки<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Range(&quot;A1&quot;).Value =
Space(intSpacesLeft) &amp; &quot;</span>Привет<span lang=EN-US
style='mso-ansi-language:EN-US'>!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>intSpacesLeft = intSpacesLeft - 1</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>  </span>' Указывем Excel, что данную процедуру нужно
вызвать через _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
lang=EN-US style='mso-ansi-language:EN-US'>1 </span>секунду<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Application.OnTime Now +
TimeValue(&quot;00:00:01&quot;), &quot;MovingString&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863751">Создание бегущей картинки</a></h2>

<p class=MsoNormal>Листинг 3.77. Бегущая картинка</p>

<p class=MsoNormal>Sub MovingImage()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim i As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim image As Object<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Создание изображения (в ячейке
&quot;A1&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>With
Range(&quot;A1&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Формирование
значения в ячейке:</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' текст</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Value =
&quot;Привет!&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' полужирный
шрифт</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.Font.Bold = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>цвет<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Font.Color = RGB(233, 133, 229)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' размер шрифта</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Font.Size = 16</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' угол наклона</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Orientation =
30</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Отображение
текста полностью</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     
</span>.EntireColumn.AutoFit</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Копирование в
буфер обмена</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Copy</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Создание
самостоятельного изображения (на основе _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span>скопированных в
буфер обмена данных)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Set image =
ActiveSheet.Pictures.Paste(Link:=False)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Содержимое ячейки больше не
нужно</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>.Clear</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Задание
начального положения изображения (левый верхний _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>угол<span
style='mso-ansi-language:EN-US'> </span>листа<span lang=EN-US style='mso-ansi-language:
EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>With image<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Top = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>.Left = 0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>MsgBox &quot;</span>ПУСК<span lang=EN-US
style='mso-ansi-language:EN-US'>!&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>With image</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Перемещение
изображения по диагонали</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For i = 0 To 100<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Top = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Left = i<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>Next</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Удаление
изображения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'> </span>.Delete</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End With</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление ссылки
на изображение</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set image = Nothing<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863752">Вращающиеся</a><span style='mso-bookmark:_Toc315863752'><span
style='mso-ansi-language:EN-US'> </span>автофигуры</span><span
style='mso-bookmark:_Toc315863752'></span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>Листинг 3.79. Вращение автофигур</p>

<p class=MsoNormal>Sub RotatingAutoShapes()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Static fRunning As
Boolean</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Проверка,
выполняется ли уже этот макрос</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>If fRunning Then</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' При повторном
запуске останавливаем все запущенные макросы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>fRunning = False<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Укажем<span lang=EN-US
style='mso-ansi-language:EN-US'>, </span>что<span style='mso-ansi-language:
EN-US'> </span>макрос<span style='mso-ansi-language:EN-US'> </span>запущен<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>fRunning = True<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim cell As Range<span
style='mso-spacerun:yes'>                  </span>' </span>Рабочая<span
style='mso-ansi-language:EN-US'> </span>ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intLeftBorder As ****<span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>        </span>' </span>Левая<span style='mso-ansi-language:
EN-US'> </span>граница<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intRightBorder As ****<span
style='mso-spacerun:yes'>         </span>' </span>Правая<span style='mso-ansi-language:
EN-US'> </span>граница<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intTopBorder As ****<span
style='mso-spacerun:yes'>           </span>' </span>Верхняя<span
style='mso-ansi-language:EN-US'> </span>граница<span style='mso-ansi-language:
EN-US'> </span>ячейки<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intBottomBorder As ****<span
style='mso-spacerun:yes'>        </span>' </span>Нижняя<span style='mso-ansi-language:
EN-US'> </span>граница<span style='mso-ansi-language:EN-US'> </span>ячейки<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim alngVertSpeed(1 To 2) As ****<span
style='mso-spacerun:yes'>  </span>' </span>Массивы<span style='mso-ansi-language:
EN-US'> </span>со<span style='mso-ansi-language:EN-US'> </span>значениями<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim alngHorzSpeed(1 To 2) As ****<span
style='mso-spacerun:yes'>  </span>' </span>горизонтальной<span
style='mso-ansi-language:EN-US'> </span>и<span style='mso-ansi-language:EN-US'>
</span>вертикальной<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                                      </span></span>'
составляющих скоростей фигур</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim ashShapes(1 To
2) As Shape<span style='mso-spacerun:yes'>     </span>' Массив перемещаемых
автофигур</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Dim i As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span>' Заполнение массива автофигур</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set ashShapes(1) = ActiveSheet.shapes(1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Set ashShapes(2) = ActiveSheet.shapes(2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Заполнение массива скоростей:</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' для первой фигуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>alngVertSpeed(1) =
3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>alngHorzSpeed(1) =
3</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' для второй фигуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>alngVertSpeed(2) =
4</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>alngHorzSpeed(2) =
4</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение границ
рабочей ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Set cell = Range(&quot;B2&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intLeftBorder = cell.Left<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intRightBorder = cell.Left + cell.Width<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intTopBorder = cell.Top<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>intBottomBorder = cell.Top +
cell.Height</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выполнение
вращения и перемещения фигур</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Do</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Изменение
положения каждой автофигуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>For i = 1 To 2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>With ashShapes(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Контроль достижения правой
границы ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .Left + .Width + alngHorzSpeed(i)
&gt; intRightBorder Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Корректировка положения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>.Left =
intRightBorder - .Width</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Изменение направления горизонтальной скорости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>на
противоположное</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>              
</span>alngHorzSpeed(i) = -alngHorzSpeed(i)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>      </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Контроль
достижения левой границы ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .Left + alngHorzSpeed(i) &lt;
intLeftBorder Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Корректировка положения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>.Left =
intLeftBorder</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Изменение направления горизонтальной скорости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>на
противоположное</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>              
</span>alngHorzSpeed(i) = -alngHorzSpeed(i)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>' Контроль
достижения нижней границы ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .Top + .Height + alngVertSpeed(i)
&gt; intBottomBorder Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>         </span></span>' Корректировка положения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>.Top =
intBottomBorder - .Height</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Изменение направления вертикальной скорости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>на<span
style='mso-ansi-language:EN-US'> </span>противоположное<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>alngVertSpeed(i) =
-alngVertSpeed(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>        </span></span>' Контроль достижения верхней
границы ячейки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>If .Top + alngVertSpeed(i) &lt;
intTopBorder Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span></span>' Корректировка положения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>.Top =
intTopBorder</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span>'
Изменение направления вертикальной скорости _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>           </span>на<span style='mso-ansi-language:
EN-US'> </span>противоположное<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>alngVertSpeed(i) =
-alngVertSpeed(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>' </span>Перемещение<span
style='mso-ansi-language:EN-US'> </span>автофигуры<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Left = .Left + alngHorzSpeed(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.Top = .Top + alngVertSpeed(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Вращение автофигуры
(изменение направления вращения _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            
</span>происходит каждый раз при изменении направления _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            
</span>вертикального<span style='mso-ansi-language:EN-US'> </span>перемещения<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>.IncrementRotation alngVertSpeed(i)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>' Даем Excel команду
обработать пользовательский ввод</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>DoEvents<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Loop<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863753">Вызов таблицы цветов</a></h2>

<p class=MsoNormal>Листинг 3.80. Отображение таблицы цветов</p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
ShowColorTable()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intColor As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Формирование заголовка таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  
</span>Range(&quot;A1&quot;).Value = &quot;Цвет&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Range(&quot;B1&quot;).Value
= &quot;Значение свойства ColorIndex&quot;</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Вывод таблицы</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Range(&quot;A2&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>For intColor = 1 To 56<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Окрашиваем ячейку столбца
&quot;A&quot; в текущий цвет</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>With ActiveCell.Interior<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.ColorIndex = intColor<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>.Pattern = xlSolid<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>       </span>.PatternColorIndex = xlAutomatic<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End With<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>В<span style='mso-ansi-language:
EN-US'> </span>ячейку<span style='mso-ansi-language:EN-US'> </span>столбца<span
lang=EN-US style='mso-ansi-language:EN-US'> &quot;B&quot; </span>вносим<span
style='mso-ansi-language:EN-US'> </span>индекс<span style='mso-ansi-language:
EN-US'> </span>текущего<span style='mso-ansi-language:EN-US'> </span>цвета<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>ActiveCell.Offset(0, 1).Value =
intColor</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Переходим на
следующую строку</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>ActiveCell.Offset(1, 0).Activate<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Next<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Покажем<span style='mso-ansi-language:
EN-US'> </span>ячейку<span lang=EN-US style='mso-ansi-language:EN-US'>
&quot;A1&quot; (</span>начало<span style='mso-ansi-language:EN-US'> </span>таблицы<span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Range(&quot;A1&quot;).Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ActiveWindow.ScrollRow = 1<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<h2><a name="_Toc315863754">Создание калькулятора</a></h2>

<p class=MsoNormal>Листинг 3.81. Создание<span style='mso-ansi-language:EN-US'>
</span>калькулятора<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub
SimpleCalculator()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strExpr As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Ввод выражения</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strExpr =
InputBox(&quot;Что будем считать?&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Подсчет и вывод
результата</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>MsgBox strExpr
&amp; &quot; = &quot; &amp; Application.Evaluate(strExpr)</p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863755">Склонение фамилии, имени и отчества</a></h2>

<p class=MsoNormal>Листинг<span lang=EN-US style='mso-ansi-language:EN-US'>
3.85. </span>Склонение<span style='mso-ansi-language:EN-US'> </span>ФИО<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public Sub
PossessiveCase()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Склоняем ФИО в родительный падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strName1 As String, strName2 As String,
strName3 As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strName1 = dhGetName(ActiveCell, 1)<span
style='mso-spacerun:yes'>  </span>' </span>Выделяем<span style='mso-ansi-language:
EN-US'> </span>имя<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strName2 = dhGetName(ActiveCell, 2)<span
style='mso-spacerun:yes'>  </span>' </span>Выделяем<span style='mso-ansi-language:
EN-US'> </span>фамилию<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strName3 = dhGetName(ActiveCell, 3)<span
style='mso-spacerun:yes'>  </span>' </span>Выделяем<span style='mso-ansi-language:
EN-US'> </span>отчество<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Если в ячейке менее трех слов -
закрытие процедуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If strName1 = &quot;&quot; Or strName2 =
&quot;&quot; Or strName3 = &quot;&quot; Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Склоняем<span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells(ActiveCell.Row, ActiveCell.Column) =
dhPossessive( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>strName1, strName2, strName3)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public Sub
DativeCase()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>' </span>Объявление<span style='mso-ansi-language:
EN-US'> </span>переменных<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strName1 As String, strName2 As String,
strName3 As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strName1 = dhGetName(ActiveCell, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strName2 = dhGetName(ActiveCell, 2)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>strName3 = dhGetName(ActiveCell, 3)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Если в ячейке
менее трех слов - закрытие процедуры</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName1) = 0 Or Len(strName2) = 0 Or
Len(strName3) = 0 _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>Then Exit Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Cells(ActiveCell.Row, ActiveCell.Column) =
dhDative( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>strName1, strName2, strName3)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhPossessive(strName1 As String, strName2 As String, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>strName3 As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fMan As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определяем, мужские ФИО или женские</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>fMan =
(Right(strName3, 1) = &quot;ч&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Склонение фамилии
в родительный падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName1) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Склонение мужской фамилии</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Select Case
Right(strName1, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>Case
&quot;о&quot;, &quot;и&quot;, &quot;я&quot;, &quot;а&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhPossessive = strName1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>й<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = Mid(strName1, 1,
Len(strName1) - 2) + &quot;</span>ого<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = strName1 + &quot;</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Склонение
женской фамилии</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Select Case Right(strName1, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>и<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>б<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>в<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>г<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>д<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ж<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>з<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>к<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>л<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span></span>&quot;м&quot;,
&quot;н&quot;, &quot;п&quot;, &quot;р&quot;, &quot;с&quot;, &quot;т&quot;,
&quot;ф&quot;, &quot;х&quot;, &quot;ц&quot;, &quot;ч&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>      </span><span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;</span>ш<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;,
&quot;</span>щ<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ь<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = strName1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>я<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = Mid(strName1, 1,
Len(strName1) - 2) &amp; &quot;</span>ой<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = Mid(strName1, 1,
Len(strName1) - 1) &amp; &quot;</span>ой<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'> </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhPossessive = dhPossessive &amp; &quot;
&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Склонение имени в
родительный падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName2) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Склонение<span
style='mso-ansi-language:EN-US'> </span>мужского<span style='mso-ansi-language:
EN-US'> </span>имени<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Select Case Right(strName2, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>й<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ь<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = dhPossessive
&amp; Mid(strName2, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>1, Len(strName2) - 1) &amp;
&quot;</span>я<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = dhPossessive
&amp; strName2 &amp; &quot;</span>а<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Склонение
женского имени</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Select Case Right(strName2, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Select Case Mid(strName2,
Len(strName2) - 1, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>Case &quot;</span>и<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>г<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                     </span>dhPossessive =
dhPossessive &amp; Mid( _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>strName2, 1,
Len(strName2) - 1) &amp; &quot;</span>и<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                     </span>dhPossessive =
dhPossessive &amp; Mid(strName2, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                      </span>1, Len(strName2) - 1)
&amp; &quot;</span>ы<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>я<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>If Mid(strName2, Len(strName2) -
1, 1) = &quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>dhPossessive = dhPossessive
&amp; Mid(strName2, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>1, Len(strName2) - 1) &amp;
&quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>dhPossessive = dhPossessive
&amp; Mid(strName2, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>1, Len(strName2) - 1) &amp;
&quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>ь<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = dhPossessive
&amp; Mid(strName2, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>1, Len(strName2) - 1) &amp;
&quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhPossessive = dhPossessive
&amp; strName2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhPossessive = dhPossessive &amp; &quot;
&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Склонение отчества в родительный
падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName3) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhPossessive = dhPossessive &amp;
strName3 &amp; &quot;</span>а<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhPossessive = dhPossessive &amp;
Mid(strName3, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>          </span>Len(strName3) - 1) &amp; &quot;</span>ы<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End
Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhDative(strName1 As String, strName2 As String, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>strName3 As String) As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim fMan As Boolean<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Определяем, мужские ФИО или женские</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>fMan =
(Right(strName3, 1) = &quot;ч&quot;)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Склонение фамилии
в дательный падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName1) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>' Склонение мужской фамилии</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>Select Case
Right(strName1, 1)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>Case
&quot;о&quot;, &quot;и&quot;, &quot;я&quot;, &quot;а&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
lang=EN-US style='mso-ansi-language:EN-US'>dhDative = strName1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>й<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = Mid(strName1, 1,
Len(strName1) - 2) + &quot;</span>ому<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = strName1 + &quot;</span>у<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Склонение
женской фамилии</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Select Case Right(strName1, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>о<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>и<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>б<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>в<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>г<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>д<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ж<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>з<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>к<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>л<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>             </span></span>&quot;м&quot;,
&quot;н&quot;, &quot;п&quot;, &quot;р&quot;, &quot;с&quot;, &quot;т&quot;,
&quot;ф&quot;, &quot;х&quot;, &quot;ц&quot;, &quot;ч&quot;, &quot;ш&quot;, _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;</span>щ<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ь<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = strName1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>я<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = Mid(strName1, 1,
Len(strName1) - 2) &amp; &quot;</span>ой<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = Mid(strName1, 1,
Len(strName1) - 1) &amp; &quot;</span>ой<span lang=EN-US style='mso-ansi-language:
EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhDative = dhDative &amp; &quot; &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Склонение имени в
дательный падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span><span lang=EN-US style='mso-ansi-language:
EN-US'>If Len(strName2) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Склонение<span
style='mso-ansi-language:EN-US'> </span>мужского<span style='mso-ansi-language:
EN-US'> </span>имени<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>Select Case Right(strName2, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>й<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>ь<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = dhDative &amp;
Mid(strName2, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>Len(strName2) - 1) &amp; &quot;</span>ю<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>           </span><span
style='mso-spacerun:yes'> </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = dhDative &amp;
strName2 &amp; &quot;</span>у<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span></span>End Select</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>' Склонение
женского имени</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Select Case Right(strName2, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case &quot;</span>а<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;, &quot;</span>я<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>If Mid(strName2, Len(strName2) -
1, 1) = &quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>dhDative = dhDative &amp;
Mid(strName2, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>Len(strName2) - 1) &amp;
&quot;</span>и<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                  </span>dhDative = dhDative &amp;
Mid(strName2, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                   </span>Len(strName2) - 1) &amp;
&quot;</span>е<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>Case &quot;</span>ь<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = dhDative &amp;
Mid(strName2, 1, _<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>                </span>Len(strName2) - 1) &amp; &quot;</span>и<span
lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>               </span>dhDative = dhDative &amp;
strName2<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>dhDative = dhDative &amp; &quot; &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Склонение отчества в дательный
падеж</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Len(strName3) &gt; 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If fMan Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhDative = dhDative &amp; strName3
&amp; &quot;</span>у<span lang=EN-US style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>dhDative = dhDative &amp;
Mid(strName3, 1, Len(strName3) - 1) &amp; &quot;</span>е<span lang=EN-US
style='mso-ansi-language:EN-US'>&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Function<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Function
dhGetName(strString As String, intNum As Integer)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Функция возвращает слово с номером
intNum во входной строке _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strString<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strTemp As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intWord As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Dim intSpace As Integer</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Удаление пробелов
по краям строки</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>strTemp =
Trim(strString)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Просмотр строки
(до слова с нужным номером)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>For intWord = 1 To intNum - 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>' </span>Поиск<span style='mso-ansi-language:
EN-US'> </span>следующего<span style='mso-ansi-language:EN-US'> </span>пробела<span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intSpace = InStr(strTemp, &quot; &quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>If intSpace = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>' </span>Строка<span style='mso-ansi-language:
EN-US'> </span>закончилась<span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>         </span>intSpace = Len(strTemp)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>End If</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Строка strTemp
теперь начинается со слова с номером intWord</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
lang=EN-US style='mso-ansi-language:EN-US'>strTemp = Trim(Right(strTemp,
Len(strTemp) - intSpace))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>Next intWord</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Выделение нужного
слова (по пробелу после него)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>intSpace = InStr(strTemp, &quot; &quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>If intSpace = 0 Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>intSpace = Len(strTemp)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>dhGetName = Trim(Left(strTemp, intSpace))<o:p></o:p></span></p>

<p class=MsoNormal>End Function</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h1><a name="_Toc315863756">ГЛАВА 12. ДАТА И ВРЕМЯ</a></h1>

<h2><a name="_Toc315863757">Вывод даты и времени_1</a></h2>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim MyDate As Date<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MyDate = DateValue(&quot;6/1/72&quot;) +
TimeValue(&quot;10:10:12&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MsgBox Str(Minute(MyDate))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MsgBox Str(Year(MyDate))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<h2><a name="_Toc315863758">Вывод даты и времени_2</a></h2>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub</span><span
lang=EN-US> </span><span lang=EN-US style='mso-ansi-language:EN-US'>TimeAndDate</span>()</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>Dim strDate As String, strTime As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strGreeting As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim strUserName As String<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Dim intSpacePos As Integer<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strDate = Format(Date, &quot;****
Date&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strTime = Format(Time, &quot;Medium
Time&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Приветствие - в зависимости от
времени суток</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If Time &lt; TimeValue(&quot;12:00&quot;) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strGreeting = &quot;</span>Доброе<span
style='mso-ansi-language:EN-US'> </span>утро<span lang=EN-US style='mso-ansi-language:
EN-US'>, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>ElseIf Time &lt;
TimeValue(&quot;17:00&quot;) Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strGreeting = &quot;</span>Добрый<span
style='mso-ansi-language:EN-US'> </span>день<span lang=EN-US style='mso-ansi-language:
EN-US'>, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>Else<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span>strGreeting = &quot;</span>Добрый<span
style='mso-ansi-language:EN-US'> </span>вечер<span lang=EN-US style='mso-ansi-language:
EN-US'>, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>End If<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' В приветствие добавляется имя
текущего пользователя</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>strUserName = Application.UserName<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>intSpacePos = InStr(1, strUserName, &quot;
&quot;, 1)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Управление ситуацией, когда в имени
нет пробела</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If intSpacePos = 0 Then intSpacePos =
Len(strUserName)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span>strGreeting = strGreeting &amp;
Left(strUserName, intSpacePos)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>   </span></span>' Вывод на экран информационного
сообщения о дате и времени</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>MsgBox strDate &amp; vbCrLf &amp; strTime,
vbOKOnly, strGreeting<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h2><a name="_Toc315863759">Получение системной даты</a></h2>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span></p>

<h3><a name="_Toc315863760">Извлечение даты и часов</a></h3>

<p class=MsoNormal>Month(переменная типа Date)</p>

<p class=MsoNormal>Day(переменная типа Date)</p>

<p class=MsoNormal>Year(переменная типа Date)</p>

<p class=MsoNormal>Hour(переменная типа Date)</p>

<p class=MsoNormal>Minute(переменная типа Date)</p>

<p class=MsoNormal>Second(переменная типа Date)</p>

<p class=MsoNormal>WeekDay(переменная типа Date)</p>

<p class=MsoNormal>WeekDay это день недели, если Вам это нужно, то вы можете
написать что-то типа этого. </p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Sub Test()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim MyDate As Date<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>MyDate = DateValue(&quot;9/1/72&quot;)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>If (WeekDay(MyDate) = vbSunday) Then MsgBox
(&quot;Sunday&quot;)<o:p></o:p></span></p>

<p class=MsoNormal>End Sub</p>

<p class=MsoNormal>vbSunday это константа , есть еще vbMonday , ну дальше
понятно.</p>

<h3><a name="_Toc315863761">Функция ДатаПолная</a></h3>

<p class=MsoNormal>Function ДатаПолная(Ячейка)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>' Получение данных
в заданной ячейке в формате _</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&quot;dd mmmm
yyyy&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Дата =
Format(Ячейка, &quot;dd mmmm yyyy&quot;)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span lang=EN-US
style='mso-ansi-language:EN-US'>If IsDate(</span>Ячейка<span lang=EN-US
style='mso-ansi-language:EN-US'>) = True Or IsDate(</span>Дата<span lang=EN-US
style='mso-ansi-language:EN-US'>) = True Then<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>      </span></span>' Возврат строки с полной датой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>ДатаПолная =
StrConv(Дата, vbProperCase)</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>Else</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>' Данные в
ячейке не являются датой</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span>ДатаПолная =
&quot;&lt;&gt;&quot;</p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span>End If</p>

<p class=MsoNormal>End Function</p>

</div>

</body>

</html>
